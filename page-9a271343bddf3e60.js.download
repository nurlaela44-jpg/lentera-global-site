(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1296],{6867:(e,t,r)=>{Promise.resolve().then(r.bind(r,65235))},39337:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});var n=r(9381);let s=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",fill:"none",...e,children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 0C4.0275 0 0 4.02614 0 8.99695C0 12.9781 2.57625 16.3407 6.15375 17.5328C6.60375 17.6115 6.7725 17.3416 6.7725 17.1055C6.7725 16.8918 6.76125 16.1833 6.76125 15.4298C4.5 15.8459 3.915 14.8787 3.735 14.3726C3.63375 14.114 3.195 13.3155 2.8125 13.1018C2.4975 12.9331 2.0475 12.517 2.80125 12.5058C3.51 12.4945 4.01625 13.158 4.185 13.428C4.995 14.7887 6.28875 14.4064 6.80625 14.1702C6.885 13.5854 7.12125 13.1918 7.38 12.9669C5.3775 12.7419 3.285 11.9659 3.285 8.52461C3.285 7.5462 3.63375 6.73647 4.2075 6.10668C4.1175 5.88176 3.8025 4.95957 4.2975 3.72249C4.2975 3.72249 5.05125 3.48632 6.7725 4.64468C7.4925 4.44225 8.2575 4.34103 9.0225 4.34103C9.7875 4.34103 10.5525 4.44225 11.2725 4.64468C12.9938 3.47507 13.7475 3.72249 13.7475 3.72249C14.2425 4.95957 13.9275 5.88176 13.8375 6.10668C14.4113 6.73647 14.76 7.53495 14.76 8.52461C14.76 11.9772 12.6562 12.7419 10.6538 12.9669C10.98 13.248 11.2613 13.7878 11.2613 14.6313C11.2613 15.8346 11.25 16.8018 11.25 17.1055C11.25 17.3416 11.4187 17.6228 11.8688 17.5328C13.6554 16.9299 15.2079 15.782 16.3078 14.2508C17.4077 12.7195 17.9995 10.882 18 8.99695C18 4.02614 13.9725 0 9 0Z",fill:"currentColor"})})},55943:(e,t,r)=>{"use strict";r.d(t,{J:()=>l});var n=r(19635),s=r(76231);async function a(){try{let e=await fetch("/api/auth/list-jwt-public-keys",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return(await e.json()).keys}catch(e){throw console.error("Error listing jwt public keys:",e),e}}async function l(e){let t=await a(),r=async(e,r)=>{let s=e.kid,a=t.find(e=>e.kid===s);if(!a)throw Error("Public key not found for kid: ".concat(s));return await (0,n.jU)(a.publicKey,"RS256")},{payload:l}=await (0,s.V)(e,r,{algorithms:["RS256"]});return l}},65235:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>nZ});var n=r(9381),s=r(19289),a=r.n(s),l=r(44064),o=r(78072),i=r(37095),c=r(10689),d=r(51455),u=r(51673),m=r(25194),p=r(90037),x=r(34441),f=r(70529),h=r(6259),g=r(80586),v=r(80895),b=r(12061);let w=[{id:"name",label:"Name",visible:!0,order:1,row:0},{id:"status",label:"Status",visible:!0,order:0,row:0},{id:"model",label:"Model",visible:!0,order:3,row:0},{id:"date",label:"Date",visible:!0,order:0,row:1},{id:"repo",label:"Repo",visible:!0,order:1,row:1},{id:"diff",label:"Diff",visible:!0,order:3,row:1},{id:"prompt",label:"Prompt",visible:!1,order:2,row:0}],y="agent-view-config",j="merge",C="agent-default-group-by",N="full";function k(){try{let e=localStorage.getItem(C);if(!e)return j;if("date"===e)return null;return e}catch(e){return j}}function S(){let[e,t]=(0,c.useState)(()=>{{let r=localStorage.getItem(y);if(r)try{var e,t;let n=JSON.parse(r),s=new Set(n.properties.map(e=>e.id)),a=w.filter(e=>!s.has(e.id)),l=k();return{...n,groupBy:l,properties:[...n.properties,...a],viewMode:n.viewMode||N,sortBy:null!=(e=n.sortBy)?e:"date",sortDirection:null!=(t=n.sortDirection)?t:"desc"}}catch(e){console.error("Failed to parse stored view config:",e)}}return{properties:w,groupBy:k(),viewMode:N,sortBy:"date",sortDirection:"desc"}});(0,c.useEffect)(()=>{x.Fr?("list"!==e.viewMode||null!==e.groupBy)&&t(e=>({...e,viewMode:"list",groupBy:null})):"full"!==e.viewMode&&t(e=>({...e,viewMode:"full"}))},[e]),(0,c.useEffect)(()=>{localStorage.setItem(y,JSON.stringify(e))},[e]);let r=(0,c.useCallback)(e=>{t(e)},[]);return(0,c.useEffect)(()=>{let e=e=>{var r;let n=x.Fr?null:null==(r=e.detail)?void 0:r.groupBy;t(e=>({...e,groupBy:n}))};return window.addEventListener("agent-default-group-by-changed",e),()=>{window.removeEventListener("agent-default-group-by-changed",e)}},[]),{viewConfig:e,updateViewConfig:r,resetViewConfig:(0,c.useCallback)(()=>{t({properties:w,groupBy:x.Fr?null:k(),viewMode:x.Fr?"list":N,sortBy:"date",sortDirection:"desc"})},[])}}let E=e=>{if(!e)return new Date;let[t,r,n]=e.split("-").map(Number);return new Date(t,r-1,n)},L={rules:[]},A="agent-filter-config";var M=r(111),_=r(68551);function I(e,t,r){let n=function(e){try{let t=e.match(/github\.com[:/]([^/]+)\/([^/\s]+?)(\.git)?$/);if(t)return{owner:t[1],repo:t[2]};return null}catch(e){return console.error("Failed to parse GitHub repo URL:",e),null}}(e);if(!n)return console.error("Failed to parse GitHub repo URL:",e),!1;try{var s,a;let e=(s=n.owner,a=n.repo,"https://github.com/".concat(s,"/").concat(a,"/compare/").concat(t,"...").concat(r,"?expand=1"));return window.open(e,"_blank","noopener,noreferrer"),!0}catch(e){return console.error("Failed to open GitHub compare view:",e),!1}}var D=r(67169),R=r(87870),T=r(49782),F=r(93973);function P(e){let{isVisible:t,isIOS:r,isAndroid:s,canInstall:a,onInstall:l,onDismiss:o}=e,[i,d]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{if(t){let e=setTimeout(()=>d(!0),100);return()=>clearTimeout(e)}d(!1)},[t]),!t)return null;let u=async()=>{a&&s&&await l()};return(0,n.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 z-50 transition-all duration-300 ease-out ".concat(i?"transform translate-y-0 opacity-100":"transform translate-y-full opacity-0"),children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm"}),(0,n.jsxs)("div",{className:"relative rounded-t-xl  bg-gradient-to-b from-[#17191D] to-[#121315] border-t border-white/10 shadow-2xl",children:[(0,n.jsx)("div",{className:"px-4 py-4",children:(0,n.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[r&&(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-500/20 rounded-full flex items-center justify-center",children:(0,n.jsx)(D.A,{className:"h-4 w-4 text-gray-400"})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-white mb-1",children:"Install Cursor App"}),(0,n.jsxs)("p",{className:"text-xs text-gray-300 leading-relaxed",children:["Tap the ",(0,n.jsx)(D.A,{className:"inline h-3 w-3 mx-0.5 mb-1"})," share button below, then select ",(0,n.jsx)("strong",{children:'"Add to Home Screen"'})]})]})]}),(0,n.jsx)(F.default,{src:"/assets/images/agents/home-screen.png",alt:"iOS Install",style:{minWidth:"calc(100vw - 34px)"},width:307,height:344})]}),s&&(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-green-500/20 rounded-full flex items-center justify-center",children:(0,n.jsx)(R.A,{className:"h-4 w-4 text-green-400"})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-white mb-1",children:"Install Cursor App"}),a?(0,n.jsx)("button",{onClick:u,className:"text-xs bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-md transition-colors",children:"Install Now"}):(0,n.jsxs)("p",{className:"text-xs text-gray-300 leading-relaxed",children:["Tap the menu"," ",(0,n.jsx)("span",{className:"inline-block w-1 h-1 bg-gray-300 rounded-full mx-0.5"}),(0,n.jsx)("span",{className:"inline-block w-1 h-1 bg-gray-300 rounded-full mx-0.5"}),(0,n.jsx)("span",{className:"inline-block w-1 h-1 bg-gray-300 rounded-full"})," ",'button, then select "Add to Home screen" or "Install app"']})]})]})]}),(0,n.jsx)("button",{onClick:o,className:"flex-shrink-0 p-1 rounded text-gray-500 transition-colors","aria-label":"Dismiss",children:(0,n.jsx)(T.A,{className:"h-4 w-4"})})]})}),(0,n.jsx)("div",{className:"h-safe-area-inset-bottom bg-gray-900/95"})]})]})}var B=r(83209),O=r(89888),z=r(57045),U=r(27345),W=r(16708),H=r(72537),q=r(26703),J=r(12640),G=r(94389),Z=r(87668),V=r(20742),K=r(42768),$=r(41396);let X={times:[0,.4,1],duration:.5},Y=(0,c.forwardRef)((e,t)=>{let{onMouseEnter:r,onMouseLeave:s,className:a,size:l=28,...o}=e,d=(0,K.s)(),u=(0,c.useRef)(!1);(0,c.useImperativeHandle)(t,()=>(u.current=!0,{startAnimation:()=>d.start("animate"),stopAnimation:()=>d.start("normal")}));let m=(0,c.useCallback)(e=>{u.current?null==r||r(e):d.start("animate")},[d,r]),p=(0,c.useCallback)(e=>{u.current?null==s||s(e):d.start("normal")},[d,s]);return(0,n.jsx)("div",{className:(0,i.cn)(a),onMouseEnter:m,onMouseLeave:p,...o,children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)($.P.path,{variants:{normal:{y:0},animate:{y:[0,2,0]}},transition:X,animate:d,d:"m6 9 6 6 6-6"})})})});Y.displayName="ChevronDownIcon";let Q={times:[0,.45,1],duration:.7,ease:[.34,1.56,.64,1]},ee={normal:{rotate:0,x:0,y:0},animate:{rotate:[-2.5,3,-1.5,2,0],x:[0,-1.5,1,-.75,0],y:[0,1,-1.5,.5,0]}},et=(0,c.forwardRef)((e,t)=>{let{size:r=16,className:s,onMouseEnter:a,onMouseLeave:l,...o}=e,d=(0,K.s)(),u=(0,c.useRef)(!1);(0,c.useImperativeHandle)(t,()=>(u.current=!0,{startAnimation:()=>d.start("animate"),stopAnimation:()=>d.start("normal")}));let m=(0,c.useCallback)(e=>{u.current||d.start("animate"),null==a||a(e)},[d,a]),p=(0,c.useCallback)(e=>{u.current||d.start("normal"),null==l||l(e)},[d,l]);return(0,n.jsx)("div",{className:(0,i.cn)("inline-flex items-center justify-center text-current select-none",s),onMouseEnter:m,onMouseLeave:p,"aria-hidden":!0,...o,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",style:{overflow:"visible"},children:[(0,n.jsx)("path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,n.jsx)($.P.path,{variants:ee,animate:d,transition:Q,d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"})]})})});function er(){let[e,t]=(0,c.useState)("");return(0,c.useEffect)(()=>{let e=setInterval(()=>{t(e=>e.length>=3?"":e+".")},175);return()=>clearInterval(e)},[]),(0,n.jsx)("span",{className:"inline-block w-[18px] text-left","aria-label":"loading",children:e})}et.displayName="AnimatedSquarePenIcon";var en=r(18089),es=r(23899),ea=r(42699),el=r(99729),eo=r(29886),ei=r(13155),ec=r(24715),ed=r(68904),eu=r(27773),em=r(74420),ep=r(6629),ex=r(84684),ef=r(42136),eh=r(27650),eg=r(14980),ev=r(45150),eb=r(91106);function ew(e){let{open:t,onClose:r}=e,s=()=>{let{diffViewMode:e,setDiffViewMode:t}=(0,v._F)(),{viewConfig:r,updateViewConfig:s}=S(),a=e=>{let{label:t,description:r,control:s}=e;return(0,n.jsx)("div",{className:"py-3 flex flex-col gap-1",children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"text-sm text-white",children:t}),r&&(0,n.jsx)("p",{className:"text-xs text-brand-gray-400 leading-tight",children:r})]}),(0,n.jsx)("div",{className:"flex-shrink-0 flex items-center",children:s})]})})};return(0,n.jsxs)("div",{className:"px-6 pb-6 text-sm",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold",children:"General"}),(0,n.jsx)("p",{className:"text-brand-gray-400 text-sm mt-2",children:"Configure default diff display, grouping, and expansion behavior."})]}),(0,n.jsx)("div",{className:"px-4 py-0 bg-brand-dashboard-card rounded-xl",children:(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(a,{label:"Diff Display Style",description:"Choose how file changes are shown in diff views.",control:(0,n.jsx)("div",{className:"flex gap-4",children:["unified","split"].map(r=>{let s=e===r;return(0,n.jsxs)("button",{type:"button","aria-pressed":s,onClick:()=>t(r),className:"group flex flex-col items-center gap-1 text-xs focus:outline-none",children:[(0,n.jsx)("div",{className:(0,i.cn)("w-[52px] h-[34px] flex rounded-md outline outline-2 transition-all items-center justify-center",s?"outline-white":"opacity-50 hover:opacity-80 outline-transparent"),style:{background:"linear-gradient(180deg, #49609D 0%, #F0B563 100%)"},children:(0,n.jsxs)("div",{className:"flex items-center overflow-hidden box-border rounded-[3.5px] w-[42px] h-[27px] p-1  bg-white",children:["unified"===r&&(0,n.jsxs)("svg",{width:"32",height:"22",viewBox:"0 0 32 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{x:"2",y:"3.5",width:"16.5",height:"1.5",rx:"0.75",fill:"#F59EB1"})}),(0,n.jsx)("rect",{x:"19",y:"3.5",width:"9",height:"1.5",rx:"0.75",fill:"#F59EB1"}),(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"6",height:"1.5",rx:"0.75",fill:"#31AF85"})}),(0,n.jsx)("rect",{x:"8",y:"0.5",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"12.5",y:"0.5",width:"19",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{width:"6",height:"1.5",rx:"0.75",transform:"matrix(-1 0 0 1 31.5 20)",fill:"#31AF85"})}),(0,n.jsx)("rect",{width:"3",height:"1.5",rx:"0.75",transform:"matrix(-1 0 0 1 24 20)",fill:"#C2E7DB"}),(0,n.jsx)("rect",{width:"19",height:"1.5",rx:"0.75",transform:"matrix(-1 0 0 1 19.5 20)",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"0.5",y:"12",width:"6",height:"1.5",rx:"0.75",fill:"#F59EB1"}),(0,n.jsx)("rect",{x:"8",y:"12",width:"3",height:"1.5",rx:"0.75",fill:"#F9CAD4"}),(0,n.jsx)("rect",{x:"12.5",y:"12",width:"19",height:"1.5",rx:"0.75",fill:"#F9CAD4"}),(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{x:"2",y:"9.5",width:"6",height:"1.5",rx:"0.75",fill:"#31AF85"})}),(0,n.jsx)("rect",{x:"9.5",y:"9.5",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"14",y:"9.5",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{x:"5",y:"6.5",width:"6",height:"1.5",rx:"0.75",fill:"#31AF85"})}),(0,n.jsx)("rect",{x:"12.5",y:"6.5",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"17",y:"6.5",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{x:"10",y:"17.5",width:"6",height:"1.5",rx:"0.75",fill:"#31AF85"})}),(0,n.jsx)("rect",{x:"17.5",y:"17.5",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"22",y:"17.5",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"})]}),"split"===r&&(0,n.jsxs)("svg",{width:"32",height:"22",viewBox:"0 0 32 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{x:"2",y:"3.25",width:"10",height:"1.5",rx:"0.75",fill:"#F59EB1"})}),(0,n.jsx)("rect",{x:"13",y:"3.25",width:"3",height:"1.5",rx:"0.75",fill:"#F59EB1"}),(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{x:"17",y:"0.25",width:"6",height:"1.5",rx:"0.75",fill:"#31AF85"})}),(0,n.jsx)("rect",{x:"24.5",y:"0.25",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"29",y:"0.25",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{width:"6",height:"1.5",rx:"0.75",transform:"matrix(-1 0 0 1 32 20.25)",fill:"#31AF85"})}),(0,n.jsx)("rect",{width:"3",height:"1.5",rx:"0.75",transform:"matrix(-1 0 0 1 24.5 20.25)",fill:"#C2E7DB"}),(0,n.jsx)("rect",{width:"3",height:"1.5",rx:"0.75",transform:"matrix(-1 0 0 1 20 20.25)",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"0.5",y:"12.25",width:"5",height:"1.5",rx:"0.75",fill:"#F59EB1"}),(0,n.jsx)("rect",{x:"6",y:"12.25",width:"2",height:"1.5",rx:"0.75",fill:"#F9CAD4"}),(0,n.jsx)("rect",{x:"8.5",y:"12.25",width:"7",height:"1.5",rx:"0.75",fill:"#F9CAD4"}),(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{x:"17",y:"9.75",width:"10",height:"1.5",rx:"0.75",fill:"#31AF85"})}),(0,n.jsx)("rect",{x:"28.5",y:"9.75",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"17",y:"6.75",width:"10",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"28.5",y:"6.75",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("g",{opacity:"0.55",children:(0,n.jsx)("rect",{x:"17",y:"17.75",width:"6",height:"1.5",rx:"0.75",fill:"#31AF85"})}),(0,n.jsx)("rect",{x:"24.5",y:"17.75",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"29",y:"17.75",width:"3",height:"1.5",rx:"0.75",fill:"#C2E7DB"}),(0,n.jsx)("rect",{x:"1",y:"15.25",width:"15",height:"1.5",rx:"0.75",fill:"#F9CAD4"}),(0,n.jsx)("rect",{x:"17",y:"15.25",width:"15",height:"1.5",rx:"0.75",fill:"#F5F5F5"}),(0,n.jsx)("rect",{x:"17",y:"12.25",width:"15",height:"1.5",rx:"0.75",fill:"#F5F5F5"}),(0,n.jsx)("rect",{x:"1",y:"9.75",width:"15",height:"1.5",rx:"0.75",fill:"#F5F5F5"}),(0,n.jsx)("rect",{x:"1",y:"6.75",width:"15",height:"1.5",rx:"0.75",fill:"#F5F5F5"}),(0,n.jsx)("rect",{x:"17",y:"3.25",width:"15",height:"1.5",rx:"0.75",fill:"#F5F5F5"})]})]})}),(0,n.jsx)("span",{className:(0,i.cn)("text-[10px] tracking-wide transition-colors",s?"text-white":"text-gray-400 group-hover:text-gray-200"),children:"unified"===r?"Unified":"Split"})]},r)})})}),(0,n.jsx)(a,{label:"Default Grouping",description:"Initial grouping for the background agents list.",control:(0,n.jsx)("select",{value:null===r.groupBy?"":r.groupBy,onChange:e=>{let t=""===e.target.value?null:e.target.value;s({...r,groupBy:t});try{null===t?localStorage.setItem(C,"date"):localStorage.setItem(C,t);let e=new CustomEvent("agent-default-group-by-changed",{detail:{groupBy:t}});window.dispatchEvent(e)}catch(e){}},className:"w-[120px] text-xs px-2 py-1 rounded-md bg-[#1e1f22] border border-white/10 focus:outline-none",style:{colorScheme:"dark"},children:[{id:"merge",name:"Merge"},{id:null,name:"Date"},{id:"status",name:"Status"},{id:"repo",name:"Repo"},{id:"model",name:"Model"},{id:"prompt",name:"Prompt"}].map(e=>(0,n.jsx)("option",{value:null===e.id?"":e.id,className:"bg-[#1e1f22]",children:e.name},null===e.id?"date":e.id))})})]})})]})},[a,l]=(0,c.useState)(!1),o=(0,c.useRef)(null);(0,c.useEffect)(()=>{t?requestAnimationFrame(()=>l(!0)):l(!1)},[t]),(0,c.useEffect)(()=>{if(!t)return;let e=document.documentElement,r=e.classList.contains("dark"),n=e.style.colorScheme;return e.classList.add("dark"),e.style.colorScheme="dark",()=>{r||e.classList.remove("dark"),e.style.colorScheme=n}},[t]);let d=(0,c.useCallback)(e=>{t&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),r())},[t,r]);(0,c.useEffect)(()=>(window.addEventListener("keydown",d,{capture:!0}),()=>window.removeEventListener("keydown",d,{capture:!0})),[d]);let u=e=>{try{window.open(e,"_blank","noopener,noreferrer")}catch(e){}},m=(0,c.useMemo)(()=>[{id:"general",label:"General",icon:(0,n.jsx)(ea.A,{className:"w-4 h-4"}),render:()=>(0,n.jsx)(s,{})},{id:"overview",label:"Overview",icon:(0,n.jsx)(el.A,{className:"w-4 h-4"}),render:()=>(0,n.jsx)(eg.M,{onNavigateToSettings:()=>x("settings"),onOpenPrivacyModal:()=>x("settings")})},{id:"settings",label:"Settings",icon:(0,n.jsx)(q.A,{className:"w-4 h-4"}),render:()=>(0,n.jsx)("div",{className:"p-0",children:(0,n.jsx)(ev.s,{})})},{id:"members",label:"Members",icon:(0,n.jsx)(eo.A,{className:"w-4 h-4"}),render:()=>(0,n.jsx)(eh.U,{onNavigateToUsage:()=>x("usage")})},{id:"integrations",label:"Integrations",icon:(0,n.jsx)(ei.A,{className:"w-4 h-4"}),render:()=>(0,n.jsx)(ef.q,{onOpenPrivacyModal:()=>x("settings")})},{id:"background-agents",label:"Background Agents",icon:(0,n.jsx)(ec.A,{className:"w-4 h-4"}),render:()=>(0,n.jsx)(ex.B,{onOpenPrivacyModal:()=>x("settings")})},{id:"bugbot",label:"Bugbot",icon:(0,n.jsx)(ed.A,{className:"w-4 h-4"}),externalLink:"/dashboard?tab=bugbot"},{id:"usage",label:"Usage",icon:(0,n.jsx)(eu.A,{className:"w-4 h-4"}),render:()=>(0,n.jsx)(eb._N,{})},{id:"docs",label:"Docs",icon:(0,n.jsx)(em.A,{className:"w-4 h-4"}),externalLink:"https://docs.cursor.com/get-started/welcome"},{id:"contact",label:"Contact Us",icon:(0,n.jsx)(ep.A,{className:"w-4 h-4"}),render:()=>(0,n.jsxs)("div",{className:"p-6 space-y-4",children:[(0,n.jsx)(O.o5,{className:"text-base font-medium",children:"Contact Us"}),(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"Reach out to the team for sales or support questions."}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(es.Button,{size:"sm",onClick:()=>u("mailto:support@cursor.com"),children:"Email Support"}),(0,n.jsx)(es.Button,{size:"sm",variant:"secondary",onClick:()=>u("/dashboard?tab=overview"),children:"Open Dashboard"})]})]})}],[]),[p,x]=(0,c.useState)(m[0].id);return(0,c.useEffect)(()=>{t&&x(m[0].id)},[t,m]),(0,n.jsxs)("div",{className:(0,i.cn)("fixed inset-0 z-[200] flex items-center justify-center overflow-hidden",a?"pointer-events-auto":"pointer-events-none"),children:[(0,n.jsx)("div",{onClick:r,className:(0,i.cn)("absolute inset-0 bg-black/60 transition-opacity duration-200",a?"opacity-100":"opacity-0")}),(0,n.jsx)("div",{ref:o,className:(0,i.cn)("relative flex h-[80vh] w-[min(1180px,92vw)] max-w-[1180px] rounded-lg border border-gray-600/30 bg-[#16181C] shadow-2xl overflow-hidden dark [color-scheme:dark]","transition-all duration-200 ease-out origin-center scale-95 opacity-0 will-change-transform will-change-opacity",a&&"scale-100 opacity-100"),role:"dialog","aria-modal":"true","aria-label":"Settings",children:(0,n.jsxs)(b.q,{children:[(0,n.jsx)("div",{className:"flex w-52 flex-col border-r border-gray-600/20 bg-[#1A1D21] h-full",children:(0,n.jsx)("nav",{className:"flex-1 overflow-y-auto p-1",children:m.map(e=>(0,n.jsxs)("button",{onClick:()=>{if(e.externalLink)return void u(e.externalLink);x(e.id)},className:(0,i.cn)("w-full flex outline-none focus:outline-none items-center gap-2 px-4 py-2 text-left text-sm rounded-md",p===e.id?"text-gray-300 bg-white/5":"text-gray-500 hover:text-gray-200 hover:bg-white/[0.02]"),children:[e.icon,(0,n.jsx)("span",{children:e.label})]},e.id))})}),(0,n.jsx)("div",{className:"flex-1 relative h-full overflow-y-auto dark [color-scheme:dark]",children:m.map(e=>(0,n.jsx)("div",{className:(0,i.cn)("absolute inset-0 overflow-y-auto py-6 px-6",p===e.id?"block":"hidden"),children:e.render&&e.render()},e.id))})]})})]})}var ey=r(4352),ej=r(54122),eC=r(88138);function eN(e){let{className:t}=e;return(0,n.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"".concat(t," icon-generating"),style:{transformOrigin:"center center"},children:(0,n.jsx)("path",{d:"M8.86853 3.94922C8.70903 3.94922 8.57003 3.88997 8.45154 3.77148C8.33305 3.65299 8.2738 3.51172 8.2738 3.34766V1.24219C8.2738 1.07812 8.33305 0.936849 8.45154 0.818359C8.57003 0.69987 8.70903 0.640625 8.86853 0.640625C9.03259 0.640625 9.17387 0.69987 9.29236 0.818359C9.41085 0.936849 9.47009 1.07812 9.47009 1.24219V3.34766C9.47009 3.51172 9.41085 3.65299 9.29236 3.77148C9.17387 3.88997 9.03259 3.94922 8.86853 3.94922ZM11.7806 5.15234C11.6667 5.03841 11.6097 4.89714 11.6097 4.72852C11.6097 4.5599 11.6667 4.41862 11.7806 4.30469L13.2777 2.82129C13.3916 2.70736 13.5306 2.65039 13.6947 2.65039C13.8633 2.65039 14.0046 2.70736 14.1185 2.82129C14.2325 2.93522 14.2894 3.0765 14.2894 3.24512C14.2894 3.40918 14.2325 3.54818 14.1185 3.66211L12.6283 5.15234C12.5144 5.26628 12.3731 5.32324 12.2045 5.32324C12.0358 5.32324 11.8946 5.26628 11.7806 5.15234ZM12.9906 8.06445C12.9906 7.90039 13.0498 7.76139 13.1683 7.64746C13.2868 7.52897 13.4258 7.46973 13.5853 7.46973H15.6908C15.8549 7.46973 15.9961 7.52897 16.1146 7.64746C16.2331 7.76139 16.2924 7.90039 16.2924 8.06445C16.2924 8.22396 16.2331 8.36296 16.1146 8.48145C15.9961 8.59993 15.8549 8.65918 15.6908 8.65918H13.5853C13.4258 8.65918 13.2868 8.59993 13.1683 8.48145C13.0498 8.36296 12.9906 8.22396 12.9906 8.06445ZM11.7806 10.9697C11.8946 10.8558 12.0358 10.7988 12.2045 10.7988C12.3731 10.7988 12.5144 10.8558 12.6283 10.9697L14.1185 12.4668C14.2325 12.5807 14.2894 12.722 14.2894 12.8906C14.2894 13.0547 14.2325 13.1937 14.1185 13.3076C14.0046 13.4215 13.8633 13.4785 13.6947 13.4785C13.5306 13.4785 13.3916 13.4215 13.2777 13.3076L11.7806 11.8174C11.6667 11.7035 11.6097 11.5622 11.6097 11.3936C11.6097 11.2249 11.6667 11.0837 11.7806 10.9697ZM8.86853 12.1797C9.03259 12.1797 9.17387 12.2389 9.29236 12.3574C9.41085 12.4759 9.47009 12.6149 9.47009 12.7744V14.8867C9.47009 15.0462 9.41085 15.1852 9.29236 15.3037C9.17387 15.4222 9.03259 15.4814 8.86853 15.4814C8.70903 15.4814 8.57003 15.4222 8.45154 15.3037C8.33305 15.1852 8.2738 15.0462 8.2738 14.8867V12.7744C8.2738 12.6149 8.33305 12.4759 8.45154 12.3574C8.57003 12.2389 8.70903 12.1797 8.86853 12.1797ZM5.96326 10.9697C6.07719 11.0837 6.13416 11.2249 6.13416 11.3936C6.13416 11.5622 6.07719 11.7035 5.96326 11.8174L4.46619 13.3076C4.35225 13.4215 4.21098 13.4785 4.04236 13.4785C3.8783 13.4785 3.7393 13.4215 3.62537 13.3076C3.51143 13.1937 3.45447 13.0547 3.45447 12.8906C3.45447 12.722 3.51143 12.5807 3.62537 12.4668L5.1156 10.9697C5.22953 10.8558 5.37081 10.7988 5.53943 10.7988C5.70805 10.7988 5.84932 10.8558 5.96326 10.9697ZM4.7533 8.06445C4.7533 8.22396 4.69405 8.36296 4.57556 8.48145C4.45707 8.59993 4.31807 8.65918 4.15857 8.65918H2.04626C1.88676 8.65918 1.74776 8.59993 1.62927 8.48145C1.51078 8.36296 1.45154 8.22396 1.45154 8.06445C1.45154 7.90039 1.51078 7.76139 1.62927 7.64746C1.74776 7.52897 1.88676 7.46973 2.04626 7.46973H4.15857C4.31807 7.46973 4.45707 7.52897 4.57556 7.64746C4.69405 7.76139 4.7533 7.90039 4.7533 8.06445ZM5.96326 5.15234C5.84932 5.26628 5.70805 5.32324 5.53943 5.32324C5.37081 5.32324 5.22953 5.26628 5.1156 5.15234L3.62537 3.66211C3.51143 3.54818 3.45447 3.40918 3.45447 3.24512C3.45447 3.0765 3.51143 2.93522 3.62537 2.82129C3.7393 2.70736 3.8783 2.65039 4.04236 2.65039C4.21098 2.65039 4.35225 2.70736 4.46619 2.82129L5.96326 4.30469C6.07719 4.41862 6.13416 4.5599 6.13416 4.72852C6.13416 4.89714 6.07719 5.03841 5.96326 5.15234Z",fill:"#EBCB8B"})})}r(30580);var ek=r(96486),eS=r(85524),eE=r(7566),eL=r(29179),eA=r(10691);function eM(e){let{selectedRepo:t,selectedBranch:r,onBranchSelect:s,className:a="",hasCachedData:l=!1,onOpenChange:o}=e,[i,d]=(0,c.useState)(!1),[u,p]=(0,c.useState)(!1),[f,h]=(0,c.useState)(!1),[g,v]=(0,c.useState)(!1),[b,w]=(0,c.useState)(-1),[y,j]=(0,c.useState)(!1),[C,N]=(0,c.useState)(!1),[k,S]=(0,c.useState)(!1),[E,L]=(0,c.useState)(""),[A,M]=(0,c.useState)({branches:[],currentPage:1,hasMore:!0,isLoading:!1,isLoadingMore:!1,error:null}),_=(0,c.useRef)(null),I=(0,c.useRef)(null),D=(0,c.useRef)(null),R=(0,c.useRef)(null),T=(0,c.useRef)(null),F=(0,c.useRef)(null),P=(0,c.useCallback)(()=>{R.current&&clearTimeout(R.current),p(!0),R.current=setTimeout(()=>{d(!1),p(!1),R.current=null},150)},[]);(0,c.useEffect)(()=>()=>{R.current&&clearTimeout(R.current),T.current&&clearTimeout(T.current),F.current&&clearTimeout(F.current)},[]),(0,c.useEffect)(()=>{function e(e){y||_.current&&!_.current.contains(e.target)&&P()}if(i)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[i,P,y]),(0,c.useEffect)(()=>{if(i){let e=r?A.branches.findIndex(e=>e.name===r):-1;w(e>=0?e:-1),e>=0&&I.current&&I.current.scrollToRow(e)}},[i,r,A.branches]),(0,c.useEffect)(()=>{null==o||o(i||f||g)},[i,f,g,o]),(0,c.useEffect)(()=>{(null==t?void 0:t.owner)&&(null==t?void 0:t.name)&&M({branches:[],currentPage:1,hasMore:!0,isLoading:!0,isLoadingMore:!1,error:null})},[null==t?void 0:t.owner,null==t?void 0:t.name]);let B=A.branches,O=(0,c.useCallback)(()=>{E.trim()&&(s(E.trim()),L(""),j(!1),P())},[E,s,P]),z=(0,c.useCallback)(()=>{j(!0),N(!0),T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{N(!1),T.current=null},10)},[]),U=(0,c.useCallback)(()=>{S(!0),F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{j(!1),S(!1),N(!1),L(""),F.current=null},150)},[]),W=(0,c.useCallback)(e=>{s(e),v(!1),h(!1)},[s]),H=(0,c.useCallback)(()=>{v(!1)},[]),q=(0,c.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(null==t?void 0:t.owner)||!(null==t?void 0:t.name))return void M(e=>({...e,branches:[],error:null}));D.current&&D.current.abort(),D.current=new AbortController,M(t=>({...t,isLoading:1===e&&!n,isLoadingMore:e>1||n,error:null}));try{let l="https://github.com/".concat(t.owner,"/").concat(t.name),o=new m.wf({repoUrl:l,page:e}),i=await fetch("/api/background-composer/get-repository-branches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.toJson()),signal:D.current.signal});if(!i.ok)throw Error("Failed to fetch branches: ".concat(i.statusText));let c=new m.Y1().fromJson(await i.json());if(M(t=>{let r,s=(c.branches||[]).map(e=>({name:e.name,isDefault:e.isDefault}));if(n){let e=new Set(t.branches.map(e=>e.name)),n=s.filter(t=>!e.has(t.name));r=[...t.branches,...n]}else r=s;return{...t,branches:r,hasMore:c.hasMore||!1,currentPage:e,isLoading:!1,isLoadingMore:!1,error:null}}),!r&&1===e){var a;let e=null==(a=c.branches)?void 0:a.find(e=>e.isDefault);e&&s(e.name)}}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;console.error("Error fetching branches:",e),M(t=>({...t,error:e instanceof Error?e.message:"Failed to fetch branches",isLoading:!1,isLoadingMore:!1}))}},[null==t?void 0:t.owner,null==t?void 0:t.name,r,s]),[J,G]=(0,c.useState)({scrollTop:0,clientHeight:0}),Z=(0,c.useRef)(null),V=(0,c.useRef)(!1);(0,c.useEffect)(()=>{(null==t?void 0:t.owner)&&(null==t?void 0:t.name)&&q(1)},[null==t?void 0:t.owner,null==t?void 0:t.name,q]);let K=(0,c.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!A.hasMore||A.isLoading||A.isLoadingMore||(Z.current=J.scrollTop,V.current=e,q(A.currentPage+1,!0))},[A.hasMore,A.isLoading,A.isLoadingMore,A.currentPage,q,J.scrollTop]),$=(0,c.useCallback)(e=>{if(!e.isLoading){if(e.isLoadMore)return void K(!0);s(e.name),P(),h(!1),w(-1)}},[s,K,P]),X=(0,c.useMemo)(()=>{let e=[...B];return A.isLoadingMore&&A.hasMore&&e.push({name:"Loading more branches...",isDefault:!1,isLoading:!0}),e},[B,A.isLoadingMore,A.hasMore]);(0,c.useEffect)(()=>{!A.isLoadingMore&&null!==Z.current&&I.current&&((()=>{if(!I.current)return;let e=X.length;if(e>8){let t=Math.max(0,e-8);I.current.scrollToRow(t)}})(),Z.current=null,V.current=!1)},[A.isLoadingMore,X.length]);let Y=(0,c.useMemo)(()=>X.filter(e=>!e.isLoading).map(e=>({id:e.name,data:e.name,displayName:e.name})),[X]);(0,c.useMemo)(()=>{if(r)return Y.find(e=>e.data===r)},[r,Y]),(0,c.useCallback)((e,t,s)=>{let a=e.data;if(a.isLoading)return(0,n.jsx)("div",{className:"opacity-60 cursor-default",children:(0,n.jsx)("span",{className:"text-gray-400",children:a.name})});if(a.isLoadMore)return(0,n.jsx)("div",{className:"text-center text-blue-400 hover:text-blue-300",children:(0,n.jsx)("span",{className:"text-xs",children:a.name})});let l=r===a.name;return(0,n.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 flex-1 min-w-0",children:[(0,n.jsx)("span",{className:"truncate font-medium ".concat(a.isDefault?"font-semibold":""),children:a.name}),a.isDefault&&(0,n.jsx)("span",{className:"text-[9px] text-white/50 font-medium mt-0.5",children:"Default"})]}),l&&(0,n.jsx)(ek.A,{className:"w-3 h-3 text-gray-300"})]})},[r]);let Q=(0,n.jsx)("svg",{width:"13",height:"18",viewBox:"0 0 13 18",fill:"none",className:"flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("g",{children:(0,n.jsx)("path",{d:"M12.6875 5.5001C12.6873 5.17282 12.5954 4.85216 12.4221 4.57451C12.2489 4.29686 12.0012 4.07337 11.7073 3.9294C11.4134 3.78543 11.085 3.72676 10.7595 3.76006C10.4339 3.79335 10.1242 3.91727 9.8655 4.11775C9.60682 4.31823 9.40954 4.58723 9.29607 4.89419C9.18259 5.20116 9.15747 5.5338 9.22355 5.85433C9.28963 6.17486 9.44427 6.47044 9.6699 6.7075C9.89554 6.94455 10.1831 7.11359 10.5 7.19541V8.12509C10.5 8.24113 10.4539 8.35241 10.3719 8.43445C10.2898 8.5165 10.1785 8.56259 10.0625 8.56259H5.25C5.10093 8.56255 4.95295 8.58808 4.8125 8.63806V7.19541C5.22492 7.08892 5.58434 6.83568 5.82339 6.48315C6.06245 6.13063 6.16473 5.70301 6.11106 5.28047C6.05739 4.85793 5.85145 4.46946 5.53186 4.18789C5.21226 3.90632 4.80094 3.75098 4.375 3.75098C3.94907 3.75098 3.53775 3.90632 3.21815 4.18789C2.89856 4.46946 2.69262 4.85793 2.63895 5.28047C2.58528 5.70301 2.68756 6.13063 2.92662 6.48315C3.16567 6.83568 3.52509 7.08892 3.9375 7.19541V10.8048C3.52509 10.9113 3.16567 11.1645 2.92662 11.517C2.68756 11.8696 2.58528 12.2972 2.63895 12.7197C2.69262 13.1423 2.89856 13.5307 3.21815 13.8123C3.53775 14.0939 3.94907 14.2492 4.375 14.2492C4.80094 14.2492 5.21226 14.0939 5.53186 13.8123C5.85145 13.5307 6.05739 13.1423 6.11106 12.7197C6.16473 12.2972 6.06245 11.8696 5.82339 11.517C5.58434 11.1645 5.22492 10.9113 4.8125 10.8048V9.87509C4.8125 9.75906 4.8586 9.64778 4.94064 9.56574C5.02269 9.48369 5.13397 9.43759 5.25 9.43759H10.0625C10.4106 9.43759 10.7444 9.29931 10.9906 9.05317C11.2367 8.80703 11.375 8.47319 11.375 8.12509V7.19541C11.7505 7.09787 12.0831 6.87853 12.3206 6.57175C12.5581 6.26497 12.6871 5.88807 12.6875 5.5001ZM3.5 5.5001C3.5 5.32704 3.55132 5.15786 3.64747 5.01397C3.74361 4.87008 3.88027 4.75793 4.04016 4.6917C4.20004 4.62547 4.37597 4.60815 4.54571 4.64191C4.71544 4.67567 4.87135 4.75901 4.99372 4.88138C5.11609 5.00375 5.19943 5.15966 5.23319 5.32939C5.26695 5.49912 5.24963 5.67506 5.1834 5.83494C5.11717 5.99483 5.00502 6.13148 4.86113 6.22763C4.71723 6.32378 4.54806 6.3751 4.375 6.3751C4.14294 6.3751 3.92038 6.28291 3.75629 6.11881C3.59219 5.95472 3.5 5.73216 3.5 5.5001ZM5.25 12.5001C5.25 12.6732 5.19869 12.8423 5.10254 12.9862C5.00639 13.1301 4.86974 13.2423 4.70985 13.3085C4.54997 13.3747 4.37403 13.392 4.2043 13.3583C4.03457 13.3245 3.87866 13.2412 3.75629 13.1188C3.63391 12.9964 3.55058 12.8405 3.51682 12.6708C3.48305 12.5011 3.50038 12.3251 3.56661 12.1652C3.63284 12.0054 3.74499 11.8687 3.88888 11.7726C4.03277 11.6764 4.20195 11.6251 4.375 11.6251C4.60707 11.6251 4.82963 11.7173 4.99372 11.8814C5.15782 12.0455 5.25 12.268 5.25 12.5001ZM10.9375 6.3751C10.7644 6.3751 10.5953 6.32378 10.4514 6.22763C10.3075 6.13148 10.1953 5.99483 10.1291 5.83494C10.0629 5.67506 10.0456 5.49912 10.0793 5.32939C10.1131 5.15966 10.1964 5.00375 10.3188 4.88138C10.4412 4.75901 10.5971 4.67567 10.7668 4.64191C10.9365 4.60815 11.1125 4.62547 11.2724 4.6917C11.4322 4.75793 11.5689 4.87008 11.665 5.01397C11.7612 5.15786 11.8125 5.32704 11.8125 5.5001C11.8125 5.73216 11.7203 5.95472 11.5562 6.11881C11.3921 6.28291 11.1696 6.3751 10.9375 6.3751Z",className:"fill-gray-600 ".concat(r?"group-hover:fill-gray-500":"")})})}),ee=!r&&(A.isLoading&&0===A.branches.length||(null==t?void 0:t.owner)&&(null==t?void 0:t.name)&&0===A.branches.length&&!A.error),et=!t&&!l&&0===A.branches.length,er=ee||et||0===X.length,en=(0,c.useCallback)(e=>{if(!I.current)return;let t=Math.min(24*X.length,192),r=Math.floor(J.scrollTop/24),n=Math.floor((J.scrollTop+t)/24)-1;(e<r||e>n)&&I.current.scrollToRow(e)},[X,J.scrollTop]);return(0,c.useEffect)(()=>{if(!i)return;let e=e=>{if(y){"Escape"===e.key&&(e.preventDefault(),U());return}switch(e.key){case"ArrowDown":e.preventDefault(),w(e=>{let t=Math.min(e+1,B.length-1);return en(t),t});break;case"ArrowUp":e.preventDefault(),w(e=>{let t=Math.max(e-1,0);return en(t),t});break;case"Enter":e.preventDefault(),b>=0&&b<B.length&&$(B[b]);break;case"Escape":e.preventDefault(),P()}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[i,b,B,en,$,P,y,U]),(0,n.jsxs)(n.Fragment,{children:[x.Fr?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>h(!0),className:"inline-flex items-center outline-none focus:outline-none ring-0 focus:ring-0 focus:ring-offset-0 justify-between text-left transition-colors duration-100 group text-xs max-w-full ".concat(a," ").concat(er?"text-gray-600 cursor-not-allowed":"text-gray-500 hover:text-gray-400 cursor-pointer"),disabled:er,children:[(0,n.jsxs)("div",{className:"flex items-center gap-1.5 transition-opacity duration-100 overflow-hidden",children:[Q,(0,n.jsx)("span",{className:"truncate text-[14px] ".concat(ee?"make-shine":""),children:ee?"Loading":et?"Select a repository first":r||(0===X.length?"No branches available":"Select branch")})]}),(0,n.jsx)("svg",{className:"w-3 h-3 transition-all duration-100 ml-1 flex-shrink-0 ".concat(er?"text-gray-700":"text-gray-600 group-hover:text-gray-500"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,n.jsx)(eA.P,{isOpen:f,onOpenChange:h,items:Y,onItemSelect:e=>{let t=X.find(t=>t.name===e.data);t&&$(t)},showAddButton:!0,addButtonText:"Add branch",onAddButtonClick:()=>v(!0),noItemsText:"No branches available",renderItem:e=>{let t=X.find(t=>t.name===e.data);if(!t||t.isLoading)return null;let s=r===t.name;return(0,n.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,n.jsx)("span",{className:"text-base text-gray-300 truncate",children:t.name}),t.isDefault&&(0,n.jsx)("span",{className:"text-md text-gray-500 flex-shrink-0 font-medium",children:"• Default"})]}),s&&(0,n.jsx)(ek.A,{className:"w-4 h-4 text-gray-300 flex-shrink-0 mt-0.5"})]})}}),(0,n.jsx)(eA.K,{isOpen:g,onOpenChange:v,title:"Enter a branch name",inputPlaceholder:"Branch name...",confirmText:"Add",cancelText:"Cancel",onConfirm:W,onCancel:H})]}):(0,n.jsxs)("div",{className:"relative ".concat(a),ref:_,children:[(0,n.jsxs)("button",{onClick:()=>{er||(i||u?P():d(!0))},disabled:er,className:"flex items-center outline-none focus:outline-none ring-0 focus:ring-0 focus:ring-offset-0 justify-between text-left transition-colors duration-100 group text-xs max-w-full ".concat(a," ").concat(er?"text-gray-600 cursor-not-allowed":"text-gray-500 hover:text-gray-400 cursor-pointer"),children:[(0,n.jsxs)("div",{className:"flex items-center gap-1.5 transition-opacity duration-100 min-w-0 flex-1 overflow-hidden",children:[Q,(0,n.jsx)("span",{className:"truncate text-[14px] min-w-0 max-w-[120px] sm:max-w-[160px] md:max-w-[200px] ".concat(ee?"make-shine":""),children:ee?"Loading":et?"Select a repository first":r||(0===X.length?"No branches available":"Select branch")})]}),(0,n.jsx)(eS.A,{className:"w-3 h-3 transition-all duration-100 ml-1 flex-shrink-0 ".concat(er?"text-gray-700":"text-gray-600 group-hover:text-gray-500"," ").concat(i&&!er?"rotate-180":"")})]}),(i||u)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-40",onClick:P}),(0,n.jsxs)("div",{className:"absolute top-full left-[-3px] z-50 mt-1 overflow-hidden bg-[#191C22] rounded-md border border-[#272C36] w-[240px] flex flex-col text-[11px]",style:{boxShadow:"0px 36px 50px 0px rgba(0, 0, 0, 0.14), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 23px 16px 6px rgba(0, 0, 0, 0.10)",opacity:1,transform:"scale(1)",transformOrigin:"top left",transition:"opacity 0.15s ease-out, transform 0.15s ease-out",animation:u?"dropdown-out 0.15s ease-out forwards":"dropdown-in 0.15s ease-out forwards"},children:[(0,n.jsx)("div",{className:"flex items-center justify-between w-full p-0.5",children:(0,n.jsx)("button",{onClick:z,className:"w-full py-1 px-2 flex items-center justify-between hover:bg-gray-300/10 transition-colors",children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(eE.A,{className:"w-3 h-3 text-gray-500"}),(0,n.jsx)("span",{className:"text-[11px] font-medium text-gray-300",children:"Add branch"})]})})}),(0,n.jsx)("div",{className:"overflow-hidden border-t border-[#272C36]",style:{padding:"2px",maxHeight:"240px",boxSizing:"border-box",height:Math.min(24*X.length+4,196)},children:0===X.length?(0,n.jsx)("div",{className:"text-center",style:{padding:"12px 6px",fontSize:"11px",color:"var(--vscode-list-inactiveSelectionForeground, rgba(255, 255, 255, 0.5))"},children:"No branches available"}):(0,n.jsx)(eL.B8,{ref:I,height:Math.min(24*X.length,192),width:234,rowCount:X.length,rowHeight:24,rowRenderer:e=>{let{index:t,key:r,style:s}=e,a=X[t],l=t===b&&!a.isLoading;return(0,n.jsx)("div",{style:{...s,boxSizing:"border-box"},children:(0,n.jsx)("button",{onClick:()=>$(a),disabled:a.isLoading,className:"searchable-dropdown-item px-1.5 py-0.5 flex items-center text-left box-border text-[rgba(255,255,255,0.7)] rounded-[4px] w-full text-[11px] ".concat(a.isLoading?"cursor-default opacity-60":"cursor-pointer"),style:{minHeight:"".concat(24,"px"),backgroundColor:l?"rgba(255, 255, 255, 0.08)":"transparent",transition:"none"},children:(0,n.jsx)("div",{className:"w-full min-w-0",children:(0,n.jsx)("div",{className:"flex items-center justify-between w-full",children:(0,n.jsxs)("div",{className:"flex items-center gap-1 flex-1 min-w-0",children:[(0,n.jsx)("span",{className:"truncate font-medium ".concat(a.isDefault?"font-semibold":""),children:a.name}),a.isDefault&&(0,n.jsx)("span",{className:"text-[10px] text-[#88C0D0] px-1 py-0 rounded flex-shrink-0 font-medium",style:{background:"rgba(136, 192, 208, 0.17)"},children:"default"})]})})})})},r)},scrollToAlignment:"auto",className:"virtualized-dropdown-list",onRowsRendered:e=>{let{stopIndex:t}=e;t>=X.length-3&&A.hasMore&&!A.isLoadingMore&&K()},onScroll:e=>{let{scrollTop:t,clientHeight:r}=e;G({scrollTop:t,clientHeight:r})}})})]})]})]}),(y||k||C)&&(0,n.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[(0,n.jsx)("div",{className:"fixed inset-0 bg-black transition-opacity duration-150 ".concat(!y||C||k?"bg-opacity-0":"bg-opacity-50"),onClick:U}),(0,n.jsx)("div",{className:"relative w-full max-w-sm mx-4 sm:mx-0 transition-all duration-150 ease-out\n                ".concat(x.Fr?"fixed bottom-0 left-0 right-0 mx-0":"","\n                ").concat(!y||C||k?x.Fr?"opacity-0 translate-y-full":"opacity-0 scale-95":x.Fr?"opacity-100 translate-y-0":"opacity-100 scale-100"),children:(0,n.jsxs)("div",{className:"shadow-lg border p-6 pointer-events-auto\n                ".concat(x.Fr?"rounded-t-xl rounded-b-none border-b-0 pb-[96px]":"rounded-lg"),style:{backgroundColor:"rgb(27, 29, 33)",borderColor:"rgb(36, 38, 42)"},children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-300 mb-4",children:"Enter a branch name"}),(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)("input",{id:"branch-name",type:"text",value:E,onChange:e=>L(e.target.value),onKeyDown:e=>{"Enter"===e.key?O():"Escape"===e.key&&(e.stopPropagation(),U())},placeholder:"Branch name...",className:"w-full pr-10 px-3 py-2.5 text-sm bg-[#2a2d32] border border-[#3e4147] ring-0.5 rounded-md text-gray-300 focus:outline-none focus:ring-0.5 focus:ring-gray-500 focus:border-gray-500",autoFocus:!0})}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,n.jsx)("button",{onClick:U,className:"px-4 py-2 text-sm text-gray-500 hover:text-gray-200 transition-colors duration-100",children:"Cancel"}),(0,n.jsx)("button",{onClick:O,disabled:!E.trim(),className:"flex w-full sm:w-auto rounded-md justify-center py-2 sm:py-1 items-center gap-1.5 px-4 bg-[#81A1C1] text-[#2A2A2A] text-sm font-medium hover:bg-[#9AB4CD] transition-colors disabled:cursor-default disabled:opacity-50 disabled:hover:bg-[#81A1C1]",children:"Add"})]})]})})]})]})}let e_=c.memo(function(e){let{selectedOption:t="push",onOptionSelect:r,onOpenChange:s,selectedBranch:a}=e,[l,o]=(0,c.useState)(!1),[i,d]=(0,c.useState)(!1),[u,m]=(0,c.useState)(!1),p=(0,c.useRef)(null),f=(0,c.useRef)(null),h=(0,c.useMemo)(()=>[{value:"push",label:a?"Push to ".concat(a):"Push to branch"},{value:"create",label:"Create new branch"}],[a]),g=(0,c.useCallback)(()=>{f.current&&clearTimeout(f.current),d(!0),f.current=setTimeout(()=>{o(!1),d(!1),f.current=null},150)},[]);(0,c.useEffect)(()=>()=>{f.current&&clearTimeout(f.current)},[]),(0,c.useEffect)(()=>{function e(e){p.current&&!p.current.contains(e.target)&&g()}if(l)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[l,g]),(0,c.useEffect)(()=>{null==s||s(l||u)},[l,u,s]);let v=h.map(e=>({id:e.value,displayName:e.label,data:e})),b=(0,c.useMemo)(()=>h.find(e=>e.value===t),[h,t]),w=(0,c.useCallback)(e=>{r(e.value),g(),m(!1)},[r,g]),y=(0,c.useCallback)(e=>{let r=t===e.data.value;return(0,n.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,n.jsx)("span",{className:"text-base",children:e.displayName}),r&&(0,n.jsx)("div",{className:"w-4 h-4 text-blue-500 flex-shrink-0",children:"✓"})]})},[t]),j=(0,n.jsx)(z.A,{className:"w-3 h-3 text-gray-600 flex-shrink-0"});return(0,n.jsx)(n.Fragment,{children:x.Fr?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>m(!0),className:"inline-flex items-center outline-none focus:outline-none ring-0 focus:ring-0 focus:ring-offset-0 justify-between text-left transition-colors duration-100 group text-xs max-w-full text-gray-500 hover:text-gray-400 cursor-pointer",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1.5 transition-opacity duration-100 min-w-0 flex-1 overflow-hidden",children:[j,(0,n.jsx)("span",{className:"truncate text-[14px] min-w-0 max-w-[120px] sm:max-w-[160px] md:max-w-[200px]",children:(null==b?void 0:b.label)||"Select branch option"})]}),(0,n.jsx)(eS.A,{className:"w-3 h-3 transition-all duration-100 ml-1 flex-shrink-0 text-gray-600 group-hover:text-gray-500"})]}),(0,n.jsx)(eA.P,{isOpen:u,onOpenChange:m,items:v,onItemSelect:e=>w(e.data),noItemsText:"No options available",renderItem:y})]}):(0,n.jsxs)("div",{className:"relative",ref:p,children:[(0,n.jsxs)("button",{onClick:()=>{l||i?g():o(!0)},className:"inline-flex items-center outline-none focus:outline-none ring-0 focus:ring-0 focus:ring-offset-0 justify-between text-left transition-colors duration-100 group text-xs max-w-full text-gray-500 hover:text-gray-400 cursor-pointer",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1.5 transition-opacity duration-100 min-w-0 flex-1 overflow-hidden",children:[j,(0,n.jsx)("span",{className:"truncate text-[14px] min-w-0 max-w-[120px] sm:max-w-[160px] md:max-w-[200px]",children:(null==b?void 0:b.label)||"Select branch option"})]}),(0,n.jsx)(eS.A,{className:"w-3 h-3 transition-all duration-100 ml-1 flex-shrink-0 text-gray-600 group-hover:text-gray-500 ".concat(l?"rotate-180":"")})]}),(l||i)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-40",onClick:g}),(0,n.jsx)("div",{className:"absolute top-full left-[-3px] z-50 mt-1 overflow-hidden bg-[#191C22] rounded-md border border-[#272C36] w-[200px] flex flex-col text-[11px]",style:{boxShadow:"0px 36px 50px 0px rgba(0, 0, 0, 0.14), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 23px 16px 6px rgba(0, 0, 0, 0.10)",opacity:1,transform:"scale(1)",transformOrigin:"top left",transition:"opacity 0.15s ease-out, transform 0.15s ease-out",animation:i?"dropdown-out 0.15s ease-out forwards":"dropdown-in 0.15s ease-out forwards"},children:(0,n.jsx)("div",{className:"p-0.5",children:h.map((e,r)=>{let s=t===e.value;return(0,n.jsxs)("button",{onClick:()=>w(e),className:"w-full px-1.5 py-1 flex items-center justify-between text-left rounded-[4px] text-[rgba(255,255,255,0.7)] transition-none hover:bg-[rgba(255,255,255,0.08)]",children:[(0,n.jsx)("span",{className:"text-[11px]",children:e.label}),s&&(0,n.jsx)("div",{className:"w-3 h-3 text-gray-300 flex-shrink-0",children:"✓"})]},e.value)})})})]})]})})});var eI=r(91575),eD=r(72221),eR=r(90076),eT=r(44612),eF=r(85502),eP=r(87967),eB=r(93118),eO=r(41583),ez=r(9691);let eU=[{name:"list",displayName:"List",icon:(0,n.jsx)(eI.A,{className:"w-3 h-3"})},{name:"kanban",displayName:"Kanban",icon:(0,n.jsx)(eD.A,{className:"w-3 h-3"})},{name:"full",displayName:"Full",icon:(0,n.jsx)(eR.A,{className:"w-3 h-3"})}];function eW(e){let{activeViewMode:t,onViewModeChange:r}=e,s=(0,c.useRef)(null),a=(0,c.useRef)(null),[l,o]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{let e=()=>{let e=s.current;if(t&&e){let t=a.current;if(t&&e.offsetWidth>0){let{offsetLeft:r,offsetWidth:n}=t,s=(r/e.offsetWidth*100).toFixed(),a=(100-(r+n)/e.offsetWidth*100).toFixed();e.style.clipPath="inset(0 ".concat(a,"% 0 ").concat(s,"% round 6px)")}}},r=requestAnimationFrame(()=>{e(),o(!0)});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e),cancelAnimationFrame(r)}},[t]),(0,n.jsxs)("div",{className:"relative flex flex-col items-center w-[213px]",children:[(0,n.jsx)("ul",{className:"relative flex w-full justify-end",children:eU.map(e=>(0,n.jsx)("li",{children:(0,n.jsxs)("button",{ref:t===e.name?a:null,"data-tab":e.name,onClick:()=>r(e.name),className:"flex ".concat(x.Fr?"h-[32px] text-[14px] ":"h-[22px] text-[12px] "," items-center gap-2 rounded px-2 font-medium text-gray-500 no-underline"),children:[e.icon,e.displayName]})},e.name))}),(0,n.jsx)("div",{"aria-hidden":!0,className:"absolute z-10 w-[213px] overflow-hidden ".concat(l?"transition-all duration-250 ease-in-out":""),ref:s,style:{clipPath:"inset(0px 75% 0px 0% round 3px)"},children:(0,n.jsx)("ul",{className:"relative flex w-full justify-end bg-gray-500/20",children:eU.map(e=>(0,n.jsx)("li",{children:(0,n.jsxs)("button",{"data-tab":e.name,onClick:()=>r(e.name),className:"flex ".concat(x.Fr?"h-[32px] text-[14px]":"h-[22px] text-[12px]"," items-center gap-2 rounded px-2 font-medium text-white no-underline"),tabIndex:-1,children:[e.icon,e.displayName]})},e.name))})})]})}function eH(e){let{viewConfig:t,onViewConfigChange:r}=e,[s,a]=(0,c.useState)(!1),[l,o]=(0,c.useState)(!1),[i,d]=(0,c.useState)("right"),u=(0,c.useRef)(null),m=(0,c.useRef)(null),p=()=>{if(!m.current)return;let e=m.current.getBoundingClientRect();window.innerWidth-e.right>=316?d("right"):d("left")},x=()=>{a(!1),setTimeout(()=>{o(!1)},150)};return(0,c.useEffect)(()=>{let e=()=>{(s||l)&&p()};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[s,l]),(0,ez.vC)("esc",()=>{(s||l)&&x()}),(0,n.jsxs)(n.Fragment,{children:[l&&(0,n.jsx)("div",{className:"fixed  inset-0 w-[100vw] h-[100vh] z-[100] transition-opacity duration-150 ".concat(s?"opacity-100":"opacity-0"),style:{top:"-68px",left:"-174px"},onClick:x}),(0,n.jsxs)("div",{className:"relative",ref:u,children:[(0,n.jsx)("button",{ref:m,onClick:()=>{s||l?x():(o(!0),p(),requestAnimationFrame(()=>{a(!0)}))},className:"flex outline-none focus:outline-none items-center p-1 hover:bg-white/5 rounded-[4px] transition-all duration-200",children:(0,n.jsx)(ea.A,{className:"w-4 h-4 text-gray-500"})}),l&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"absolute top-full ".concat("full"===t.viewMode?"w-[230px]":"w-[300px]"," mt-2 rounded-lg shadow-2xl z-[1000] overflow-hidden transition-all duration-150 origin-top ").concat("right"===i?"left-0":"right-0"," ").concat(s?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 -translate-y-1"),style:{backgroundColor:"rgb(27, 29, 33)",border:"1px solid rgb(36, 38, 42)",boxShadow:"0 0 8px 2px color-mix(in srgb, var(--vscode-widget-shadow, rgba(0, 0, 0, 0.36)) 30%, transparent)"},onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"flex flex-row w-full items-center justify-between px-2 h-[36px]",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(eT.A,{className:"w-3 h-3 text-gray-500"}),(0,n.jsx)("span",{className:"text-[12px] font-semibold text-gray-500",children:"Group"})]}),(0,n.jsx)("select",{value:t.groupBy||"",onChange:e=>{var n;return n=e.target.value||null,void r({...t,groupBy:n})},onClick:e=>e.stopPropagation(),className:"w-[142px] text-gray-300 px-[6px] py-[3px] rounded-[4px] text-[12px] border bg-transparent border-white/10 focus:outline-none focus:ring-0 transition-colors",style:{colorScheme:"dark"},children:[{id:null,name:"Date"},{id:"status",name:"Status"},{id:"repo",name:"Repo"},{id:"model",name:"Model"},{id:"merge",name:"Merge"},{id:"prompt",name:"Prompt"}].map(e=>(0,n.jsx)("option",{value:e.id||"",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:e.name},e.id||"date"))})]}),(0,n.jsxs)("div",{className:"flex flex-row w-full items-center justify-between px-2 h-[36px]",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(eF.A,{className:"w-3 h-3 text-gray-500"}),(0,n.jsx)("span",{className:"text-[12px] font-semibold text-gray-500",children:"Sort"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsxs)("select",{value:t.sortBy||"date",onChange:e=>r({...t,sortBy:e.target.value||"date"}),onClick:e=>e.stopPropagation(),className:"w-[114px] text-gray-300 px-[6px] py-[3px] rounded-[4px] text-[12px] border bg-transparent border-white/10 focus:outline-none focus:ring-0 transition-colors",style:{colorScheme:"dark"},children:[(0,n.jsx)("option",{value:"date",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Date"}),(0,n.jsx)("option",{value:"status",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Status"}),(0,n.jsx)("option",{value:"name",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Name"}),(0,n.jsx)("option",{value:"model",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Model"}),(0,n.jsx)("option",{value:"repo",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Repo"}),(0,n.jsx)("option",{value:"branch",style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:"Branch"})]}),(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),r({...t,sortDirection:"asc"===t.sortDirection?"desc":"asc"})},className:"p-1 hover:bg-white/5 rounded-[4px] transition-all duration-200",children:"asc"===t.sortDirection?(0,n.jsx)(eP.A,{className:"w-4 h-4 text-gray-400"}):(0,n.jsx)(eB.A,{className:"w-4 h-4 text-gray-400"})})]})]}),"full"!==t.viewMode&&(0,n.jsxs)("div",{className:"px-2 flex flex-row w-full items-center justify-between h-[36px]",onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(eO.A,{className:"w-3 h-3 text-gray-500"}),(0,n.jsx)("span",{className:"text-[12px] font-semibold text-gray-500",children:"Layout"})]}),(0,n.jsx)(eW,{activeViewMode:t.viewMode||"kanban",onViewModeChange:e=>{r({...t,viewMode:e})}})]}),!(()=>{let e=k();return t.groupBy===e&&(t.viewMode===N||void 0===t.viewMode)&&"date"===t.sortBy&&"desc"===t.sortDirection&&t.properties.every(e=>{let t=w.find(t=>t.id===e.id);return!!t&&e.visible===t.visible&&e.order===t.order&&e.row===t.row})})()&&(0,n.jsx)("div",{className:"px-2 py-2 border-t border-white/5",onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation(),children:(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),localStorage.removeItem("agent-view-config"),r({groupBy:k(),properties:[...w],viewMode:N,sortBy:"date",sortDirection:"desc"})},className:"text-[12px] hover:bg-gray-500/10 rounded-md px-2 py-1 font-medium text-gray-300 hover:text-white transition-colors",children:"Reset"})})]})})]})]})}function eq(e){let{showAutoModelModal:t,setShowAutoModelModal:r,onEditLimits:s,onContinueWithAuto:a}=e;return(0,n.jsx)("div",{className:"fixed inset-0 flex items-center justify-center transition-all duration-300 ".concat(t?"opacity-100 bg-black/50 z-50 pointer-events-auto":"opacity-0 pointer-events-none z-[-1] [*]:pointer-events-none"),style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:()=>r(!1),children:(0,n.jsx)("div",{className:"bg-gradient-to-b shadow-lg border p-6 mx-4 sm:mx-0 pointer-events-auto\n            sm:rounded-lg\n            max-sm:rounded-t-xl max-sm:rounded-b-none max-sm:border-b-0 max-sm:mx-0 from-[#17191D] to-[#121315] rounded-xl w-[380px] flex flex-col gap-2 border-white/10 transition-all duration-300 ".concat(t?"scale-100 opacity-100":"scale-95 opacity-0 pointer-events-none"),style:{borderColor:"rgb(36, 38, 42)"},onClick:e=>e.stopPropagation(),children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("span",{className:"text-gray-300 text-xl font-medium",children:"Running on Auto"}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Usage limits reached. This Agent is running on Auto for free."}),(0,n.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 mt-4",children:[(0,n.jsx)("button",{onClick:s,className:"w-full border border-solid border-white/10 inline-flex text-white/50 items-center hover:bg-white/5 justify-center rounded-md px-4 py-2 text-sm font-medium text-white transition-colors focus:outline-none focus:ring-none focus:ring-offset-2",children:"Edit limits"}),(0,n.jsx)("button",{onClick:a,className:"w-full inline-flex items-center hover:bg-brand-dashboard-highlight/30 justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2",children:"Continue with Auto"})]})]})})})}var eJ=r(76777),eG=r(16128),eZ=r(83212),eV=r(21856),eK=r(14578),e$=r(69971),eX=r(79183),eY=r(12393);let eQ=[{id:"gpt-5",displayName:"GPT-5"},{id:"claude-4-sonnet",displayName:"Claude 4 Sonnet"},{id:"o3",displayName:"o3"},{id:"claude-4-opus",displayName:"Claude 4 Opus"},{id:"default",displayName:"Auto"}];function e0(e){let{selectedModels:t=[],onModelSelect:r,className:s="",onOpenChange:a,isCompact:l,openUpwards:o}=e,[i,d]=(0,c.useState)(!1);(0,c.useEffect)(()=>{null==a||a(i)},[i,a]);let u=(0,c.useMemo)(()=>eQ.map(e=>({id:e.id,data:e.id,displayName:e.displayName})),[]),m=(0,c.useCallback)(e=>{let n,s=t.includes(e);console.log("Selected models:",n=l?s?[]:[e]:s?t.filter(t=>t!==e):[...t,e]),r(n)},[t,l,r]),p=(0,c.useCallback)(e=>{let r=t.includes(e.data);return(0,n.jsxs)("div",{className:"flex flex-row gap-2 w-full items-center outline-none focus:outline-none ring-0 focus:ring-0 focus:ring-offset-0",children:[(0,n.jsxs)("div",{className:"relative w-3 h-3 min-w-3 min-h-3 flex-shrink-0",children:[(0,n.jsx)("input",{type:"checkbox",checked:r,onChange:()=>m(e.data),className:"w-3 h-3 min-w-3 min-h-3 flex-shrink-0 rounded-sm border border-white/20 bg-transparent appearance-none checked:bg-[#81A1C1] checked:border-[#81A1C1] focus:outline-none focus:ring-1 focus:ring-[#81A1C1] cursor-pointer",onClick:e=>e.stopPropagation()}),r&&(0,n.jsx)(ek.A,{className:"absolute inset-0 w-2 h-2 m-auto text-[#1a1c21] pointer-events-none"})]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-row gap-1 items-center outline-none focus:outline-none ring-0 focus:ring-0 focus:ring-offset-0",children:[(0,n.jsx)("div",{className:"font-medium truncate ".concat(l?"text-[11px]":""),children:e.displayName}),"default"!==e.data&&(0,n.jsx)("span",{className:"text-white/50 font-medium mt-0.5 ".concat(l?"text-[8px]":"text-[9px]"),children:"MAX"})]})]})},[t,m]),f=(0,c.useCallback)(e=>{let r=t.includes(e.data);return(0,n.jsxs)("div",{className:"flex flex-row gap-3 w-full items-center",children:[(0,n.jsxs)("div",{className:"relative w-5 h-5 min-w-5 min-h-5 flex-shrink-0",children:[(0,n.jsx)("input",{type:"checkbox",checked:r,onChange:()=>m(e.data),className:"w-5 h-5 min-w-5 min-h-5 flex-shrink-0 rounded-sm border border-white/20 bg-transparent appearance-none checked:bg-[#81A1C1] checked:border-[#81A1C1] focus:outline-none focus:ring-1 focus:ring-[#81A1C1] cursor-pointer",onClick:e=>e.stopPropagation()}),r&&(0,n.jsx)(ek.A,{className:"absolute inset-0 w-3 h-3 m-auto text-[#1a1c21] pointer-events-none"})]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-row gap-2 items-center",children:[(0,n.jsx)("div",{className:"font-medium text-base text-gray-300",children:e.displayName}),"default"!==e.data&&(0,n.jsx)("span",{className:"text-xs text-white/50 font-medium",children:"MAX"})]})]})},[t,m]),h=(0,c.useMemo)(()=>0===t.length?"Select models":t.map(e=>{var t;return null==(t=eQ.find(t=>t.id===e))?void 0:t.displayName}).filter(Boolean).join(", "),[t]),g=(0,c.useMemo)(()=>t.length>0&&u.find(e=>e.data===t[0])||null,[t,u]),v=(0,c.useCallback)(e=>{m(e.data)},[m]),b=(0,n.jsx)(n.Fragment,{children:" "});return(0,n.jsx)(n.Fragment,{children:x.Fr?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>d(!0),className:"flex items-center justify-between w-fit text-left transition-colors duration-100 max-w-[200px] overflow-hidden flex-shrink-0 group text-gray-500 hover:text-gray-400 ".concat(s),children:[(0,n.jsxs)("div",{className:"flex items-center gap-1.5 transition-opacity duration-100 min-w-0",children:[b,(0,n.jsxs)("div",{className:"flex gap-1 min-w-0 items-center",children:[(0,n.jsx)("span",{className:"truncate ".concat(l?"text-[11px]":"text-[14px]"),children:h}),t.length>0&&(1!==t.length||"default"!==t[0])&&(0,n.jsx)("div",{className:"flex items-center gap-1.5 h-[14px] border border-white/10 rounded px-1 py-0",children:(0,n.jsx)("span",{className:"text-[9px] uppercase font-bold",style:{background:"linear-gradient(to right, #81a1c1, #7d7c9b)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Max"})})]})]}),(0,n.jsx)("svg",{className:"w-3 h-3 text-gray-600 group-hover:text-gray-500 transition-opacity duration-100 ml-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,n.jsx)(eA.P,{isOpen:i,onOpenChange:d,items:u,onItemSelect:v,searchPlaceholder:"Search models...",noItemsText:"No models available",noSearchResultsText:"No models found",renderItem:f,closeOnSelect:!1})]}):(0,n.jsx)(eY.q,{items:u,selectedItem:g,onItemSelect:v,placeholder:"Select models",searchPlaceholder:"Search models...",className:s,icon:b,noItemsText:"No models available",largeFonts:!l,noSearchResultsText:"No models found",renderItem:p,onOpenChange:a,showMax:t.length>0,customDisplayText:h,closeOnSelect:!1,openUpwards:o})})}let e1=[{id:"status",label:"Status",type:"multiselect",icon:eG.A,operators:["is","is_not","any_of","none_of"],options:[{value:m.R6.RUNNING,label:"Running"},{value:m.R6.FINISHED,label:"Finished"},{value:m.R6.ERROR,label:"Error"},{value:m.R6.CREATING,label:"Creating"},{value:m.R6.EXPIRED,label:"Expired"}]},{id:"model",label:"Model",type:"multiselect",icon:e=>{let{className:t}=e;return(0,n.jsx)("svg",{width:"14",height:"12",viewBox:"0 0 14 12",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:t,children:(0,n.jsx)("path",{d:"M0.457031 6.1377C0.457031 5.77637 0.515625 5.42969 0.632812 5.09766C0.753255 4.76562 0.924154 4.46289 1.14551 4.18945C1.36686 3.91276 1.63053 3.68327 1.93652 3.50098L2.39551 4.28223C2.0765 4.47754 1.82422 4.73958 1.63867 5.06836C1.45638 5.39714 1.36523 5.75195 1.36523 6.13281C1.36523 6.5625 1.45801 6.93848 1.64355 7.26074C1.83236 7.58301 2.0944 7.83366 2.42969 8.0127C2.76497 8.19173 3.15723 8.28125 3.60645 8.28125C4.03939 8.28125 4.42025 8.20475 4.74902 8.05176C5.0778 7.89551 5.33171 7.67904 5.51074 7.40234C5.69303 7.1224 5.78418 6.7985 5.78418 6.43066C5.78418 6.25163 5.75814 6.09212 5.70605 5.95215C5.65397 5.81217 5.5791 5.69499 5.48145 5.60059C5.39355 5.51921 5.32031 5.4541 5.26172 5.40527C5.20312 5.35319 5.15918 5.30111 5.12988 5.24902C5.10059 5.19368 5.08594 5.12207 5.08594 5.03418C5.08594 4.91699 5.12663 4.82096 5.20801 4.74609C5.29264 4.67122 5.40007 4.63379 5.53027 4.63379C5.62142 4.63379 5.7028 4.65007 5.77441 4.68262C5.84603 4.71517 5.93066 4.77376 6.02832 4.8584C6.2334 5.03092 6.3929 5.25391 6.50684 5.52734C6.62077 5.79753 6.67773 6.10352 6.67773 6.44531C6.67773 6.99219 6.54915 7.4707 6.29199 7.88086C6.03483 8.29102 5.6735 8.61003 5.20801 8.83789C4.74251 9.06576 4.20378 9.17969 3.5918 9.17969C2.9668 9.17969 2.41829 9.05436 1.94629 8.80371C1.47428 8.5498 1.10807 8.19499 0.847656 7.73926C0.58724 7.28027 0.457031 6.74642 0.457031 6.1377ZM1.77539 3.54492C1.77539 3.14779 1.87305 2.79785 2.06836 2.49512C2.26367 2.18913 2.52734 1.94987 2.85938 1.77734C3.19141 1.60156 3.5625 1.51367 3.97266 1.51367C4.24609 1.51367 4.52279 1.55924 4.80273 1.65039C5.08268 1.73828 5.34961 1.875 5.60352 2.06055L5.07129 2.79785C4.89551 2.6709 4.71322 2.5765 4.52441 2.51465C4.33561 2.4528 4.15007 2.42188 3.96777 2.42188C3.72038 2.42188 3.50065 2.4707 3.30859 2.56836C3.11654 2.66276 2.96354 2.7946 2.84961 2.96387C2.73893 3.12988 2.68359 3.32357 2.68359 3.54492C2.68359 3.74349 2.72754 3.9209 2.81543 4.07715C2.90658 4.23014 3.03516 4.35059 3.20117 4.43848C3.36719 4.52637 3.56576 4.57031 3.79688 4.57031C3.91732 4.57031 4.02148 4.61589 4.10938 4.70703C4.20052 4.79492 4.24609 4.90072 4.24609 5.02441C4.24609 5.14811 4.20052 5.25553 4.10938 5.34668C4.02148 5.43457 3.91732 5.47852 3.79688 5.47852C3.38346 5.47852 3.02539 5.39714 2.72266 5.23438C2.42318 5.06836 2.19043 4.84049 2.02441 4.55078C1.8584 4.25781 1.77539 3.92253 1.77539 3.54492ZM4.41211 3.38867C4.42839 2.91341 4.54557 2.49512 4.76367 2.13379C4.98177 1.76921 5.27637 1.48438 5.64746 1.2793C6.02181 1.07422 6.44499 0.97168 6.91699 0.97168C7.26204 0.97168 7.58594 1.04004 7.88867 1.17676C8.19141 1.31348 8.44531 1.50228 8.65039 1.74316C8.71224 1.72689 8.77246 1.71549 8.83105 1.70898C8.8929 1.70247 8.94661 1.69922 8.99219 1.69922C9.32422 1.69922 9.63672 1.76107 9.92969 1.88477C10.2259 2.00846 10.488 2.18587 10.7158 2.41699C10.9437 2.64486 11.1227 2.91667 11.2529 3.23242C11.3864 3.54818 11.4531 3.89648 11.4531 4.27734C11.4531 4.75586 11.375 5.15462 11.2188 5.47363C11.0658 5.79264 10.8672 6.05957 10.623 6.27441C10.3822 6.48926 10.1266 6.67643 9.85645 6.83594C9.58626 6.99219 9.3291 7.14518 9.08496 7.29492C8.84408 7.44466 8.64551 7.61556 8.48926 7.80762C8.33626 7.99967 8.25977 8.2373 8.25977 8.52051C8.25977 8.87858 8.39974 9.139 8.67969 9.30176C8.96289 9.46452 9.34212 9.5459 9.81738 9.5459C9.889 9.5459 9.96224 9.5459 10.0371 9.5459C10.112 9.54264 10.1787 9.54102 10.2373 9.54102C10.2861 9.54102 10.3219 9.55404 10.3447 9.58008C10.3708 9.60286 10.3838 9.63379 10.3838 9.67285C10.3838 9.88444 10.4115 10.0977 10.4668 10.3125C10.5221 10.5273 10.6084 10.7064 10.7256 10.8496C10.846 10.9961 10.999 11.0693 11.1846 11.0693C11.3669 11.0693 11.5329 10.9798 11.6826 10.8008C11.8324 10.6217 11.9512 10.3743 12.0391 10.0586C12.127 9.74284 12.1709 9.38477 12.1709 8.98438C12.1709 8.73698 12.1611 8.51237 12.1416 8.31055C12.1253 8.10872 12.1058 7.90527 12.083 7.7002L12.9863 7.45117C13.0124 7.66276 13.0335 7.889 13.0498 8.12988C13.0661 8.37077 13.0742 8.66048 13.0742 8.99902C13.0742 9.37988 13.0335 9.74935 12.9521 10.1074C12.8708 10.4655 12.7503 10.7845 12.5908 11.0645C12.4346 11.3444 12.2376 11.5658 12 11.7285C11.7656 11.8945 11.4938 11.9775 11.1846 11.9775C10.9014 11.9775 10.6523 11.8994 10.4375 11.7432C10.2259 11.5902 10.0534 11.3883 9.91992 11.1377C9.78646 10.8903 9.69694 10.6234 9.65137 10.3369C9.59928 10.3402 9.54557 10.3434 9.49023 10.3467C9.4349 10.3499 9.38281 10.3516 9.33398 10.3516C8.95312 10.3516 8.61133 10.2767 8.30859 10.127C8.00586 9.98047 7.7666 9.77376 7.59082 9.50684C7.41829 9.23665 7.33203 8.91764 7.33203 8.5498C7.33203 8.16895 7.40853 7.85156 7.56152 7.59766C7.71777 7.34049 7.91797 7.11914 8.16211 6.93359C8.40625 6.74479 8.66504 6.56901 8.93848 6.40625C9.21191 6.24349 9.46908 6.07096 9.70996 5.88867C9.9541 5.70312 10.1543 5.48177 10.3105 5.22461C10.4668 4.96745 10.5449 4.65169 10.5449 4.27734C10.5449 3.9388 10.4652 3.64583 10.3057 3.39844C10.1494 3.15104 9.94434 2.95898 9.69043 2.82227C9.43978 2.68229 9.17122 2.61068 8.88477 2.60742C8.80013 2.60742 8.71387 2.6123 8.62598 2.62207C8.54134 2.63184 8.46159 2.64811 8.38672 2.6709C8.32487 2.68392 8.27441 2.68717 8.23535 2.68066C8.19954 2.6709 8.16862 2.64323 8.14258 2.59766C8.04818 2.38281 7.88867 2.20866 7.66406 2.0752C7.43945 1.94173 7.1888 1.875 6.91211 1.875C6.60612 1.875 6.33431 1.94336 6.09668 2.08008C5.8623 2.21354 5.67513 2.39746 5.53516 2.63184C5.39844 2.86296 5.32357 3.12988 5.31055 3.43262C5.30404 3.57259 5.25846 3.68327 5.17383 3.76465C5.08919 3.84277 4.98503 3.88184 4.86133 3.88184C4.73112 3.88184 4.62207 3.83626 4.53418 3.74512C4.44954 3.65397 4.40885 3.53516 4.41211 3.38867ZM10.2129 8.24707C10.2129 8.12012 10.2585 8.01107 10.3496 7.91992C10.4408 7.82552 10.5498 7.78483 10.6768 7.79785C11.266 7.84668 11.7396 7.72135 12.0977 7.42188C12.4557 7.1224 12.6348 6.70247 12.6348 6.16211C12.6348 5.66732 12.4834 5.26855 12.1807 4.96582C11.8812 4.66309 11.4824 4.51497 10.9844 4.52148L11.1309 3.61328C11.6126 3.67188 12.0342 3.81836 12.3955 4.05273C12.7601 4.28385 13.0417 4.58171 13.2402 4.94629C13.4421 5.31087 13.543 5.71615 13.543 6.16211C13.543 6.70573 13.4225 7.17611 13.1816 7.57324C12.944 7.96712 12.6087 8.26335 12.1758 8.46191C11.7428 8.65723 11.2399 8.73698 10.667 8.70117C10.54 8.69141 10.4326 8.64583 10.3447 8.56445C10.2568 8.47982 10.2129 8.37402 10.2129 8.24707ZM7.74219 8.80859L8.0498 9.67773C7.81868 9.74935 7.58594 9.80143 7.35156 9.83398C7.11719 9.86654 6.89258 9.88281 6.67773 9.88281C6.13411 9.88281 5.64095 9.79004 5.19824 9.60449C4.75879 9.41569 4.40723 9.16667 4.14355 8.85742L4.94922 8.2373C5.05339 8.3903 5.2015 8.52214 5.39355 8.63281C5.58561 8.74349 5.80046 8.82975 6.03809 8.8916C6.27897 8.9502 6.52474 8.97949 6.77539 8.97949C6.93815 8.97949 7.10254 8.96484 7.26855 8.93555C7.43783 8.90625 7.5957 8.86393 7.74219 8.80859ZM6.05762 5.41016C6.52311 5.35156 6.85352 5.20996 7.04883 4.98535C7.24414 4.76074 7.34017 4.44661 7.33691 4.04297C7.33366 3.91927 7.37598 3.81348 7.46387 3.72559C7.55176 3.6377 7.65755 3.59375 7.78125 3.59375C7.90495 3.59375 8.01237 3.6377 8.10352 3.72559C8.19466 3.81348 8.24186 3.91927 8.24512 4.04297C8.24837 4.64518 8.09538 5.13835 7.78613 5.52246C7.48014 5.90658 7.00651 6.15885 6.36523 6.2793L6.05762 5.41016Z"})})},operators:["is","is_not","any_of","none_of"],options:eQ.map(e=>({value:e.id,label:e.displayName}))},{id:"repoUrl",label:"Repo",type:"multiselect",icon:eZ.A,operators:["is","is_not","any_of","none_of","contains","does_not_contain"]},{id:"createdAt",label:"Date",type:"date",icon:eV.A,operators:["is","before","after","between"]},{id:"merge",label:"Pull request",type:"boolean",icon:z.A,operators:["is","is_not"]}],e2={is:"Is",is_not:"Is not",contains:"Contains",does_not_contain:"Does not contain",starts_with:"Starts with",ends_with:"Ends with",is_empty:"Is empty",is_not_empty:"Is not empty",any_of:"Any of",none_of:"None of",before:"Before",after:"After",between:"Between"},e5={rules:[]},e3=e=>{if(!e)return new Date;let[t,r,n]=e.split("-").map(Number);return new Date(t,r-1,n)},e4=e=>{let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(n)};function e8(e){var t,r,s;let{filterConfig:a,onFilterConfigChange:l}=e,[o,i]=(0,c.useState)(!1),[d,u]=(0,c.useState)(!1),[m,p]=(0,c.useState)("right"),[x,h]=(0,c.useState)("main"),[g,v]=(0,c.useState)({}),[b,w]=(0,c.useState)(""),y=(0,c.useRef)(null),j=(0,c.useRef)(null),C=(0,c.useRef)(null),N=(0,c.useRef)(null),{installations:k}=(0,f.d)(),S=function(){try{let e=localStorage.getItem("recentRepositories");return e?JSON.parse(e):[]}catch(e){return[]}}(),E=(0,c.useMemo)(()=>k.flatMap(e=>e.repos.map(t=>({repo:t,displayName:"".concat(t.owner,"/").concat(t.name),installationName:e.repos.length>0?t.owner:"Unknown"}))),[k]),L=(0,c.useMemo)(()=>{let e=[],t=S.map(e=>{let t=E.find(t=>t.repo.repoNodeId===e.repoNodeId);return t?{...t,isRecent:!0}:null}).filter(Boolean);t.forEach(t=>{e.push({value:t.repo.htmlUrl,label:t.displayName})});let r=new Set(t.map(e=>e.repo.repoNodeId));return E.filter(e=>!r.has(e.repo.repoNodeId)).forEach(t=>{e.push({value:t.repo.htmlUrl,label:t.displayName})}),e},[E,S]),A=(0,c.useMemo)(()=>new eJ.A(L,{keys:["label"],threshold:.3,distance:100,includeScore:!0,includeMatches:!0,minMatchCharLength:1,shouldSort:!0}),[L]),M=(0,c.useMemo)(()=>{if(!b.trim()){let e=Array.isArray(g.value)?g.value:("is"===g.operator||"is_not"===g.operator)&&g.value?[g.value]:[];return e.length>0?L.filter(t=>e.includes(t.value)):L}return A.search(b).map(e=>e.item)},[L,b,A,g.value,g.operator]),_=(0,c.useCallback)(()=>{if(!j.current)return;let e=j.current.getBoundingClientRect();p(window.innerWidth-e.right>=316?"right":"left")},[]),I=()=>{i(!1),setTimeout(()=>{u(!1),h("main"),v({})},150)};(0,c.useEffect)(()=>{let e=()=>{(o||d)&&_()};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[o,d,_]);let D=()=>{var e;return(null==(e=a.rules)?void 0:e.length)>0},R=()=>{I()},T=e1.map(e=>{if("repoUrl"===e.id)if(L.length>0)return{...e,type:"multiselect",options:L};else return{...e,type:"text",operators:["is","is_not","contains","does_not_contain","starts_with","ends_with","is_empty","is_not_empty"]};return e}),F=e=>{var t;return null==(t=a.rules)?void 0:t.find(t=>t.property===e)},P=e=>{g.operator&&O(g.operator,e)},B=()=>{g.editingRuleId&&(l({rules:(a.rules||[]).filter(e=>e.id!==g.editingRuleId)}),v(e=>({...e,editingRuleId:void 0,value:void 0,error:void 0})))},O=(e,t)=>{if(!g.property)return;if(("any_of"===e||"none_of"===e)&&Array.isArray(t)&&0===t.length){g.editingRuleId&&B();return}let r={id:g.editingRuleId||Date.now().toString(),property:g.property.id,operator:e,value:t},n=a.rules||[];g.editingRuleId?l({rules:n.map(e=>e.id===g.editingRuleId?r:e)}):l({rules:[...n,r]}),v(e=>({...e,value:t,editingRuleId:r.id,error:void 0}))},z=(e,t)=>{if(e&&t&&t<e)return"End date cannot be earlier than start date"};return(0,ez.vC)("esc",()=>{(o||d)&&R()}),(0,c.useEffect)(()=>{var e;("operator"!==x||(null==(e=g.property)?void 0:e.id)!=="repoUrl")&&w("")},[x,null==(t=g.property)?void 0:t.id]),(0,c.useEffect)(()=>{var e;if("operator"===x&&(null==(e=g.property)?void 0:e.id)==="repoUrl"&&C.current){let e=setTimeout(()=>{var e;null==(e=C.current)||e.focus()},50);return()=>clearTimeout(e)}},[x,null==(r=g.property)?void 0:r.id]),(0,n.jsxs)(n.Fragment,{children:[d&&(0,n.jsx)("div",{className:"fixed  inset-0 w-[100vw] h-[100vh] z-[100] transition-opacity duration-150 ".concat(o?"opacity-100":"opacity-0"),style:{top:"-68px",left:"-174px"},onClick:R}),(0,n.jsxs)("div",{className:"relative",ref:y,children:[(0,n.jsx)("button",{ref:j,onClick:()=>{o||d?I():(u(!0),_(),requestAnimationFrame(()=>{i(!0)}))},className:"flex outline-none focus:outline-none items-center p-1 rounded-[6px] transition-all duration-200 ".concat(D()?"bg-gray-500/20 hover:bg-gray-500/30 text-gray-300":"hover:bg-white/5 text-gray-500"),children:(0,n.jsx)(e$.A,{className:"w-4 h-4"})}),d&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"absolute top-full w-[232px] z-[999] mt-2 rounded-lg shadow-2xl overflow-hidden transition-all duration-150 origin-top ".concat("right"===m?"left-0":"right-0"," ").concat(o?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 -translate-y-1"),style:{backgroundColor:"rgb(27, 29, 33)",border:"1px solid rgb(36, 38, 42)",boxShadow:"0 0 8px 2px color-mix(in srgb, var(--vscode-widget-shadow, rgba(0, 0, 0, 0.36)) 30%, transparent)"},children:[(0,n.jsx)("div",{className:"px-2 flex flex-row w-full items-center justify-between pt-2",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:["operator"===x?(0,n.jsxs)("button",{onClick:()=>{"operator"===x?h("main"):(h("main"),v({}))},className:"flex items-center gap-2 p-1 pr-2 -mr-2 hover:bg-gray-500/10 rounded-md transition-colors",children:[(0,n.jsx)(eX.A,{className:"w-3 h-3 text-gray-500"}),(0,n.jsx)("span",{className:"text-[12px] font-semibold text-gray-500",children:null==(s=g.property)?void 0:s.label})]}):(0,n.jsx)("span",{className:"text-[12px] font-semibold text-gray-500",children:"Filter"}),"operator"===x&&g.property&&"boolean"!==g.property.type&&(0,n.jsx)("select",{value:g.operator||"",onChange:e=>(e=>{let t=g.value;if("any_of"===e||"none_of"===e)Array.isArray(t)||(t=null!=t?[t]:[]);else if("is"===e||"is_not"===e){var r;Array.isArray(t)?t=t.length>0?t[0]:void 0:(null==(r=g.property)?void 0:r.type)!=="date"||!t||"object"!=typeof t||Array.isArray(t)||t instanceof Date||(t=t.from instanceof Date?t.from:t.to instanceof Date?t.to:void 0)}else"between"===e?t&&"object"==typeof t&&t.from&&t.to||(t=t instanceof Date?{from:t,to:null}:{from:null,to:null}):"before"!==e&&"after"!==e||t instanceof Date||(t=t&&"object"==typeof t&&t.from instanceof Date?t.from:t&&"object"==typeof t&&t.to instanceof Date?t.to:void 0);if(v(r=>({...r,operator:e,value:t,error:void 0})),"is_empty"===e||"is_not_empty"===e)O(e,null);else if(null!=t)if(Array.isArray(t)&&0===t.length)return;else"between"===e?t&&"object"==typeof t&&t.from instanceof Date&&t.to instanceof Date&&(z(t.from,t.to)||O(e,t)):O(e,t)})(e.target.value),className:"ml-2 text-gray-300 px-[6px] py-[3px] rounded-[4px] text-[12px] border bg-transparent border-white/10 focus:outline-none focus:ring-0 transition-colors",style:{colorScheme:"dark"},children:g.property.operators.map(e=>(0,n.jsx)("option",{value:e,style:{colorScheme:"dark"},className:"bg-[#1e1f22]",children:e2[e]},e))})]})}),(0,n.jsxs)("div",{className:"p-1",children:["main"===x&&(0,n.jsx)("div",{className:"space-y-0",children:(0,n.jsx)("div",{className:"space-y-0",children:null==T?void 0:T.map(e=>{let t=e.icon,r=F(e.id);return(0,n.jsx)("button",{onClick:()=>(e=>{let t=F(e.id);if(t)v({property:e,operator:t.operator,value:t.value,editingRuleId:t.id});else{let t;switch(e.type){case"boolean":case"multiselect":t="is";break;case"text":t="contains";break;case"date":t="after";break;default:t=e.operators[0]}v({property:e,operator:t})}h("operator")})(e),className:"w-full flex items-center justify-between px-2 font-medium py-1.5 hover:bg-gray-500/10 rounded-md transition-colors text-left",children:(0,n.jsxs)("div",{className:"flex gap-2 flex-1 ".concat(r?"items-start":"items-center"),children:[(0,n.jsx)(t,{className:"w-4 h-4 text-gray-400 ".concat(r?"mt-1":"")}),(0,n.jsxs)("div",{className:"flex flex-col items-start",children:[(0,n.jsx)("span",{className:"text-[12px] text-gray-300",children:e.label}),r&&(0,n.jsx)("span",{className:"text-[10px] text-gray-500",children:((e,t)=>{var r,n,s,a,l;let o=e2[e.operator];if("is_empty"===e.operator||"is_not_empty"===e.operator)return o;let i=e.value;if("multiselect"===t.type&&Array.isArray(e.value))i=e.value.map(e=>{var r,n;return(null==(n=t.options)||null==(r=n.find(t=>t.value===e))?void 0:r.label)||e}).join(", ");else if("boolean"===t.type)a=t.id,l=e.value,i="merge"===a?l?"Is merged":"Is not merged":l?"True":"False";else if("date"===t.type)if("between"===e.operator&&(null==(r=e.value)?void 0:r.from)&&(null==(n=e.value)?void 0:n.to)){let t=e.value.from.toLocaleDateString(),r=e.value.to.toLocaleDateString();i="".concat(t," - ").concat(r)}else e.value instanceof Date&&(i=e.value.toLocaleDateString());else if("multiselect"===t.type&&!Array.isArray(e.value)){let r=null==(s=t.options)?void 0:s.find(t=>t.value===e.value);i=(null==r?void 0:r.label)||e.value}let c=String(i);return"".concat(o," ").concat(c.toLowerCase())})(r,e)})]})]})},e.id)})})}),"operator"===x&&g.property&&g.operator&&(()=>{var e,t,r;if(!g.property||!g.operator)return null;let{property:s,operator:a}=g;switch(s.type){case"boolean":{let e="merge"===s.id?[{value:!0,label:"Is merged"},{value:!1,label:"Is not merged"}]:[{value:!0,label:"True"},{value:!1,label:"False"}],t=g.value;return(0,n.jsx)("div",{className:"space-y-0",children:e.map(e=>(0,n.jsxs)("button",{onClick:()=>{t===e.value&&g.editingRuleId?B():P(e.value)},className:"w-full font-medium text-left px-2 py-1.5 rounded-md text-[12px] transition-colors hover:bg-gray-500/10 text-gray-300 flex items-center justify-between",children:[(0,n.jsx)("span",{children:e.label}),t===e.value&&(0,n.jsx)(ek.A,{className:"w-3 h-3 text-gray-300"})]},String(e.value)))})}case"multiselect":if("repoUrl"===s.id){let e=Array.isArray(g.value)?g.value:"any_of"===a||"none_of"===a?[]:void 0;return(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex gap-1 items-center px-1",children:[(0,n.jsx)(eK.A,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),(0,n.jsx)("input",{ref:C,type:"text",placeholder:"Search repositories...",value:b,onChange:e=>w(e.target.value),onKeyDown:e=>{"Enter"===e.key&&w("")},className:"flex-1 px-1 py-1 bg-transparent border-none text-[12px] text-gray-300 placeholder-gray-500 focus:outline-none",autoFocus:!0})]}),(0,n.jsx)("div",{className:"border-t border-white/5 pt-1",children:0===M.length?(0,n.jsx)("div",{className:"text-center py-3 text-[12px] text-gray-500",children:b?"No repositories found":"No repositories available"}):(0,n.jsx)(eL.B8,{ref:N,height:Math.min(200,29*M.length),width:222,rowCount:M.length,rowHeight:29,rowRenderer:t=>{let{index:r,key:s,style:l}=t,o=M[r],i="is"===a||"is_not"===a?g.value===o.value:Array.isArray(e)&&e.includes(o.value);return(0,n.jsx)("div",{style:l,children:(0,n.jsxs)("button",{onClick:()=>{if(w(""),"is"===a||"is_not"===a)g.value===o.value&&g.editingRuleId?B():P(o.value);else{let t=Array.isArray(e)?e:[];P(t.includes(o.value)?t.filter(e=>e!==o.value):[...t,o.value])}},className:"w-full font-medium text-left px-2 py-1.5 rounded-md text-[12px] transition-colors hover:bg-gray-500/10 text-gray-300 flex items-center justify-between",children:[(0,n.jsx)("span",{className:"truncate",children:function(e,t){if(!t||t.length<1)return e;let r=t.toLowerCase(),s=e.toLowerCase(),a=[],l=0;for(;l<s.length;){let e=s.indexOf(r,l);if(-1===e)break;a.push({start:e,end:e+t.length}),l=e+1}if(0===a.length){for(let n of e.split(/[\s\-_./\\]+/))if(n.toLowerCase().startsWith(r)){let e=s.indexOf(n.toLowerCase());if(-1!==e){a.push({start:e,end:e+t.length});break}}}if(0===a.length)return e;a.sort((e,t)=>e.start-t.start);let o=[],i=0;return a.forEach((t,r)=>{t.start>i&&o.push(e.slice(i,t.start)),o.push((0,n.jsx)("span",{className:"text-[#88C0D0] bg-[#273037] rounded-[2px]",children:e.slice(t.start,t.end)},r)),i=t.end}),i<e.length&&o.push(e.slice(i)),o}(o.label,b)}),i&&(0,n.jsx)(ek.A,{className:"w-3 h-3 text-gray-300 flex-shrink-0"})]})},s)},scrollToAlignment:"auto",className:"virtualized-dropdown-list"})})]})}if("is"===a||"is_not"===a){let t=g.value;return(0,n.jsx)("div",{className:"space-y-0",children:null==(e=s.options)?void 0:e.map(e=>(0,n.jsxs)("button",{onClick:()=>{t===e.value&&g.editingRuleId?B():P(e.value)},className:"w-full font-medium text-left px-2 py-1.5 rounded-md text-[12px] transition-colors hover:bg-gray-500/10 text-gray-300 flex items-center justify-between",children:[(0,n.jsx)("span",{children:e.label}),t===e.value&&(0,n.jsx)(ek.A,{className:"w-3 h-3 text-gray-300"})]},e.value))})}{let e=Array.isArray(g.value)?g.value:[];return(0,n.jsx)("div",{className:"space-y-0",children:null==(t=s.options)?void 0:t.map(t=>(0,n.jsxs)("button",{onClick:()=>{P(e.includes(t.value)?e.filter(e=>e!==t.value):[...e,t.value])},className:"w-full font-medium text-left px-2 py-1.5 rounded-md text-[12px] transition-colors hover:bg-gray-500/10 text-gray-300 flex items-center justify-between",children:[(0,n.jsx)("span",{children:t.label}),e.includes(t.value)&&(0,n.jsx)(ek.A,{className:"w-3 h-3 text-gray-300"})]},t.value))})}case"text":return(0,n.jsxs)("div",{className:"space-y-0",children:[(0,n.jsx)("input",{type:"text",value:g.value||"",onChange:e=>v(t=>({...t,value:e.target.value})),onKeyDown:e=>{var t;"Enter"===e.key&&(null==(t=g.value)?void 0:t.trim())&&P(g.value)},placeholder:"Enter ".concat(s.label.toLowerCase(),"..."),className:"w-full px-2 py-1.5 bg-transparent border border-white/10 rounded-md text-[12px] text-gray-300 placeholder-gray-500 focus:outline-none focus:ring-0 focus:border-white/20 transition-colors",autoFocus:!0}),(0,n.jsx)("button",{onClick:()=>P(g.value),disabled:!(null==(r=g.value)?void 0:r.trim()),className:"w-full px-2 py-1.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white text-[12px] font-medium rounded-md transition-colors",children:"Apply"})]});case"date":if("between"!==a)return(0,n.jsx)("div",{className:"space-y-0",children:(0,n.jsx)("input",{type:"date",value:g.value&&g.value instanceof Date?e4(g.value):"",onChange:e=>{let t=e.target.value?e3(e.target.value):null;v(e=>({...e,value:t})),t&&P(t)},style:{colorScheme:"dark"},className:"w-full px-2 py-1.5 bg-transparent border border-white/10 rounded-md text-[12px] text-gray-300 focus:outline-none focus:ring-0 focus:border-white/20 transition-colors",autoFocus:!0})});{let e=g.value||{from:null,to:null},t=!!g.error;return(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"From"}),(0,n.jsx)("input",{type:"date",value:e.from&&e.from instanceof Date?e4(e.from):"",onChange:t=>{let r=t.target.value?e3(t.target.value):null,n={...e,from:r},s=z(r,e.to);v(e=>({...e,value:n,error:s})),n.from&&n.to&&!s&&P(n)},className:"w-full px-2 py-1.5 bg-transparent border rounded-md text-[12px] text-gray-300 focus:outline-none focus:ring-0 focus:border-white/20 transition-colors ".concat(t?"border-red-500":"border-white/10")})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"To"}),(0,n.jsx)("input",{type:"date",value:e.to&&e.to instanceof Date?e4(e.to):"",onChange:t=>{let r=t.target.value?e3(t.target.value):null,n={...e,to:r},s=z(e.from,r);v(e=>({...e,value:n,error:s})),n.from&&n.to&&!s&&P(n)},className:"w-full px-2 py-1.5 bg-transparent border rounded-md text-[12px] text-gray-300 focus:outline-none focus:ring-0 focus:border-white/20 transition-colors ".concat(t?"border-red-500":"border-white/10")})]})]})}default:return null}})()]}),"main"===x&&D()&&(0,n.jsx)("div",{className:"px-2 py-2 border-t border-white/5",children:(0,n.jsx)("div",{className:"flex gap-1",children:(0,n.jsx)("button",{onClick:()=>{l(e5)},className:"text-[12px] hover:bg-gray-500/10 rounded-md px-2 py-1 font-medium text-gray-300 hover:text-white transition-colors",children:"Reset"})})}),"operator"===x&&g.editingRuleId&&(0,n.jsx)("div",{className:"px-2 py-2 -mx-1 border-t border-white/5",children:(0,n.jsx)("button",{onClick:B,className:"text-[12px] hover:bg-red-500/10 rounded-md px-2 py-1 font-medium text-red-400 hover:text-red-300 transition-colors",children:"Remove filter"})})]})})]})]})}let e6={normal:{d:"m5 12 7-7 7 7"},animate:{d:"m5 12 7-7 7 7",transform:["translateY(0px)","translateY(3px)","translateY(0px)"],transition:{duration:.4}}},e7={normal:{d:"M12 19V5"},animate:{d:["M12 19V5","M12 19V10","M12 19V5"],transition:{duration:.4}}},e9=(0,c.forwardRef)((e,t)=>{let{onMouseEnter:r,onMouseLeave:s,className:a,size:l=28,...o}=e,d=(0,K.s)(),u=(0,c.useRef)(!1);(0,c.useImperativeHandle)(t,()=>(u.current=!0,{startAnimation:()=>d.start("animate"),stopAnimation:()=>d.start("normal")}));let m=(0,c.useCallback)(e=>{u.current?null==r||r(e):d.start("animate")},[d,r]),p=(0,c.useCallback)(e=>{u.current?null==s||s(e):d.start("normal")},[d,s]);return(0,n.jsx)("div",{className:(0,i.cn)(a),onMouseEnter:m,onMouseLeave:p,...o,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)($.P.path,{d:"m5 12 7-7 7 7",variants:e6,animate:d}),(0,n.jsx)($.P.path,{d:"M12 19V5",variants:e7,animate:d})]})})});function te(e){let{onClick:t,disabled:r=!1,className:s="",isCompact:a=!1}=e,l=(0,c.useRef)(null);return(0,n.jsx)("button",{id:"bg-composer-submit-btn",disabled:r,className:"".concat(a?"w-4 h-4 min-w-4 min-h-4":"w-6 h-6 min-w-6 min-h-6"," flex items-center justify-center rounded-full ").concat(r?"opacity-25 cursor-default":"outline outline-1 outline-gray-300 hover:bg-white hover:outline-white hover:scale-105 hover:opacity-100"," ").concat(x.Fr?"bg-white outline-none w-6 h-6 min-w-6 min-h-6":"bg-gray-300"," transition-all duration-100  ").concat(s),onClick:t,onMouseDown:e=>{var t;e.stopPropagation(),null==(t=l.current)||t.startAnimation()},children:(0,n.jsx)(e9,{className:"text-[#616163]",size:a?14:16,ref:l})})}function tt(e){let{isSubmitting:t,isPaused:r,loadingDots:s,text:a,selectedModels:l,setSelectedModels:o,setModelDropdownOpen:i,onSubmit:d,onStop:u,onImageSelect:m,isCompact:p,isFollowUp:f,githubError:h}=e,g=(0,c.useRef)(null),v=(0,c.useMemo)(()=>!t||r||f,[t,r,f]),b=(0,c.useMemo)(()=>(!t||r)&&!f,[t,r,f]);return(0,n.jsxs)("div",{className:"flex items-center gap-1.5 p-2 min-h-[40px]",children:[(0,n.jsx)("input",{ref:g,type:"file",accept:"image/*",multiple:!0,onChange:e=>{m(e.target.files),e.target&&(e.target.value="")},style:{display:"none"}}),t&&!r&&!f&&(0,n.jsx)("div",{className:"px-1.5 flex items-center gap-0.5 text-xs py-px",children:(0,n.jsxs)("span",{className:"text-[11px] font-medium leading-[150%] text-white/40",children:["Generating",(0,n.jsx)("span",{className:"inline-block w-[18px] text-left",children:s})]})}),v&&(0,n.jsx)("div",{className:"px-1.5 rounded-[23px] aspect-1 bg-gray-500/10 flex items-center gap-1 text-xs ".concat(x.Fr||f?"w-[24px] h-[24px] min-w-[24px] min-h-[24px] justify-center":""),children:(0,n.jsx)("svg",{width:"15",height:"11",viewBox:"0 0 15 11",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M2.99219 10.4395C2.375 10.4395 1.84375 10.3184 1.39844 10.0762C0.957031 9.83398 0.617188 9.50781 0.378906 9.09766C0.144531 8.68359 0.0273438 8.22461 0.0273438 7.7207C0.0273438 7.29492 0.109375 6.90625 0.273438 6.55469C0.441406 6.19922 0.673828 5.89453 0.970703 5.64062C1.27148 5.38672 1.62305 5.20117 2.02539 5.08398C2.08398 4.49023 2.24219 3.94336 2.5 3.44336C2.75781 2.94336 3.08984 2.50781 3.49609 2.13672C3.90234 1.76563 4.36328 1.47852 4.87891 1.27539C5.39453 1.06836 5.93945 0.964844 6.51367 0.964844C7.40039 0.964844 8.18945 1.18359 8.88086 1.62109C9.57617 2.05859 10.123 2.66797 10.5215 3.44922C11.0605 3.44922 11.5566 3.53711 12.0098 3.71289C12.4668 3.88867 12.8633 4.13477 13.1992 4.45117C13.5391 4.76758 13.8008 5.13867 13.9844 5.56445C14.1719 5.98633 14.2656 6.44531 14.2656 6.94141C14.2656 7.42969 14.1738 7.88672 13.9902 8.3125C13.8105 8.73828 13.5566 9.10938 13.2285 9.42578C12.9043 9.74219 12.5234 9.99023 12.0859 10.1699C11.6523 10.3496 11.1836 10.4395 10.6797 10.4395H2.99219ZM2.99805 9.33789H10.7207C11.1816 9.33789 11.5957 9.23242 11.9629 9.02148C12.3301 8.81055 12.6211 8.52734 12.8359 8.17188C13.0547 7.81641 13.1641 7.41602 13.1641 6.9707C13.1641 6.52148 13.0527 6.11523 12.8301 5.75195C12.6074 5.38867 12.2832 5.10156 11.8574 4.89062C11.4355 4.67578 10.9219 4.56836 10.3164 4.56836C10.1328 4.56836 9.99023 4.53906 9.88867 4.48047C9.79102 4.42188 9.70508 4.31836 9.63086 4.16992C9.4082 3.72461 9.14062 3.3457 8.82812 3.0332C8.51953 2.7168 8.17188 2.47656 7.78516 2.3125C7.39844 2.14844 6.97461 2.06641 6.51367 2.06641C6.06055 2.06641 5.63672 2.15039 5.24219 2.31836C4.85156 2.48633 4.50195 2.72461 4.19336 3.0332C3.88867 3.33789 3.64062 3.69922 3.44922 4.11719C3.26172 4.53125 3.14648 4.98828 3.10352 5.48828C3.08789 5.66797 3.04492 5.80078 2.97461 5.88672C2.9043 5.97266 2.78516 6.03711 2.61719 6.08008C2.13672 6.20508 1.76758 6.41211 1.50977 6.70117C1.25586 6.98633 1.12891 7.33594 1.12891 7.75C1.12891 8.07031 1.20312 8.34961 1.35156 8.58789C1.5 8.82227 1.71289 9.00586 1.99023 9.13867C2.26758 9.27148 2.60352 9.33789 2.99805 9.33789Z",className:"fill-gray-600"})})}),b&&(0,n.jsx)(e0,{selectedModels:l,onModelSelect:o,onOpenChange:i,isCompact:p,openUpwards:f}),(0,n.jsxs)("div",{className:"flex items-center gap-3 ml-auto",children:[!t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>{var e;null==(e=g.current)||e.click()},className:"w-6 h-6 min-w-6 min-h-6 flex items-center justify-center rounded-full hover:text-gray-300 transition-all duration-100 text-gray-500",title:"Attach images",children:(0,n.jsx)("svg",{width:"20",height:"19",fill:"currentColor",viewBox:"0 0 20 19",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsxs)("g",{opacity:"0.7",children:[(0,n.jsx)("path",{d:"M18.7565 13.9987C18.7565 14.78 18.572 15.3713 18.2032 15.7728C17.8342 16.1797 17.2808 16.3831 16.543 16.3831H2.90365C2.296 16.3831 1.84028 16.196 1.53646 15.8216C1.23264 15.4527 1.06717 14.8993 1.04004 14.1615L4.14063 11.362C4.30882 11.2047 4.47972 11.0907 4.65332 11.0202C4.82693 10.9442 5.00597 10.9063 5.19043 10.9063C5.38032 10.9063 5.56748 10.9469 5.75195 11.0283C5.94183 11.1043 6.12088 11.2182 6.28907 11.3701L7.7946 12.7292L11.473 9.4414C11.6629 9.27865 11.8582 9.15658 12.0589 9.0752C12.2596 8.99382 12.4712 8.95313 12.6937 8.95313C12.9161 8.95313 13.1304 8.99653 13.3366 9.08333C13.5482 9.16472 13.7435 9.2895 13.9225 9.45768L18.7565 13.9987ZM6.4681 9.53907C6.11545 9.53907 5.79265 9.45497 5.49967 9.28678C5.21213 9.11317 4.98155 8.87988 4.80795 8.58692C4.63433 8.29395 4.54753 7.97113 4.54753 7.61848C4.54753 7.27127 4.63433 6.95117 4.80795 6.6582C4.98155 6.36523 5.21213 6.13195 5.49967 5.95833C5.79265 5.78472 6.11545 5.69792 6.4681 5.69792C6.82075 5.69792 7.14085 5.78472 7.42838 5.95833C7.71593 6.13195 7.9465 6.36523 8.12012 6.6582C8.29373 6.95117 8.38053 7.27127 8.38053 7.61848C8.38053 7.97113 8.29373 8.29395 8.12012 8.58692C7.9465 8.87988 7.71593 9.11317 7.42838 9.28678C7.14085 9.45497 6.82075 9.53907 6.4681 9.53907ZM2.96062 16.9528C2.10883 16.9528 1.46864 16.7412 1.04004 16.318C0.616862 15.9003 0.405273 15.2737 0.405273 14.4382V4.49348C0.405273 3.65257 0.616862 3.02322 1.04004 2.60547C1.46864 2.1823 2.10883 1.9707 2.96062 1.9707H17.0393C17.8967 1.9707 18.5368 2.1823 18.96 2.60547C19.3832 3.02865 19.5947 3.65798 19.5947 4.49348V14.4382C19.5947 15.2737 19.3832 15.9003 18.96 16.318C18.5368 16.7412 17.8967 16.9528 17.0393 16.9528H2.96062ZM2.97688 15.6426H17.0232C17.4247 15.6426 17.7338 15.5368 17.9508 15.3252C18.1733 15.1082 18.2845 14.7881 18.2845 14.3649V4.56673C18.2845 4.14355 18.1733 3.82347 17.9508 3.60645C17.7338 3.38943 17.4247 3.28092 17.0232 3.28092H2.97688C2.56998 3.28092 2.25803 3.38943 2.04102 3.60645C1.824 3.82347 1.7155 4.14355 1.7155 4.56673V14.3649C1.7155 14.7881 1.824 15.1082 2.04102 15.3252C2.25803 15.5368 2.56998 15.6426 2.97688 15.6426Z"}),(0,n.jsx)("path",{d:"M17.0391 1.9707C17.8964 1.9707 18.5368 2.18231 18.96 2.60547C19.3831 3.0286 19.5947 3.65782 19.5947 4.49316V14.4385C19.5947 15.2738 19.3831 15.9007 18.96 16.3184C18.5368 16.7414 17.8963 16.9531 17.0391 16.9531H2.96094C2.10926 16.9531 1.46864 16.7414 1.04004 16.3184C0.616917 15.9007 0.405328 15.2738 0.405273 14.4385V4.49316C0.405327 3.65241 0.616916 3.02317 1.04004 2.60547C1.46864 2.1823 2.10915 1.9707 2.96094 1.9707H17.0391ZM2.97656 3.28125C2.56982 3.28131 2.25798 3.38949 2.04102 3.60645C1.82405 3.82341 1.71588 4.14339 1.71582 4.56641V13.5508L4.14062 11.3623C4.30877 11.205 4.47976 11.091 4.65332 11.0205C4.82694 10.9446 5.00596 10.9063 5.19043 10.9062C5.38031 10.9062 5.56749 10.9469 5.75195 11.0283C5.94183 11.1043 6.12088 11.2182 6.28906 11.3701L7.79492 12.7295L11.4727 9.44141C11.6625 9.27873 11.858 9.15658 12.0586 9.0752C12.2592 8.99385 12.471 8.95316 12.6934 8.95312C12.9158 8.95312 13.1308 8.99621 13.3369 9.08301C13.5484 9.16439 13.7439 9.28987 13.9229 9.45801L18.2842 13.5547V4.56641C18.2841 4.14349 18.1735 3.8234 17.9512 3.60645C17.7342 3.38948 17.4248 3.2813 17.0234 3.28125H2.97656ZM6.46777 5.69824C6.82042 5.69824 7.14118 5.78439 7.42871 5.95801C7.71622 6.13162 7.94652 6.36527 8.12012 6.6582C8.29368 6.95108 8.38081 7.27107 8.38086 7.61816C8.38086 7.97081 8.29373 8.29395 8.12012 8.58691C7.94652 8.87985 7.71622 9.1135 7.42871 9.28711C7.14118 9.45529 6.82042 9.53906 6.46777 9.53906C6.11541 9.53901 5.79279 9.45509 5.5 9.28711C5.21247 9.11349 4.98122 8.87988 4.80762 8.58691C4.63406 8.29399 4.54785 7.97075 4.54785 7.61816C4.5479 7.27113 4.63411 6.95104 4.80762 6.6582C4.98122 6.36524 5.21247 6.13162 5.5 5.95801C5.79279 5.7846 6.11541 5.6983 6.46777 5.69824Z","fill-opacity":"0.6"})]})})}),(0,n.jsx)(te,{isCompact:p||!1,onClick:d,disabled:!a.trim()||!!h})]}),t&&(r||f)&&(0,n.jsx)("button",{onClick:u,className:"".concat(f?"w-4 h-4 min-w-4 min-h-4":"w-6 h-6 min-w-6 min-h-6"," flex items-center justify-center rounded-full bg-white/80 transition-all duration-100 outline outline-1 outline-white hover:bg-white/90 hover:scale-105 opacity-50 hover:opacity-100"),children:(0,n.jsx)("div",{className:"".concat(f?"w-[6px] h-[6px]":"w-[10px] h-[10px]"," rounded-sm bg-[#212226]")})}),t&&!r&&!f&&(0,n.jsx)("button",{onClick:u,className:"flex items-center gap-2 px-1 py-0.5 bg-white/5 bg-opacity-30 text-[#D8DEE9] text-xs font-medium rounded-md hover:bg-white/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Stop"})]})]})}e9.displayName="ArrowUpIcon";var tr=r(43122),tn=r(85181),ts=r(99621),ta=r(47508),tl=r(73984),to=r(71909),ti=r(97764);function tc(e){let{shouldAutoFocus:t}=e,[r]=(0,tn.DF)();return(0,c.useEffect)(()=>{!1!==t&&r.focus()},[r,t]),null}let td=e=>{let{setEditor:t,readonly:r}=e,[n]=(0,tn.DF)();return(0,c.useEffect)(()=>{t&&(t(n),n.setEditable(!(null!=r&&r)))},[t,r,n]),null},tu=e=>{let[t]=(0,tn.DF)(),{setText:r,setRichText:n,setHasContent:s}=e,a=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=t.registerTextContentListener(e=>{(r||s)&&(0,ti.unstable_batchedUpdates)(()=>{r&&r(e),s&&s(e.trim().length>0)}),n&&(a.current&&window.clearTimeout(a.current),a.current=window.setTimeout(()=>{n(JSON.stringify(t.getEditorState()))},120))});return()=>{a.current&&window.clearTimeout(a.current),e()}},[t,r,n,s]),null},tm=e=>{let[t]=(0,tn.DF)(),{onFocusChange:r}=e;return(0,c.useEffect)(()=>t.registerRootListener(e=>{if(null!==e){let t=()=>{null==r||r(!0)},n=()=>{null==r||r(!1)};return e.addEventListener("focus",t,!0),e.addEventListener("blur",n,!0),()=>{e.removeEventListener("focus",t,!0),e.removeEventListener("blur",n,!0)}}}),[t,r]),null},tp=e=>{let{hasOpenModal:t}=e,[r]=(0,tn.DF)();return(0,c.useEffect)(()=>{let e=r.registerCommand(eC.Q$N,e=>!t&&(e&&(e.preventDefault(),e.stopPropagation()),r.blur(),!0),eC.WgU);return()=>{e()}},[r,t]),null},tx=e=>{let[t]=(0,tn.DF)(),{onSubmit:r,isSubmitting:n}=e;return(0,c.useEffect)(()=>{let e=t.registerCommand(eC.RTo,e=>(!e||!e.shiftKey)&&!x.Fr&&(e&&(e.preventDefault(),e.stopPropagation()),n||r(),!0),eC.WgU);return()=>{e()}},[t,r,n]),null},tf=e=>{let[t]=(0,tn.DF)(),{onImageSelect:r}=e;return(0,c.useEffect)(()=>{if(!r)return;let e=t.registerCommand(eC.waI,e=>{if(!(e instanceof ClipboardEvent))return!1;let t=e.clipboardData;if(!t)return!1;let n=t.files;if(n&&n.length>0){let t=Array.from(n).filter(e=>e.type.startsWith("image/"));if(t.length>0)return e.preventDefault(),e.stopPropagation(),r(Object.assign(t,{item:e=>t[e]||null})),!0}return!1},eC.WgU);return()=>{e()}},[t,r]),null};function th(e){let{setText:t,setRichText:r,setEditor:s,onFocusChange:a,onSubmit:l,onStop:o,isSubmitting:i,isPaused:d,onKeyDown:u,isCompact:m,shouldAutoFocus:p,placeholder:f,onImageSelect:h,isFollowUp:g,hasOpenModal:v}=e,[b,w]=(0,c.useState)(""),[y,j]=(0,c.useState)(!1),C=(0,c.useRef)(null),N=(0,c.useRef)(!1),k=()=>{i||l()};(0,c.useEffect)(()=>{let e=e=>{if(!window._bypassBeforeUnload&&(y||i))return e.preventDefault(),e.returnValue="","You have unsaved changes in the editor. Are you sure you want to leave?"};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[y,i]),(0,c.useEffect)(()=>{if(!i||d||!m)return;let e=setInterval(()=>{w(e=>e.length>=3?"":e+".")},175);return()=>clearInterval(e)},[i,d,m]);let S=(0,c.useMemo)(()=>({namespace:"BackgroundComposerEditor",theme:{text:{base:"text-white"}},onError:e=>{console.error(e)}}),[]),E=!y;return(0,n.jsxs)(tr.n,{initialConfig:S,children:[(0,n.jsxs)("div",{className:"flex flex-col ".concat(m?"h-fit p-2":"flex-1 "),style:{pointerEvents:"all"},onKeyDown:e=>{"Enter"===e.key&&e.metaKey&&!m?(e.preventDefault(),e.stopPropagation(),k()):"Enter"!==e.key||e.shiftKey||!m||x.Fr||(e.preventDefault(),e.stopPropagation(),k()),u(e)},children:[m&&g&&i&&!d&&(0,n.jsx)("div",{className:"px-1.5 flex items-center gap-0.5 text-xs py-px mb-2",children:(0,n.jsxs)("span",{className:"text-[11px] font-medium leading-[150%] text-white/40",children:["Generating",(0,n.jsx)("span",{className:"inline-block w-[18px] text-left",children:b})]})}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(to.h,{contentEditable:(0,n.jsx)(ts.a,{ref:C,className:"line-height-1.5 caret-white ".concat(g?"p-0 transition-[padding] duration-200 ease-in-out":"p-3 pr-12 transition-[padding] duration-200 ease-in-out"," min-h-[48.4px] max-h-[258px] resize-none text-gray-300 select-text ").concat(m&&!g?"bg-[rgba(255,255,255,0.14)] rounded-[12px] border border-white/10 shadow-lg backdrop-blur-md placeholder:text-white":""," outline-none overflow-y-auto w-full ").concat(g?"text-[14px]":"text-[16px]"," selection:bg-white/20 selection:text-white scroll-p-5")}),placeholder:(0,n.jsx)("div",{className:"absolute ".concat(g?"top-0 left-0":"top-[12.5px] left-3.5"," pointer-events-none ").concat(m?"text-white/40":"text-gray-500"," ").concat(g?"text-[14px] transition-[margin] duration-200 ".concat(i?"ml-10":""):"text-[16px]"," transition-opacity duration-300 ease-out ").concat(E?"opacity-100":"opacity-0"),children:i?d?"Generation paused - click to resume...":"Submitting request...":f||"Give Cursor a follow-up instruction..."}),ErrorBoundary:ta.R}),(0,n.jsx)(tl.G,{}),(0,n.jsx)(tc,{shouldAutoFocus:p}),(0,n.jsx)(tu,{setText:t,setRichText:r,setHasContent:j}),(0,n.jsx)(tx,{onSubmit:k,isSubmitting:i}),(0,n.jsx)(tm,{onFocusChange:a}),(0,n.jsx)(tp,{hasOpenModal:v}),(0,n.jsx)(tf,{onImageSelect:h}),m&&!g&&(0,n.jsxs)(n.Fragment,{children:[!i&&(0,n.jsx)(te,{onClick:k,disabled:!y,isCompact:m,className:"absolute ".concat(x.Fr?"bottom-3":"bottom-4"," right-3")}),i&&(0,n.jsx)("button",{onClick:()=>{N.current=!0,o()},className:"absolute bottom-4 right-3 w-4 h-4 min-w-4 min-h-4 flex items-center justify-center rounded-full bg-white/80 transition-all duration-100 outline outline-1 outline-white hover:bg-white/90 hover:scale-105 opacity-50 hover:opacity-100 ".concat(x.Fr?"bg-white/80":""),children:(0,n.jsx)("div",{className:"w-[6px] h-[6px] bg-[#212226]"})})]})]})]}),(0,n.jsx)(td,{setEditor:s,readonly:i})]})}var tg=r(67473);let tv=e=>{let{showAutoModelModal:t,setShowAutoModelModal:r,onEditLimits:s,onContinueWithAuto:a}=e;return(0,n.jsx)(tg._s.Root,{open:t,onOpenChange:e=>{e||r(!1)},children:(0,n.jsxs)(tg._s.Portal,{children:[(0,n.jsx)(tg._s.Overlay,{className:"fixed inset-0 bg-black/50 z-50"}),(0,n.jsxs)(tg._s.Content,{className:"bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col rounded-t-xl border border-white/10 h-fit max-h-[70vh] fixed bottom-0 left-0 right-0 z-50",children:[(0,n.jsx)("div",{className:"p-4 pb-0",children:(0,n.jsx)(tg._s.Handle,{className:"bg-white/20 h-1 w-12 rounded-full mx-auto mb-4"})}),(0,n.jsxs)("div",{className:"p-6 pt-0",children:[(0,n.jsx)("div",{className:"flex items-center justify-between mb-0",children:(0,n.jsx)(O.DZ,{variant:"subheading-2",className:"text-white",children:"Running on Auto"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(O.o5,{className:"text-sm text-white/70",children:"Usage limits reached"}),(0,n.jsx)(O.o5,{className:"text-xs text-white/50",children:"This Agent is running on Auto for free."}),(0,n.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 mt-4",children:[(0,n.jsx)("button",{onClick:s,className:"w-full border border-solid border-white/10 inline-flex text-white/50 items-center hover:bg-white/5 justify-center rounded-md px-4 py-2 text-sm font-medium text-white transition-colors focus:outline-none focus:ring-none focus:ring-offset-2",children:"Edit limits"}),(0,n.jsx)("button",{onClick:a,className:"w-full inline-flex items-center hover:bg-brand-dashboard-highlight/30 justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2",children:"Continue with Auto"})]})]})]})]})]})})};var tb=r(10195);function tw(e){var t;let{onFocusChange:r,onDropdownOpenChange:s,onBeforeSubmit:a,viewConfig:l,onViewConfigChange:o,filterConfig:i,onFilterConfigChange:u,inputRef:p,isFloating:g,isFollowUp:w,customPlaceholder:y,hideDropdowns:j,hideFooterButtons:C,onStop:N,selectedComposer:k,githubConnected:S,isGithubLoading:E,onConnectGithub:L,githubError:A,deeplinkData:M,hasOpenModal:I}=e,{refetchBackgroundComposers:D,setShowUsagePricingModal:R,setShowUpgradePaidModal:T,addOptimisticBackgroundComposer:F,removeOptimisticBackgroundComposer:P,updateComposerStatusOptimistically:B,backgroundComposers:O,showAutoModelModal:z,setShowAutoModelModal:U,addOptimisticMessage:W,removeOptimisticMessage:H}=(0,v._F)(),{stripeStatus:q}=(0,b.M)(),{installations:J}=(0,f.d)(),G=(0,h.t)(),[Z,V]=(0,c.useState)(""),[K,$]=(0,c.useState)(""),[X,Y]=(0,c.useState)(!1),[Q,ee]=(0,c.useState)(null),[et,en]=(0,c.useState)(!1),[es,ea]=(0,c.useState)(!1),[el,eo]=(0,c.useState)(null),[ei,ec]=(0,c.useState)((0,_.f6)()),[ed,eu]=(0,c.useState)((0,_.XG)()),em=(0,c.useMemo)(()=>{var e;return null==(e=O.find(e=>{var t;return e.bcId===(null==k||null==(t=k.composer)?void 0:t.bcId)}))?void 0:e.status},[k,O]),[ep,ex]=(0,c.useState)(()=>{var e;if(w&&(null==k||null==(e=k.modelDetails)?void 0:e.modelName)){let e=k.modelDetails.modelName;if(e&&"string"==typeof e)return[e]}return(0,_.Ju)()});(0,c.useEffect)(()=>{var e;if(w&&(null==k||null==(e=k.modelDetails)?void 0:e.modelName)){let e=k.modelDetails.modelName;ex(t=>1===t.length&&t[0]===e?t:[e])}},[w,null==k||null==(t=k.modelDetails)?void 0:t.modelName]);let[ef,eh]=(0,c.useState)(!1),[eg,ev]=(0,c.useState)(!1),[eb,ew]=(0,c.useState)(!1),[ek,eS]=(0,c.useState)(!1),[eE,eL]=(0,c.useState)("push"),[eA,eI]=(0,c.useState)(""),[eD,eR]=(0,c.useState)([]),[eT,eF]=(0,c.useState)(null),[eP,eB]=(0,c.useState)(new Set),[eO,ez]=(0,c.useState)(new Map),eU=(0,c.useRef)(!1);(0,c.useEffect)(()=>{if(!et||es)return;let e=setInterval(()=>{eI(e=>e.length>=3?"":e+".")},175);return()=>clearInterval(e)},[et,es]),(0,c.useEffect)(()=>{let e=new Set;eD.forEach((t,r)=>{eO.get(t.uuid)||e.add(r)}),e.size>0?eB(e):eP.size>0&&eB(new Set)},[eD,eO,eP.size]),(0,c.useEffect)(()=>{let e=ef||eg||eb||ek;null==s||s(e)},[ef,eg,eb,ek,s]),(0,c.useEffect)(()=>{ei&&(0,_.$d)(ei)},[ei]),(0,c.useEffect)(()=>{if(ed){if(eU.current){eU.current=!1;return}(0,_.P5)(ed)}},[ed]),(0,c.useEffect)(()=>{w||(0,_.d9)(ep)},[ep,w]);let eW=(0,c.useCallback)(e=>{w?ex(e.slice(-1)):ex(e)},[w]),eJ=(0,c.useCallback)(e=>{ec(e),ei&&ei.repoNodeId===e.repoNodeId||(eu(void 0),(0,_.C4)())},[ei]),eG=(0,c.useCallback)(e=>{eu(e)},[]);(0,c.useEffect)(()=>{Y(!0)},[]),(0,c.useImperativeHandle)(p,()=>({setPrompt:e=>{V(e),$(e),Q&&Q.update(()=>{let t=(0,eC.NiT)();t.clear(),t.append((0,eC.lJ7)().append((0,eC.sTu)(e)))})},getPrompt:()=>Z,setRepo:(e,t)=>{for(let r of J){let n=r.repos.find(r=>r.owner===e&&r.name===t);if(n)return void eJ(n)}console.warn("Repository ".concat(e,"/").concat(t," not found in installations"))},setBranch:e=>{eU.current=!0,eu(e)},focus:()=>{Q&&Q.focus()},insertTextAtCursor:e=>{Q&&Q.update(()=>{let t=(0,eC.vJq)();(0,eC.I2P)(t)?t.insertText(e):(0,eC.NiT)().append((0,eC.lJ7)().append((0,eC.sTu)(e)))})}}),[Q,J,eJ,Z]);let eZ=(0,c.useCallback)(e=>{null==r||r(e)},[r]),eV=async e=>{if(!e)return;let t=[],r=new Map(eO);for(let n=0;n<e.length;n++){let s=e[n];if(!s.type.startsWith("image/")){d.oR.error("".concat(s.name," is not an image file"));continue}if(s.size>0xa00000){d.oR.error("".concat(s.name," is too large. Please select images under 10MB."));continue}try{let e=await new Promise((e,t)=>{let r=new FileReader;r.onload=()=>e(r.result),r.onerror=()=>t(Error("Failed to read ".concat(s.name))),r.readAsDataURL(s)}),n=await s.arrayBuffer(),a=new Uint8Array(n),l=0,o=0;try{let t=new Image;if(await new Promise((r,n)=>{let a=setTimeout(()=>{console.warn("Image load timeout for ".concat(s.name)),n(Error("Timeout loading image: ".concat(s.name,". The file may be too large or corrupted.")))},1e4);t.onload=()=>{clearTimeout(a),l=t.width,o=t.height,r()},t.onerror=e=>{clearTimeout(a),console.error("Image load error for",s.name,e),n(Error("Failed to load image: ".concat(s.name,". The file may be corrupted or in an unsupported format.")))},t.src=e}),0===l||0===o)throw Error("Invalid image dimensions (".concat(l,"x").concat(o,"): ").concat(s.name))}catch(r){console.warn("Image dimension detection failed for ".concat(s.name,", using fallback dimensions:"),r);let e=a.length>8&&137===a[0]&&80===a[1]&&78===a[2]&&71===a[3],t=a.length>2&&255===a[0]&&216===a[1];if(e||t||s.type.startsWith("image/"))l=800,o=600;else throw r}if(a.length>0xa00000)throw Error("".concat(s.name," is too large. Maximum size is 10MB."));let i=crypto.randomUUID(),c=new ej.UR({data:a,dimension:new ej.t1({width:l,height:o}),uuid:i});r.set(i,e),t.push(c)}catch(t){console.error("Error processing image:",t);let e="Failed to process ".concat(s.name);e=t instanceof Error?t.message:t&&"object"==typeof t&&"type"in t?"Failed to load ".concat(s.name,". Please check if the file is a valid image."):"Unknown error processing ".concat(s.name,". Please try a different image."),d.oR.error(e)}}t.length>0&&(eR(e=>[...e,...t]),ez(r),d.oR.success("Added ".concat(t.length," image").concat(t.length>1?"s":"")))},eK=(0,c.useCallback)(e=>{eR(t=>{let r=t[e];return r&&ez(e=>{let t=new Map(e);return t.delete(r.uuid),t}),t.filter((t,r)=>r!==e)})},[]),e$=(0,c.useCallback)((e,t,r,n)=>{V(e),$(t),eR(r),ez(n),Q&&Q.update(()=>{let t=(0,eC.NiT)();t.clear(),t.append((0,eC.lJ7)().append((0,eC.sTu)(e)))})},[Q]),eX=async()=>{var e,t,r,s,l,o,i,c;let u=[...eD],p=new Map(eO),x=!1,f=!1;if(!Z.trim())return void d.oR.error("Please enter a message");if(!w&&A)return void d.oR.error("Unable to connect to GitHub. Please try again later.");if(!w&&!1===S&&!E){null==L||L();return}if(w){if(!k)return void d.oR.error("No composer selected");if(!(null==(e=k.composer)?void 0:e.bcId))return void d.oR.error("Invalid composer");if(0===ep.length||!ep[0])return void d.oR.error("Please select a model");if(et)return void d.oR.error("Please wait for the previous message to be sent")}else{if(!ei)return void d.oR.error("Please select a repository");if(!ed)return void d.oR.error("Please select a branch");if(0===ep.length)return void d.oR.error("Please select at least one model");if(et)return void d.oR.error("Please wait for the previous message to be sent")}if(a&&!a())return;let h=new AbortController;if(eo(h),en(!0),w&&k&&k.composer){if(k.composer.isArchived){d.oR.error("Cannot send message, Agent is archived"),en(!1),eo(null);return}eR([]),ez(new Map),V(""),$(""),Q&&Q.update(()=>{(0,eC.NiT)().clear()});try{let e=new ey.hS({text:Z,type:ey.Jc.HUMAN,images:u});W(k.composer.bcId,e);let n=new m.FF({bcId:k.composer.bcId,followupMessage:e,synchronous:!0,followupSource:G?m._b.IOS_APP:m._b.WEBSITE}),a=await fetch("/api/auth/addAsyncFollowupBackgroundComposer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.toJson()),signal:h.signal});if(!a.ok){let e=await a.json();if(null==e||null==(r=e.error)||null==(t=r.details)?void 0:t.some(e=>"ERROR_USAGE_PRICING_REQUIRED_CHANGEABLE"===e.error)){console.log("Usage pricing required error:",e),R(!0),H(k.composer.bcId,Z),x||(e$(Z,K,u,p),x=!0);return}if(null==e||null==(l=e.error)||null==(s=l.details)?void 0:s.some(e=>{var t,r;return"ERROR_BAD_REQUEST"===e.error&&(null==(r=e.details)||null==(t=r.detail)?void 0:t.includes("Free trial usage limit reached"))})){console.log("Free trial usage limit reached error:",e),T(!0),H(k.composer.bcId,Z),x||(e$(Z,K,u,p),x=!0);return}let n=null==e||null==(i=e.error)||null==(o=i.details)?void 0:o.find(e=>"ERROR_UNAUTHORIZED"===e.error);if(n){if(((null==(c=n.details)?void 0:c.detail)||"").includes("read-only access to this background composer")){d.oR.error("You have read-only access to this background composer."),H(k.composer.bcId,Z),x||(e$(Z,K,u,p),x=!0);return}console.log("Pro subscription required error:",e),T(!0),H(k.composer.bcId,Z),x||(e$(Z,K,u,p),x=!0);return}throw H(k.composer.bcId,Z),Error("HTTP error! status: ".concat(a.status))}(await a.json()).wasSwappedToDefault&&(console.log("Follow-up model was swapped to auto/default"),e0()?(0,d.oR)("Running on Auto",{description:"Usage limits reached. This Agent is running on Auto for free.",duration:4e3}):(U(!0),e1())),await D()}catch(e){e instanceof Error&&"AbortError"===e.name?(console.log("Background composer request was cancelled"),H(k.composer.bcId,Z)):(console.error("Error sending message:",e),H(k.composer.bcId,Z),x||e$(Z,K,u,p))}finally{setTimeout(()=>{en(!1)},6e3),ea(!1),eo(null)}return}let g="https://github.com/".concat(ei.owner,"/").concat(ei.name),v=g.replace("https://",""),b=Date.now(),y=new Map,j=ep.map(e=>{let t="bc-".concat(crypto.randomUUID());return y.set(e,t),new m.hF({bcId:t,createdAtMs:b,workspaceRootPath:"/workspace",isOwnedByDifferentTeamMember:!1,name:"New Background Agent",branchName:ed,hasStartedVm:!1,repoUrl:v,isArchived:!1,nId:"",isKilled:!1,status:m.R6.CREATING,isUnread:!0,source:G?m._b.IOS_APP:m._b.WEBSITE})});j.forEach(e=>{var t;let r=null==(t=Array.from(y.entries()).find(t=>{let[r,n]=t;return n===e.bcId}))?void 0:t[0];r?F(e,{promptText:Z,modelDetails:new ej.Gm({modelName:r,maxMode:!0}),images:eD}):F(e)}),eR([]),ez(new Map),V(""),$(""),Q&&Q.update(()=>{(0,eC.NiT)().clear()}),en(!1);try{console.log("Submitting requests for all selected models:",ep);let e=ep.length>1?crypto.randomUUID():void 0,t=ep.map(async t=>{try{var r,n,s,a,l,o,i,c,p;let x=y.get(t);if(!x)throw Error("Unexpected error - bcId not found for model ".concat(t));let b={bcId:x,snapshotNameOrId:v,startForAuthIdOnTeam:"",devcontainerStartingPoint:{url:g,ref:ed,cursorServerCommit:"",userExtensions:[],gitDiffToApply:void 0,environmentJsonOverride:"",dontAllowReadingEnvironmentJsonFromDatabase:!1,skipBuildCaches:!1},source:G?m._b.IOS_APP:m._b.WEBSITE,snapshotWorkspaceRootPath:"/workspace",prompt:"",richPrompt:"",returnImmediately:!0,files:[],repoUrl:v,modelDetails:{modelName:t,maxMode:!0},additionalModelDetails:[],repositoryInfo:{repositoryInfo:void 0,pathEncryptionKey:"",shouldSyncIndex:!1,repositoryInfoShouldQueryStaging:!1,queryOnlyRepoAccess:void 0,repositoryInfoShouldQueryProd:!1,repoQueryAuthToken:""},autoBranch:!M||"create"===eE,forceVmBackend:void 0,forceCluster:void 0,conversationHistory:[{text:Z,richText:K||Z,capabilityContexts:[],type:ey.Jc.HUMAN,images:eD}],images:[],documentationIdentifiers:[],externalLinks:[],addInitialMessageToResponses:!0,promptGroupId:e},w=new m.px(b);console.log("Sending background composer request for model ".concat(t,":"),b);let C=await fetch("/api/auth/startBackgroundComposerFromSnapshot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w.toJson()),signal:h.signal});if(!C.ok){let e=await C.json();if(null==e||null==(s=e.error)||null==(n=s.details)?void 0:n.some(e=>"ERROR_USAGE_PRICING_REQUIRED_CHANGEABLE"===e.error))return console.log("Usage pricing required error:",e),R(!0),f=!0,{modelName:t,error:Error("Payment error"),success:!1,paymentError:!0};if(null==e||null==(l=e.error)||null==(a=l.details)?void 0:a.some(e=>{var t,r;return"ERROR_BAD_REQUEST"===e.error&&(null==(r=e.details)||null==(t=r.detail)?void 0:t.includes("Free trial usage limit reached"))}))return console.log("Free trial usage limit reached error:",e),T(!0),f=!0,{modelName:t,error:Error("Payment error"),success:!1,paymentError:!0};if(null==e||null==(i=e.error)||null==(o=i.details)?void 0:o.some(e=>"ERROR_UNAUTHORIZED"===e.error))return console.log("Pro subscription required error:",e),T(!0),f=!0,{modelName:t,error:Error("Payment error"),success:!1,paymentError:!0};if(null==e||null==(p=e.error)||null==(c=p.details)?void 0:c.some(e=>{var t,r;return"ERROR_BAD_REQUEST"===e.error&&(null==(r=e.details)||null==(t=r.detail)?void 0:t.includes("Git Repository is empty"))}))return console.log("Empty repository error:",e),d.oR.error("This repository is empty. Please commit a file before running Agent."),f=!0,{modelName:t,error:Error("Empty repository"),success:!1,emptyRepoError:!0};throw Error("HTTP error for model ".concat(t,"! status: ").concat(C.status))}let N=await C.json();if(console.log("Background composer response for model ".concat(t,":"),N),console.log("Background composer ID (bcId) for model ".concat(t,":"),null==(r=N.composer)?void 0:r.bcId),N.wasSwappedToDefault){console.log("Model ".concat(t," was swapped to auto/default")),e0()?(0,d.oR)("Running on Auto",{description:"Usage limits reached. This Agent is running on Auto for free.",duration:4e3}):(U(!0),e1());let e=y.get(t),r=j.find(t=>t.bcId===e);r&&(P(e),F(r,{promptText:Z,modelDetails:new ej.Gm({modelName:"default",maxMode:!1}),images:u})),t="default"}return{modelName:t,result:N,success:!0}}catch(r){if(r instanceof Error&&"AbortError"===r.name){console.log("Background composer request for model ".concat(t," was cancelled"));let e=y.get(t);return P(e),{modelName:t,error:r,success:!1,aborted:!0}}let e=y.get(t);return console.error("Error creating background composer for model ".concat(t," (bcId: ").concat(e,"):"),r),P(e),{modelName:t,error:r,success:!1}}}),r=await Promise.all(t),s=r.filter(e=>e.success&&!e.aborted),a=r.filter(e=>!e.success&&!e.aborted);if(s.length>0){let e=1===s.length?"background agent":"".concat(s.length," background agents"),t=s.map(e=>e.modelName).join(", ");d.oR.success((0,n.jsxs)("div",{className:"text-left",children:[(0,n.jsxs)("div",{children:["Started ",e]}),(0,n.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Using ",t]})]}),{duration:4e3,icon:(0,n.jsx)(eN,{className:"animate-spin-slow mt-1"}),style:{maxWidth:"90vw",fontSize:"14px",textAlign:"left",alignItems:"flex-start"}}),eR([]),ez(new Map),V(""),$(""),Q&&Q.update(()=>{(0,eC.NiT)().clear()})}else f&&!x&&(e$(Z,K,u,p),x=!0);a.length>0&&0===s.length&&d.oR.error("Failed to create agents."),D()}catch(e){e instanceof Error&&"AbortError"===e.name?console.log("Background composer request was cancelled"):(console.error("Error creating background composer:",e),d.oR.error("Failed to create agents.")),j.forEach(e=>{P(e.bcId)}),e instanceof Error&&"AbortError"===e.name||x||e$(Z,K,u,p)}finally{en(!1),ea(!1),eo(null)}},eY=(0,c.useCallback)(async()=>{var e;if(el&&el.abort(),ea(!1),null==k||null==(e=k.composer)?void 0:e.bcId){let e=k.composer.bcId,t=k.composer.status;B(e,m.R6.FINISHED);try{let r=await fetch("/api/background-composer/pause",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e})});r.ok||(B(e,t),console.error("Failed to pause background composer: ".concat(r.status," ").concat(r.statusText)))}catch(r){B(e,t),console.error("Error pausing background composer:",r)}}},[el,k,B]);(0,c.useEffect)(()=>{if(eP.size>0){let e=Array.from(eP).sort((e,t)=>t-e);eR(t=>{let r=[...t];return e.forEach(e=>{e>=0&&e<r.length&&(r.splice(e,1),d.oR.error("Failed to display image ".concat(e+1,". Removing from selection.")))}),r}),eB(new Set)}},[eP]);let eQ=(0,c.useMemo)(()=>!j,[j]);(0,c.useEffect)(()=>{Q&&Z&&Q.update(()=>{let e=(0,eC.NiT)();e.clear(),e.append((0,eC.lJ7)().append((0,eC.sTu)(Z)))})},[Q]);let e0=()=>{try{return"true"===localStorage.getItem("auto-model-modal-seen")}catch(e){return console.warn("Failed to read auto model modal state from localStorage:",e),!1}},e1=(0,c.useCallback)(()=>{try{localStorage.setItem("auto-model-modal-seen","true")}catch(e){console.warn("Failed to save auto model modal state to localStorage:",e)}},[]);return X?(0,n.jsxs)("div",{className:w?"relative":"flex flex-col gap-4",children:[w&&(et&&!es||em===m.R6.RUNNING||em===m.R6.CREATING)&&(0,n.jsxs)("div",{className:"absolute flex items-center border border-white/5 justify-between px-3 py-1.5 bg-[#1B1D21] rounded-t-lg border-b-0 z-10",style:{width:"calc(100% - 22px)",left:"10px",top:"-28.8px"},children:[(0,n.jsxs)("span",{className:"text-[11px] font-medium text-white/60",children:["Generating",(0,n.jsx)(er,{})]}),(0,n.jsx)("button",{onClick:N||eY,className:"text-[11px] font-medium text-white/60 hover:text-white/80 transition-colors",children:"Stop"})]}),(0,n.jsxs)("div",{className:w?"flex flex-col w-full rounded-xl min-h-[60px] bg-[#1B1D21] ".concat(et?"hover:bg-[#212326] cursor-pointer":"cursor-text"):"flex flex-col w-full rounded-xl min-h-[118px] bg-[#1B1D21] ".concat(et?"hover:bg-[#212326] cursor-pointer":"cursor-text"),style:w?{border:"1px solid rgba(255, 255, 255, 0.08)"}:{border:"1px solid rgba(255, 255, 255, 0.04)",boxShadow:"0px 18px 25.8px 0px rgba(0, 0, 0, 0.06)"},onClick:e=>{if(et)return void ea(e=>!e);e.target.closest('button, input, textarea, select, [role="menu"], [role="listbox"], [role="dialog"], [data-prevent-editor-focus]')||null==Q||Q.focus()},children:[eD.length>0&&(0,n.jsx)("div",{className:"flex flex-wrap gap-2 p-2 border-b border-white/5 relative",children:eD.map((e,t)=>{let r=eO.get(e.uuid);return r?(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("div",{className:"relative group border p-0.5 pr-1 cursor-pointer rounded-[6px] hover:bg-gray-500/10 border-gray-500/10 flex items-center gap-1",onClick:()=>eF(eT===t?null:t),children:[(0,n.jsx)("img",{src:r,alt:"Selected image ".concat(t+1),className:"w-4 h-4 object-cover rounded-[4px] border border-white/10 opacity-100 flex group-hover:hidden",onError:()=>{eB(e=>new Set([...e,t]))}}),(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),eK(t)},className:"w-4 h-4 items-center justify-center group-hover:flex hidden",children:(0,n.jsx)("span",{className:"text-gray-500 text-xs",children:"\xd7"})}),(0,n.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Image ".concat(t+1)})]}),eT===t&&(0,n.jsxs)("div",{className:"absolute top-full left-0 mt-2 z-50 bg-[#1B1D21] border border-white/10 rounded-[6px] p-1 shadow-lg animate-in fade-in-0 scale-in-95 duration-200",style:{minWidth:"200px",maxWidth:"300px"},onMouseLeave:()=>eF(null),children:[(0,n.jsxs)("div",{className:"text-[11px] font-medium text-gray-500 mb-1",children:["Image ",t+1]}),(0,n.jsx)("img",{src:r,alt:"Preview of image ".concat(t+1),className:"w-full h-auto max-h-64 object-contain rounded border border-white/10",onError:()=>{eB(e=>new Set([...e,t]))}})]})]},e.uuid):null})}),(0,n.jsx)(th,{setText:V,onStop:N||eY,setRichText:$,setEditor:ee,onFocusChange:eZ,onSubmit:eX,isSubmitting:et,isPaused:es,isCompact:w,isFollowUp:w,onKeyDown:e=>{"ArrowDown"===e.key&&!Z.trim()&&(e.preventDefault(),Q&&Q.blur())},placeholder:y||"Ask Cursor to build, fix bugs, explore",onImageSelect:eV,hasOpenModal:I}),!C&&(0,n.jsx)(tt,{isSubmitting:et,isPaused:es,loadingDots:eA,text:Z,selectedModels:ep,setSelectedModels:eW,setModelDropdownOpen:eh,onSubmit:eX,onStop:N||eY,onImageSelect:eV,isCompact:w,isFollowUp:w,githubError:A})]}),eQ&&(0,n.jsx)("div",{className:"flex flex-col gap-2.5 px-3 box-border ".concat(g?"mb-1.5":"mb-6"),children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-2.5 items-center min-w-0",children:[(0,n.jsx)("div",{className:"flex gap-2.5 min-w-0 flex-1",children:M?(0,n.jsx)("div",{className:"min-w-0",children:(0,n.jsx)(e_,{selectedOption:eE,onOptionSelect:eL,onOpenChange:eS,selectedBranch:ed})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"min-w-0",onClick:e=>{if(!1===S&&!E){e.preventDefault(),e.stopPropagation(),null==L||L();return}},children:(0,n.jsx)(tb.A,{selectedRepo:ei,onRepoSelect:eJ,hasCachedData:!!ei,onOpenChange:ev,className:"min-w-0"})}),ei&&(0,n.jsx)("div",{onClick:e=>{if(!1===S&&!E){e.preventDefault(),e.stopPropagation(),null==L||L();return}},className:"min-w-0",children:(0,n.jsx)(eM,{selectedRepo:ei,selectedBranch:ed,onBranchSelect:eG,hasCachedData:!!ed,onOpenChange:ew,className:"min-w-0"})})]})}),l&&o&&!x.Fr&&!g&&(0,n.jsxs)("div",{className:"flex gap-2",children:[i&&u&&(0,n.jsx)(e8,{filterConfig:i,onFilterConfigChange:u}),(0,n.jsx)(eH,{viewConfig:l,onViewConfigChange:o})]})]})}),x.Fr?(0,n.jsx)(tv,{showAutoModelModal:z,setShowAutoModelModal:U,onEditLimits:()=>{U(!1),R(!0)},onContinueWithAuto:()=>{U(!1)}}):(0,n.jsx)(eq,{showAutoModelModal:z,setShowAutoModelModal:U,onEditLimits:()=>{U(!1),R(!0)},onContinueWithAuto:()=>{U(!1)}})]}):w?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)("div",{className:"h-[182px]"})}var ty=r(56959),tj=r(6135);function tC(e){let{open:t,composerId:r,onClose:s,onCopy:a,onDelete:l,copied:o}=e,[i,d]=(0,c.useState)(!1),[u,m]=(0,c.useState)(!1);return((0,c.useEffect)(()=>{if(t){m(!0);let e=setTimeout(()=>d(!0),10);return()=>clearTimeout(e)}{d(!1);let e=setTimeout(()=>m(!1),150);return()=>clearTimeout(e)}},[t]),u)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-40 cursor-default",onMouseDown:s}),(0,n.jsxs)("div",{className:"absolute z-50 top-7 right-1 min-w-[170px] p-1 rounded-lg shadow-lg",style:{backgroundColor:"#1b1d21",border:"1px solid #24262a",boxShadow:"0 0 8px 2px color-mix(in srgb, var(--vscode-widget-shadow, rgba(0, 0, 0, 0.36)) 30%, transparent)",opacity:+!!i,transform:i?"scale(1)":"scale(0.95)",transformOrigin:"top right",transition:"opacity 0.15s ease-out, transform 0.15s ease-out"},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("button",{onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),a()},className:"flex outline-none focus:outline-none group justify-between items-center w-full hover:bg-white/5 cursor-pointer rounded-[6px] p-2 px-2.5",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[o?(0,n.jsx)(ek.A,{className:"h-4 w-4 text-gray-500"}):(0,n.jsx)(ty.A,{className:"h-4 w-4 text-gray-500"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Copy request ID"})]})}),(0,n.jsx)("button",{onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),l()},className:"flex outline-none focus:outline-none group justify-between items-center w-full hover:bg-red-500/10 cursor-pointer rounded-[6px] p-2 px-2.5",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(tj.A,{className:"h-4 w-4 text-red-400"}),(0,n.jsx)("span",{className:"text-sm font-medium text-red-400",children:"Delete agent"})]})})]})]}):null}var tN=r(67896),tk=r(33063),tS=r(77187),tE=r(92079),tL=r(75281);function tA(e){let{isOpen:t,onClose:r,diffViewMode:s,onViewModeToggle:a,onExpandAll:l,onCollapseAll:o,onCopyRequestId:i,onSendFeedback:d,selectedComposerBcId:u,isCopied:m}=e,[p,x]=(0,c.useState)(!1),[f,h]=(0,c.useState)(!1);return((0,c.useEffect)(()=>{if(t){h(!0);let e=setTimeout(()=>{x(!0)},10);return()=>clearTimeout(e)}{x(!1);let e=setTimeout(()=>{h(!1)},150);return()=>clearTimeout(e)}},[t]),(0,c.useEffect)(()=>{if(t){let e=e=>{"Escape"===e.key&&(e.preventDefault(),e.stopImmediatePropagation(),r())};return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}}},[t,r]),f)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-40",onClick:r}),(0,n.jsxs)("div",{"data-menu-content":!0,className:"absolute right-0 top-full z-50 mt-2 min-w-[220px] p-1 rounded-lg shadow-lg",style:{backgroundColor:"#1b1d21",border:"1px solid #24262a",boxShadow:"0 0 8px 2px color-mix(in srgb, var(--vscode-widget-shadow, rgba(0, 0, 0, 0.36)) 30%, transparent)",opacity:+!!p,transform:p?"scale(1)":"scale(0.95)",transformOrigin:"top right",transition:"opacity 0.15s ease-out, transform 0.15s ease-out",zIndex:0x3b9ac9ff},children:[(0,n.jsxs)("button",{onClick:()=>a("unified"),className:"flex outline-none focus:outline-none group justify-between items-center w-full hover:bg-white/5 cursor-pointer rounded-[6px] p-2 px-2.5 ",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(tN.A,{size:14,className:"text-gray-500"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Unified view"})]}),"unified"===s&&(0,n.jsx)(ek.A,{className:"h-4 w-4 text-gray-300"})]}),(0,n.jsxs)("button",{onClick:()=>a("split"),className:"flex outline-none focus:outline-none group justify-between items-center w-full hover:bg-white/5 cursor-pointer rounded-[6px] p-2 px-2.5 ",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(tk.A,{size:14,className:"text-gray-500"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Split view"})]}),"split"===s&&(0,n.jsx)(ek.A,{className:"h-4 w-4 text-gray-300"})]}),(0,n.jsx)("div",{className:"h-px bg-gray-300/5 my-1"}),(0,n.jsx)("button",{onClick:l,className:"flex outline-none focus:outline-none group justify-between items-center w-full hover:bg-white/5 cursor-pointer rounded-[6px] p-2 px-2.5 ",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(tL.p,{size:14,className:"text-gray-500"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Expand all"})]})}),(0,n.jsx)("button",{onClick:o,className:"flex outline-none focus:outline-none group justify-between items-center w-full hover:bg-white/5 cursor-pointer rounded-[6px] p-2 px-2.5 ",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(tE.f,{size:14,className:"text-gray-500"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Collapse all"})]})}),(0,n.jsx)("div",{className:"h-px bg-gray-300/5 my-1"}),(0,n.jsx)("button",{onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),i()},onClick:e=>{e.preventDefault(),e.stopPropagation()},disabled:!u,className:"flex outline-none focus:outline-none group justify-between items-center w-full hover:bg-white/5 cursor-pointer rounded-[6px] p-2 px-2.5  disabled:opacity-50 disabled:cursor-not-allowed",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[m?(0,n.jsx)(ek.A,{className:"h-4 w-4 text-gray-500 group-hover:opacity-100 opacity-60 transition-opacity"}):(0,n.jsx)(ty.A,{className:"h-4 w-4 text-gray-500 group-hover:opacity-100 opacity-60 transition-opacity"})," ",(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Copy Request ID"})]})}),(0,n.jsx)("button",{onClick:d,className:"flex outline-none focus:outline-none rounded-[6px] w-full text-gray-300 items-center justify-between p-2 px-2.5 text-sm hover:bg-white/5 ",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(tS.A,{size:14,className:"text-gray-500"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Send feedback"})]})})]})]}):null}var tM=r(26490),t_=r(86167),tI=r(87),tD=r(42656),tR=r(94732),tT=r(77527),tF=r(16172),tP=r(55198),tB=r(33815),tO=r(38742),tz=r(57023),tU=r(20698);function tW(e){return e&&-1!==e.indexOf("<linear_issue")?e.replace(/<linear_issue>([\s\S]*?)<\/linear_issue>/g,(e,t)=>{var r,n;let s=((null==(r=t.match(/<title>([\s\S]*?)<\/title>/))?void 0:r[1])||"Untitled").trim(),a=((null==(n=t.match(/<description>([\s\S]*?)<\/description>/))?void 0:n[1])||"").trim();return"\n**".concat(s,"**\n").concat(a,"\n")}):e}let tH=e=>{let{className:t}=e;return(0,n.jsx)("svg",{width:"14",height:"12",viewBox:"0 0 14 12",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:t,children:(0,n.jsx)("path",{d:"M0.457031 6.1377C0.457031 5.77637 0.515625 5.42969 0.632812 5.09766C0.753255 4.76562 0.924154 4.46289 1.14551 4.18945C1.36686 3.91276 1.63053 3.68327 1.93652 3.50098L2.39551 4.28223C2.0765 4.47754 1.82422 4.73958 1.63867 5.06836C1.45638 5.39714 1.36523 5.75195 1.36523 6.13281C1.36523 6.5625 1.45801 6.93848 1.64355 7.26074C1.83236 7.58301 2.0944 7.83366 2.42969 8.0127C2.76497 8.19173 3.15723 8.28125 3.60645 8.28125C4.03939 8.28125 4.42025 8.20475 4.74902 8.05176C5.0778 7.89551 5.33171 7.67904 5.51074 7.40234C5.69303 7.1224 5.78418 6.7985 5.78418 6.43066C5.78418 6.25163 5.75814 6.09212 5.70605 5.95215C5.65397 5.81217 5.5791 5.69499 5.48145 5.60059C5.39355 5.51921 5.32031 5.4541 5.26172 5.40527C5.20312 5.35319 5.15918 5.30111 5.12988 5.24902C5.10059 5.19368 5.08594 5.12207 5.08594 5.03418C5.08594 4.91699 5.12663 4.82096 5.20801 4.74609C5.29264 4.67122 5.40007 4.63379 5.53027 4.63379C5.62142 4.63379 5.7028 4.65007 5.77441 4.68262C5.84603 4.71517 5.93066 4.77376 6.02832 4.8584C6.2334 5.03092 6.3929 5.25391 6.50684 5.52734C6.62077 5.79753 6.67773 6.10352 6.67773 6.44531C6.67773 6.99219 6.54915 7.4707 6.29199 7.88086C6.03483 8.29102 5.6735 8.61003 5.20801 8.83789C4.74251 9.06576 4.20378 9.17969 3.5918 9.17969C2.9668 9.17969 2.41829 9.05436 1.94629 8.80371C1.47428 8.5498 1.10807 8.19499 0.847656 7.73926C0.58724 7.28027 0.457031 6.74642 0.457031 6.1377ZM1.77539 3.54492C1.77539 3.14779 1.87305 2.79785 2.06836 2.49512C2.26367 2.18913 2.52734 1.94987 2.85938 1.77734C3.19141 1.60156 3.5625 1.51367 3.97266 1.51367C4.24609 1.51367 4.52279 1.55924 4.80273 1.65039C5.08268 1.73828 5.34961 1.875 5.60352 2.06055L5.07129 2.79785C4.89551 2.6709 4.71322 2.5765 4.52441 2.51465C4.33561 2.4528 4.15007 2.42188 3.96777 2.42188C3.72038 2.42188 3.50065 2.4707 3.30859 2.56836C3.11654 2.66276 2.96354 2.7946 2.84961 2.96387C2.73893 3.12988 2.68359 3.32357 2.68359 3.54492C2.68359 3.74349 2.72754 3.9209 2.81543 4.07715C2.90658 4.23014 3.03516 4.35059 3.20117 4.43848C3.36719 4.52637 3.56576 4.57031 3.79688 4.57031C3.91732 4.57031 4.02148 4.61589 4.10938 4.70703C4.20052 4.79492 4.24609 4.90072 4.24609 5.02441C4.24609 5.14811 4.20052 5.25553 4.10938 5.34668C4.02148 5.43457 3.91732 5.47852 3.79688 5.47852C3.38346 5.47852 3.02539 5.39714 2.72266 5.23438C2.42318 5.06836 2.19043 4.84049 2.02441 4.55078C1.8584 4.25781 1.77539 3.92253 1.77539 3.54492ZM4.41211 3.38867C4.42839 2.91341 4.54557 2.49512 4.76367 2.13379C4.98177 1.76921 5.27637 1.48438 5.64746 1.2793C6.02181 1.07422 6.44499 0.97168 6.91699 0.97168C7.26204 0.97168 7.58594 1.04004 7.88867 1.17676C8.19141 1.31348 8.44531 1.50228 8.65039 1.74316C8.71224 1.72689 8.77246 1.71549 8.83105 1.70898C8.8929 1.70247 8.94661 1.69922 8.99219 1.69922C9.32422 1.69922 9.63672 1.76107 9.92969 1.88477C10.2259 2.00846 10.488 2.18587 10.7158 2.41699C10.9437 2.64486 11.1227 2.91667 11.2529 3.23242C11.3864 3.54818 11.4531 3.89648 11.4531 4.27734C11.4531 4.75586 11.375 5.15462 11.2188 5.47363C11.0658 5.79264 10.8672 6.05957 10.623 6.27441C10.3822 6.48926 10.1266 6.67643 9.85645 6.83594C9.58626 6.99219 9.3291 7.14518 9.08496 7.29492C8.84408 7.44466 8.64551 7.61556 8.48926 7.80762C8.33626 7.99967 8.25977 8.2373 8.25977 8.52051C8.25977 8.87858 8.39974 9.139 8.67969 9.30176C8.96289 9.46452 9.34212 9.5459 9.81738 9.5459C9.889 9.5459 9.96224 9.5459 10.0371 9.5459C10.112 9.54264 10.1787 9.54102 10.2373 9.54102C10.2861 9.54102 10.3219 9.55404 10.3447 9.58008C10.3708 9.60286 10.3838 9.63379 10.3838 9.67285C10.3838 9.88444 10.4115 10.0977 10.4668 10.3125C10.5221 10.5273 10.6084 10.7064 10.7256 10.8496C10.846 10.9961 10.999 11.0693 11.1846 11.0693C11.3669 11.0693 11.5329 10.9798 11.6826 10.8008C11.8324 10.6217 11.9512 10.3743 12.0391 10.0586C12.127 9.74284 12.1709 9.38477 12.1709 8.98438C12.1709 8.73698 12.1611 8.51237 12.1416 8.31055C12.1253 8.10872 12.1058 7.90527 12.083 7.7002L12.9863 7.45117C13.0124 7.66276 13.0335 7.889 13.0498 8.12988C13.0661 8.37077 13.0742 8.66048 13.0742 8.99902C13.0742 9.37988 13.0335 9.74935 12.9521 10.1074C12.8708 10.4655 12.7503 10.7845 12.5908 11.0645C12.4346 11.3444 12.2376 11.5658 12 11.7285C11.7656 11.8945 11.4938 11.9775 11.1846 11.9775C10.9014 11.9775 10.6523 11.8994 10.4375 11.7432C10.2259 11.5902 10.0534 11.3883 9.91992 11.1377C9.78646 10.8903 9.69694 10.6234 9.65137 10.3369C9.59928 10.3402 9.54557 10.3434 9.49023 10.3467C9.4349 10.3499 9.38281 10.3516 9.33398 10.3516C8.95312 10.3516 8.61133 10.2767 8.30859 10.127C8.00586 9.98047 7.7666 9.77376 7.59082 9.50684C7.41829 9.23665 7.33203 8.91764 7.33203 8.5498C7.33203 8.16895 7.40853 7.85156 7.56152 7.59766C7.71777 7.34049 7.91797 7.11914 8.16211 6.93359C8.40625 6.74479 8.66504 6.56901 8.93848 6.40625C9.21191 6.24349 9.46908 6.07096 9.70996 5.88867C9.9541 5.70312 10.1543 5.48177 10.3105 5.22461C10.4668 4.96745 10.5449 4.65169 10.5449 4.27734C10.5449 3.9388 10.4652 3.64583 10.3057 3.39844C10.1494 3.15104 9.94434 2.95898 9.69043 2.82227C9.43978 2.68229 9.17122 2.61068 8.88477 2.60742C8.80013 2.60742 8.71387 2.6123 8.62598 2.62207C8.54134 2.63184 8.46159 2.64811 8.38672 2.6709C8.32487 2.68392 8.27441 2.68717 8.23535 2.68066C8.19954 2.6709 8.16862 2.64323 8.14258 2.59766C8.04818 2.38281 7.88867 2.20866 7.66406 2.0752C7.43945 1.94173 7.1888 1.875 6.91211 1.875C6.60612 1.875 6.33431 1.94336 6.09668 2.08008C5.8623 2.21354 5.67513 2.39746 5.53516 2.63184C5.39844 2.86296 5.32357 3.12988 5.31055 3.43262C5.30404 3.57259 5.25846 3.68327 5.17383 3.76465C5.08919 3.84277 4.98503 3.88184 4.86133 3.88184C4.73112 3.88184 4.62207 3.83626 4.53418 3.74512C4.44954 3.65397 4.40885 3.53516 4.41211 3.38867ZM10.2129 8.24707C10.2129 8.12012 10.2585 8.01107 10.3496 7.91992C10.4408 7.82552 10.5498 7.78483 10.6768 7.79785C11.266 7.84668 11.7396 7.72135 12.0977 7.42188C12.4557 7.1224 12.6348 6.70247 12.6348 6.16211C12.6348 5.66732 12.4834 5.26855 12.1807 4.96582C11.8812 4.66309 11.4824 4.51497 10.9844 4.52148L11.1309 3.61328C11.6126 3.67188 12.0342 3.81836 12.3955 4.05273C12.7601 4.28385 13.0417 4.58171 13.2402 4.94629C13.4421 5.31087 13.543 5.71615 13.543 6.16211C13.543 6.70573 13.4225 7.17611 13.1816 7.57324C12.944 7.96712 12.6087 8.26335 12.1758 8.46191C11.7428 8.65723 11.2399 8.73698 10.667 8.70117C10.54 8.69141 10.4326 8.64583 10.3447 8.56445C10.2568 8.47982 10.2129 8.37402 10.2129 8.24707ZM7.74219 8.80859L8.0498 9.67773C7.81868 9.74935 7.58594 9.80143 7.35156 9.83398C7.11719 9.86654 6.89258 9.88281 6.67773 9.88281C6.13411 9.88281 5.64095 9.79004 5.19824 9.60449C4.75879 9.41569 4.40723 9.16667 4.14355 8.85742L4.94922 8.2373C5.05339 8.3903 5.2015 8.52214 5.39355 8.63281C5.58561 8.74349 5.80046 8.82975 6.03809 8.8916C6.27897 8.9502 6.52474 8.97949 6.77539 8.97949C6.93815 8.97949 7.10254 8.96484 7.26855 8.93555C7.43783 8.90625 7.5957 8.86393 7.74219 8.80859ZM6.05762 5.41016C6.52311 5.35156 6.85352 5.20996 7.04883 4.98535C7.24414 4.76074 7.34017 4.44661 7.33691 4.04297C7.33366 3.91927 7.37598 3.81348 7.46387 3.72559C7.55176 3.6377 7.65755 3.59375 7.78125 3.59375C7.90495 3.59375 8.01237 3.6377 8.10352 3.72559C8.19466 3.81348 8.24186 3.91927 8.24512 4.04297C8.24837 4.64518 8.09538 5.13835 7.78613 5.52246C7.48014 5.90658 7.00651 6.15885 6.36523 6.2793L6.05762 5.41016Z"})})},tq=e=>{let t=0;if(0===e.length)return t.toString();for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return Math.abs(t).toString(36)},tJ=e=>{try{var t,r,n,s;let a=null==(t=e.result)?void 0:t.result;if((null==a?void 0:a.case)==="todoWriteResult"&&(null==(r=a.value)?void 0:r.finalTodos)&&Array.isArray(a.value.finalTodos))return a.value.finalTodos;let l=null==(n=e.result)?void 0:n.todoWriteResult;if((null==l?void 0:l.finalTodos)&&Array.isArray(l.finalTodos))return l.finalTodos;let o=null==(s=e.result)?void 0:s.todo_write_result;if((null==o?void 0:o.final_todos)&&Array.isArray(o.final_todos))return o.final_todos;let i=JSON.parse(e.args||"{}");if(Array.isArray(i.todos))return i.todos;let c=JSON.parse(e.rawArgs||"{}");if(Array.isArray(c.todos))return c.todos}catch(e){console.error("Error parsing todo result",e)}return[]},tG=(0,c.memo)(function(e){let{result:t}=e,{filename:r,chunks:n}=(0,c.useMemo)(()=>{var e,r,n,s;let a="";try{let e=JSON.parse(t.rawArgs||"{}");a=(0,_.ow)(e.target_file||e.file_path||"")}catch(e){console.warn("Failed to parse rawArgs:",e)}let l=t.result,o=null;return(null==l||null==(e=l.result)?void 0:e.value)&&"object"==typeof l.result.value&&"diff"in l.result.value&&"object"==typeof l.result.value.diff&&"chunks"in l.result.value.diff?o=l.result.value.diff.chunks:(null==l||null==(n=l.editFileResult)||null==(r=n.diff)?void 0:r.chunks)?o=l.editFileResult.diff.chunks:(null==l||null==(s=l.diff)?void 0:s.chunks)&&(o=l.diff.chunks),{filename:a,chunks:o}},[t]);return null}),tZ=(0,c.memo)(function(e){let{thinkingDurationMs:t}=e,r=t>0?Math.max(1,Math.round(t/1e3)):0;return(0,n.jsxs)("div",{className:"flex items-center gap-2 text-xs text-white/40 mb-1",children:[(0,n.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,n.jsx)(tH,{})}),(0,n.jsxs)("span",{children:["Thought for ",r," second",1!==r?"s":""]})]})}),tV=(0,c.memo)(function(e){let{result:t}=e,r=(0,c.useMemo)(()=>{let e=t.toolName.replace(/_v\d+$/i,"");return"ripgrep_search"===e?"grep_search":"semantic_search_full"===e?"codebase_search":"read_semsearch_files"===e?"read_file":e},[t.toolName]),{argsObj:s,rawArgsObj:a}=(0,c.useMemo)(()=>{let e={},r={};try{e=JSON.parse(t.args||"{}")}catch(e){console.error("Error parsing args",e)}try{r=JSON.parse(t.rawArgs||"{}")}catch(e){console.error("Error parsing rawArgs",e)}return{argsObj:e,rawArgsObj:r}},[t.args,t.rawArgs]),l=(0,c.useMemo)(()=>"todo_write"===r&&tJ(t).length>0,[r,t]),o=(0,c.useMemo)(()=>{if("list_dir"!==r)return"";let e=s.directoryPath||s.relative_workspace_path||a.directoryPath||a.relative_workspace_path;return"string"==typeof e&&""!==e.trim()?(0,_.ow)(e):""},[r,s,a]),i=(0,c.useMemo)(()=>{var e,n,s,a;if("edit_file"!==r||!t.result)return null;let l=t.result,o=null;return(null==l||null==(e=l.result)?void 0:e.value)&&"object"==typeof l.result.value&&"diff"in l.result.value&&"object"==typeof l.result.value.diff&&"chunks"in l.result.value.diff?o=l.result.value.diff.chunks:(null==l||null==(s=l.editFileResult)||null==(n=s.diff)?void 0:n.chunks)?o=l.editFileResult.diff.chunks:(null==l||null==(a=l.diff)?void 0:a.chunks)&&(o=l.diff.chunks),!!o&&o.filter(e=>e.diffString).length>0},[r,t]);return(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[!("edit_file"===r&&i)&&!("todo_write"===r&&l)&&(0,n.jsxs)("div",{className:"group flex items-center gap-2 text-xs text-gray-500 min-w-0 px-1 sm:px-2",children:[(0,n.jsxs)("div",{className:"w-3 h-3 flex items-center justify-center flex-shrink-0",children:["list_dir"===r&&(0,n.jsx)(tM.A,{className:"w-3 h-3"}),"read_file"===r&&(0,n.jsx)(t_.A,{className:"w-3 h-3"}),"edit_file"===r&&(0,n.jsx)(tI.A,{className:"w-3 h-3"}),"run_terminal_cmd"===r&&(0,n.jsx)(tD.A,{className:"w-3 h-3"}),"delete_file"===r&&(0,n.jsx)(tR.A,{className:"w-3 h-3"}),"search_symbols"===r&&(0,n.jsx)(tT.A,{className:"w-3 h-3"}),("read_lints"===r||"fix_lints"===r)&&(0,n.jsx)(tF.A,{className:"w-3 h-3"}),("fetch_pull_request"===r||"fetch_github_issue"===r)&&(0,n.jsx)(tP.A,{className:"w-3 h-3"}),("deep_search"===r||"file_search"===r||"grep_search"===r||"codebase_search"===r||"search_github"===r)&&(0,n.jsx)(eK.A,{className:"w-3 h-3"}),("task"===r||"await_task"===r)&&(0,n.jsx)(tB.A,{className:"w-3 h-3"}),("todo_write"===r||"todo_read"===r)&&(0,n.jsx)(tB.A,{className:"w-3 h-3"}),"web_search"===r&&(0,n.jsx)(eK.A,{className:"w-3 h-3"}),("search_replace"===r||"reapply"===r)&&(0,n.jsx)(tI.A,{className:"w-3 h-3"}),"create_diagram"===r&&(0,n.jsx)(t_.A,{className:"w-3 h-3"}),("fetch_rules"===r||"knowledge_base"===r)&&(0,n.jsx)(tT.A,{className:"w-3 h-3"}),("mcp"===r||"background_composer_followup"===r)&&(0,n.jsx)(ec.A,{className:"w-3 h-3"}),"goto_definition"===r&&(0,n.jsx)(tT.A,{className:"w-3 h-3"}),"go_to_definition"===r&&(0,n.jsx)(tT.A,{className:"w-3 h-3"}),!["list_dir","read_file","edit_file","run_terminal_cmd","delete_file","search_symbols","read_lints","fix_lints","fetch_pull_request","fetch_github_issue","deep_search","task","await_task","todo_write","todo_read","file_search","grep_search","codebase_search","search_github","web_search","search_replace","reapply","create_diagram","fetch_rules","knowledge_base","mcp","background_composer_followup","goto_definition","go_to_definition"].includes(r)&&(0,n.jsx)(n.Fragment,{})]}),(0,n.jsxs)("span",{className:"truncate min-w-0 flex-1",children:["list_dir"===r&&(o?"Listed ".concat(o):"Listed directory contents"),"read_file"===r&&(()=>{try{let e=JSON.parse(t.rawArgs||"{}").target_file;return e?(0,n.jsxs)("span",{className:"break-words",children:["Read ",e.split("/").pop()]}):"Read file"}catch(e){return"Read file"}})(),"edit_file"===r&&(()=>{try{let e=JSON.parse(t.rawArgs||"{}"),r=e.target_file||e.file_path;return r?(0,n.jsxs)("span",{className:"break-words",children:["Edited ",r.split("/").pop()]}):"Edited file"}catch(e){return"Edited file"}})(),"create_file"===r&&(()=>{try{let e=JSON.parse(t.rawArgs||"{}").target_file;return e?(0,n.jsxs)("span",{className:"break-words",children:["Created ",e.split("/").pop()]}):"Created file"}catch(e){return"Created file"}})(),("run_terminal_cmd"===r||"run_terminal_command"===r)&&(()=>{try{let e=JSON.parse(t.args||"{}").command;return e||(e=JSON.parse(t.rawArgs||"{}").command),e&&"string"==typeof e?(0,n.jsxs)("span",{className:"font-mono text-xs",children:["Ran:"," ",e.length>50?"".concat(e.substring(0,50),"..."):e]}):"Ran terminal command"}catch(e){return"Ran terminal command"}})(),"delete_file"===r&&"Deleted file","search_symbols"===r&&"Searched symbols","read_lints"===r&&"Read lints","fix_lints"===r&&"Fixed lints","fetch_pull_request"===r&&"Fetched pull request","fetch_github_issue"===r&&"Fetched GitHub issue","deep_search"===r&&"Deep searched","task"===r&&"Executed task","await_task"===r&&"Awaited task","todo_write"===r&&"Updated todo list","todo_read"===r&&"Read todo list",("file_search"===r||"codebase_search"===r)&&"Searched files","search_github"===r&&"Searched GitHub","grep_search"===r&&(()=>{try{var e;let r=JSON.parse(t.args||"{}"),n=r.query||(null==(e=r.patternInfo)?void 0:e.pattern);return n||(n=JSON.parse(t.rawArgs||"{}").query),n?'Grepped codebase for "'.concat(n,'"'):"Grepped codebase"}catch(e){return"Grepped codebase"}})(),"web_search"===r&&"Searched the web","search_replace"===r&&"Replaced text","reapply"===r&&"Reapplied changes","create_diagram"===r&&"Created diagram","fetch_rules"===r&&"Fetched rules","knowledge_base"===r&&"Accessed knowledge base","mcp"===r&&"Used MCP","background_composer_followup"===r&&"Background composer followup","goto_definition"===r&&"Went to definition","go_to_definition"===r&&"Used go-to-definition",!["list_dir","read_file","edit_file","run_terminal_cmd","delete_file","search_symbols","read_lints","fix_lints","fetch_pull_request","fetch_github_issue","deep_search","task","await_task","todo_write","todo_read","file_search","grep_search","codebase_search","search_github","web_search","search_replace","reapply","create_diagram","fetch_rules","knowledge_base","mcp","background_composer_followup","goto_definition","go_to_definition"].includes(r)&&!!r&&""!==r.trim()&&"Used ".concat(r.replace(/_/g,"-"))]})]}),"edit_file"===r&&t.result&&(0,n.jsx)(tG,{result:t}),"todo_write"===r&&(0,n.jsx)(rn,{result:t})]})}),tK=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;if(t<=0)return"█".repeat(r);let n=Math.min(Math.floor(e/t*r),r),s="█".repeat(n)+"░".repeat(r-n),a=Math.round(e/t*100);return"[".concat(s,"] ").concat(a,"%")},t$=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(0===e)return"0 B";let r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(t<0?0:t))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][r]},tX=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r]},tY=(e,t)=>{if(e.includes("[Status] Acquired repo state – continuing startup")){let e="";return(null==t?void 0:t.data)&&((e=t.data.requestId||t.data.request_id||t.data.id||t.data.composerId||t.data.composer_id||"")||!t.data.event||(e=t.data.event.requestId||t.data.event.request_id||t.data.event.id||"")),"Allocating resources for this agent".concat(e?" (request id: ".concat(e,")"):"","...")}return e.replace(/^\d+;"?>/,"").trim()},tQ=e=>{let t=e.toLowerCase();return!!e.startsWith("[Status]")||["startup completed","starting cursor","cursor started","initialization complete","ready","environment ready","setup complete","allocation complete","resources allocated"].some(e=>t.includes(e))},t0=e=>{let t=e.level,r=e.time,n=e.message,s=new Set(["level","time","message","event","eventId"]),a=["service","component","process_id","pid","hostname","process_arch","process_platform","basePath","devContainerPath"],l=[];for(let t of a)Object.prototype.hasOwnProperty.call(e,t)&&l.push([t,e[t]]);let o=new Set(a);Object.keys(e).filter(e=>!s.has(e)&&!o.has(e)).sort().forEach(t=>l.push([t,e[t]]));let i=[];if(t&&i.push("[".concat(String(t).toUpperCase(),"]")),r)try{i.push(new Date(r).toLocaleTimeString())}catch(e){i.push(String(r))}e.service&&i.push(String(e.service)),n&&i.push(String(n));let c=i.join(" ");if(0===l.length)return{text:c,type:"structured_log",level:t};let d=Math.min(32,l.reduce((e,t)=>{let[r]=t;return Math.max(e,r.length)},0)),u=[c];return l.forEach((e,t)=>{let r,[n,s]=e,a=t===l.length-1,o=n.padEnd(d," ");if(null==s)r=String(s);else if("object"==typeof s)try{r=JSON.stringify(s)}catch(e){r=String(s)}else r=String(s);u.push("  ".concat(a?"└":"├"," ").concat(o,": ").concat(r))}),{text:u.join("\n"),type:"structured_log",level:t}},t1=e=>{var t,r,n,s,a,l,o,i,c,d,u;if(e.interpretedMessage){let t=tY(e.interpretedMessage,e);return tQ(t)?{text:t.startsWith("[Status]")?t.replace("[Status]","").trim():t,type:"status"}:{text:t,type:"interpreted"}}if(null==(t=e.data)?void 0:t.startError){let t=e.data.startError,r=(null==(l=t.details)?void 0:l.title)||"Environment failed to start",n=(null==(o=t.details)?void 0:o.detail)||t.error||"Unknown error";return{text:"Error: ".concat(r,"\nDetails:\n").concat(n),type:"structured_error"}}if(null==(r=e.data)?void 0:r.error)return e.data.error&&"string"==typeof e.data.error&&e.data.error.toLowerCase().includes("node response timed out")?null:{text:"ERROR: ".concat(e.data.error),type:"error"};if(null==(n=e.data)?void 0:n.updatedStatus)return null;if(null==(s=e.data)?void 0:s.event){let t=e.data.event;if(null==(i=t.event)?void 0:i.installStdout){let r=tY(t.event.installStdout,e),n=r.trim();if(n.startsWith("{")&&n.endsWith("}")||n.startsWith("[")&&n.endsWith("]")||n.startsWith('"{')&&n.endsWith('}"'))try{let e=n;n.startsWith('"{')&&n.endsWith('}"')&&(e=JSON.parse(n)),e=e.replace(/[\r\n]+$/,"").trim();let t=JSON.parse(e);if(t&&"object"==typeof t&&!Array.isArray(t)&&(t.level||t.message||t.time))return t0(t);if(t&&("object"==typeof t||Array.isArray(t)))return tX("processLogEntry: detected JSON in installStdout",{originalText:r.substring(0,100),parsedType:Array.isArray(t)?"array":"object",keys:"object"!=typeof t||Array.isArray(t)?[]:Object.keys(t)}),{text:JSON.stringify(t,null,2),type:"json"}}catch(e){}return tQ(r)?{text:r.startsWith("[Status]")?r.replace("[Status]","").trim():r,type:"status"}:{text:r,type:"stdout"}}if(null==(c=t.event)?void 0:c.installStderr)return{text:tY(t.event.installStderr,e),type:"stderr"};if(null==(d=t.event)?void 0:d.stdout){let r=tY(t.event.stdout,e),n=r.trim();if(n.startsWith("{")&&n.endsWith("}")||n.startsWith("[")&&n.endsWith("]")||n.startsWith('"{')&&n.endsWith('}"'))try{let e=n;n.startsWith('"{')&&n.endsWith('}"')&&(e=JSON.parse(n));let t=e.replace(/[\r\n]+$/,"").trim(),s=JSON.parse(t);if(s&&"object"==typeof s&&!Array.isArray(s)&&(s.level||s.message||s.time))return t0(s);if(s&&("object"==typeof s||Array.isArray(s)))return tX("processLogEntry: detected JSON in stdout",{originalText:r.substring(0,100),parsedType:Array.isArray(s)?"array":"object",keys:"object"!=typeof s||Array.isArray(s)?[]:Object.keys(s)}),{text:JSON.stringify(s,null,2),type:"json"}}catch(e){}return tQ(r)?{text:r.startsWith("[Status]")?r.replace("[Status]","").trim():r,type:"status"}:{text:r,type:"stdout"}}else if(null==(u=t.event)?void 0:u.stderr){let r=tY(t.event.stderr,e),n=r.trim();if(n.startsWith("{")&&n.endsWith("}")||n.startsWith("[")&&n.endsWith("]"))try{let e=n.replace(/[\r\n]+$/,"").trim(),t=JSON.parse(e);if(t&&"object"==typeof t&&(t.level||t.message||t.service||t.time||t.pid))return{text:JSON.stringify(t,null,2),type:"json"}}catch(e){}return{text:r,type:"stderr"}}else{let e=Object.keys(t)[0];return e?"eventid"===e.toLowerCase()?null:{text:"event: ".concat(e),type:"event"}:{text:JSON.stringify(t,null,2),type:"json"}}}if(null==(a=e.data)?void 0:a.eventId)return{text:"eventId: ".concat(e.data.eventId),type:"event"};if(e.data&&"string"==typeof e.data){let t=e.data.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]"))try{let r=JSON.parse(t);return t1({...e,data:r})}catch(e){}}if(e.data&&"object"==typeof e.data){let t=e.data;if(t.level||t.message||t.time){let e=t.level,r=t.time,n=t.message,s=new Set(["level","time","message","event","eventId"]),a=["service","component","process_id","pid","hostname","process_arch","process_platform","basePath","devContainerPath"],l=[];for(let e of a)Object.prototype.hasOwnProperty.call(t,e)&&l.push([e,t[e]]);let o=new Set(a);Object.keys(t).filter(e=>!s.has(e)&&!o.has(e)).sort().forEach(e=>{l.push([e,t[e]])});let i=[];if(e&&i.push("[".concat(String(e).toUpperCase(),"]")),r)try{i.push(new Date(r).toLocaleTimeString())}catch(e){i.push(String(r))}t.service&&i.push(String(t.service)),n&&i.push(String(n));let c=i.join(" ");if(0===l.length)return{text:c,type:"structured_log",level:e};let d=Math.min(32,l.reduce((e,t)=>{let[r]=t;return Math.max(e,r.length)},0)),u=[c];return l.forEach((e,t)=>{let r,[n,s]=e,a=t===l.length-1,o=n.padEnd(d," ");if(null==s)r=String(s);else if("object"==typeof s)try{r=JSON.stringify(s)}catch(e){r=String(s)}else r=String(s);u.push("  ".concat(a?"└":"├"," ").concat(o,": ").concat(r))}),{text:u.join("\n"),type:"structured_log",level:e}}}return e.data&&"string"==typeof e.data&&tQ(e.data)?{text:e.data.startsWith("[Status]")?e.data.replace("[Status]","").trim():e.data,type:"status"}:{text:JSON.stringify(e.data,null,2),type:"json"}},t2={dot_cycle:["⣾","⣽","⣻","⢿","⡿","⣟","⣯","⣷"],grow_dot:[".","o","O","@","*"," "]},t5=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,n=t2[e],s=Math.floor(t/r)%n.length;return n[s]},t3=(e,t)=>{switch(e){case"status":return"#88c0d0";case"error":case"structured_error":return"#bf616a";case"stderr":case"installing":return"#ebcb8b";case"stdout":default:return"#d8dee9";case"structured_log":if(t)switch(t.toLowerCase()){case"error":return"#bf616a";case"warn":case"warning":return"#ebcb8b";case"info":return"#88c0d0";case"debug":return"#a3be8c"}return"#d8dee9";case"json":return"#5e81ac";case"event":return"#b48ead"}},t4=e=>{let t,r=e.trim();if(!(r.startsWith("{")||r.startsWith("[")))return null;try{t=JSON.parse(r)}catch(e){return null}let n=[],s=e=>{if(null===e)return[{kind:"null",text:"null"}];switch(typeof e){case"number":return[{kind:"number",text:String(e)}];case"boolean":return[{kind:"boolean",text:String(e)}];case"string":return[{kind:"string",text:e}];default:return[{kind:"plain",text:String(e)}]}},a=(e,t,r,s)=>{n.push({depth:e,isLast:t,ancestorsLast:[...r],parts:s})},l=(e,t,r)=>{if(null===e)return void a(t,!0,r,[{kind:"null",text:"null"}]);if(Array.isArray(e))return 0===e.length?void a(t,!0,r,[{kind:"plain",text:"[]"}]):void e.forEach((n,o)=>{let i=o===e.length-1;null!==n&&"object"==typeof n?(a(t,i,r,[{kind:"plain",text:"(item)"}]),l(n,t+1,[...r,i])):a(t,i,r,s(n))});if("object"==typeof e){let n=Object.entries(e);return 0===n.length?void a(t,!0,r,[{kind:"plain",text:"{}"}]):void n.forEach((e,o)=>{let[i,c]=e,d=o===n.length-1;null!==c&&"object"==typeof c?(a(t,d,r,[{kind:"key",text:i}]),l(c,t+1,[...r,d])):a(t,d,r,[{kind:"key",text:i},{kind:"plain",text:": "},...s(c)])})}a(t,!0,r,s(e))};"object"==typeof t&&null!==t&&Array.isArray(t),l(t,0,[]);let o=e=>e.replace(/[&<>]/g,e=>"&"===e?"&amp;":"<"===e?"&lt;":"&gt;"),i=n.map((e,t)=>{let r=((e,t,r)=>{if(0===t.depth){let t=e.findIndex(e=>0===e.depth),n=(()=>{for(let t=e.length-1;t>=0;t--)if(0===e[t].depth)return t;return e.length-1})();return r===t&&r===n?"└─ ":r===t?"┌─ ":r===n?"└─ ":"│ "}let n=[];for(let e=0;e<t.ancestorsLast.length-1;e++)n.push(t.ancestorsLast[e]?"   ":"│  ");return n.push(t.isLast?"└─ ":"│ "),n.join("")})(n,e,t),s=e.parts.map(e=>{let t=o(e.text);return"plain"===e.kind?t:'<span style="color:'.concat((e=>{switch(e){case"key":return"#88c0d0";case"number":return"#ebcb8b";case"boolean":case"null":return"#b48ead";case"string":return"#a3be8c";default:return"#d8dee9"}})(e.kind),';font-weight:500;">').concat(t,"</span>")}).join("");return'<span style="color:#88c0d0;">'.concat(o(r),"</span>")+s}).join("\n");return{__html:"<pre style=\"color:#d8dee9;font-family:ui-monospace,SFMono-Regular,'SF Mono',Monaco,Consolas,'Liberation Mono','Courier New',monospace;font-size:11px;line-height:1.4;white-space:pre-wrap;margin:0;padding:0;\">".concat(i,"</pre>")}},t8=(0,c.memo)(function(e){let{output:t,progressInfo:r,isSpinning:s,spinnerTick:a}=e;if("structured_error"===t.type){let e=t.text.split("\n"),s=e[0],a=e[1],l=e.slice(2).join("\n");return(0,n.jsxs)("div",{className:"flex flex-col gap-1 min-w-0",children:[(0,n.jsx)("div",{className:"flex gap-3 min-w-0",children:(0,n.jsxs)("pre",{className:"text-xs font-mono flex-shrink-0 whitespace-pre-wrap break-words min-w-0 flex-1 leading-relaxed",children:[(0,n.jsx)("span",{style:{color:"#bf616a"},children:s}),a&&(0,n.jsxs)(n.Fragment,{children:["\n",(0,n.jsx)("span",{style:{color:"#ebcb8b"},children:a})]}),l&&(0,n.jsxs)(n.Fragment,{children:["\n",(0,n.jsx)("span",{style:{color:"#ebcb8b"},children:l})]})]})}),r&&(0,n.jsxs)("div",{className:"ml-2 text-xs",children:["progress"===r.event&&r.transferred&&r.total&&(0,n.jsxs)("div",{className:"flex items-center gap-2 text-cyan-300",children:[(0,n.jsx)("span",{className:"font-mono text-[10px]",children:tK(r.transferred,r.total,30)}),(0,n.jsxs)("span",{className:"text-[10px] text-gray-400",children:[t$(r.transferred)," /"," ",t$(r.total)]})]}),"progress"===r.event&&r.percentage&&!r.transferred&&(0,n.jsx)("div",{className:"flex items-center gap-2 text-cyan-300",children:(0,n.jsx)("span",{className:"font-mono text-[10px]",children:tK(r.percentage,100,30)})}),r.layerId&&r.status&&(0,n.jsxs)("div",{className:"flex items-center gap-2 text-purple-300",children:[(0,n.jsxs)("span",{className:"text-[10px] font-mono",children:["Layer ",r.layerId.substring(0,12),":"]}),(0,n.jsxs)("span",{className:"text-[10px]",children:[r.status,r.percentage&&" ".concat(r.percentage,"%")]})]})]})]})}if("status"===t.type)return(0,n.jsx)("div",{className:"flex flex-col gap-1 min-w-0",children:(0,n.jsxs)("div",{className:"flex gap-2 min-w-0 items-start",children:[s&&(0,n.jsx)("span",{className:"text-xs font-mono flex-shrink-0 mt-0.5",style:{color:t3(t.type,t.level)},children:t5("dot_cycle",150*(a||0),150)}),(0,n.jsx)("pre",{className:"text-xs font-mono flex-shrink-0 whitespace-pre-wrap break-words min-w-0 flex-1 leading-relaxed",style:{color:"#88c0d0"},children:t.text})]})});if("structured_log"===t.type){let e=t.text.split("\n");return(0,n.jsx)("div",{className:"flex flex-col gap-1 min-w-0",children:(0,n.jsx)("div",{className:"flex gap-3 min-w-0",children:(0,n.jsx)("pre",{className:"text-xs font-mono flex-shrink-0 whitespace-pre-wrap break-words min-w-0 flex-1 leading-relaxed",children:e.map((r,s)=>{let a=r.startsWith("  "),l=0===s&&r.includes("[")&&r.includes("]"),o=t3(t.type,t.level);return l?o="#a3be8c":a&&(o="#81a1c1"),(0,n.jsxs)("span",{style:{color:o},children:[r,s<e.length-1&&"\n"]},s)})})})})}if("json"===t.type){let e=t4(t.text);return e?(tX("LogEntryDisplay: rendering highlighted JSON",{textLength:t.text.length}),(0,n.jsx)("div",{className:"flex flex-col gap-1 min-w-0",children:(0,n.jsxs)("div",{className:"flex gap-2 min-w-0 items-start",children:[s&&(0,n.jsx)("span",{className:"text-xs font-mono flex-shrink-0 mt-0.5",style:{color:t3(t.type,t.level)},children:t5("dot_cycle",150*(a||0),150)}),(0,n.jsx)("div",{className:"flex-shrink-0 min-w-0 flex-1",dangerouslySetInnerHTML:e})]})})):(tX("LogEntryDisplay: JSON highlighting failed, using fallback",{text:t.text}),(0,n.jsx)("div",{className:"flex flex-col gap-1 min-w-0",children:(0,n.jsxs)("div",{className:"flex gap-3 min-w-0 items-start",children:[s&&(0,n.jsx)("span",{className:"text-xs font-mono flex-shrink-0 mt-0.5",style:{color:t3(t.type,t.level)},children:t5("dot_cycle",150*(a||0),150)}),(0,n.jsx)("pre",{className:"text-xs font-mono flex-shrink-0 whitespace-pre-wrap break-words min-w-0 flex-1 leading-relaxed",style:{color:t3(t.type,t.level)},children:t.text})]})}))}if(("stdout"===t.type||"stderr"===t.type||"interpreted"===t.type)&&/^\s*[{[]/.test(t.text.trim())&&/[}\]]\s*$/.test(t.text.trim())){let e=t.text.replace(/[\r\n]+$/,"").trim();if(e.startsWith('"{')&&e.endsWith('}"'))try{e=JSON.parse(e)}catch(e){}let r=t4(e);if(r)return tX("LogEntryDisplay: fallback JSON formatting applied",{type:t.type,originalLength:t.text.length,cleanedLength:e.length,firstChars:e.substring(0,50)}),(0,n.jsx)("div",{className:"flex flex-col gap-1 min-w-0",children:(0,n.jsxs)("div",{className:"flex gap-2 min-w-0 items-start",children:[s&&(0,n.jsx)("span",{className:"text-xs font-mono flex-shrink-0 mt-0.5",style:{color:t3(t.type,t.level)},children:t5("dot_cycle",150*(a||0),150)}),(0,n.jsx)("div",{className:"flex-shrink-0 min-w-0 flex-1",dangerouslySetInnerHTML:r})]})})}let l=/(?:\.{3}|…)\s*$/,o=l.test(t.text),i=/(?:starting|loading|initializing|installing|downloading|preparing|building|waiting|allocating)\b/i.test(t.text),c=s&&(o||"status"===t.type||i),d=c?t.text.replace(l,"").trimEnd():t.text;c&&tX("LogEntryDisplay: spinner active",{original:t.text,display:d,endsWithEllipsis:o,indicativeProgress:i,type:t.type});let u=t3(t.type,t.level);return(0,n.jsxs)("div",{className:"flex flex-col gap-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex gap-3 min-w-0 items-start",children:[c&&(0,n.jsx)("span",{className:"text-xs font-mono flex-shrink-0 mt-0.5",style:{color:u},children:t5("dot_cycle",150*(a||0),150)}),(0,n.jsx)("pre",{className:"text-xs font-mono flex-shrink-0 whitespace-pre-wrap break-words min-w-0 flex-1 leading-relaxed tabular-nums kerning-none",style:{color:u,letterSpacing:"0.00982143em"},children:d})]}),r&&(0,n.jsxs)("div",{className:"ml-2 text-xs",children:["progress"===r.event&&r.transferred&&r.total&&(0,n.jsxs)("div",{className:"flex items-center gap-2 text-cyan-300",children:[(0,n.jsx)("span",{className:"font-mono text-[10px]",children:tK(r.transferred,r.total,30)}),(0,n.jsxs)("span",{className:"text-[10px] text-gray-400",children:[t$(r.transferred)," /"," ",t$(r.total)]})]}),"progress"===r.event&&r.percentage&&!r.transferred&&(0,n.jsx)("div",{className:"flex items-center gap-2 text-cyan-300",children:(0,n.jsx)("span",{className:"font-mono text-[10px]",children:tK(r.percentage,100,30)})}),r.layerId&&r.status&&(0,n.jsxs)("div",{className:"flex items-center gap-2 text-purple-300",children:[(0,n.jsxs)("span",{className:"text-[10px] font-mono",children:["Layer ",r.layerId.substring(0,12),":"]}),(0,n.jsxs)("span",{className:"text-[10px]",children:[r.status,r.percentage&&" ".concat(r.percentage,"%")]})]})]})]})}),t6=(0,c.memo)(function(e){let{logs:t}=e,r=(0,c.useRef)(null),[s,a]=(0,c.useState)(new Set),[l,o]=(0,c.useState)(0);(0,c.useEffect)(()=>{if(0===s.size)return;let e=setInterval(()=>{o(e=>e+1)},150);return()=>clearInterval(e)},[s.size]);let i=(0,c.useMemo)(()=>{if(!t||0===t.length)return[];let e=new Set,r=t.filter(e=>{var t,r,n,s,a,l;if((null==(t=e.data)?void 0:t.eventId)&&1===Object.keys(e.data).length)return!1;if(null==(r=e.data)?void 0:r.event){let t=e.data.event;if(!(null==(n=t.event)?void 0:n.installStdout)&&!(null==(s=t.event)?void 0:s.installStderr)&&!(null==(a=t.event)?void 0:a.stdout)&&!(null==(l=t.event)?void 0:l.stderr)&&"eventID"===Object.keys(t)[0])return!1}return!0}).map((t,r)=>{let n=t1(t);if(!n||!n.text.trim())return null;/^Installing\b/i.test(n.text)&&(n.type="installing");let s=tq(n.text+(n.type||""));if(e.has(s))return null;e.add(s);let a=(e=>{tX("parseDownloadProgress: evaluating text",e.slice(0,200));try{let t=JSON.parse(e);if(t.event)return tX("parseDownloadProgress: detected structured progress JSON"),t}catch(e){}return null})(n.text),l=(e=>{let t=e.match(/Layer\s+([a-f0-9]{8,}):?\s*(downloading|extracting)\s*(\d+)%?/i);if(t)return tX("parseDockerProgress: matched layer progress",t[1]),{layerId:t[1],status:t[2],percentage:parseInt(t[3])||0};let r=e.match(/Layer\s+([a-f0-9]{8,}):?\s*(.*)/i);return r?{layerId:r[1],status:r[2].trim()}:null})(n.text),o=(e=>{if(!/^Installing\b/i.test(e))return null;let t=e.match(/(\b|\s)(\d{1,3})%/);return t?{event:"progress",percentage:Math.min(100,parseInt(t[2],10))}:null})(n.text);return{key:"log-".concat(t.chunkIndex,"-").concat(r),output:n,progressInfo:a||l||o||null}}).filter(e=>null!==e);return tX("processedLogs summary",{count:r.length}),r},[t]);(0,c.useEffect)(()=>{let e=null;for(let t=i.length-1;t>=0;t--){let r=i[t],n=r.output.text.toLowerCase(),s=/(?:\.{3}|…)\s*$/.test(n),a=/\b(starting|loading|initializing|installing|downloading|preparing|building|waiting|allocating)\b/.test(n);if(s||"status"===r.output.type||a){e=r.key;break}}a(t=>{if(!e&&0===t.size||e&&1===t.size&&t.has(e))return t;let r=new Set;return e&&r.add(e),r})},[i]),(0,c.useEffect)(()=>{if(r.current&&i.length>0){let e=r.current;e.scrollTop=e.scrollHeight}},[i.length]);let d=i.length>0;return t&&0!==t.length?(0,n.jsxs)("div",{className:"flex flex-col gap-2 mt-2 h-full",children:[(0,n.jsxs)("div",{className:"flex items-center px-2 py-1 gap-2 text-gray-500 opacity-60 text-[12px]",children:[(0,n.jsx)(ec.A,{className:"w-3 h-3"}),(0,n.jsxs)("div",{className:"flex items-center gap-0",children:[(0,n.jsx)("span",{className:"flex make-shine items-center",children:"Starting up background agent"}),(0,n.jsx)(er,{})]})]}),d&&(0,n.jsx)("div",{className:"bg-[#191c22] h-full border rounded-lg font-mono text-sm overflow-hidden w-full",style:{borderColor:"rgba(139, 148, 158, 0.25)"},children:(0,n.jsx)("div",{ref:r,className:"h-full p-2 w-full overflow-y-auto",children:i.map(e=>(0,n.jsx)(t8,{output:e.output,progressInfo:e.progressInfo,isSpinning:s.has(e.key),spinnerTick:l},e.key))})})]}):null}),t7=(0,c.memo)(function(e){let{message:t,inSidebar:r,onFilenameClick:s,isFirstMessage:a,isFirstMessageExpanded:l,onFirstMessageToggle:o}=e,i=(0,c.useRef)(null),[d,u]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!a)return;let e=i.current;if(!e)return;let t=()=>{if(!e)return;let t=e.scrollHeight>202;u(e=>e!==t?t:e)};t();let r=requestAnimationFrame(t),n=null;return"undefined"!=typeof ResizeObserver&&(n=new ResizeObserver(()=>t())).observe(e),()=>{cancelAnimationFrame(r),n&&n.disconnect()}},[a,t.text]);let m=(0,c.useMemo)(()=>{if(r&&s)return{code:e=>{let{children:t,...r}=e,a=String(t).replace(/\n$/,"");return(/\.(js|jsx|ts|tsx|py|java|cpp|c|h|css|scss|html|xml|json|md|txt|yml|yaml|toml|ini|cfg|conf|sh|bat|sql|php|rb|go|rs|swift|kt|dart|vue|svelte|sol|move|cairo)$/i.test(a)||/[/\\]/.test(a)&&a.length>1||/^(Dockerfile|Makefile|README|LICENSE|CHANGELOG|package\.json|yarn\.lock|package-lock\.json|requirements\.txt|Cargo\.toml|go\.mod|pom\.xml|build\.gradle|webpack\.config\.js|tsconfig\.json|\.env|\.gitignore|\.dockerignore)$/i.test(a))&&s?(0,n.jsx)("code",{...r,className:"break-words whitespace-pre-wrap text-[11px] text-[#88C0D0] cursor-pointer hover:bg-[#262c34] rounded transition-colors",onClick:e=>{e.stopPropagation(),s(a)},title:"Click to view ".concat(a),children:t}):(0,n.jsx)("code",{...r,className:"break-words whitespace-pre-wrap text-[11px] text-[#88C0D0]",children:t})}}},[r,s]),p=(0,c.useMemo)(()=>(0,n.jsx)(Z.oz,{components:m,children:tW(t.text)}),[t.text,m]);if(t.type===ey.Jc.HUMAN){let e=a&&!l&&d,r=a&&d&&!l;return(0,n.jsxs)("div",{className:"bg-[#1B1D21] border border-white/5 w-full rounded-lg p-2 overflow-hidden min-w-0 relative ".concat(r?"cursor-pointer hover:bg-[#212326] transition-colors":""),onClick:r?o:void 0,children:[(0,n.jsx)("div",{ref:i,className:"text-[13px] whitespace-pre-wrap w-full text-white/[0.7] break-words overflow-wrap-anywhere hyphens-auto ".concat(e?"max-h-[200px] overflow-hidden":""),children:t.text}),e&&(0,n.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-transparent to-transparent pointer-events-none"})]})}return(0,n.jsx)("div",{className:"text-[13px] leading-[1.4] [&_code]:text-[13px] text-gray-300 prose prose-invert prose-sm max-w-none min-w-0 [&_code]:break-words [&_code]:whitespace-pre-wrap [&_code]:text-[#88C0D0] [&_strong]:text-gray-300 [&_h1]:text-[16px] [&_h1]:text-gray-300 [&_h2]:text-[15px] [&_h2]:text-gray-300 [&_h3]:text-[14px] [&_h3]:text-gray-300 [&_li_code]:break-words [&_li_code]:overflow-wrap-anywhere [&_pre]:overflow-hidden [&_pre]:break-words [&_pre]:whitespace-pre-wrap [&_li::marker]:text-gray-500 [&_p]:break-words [&_p]:overflow-wrap-anywhere [&_p]:break-words [&_*]:max-w-full px-1 sm:px-2 [&_code]:before:content-none [&_code]:after:content-none overflow-hidden break-words",children:p})}),t9=(0,c.memo)(function(e){let{action:t,actionIndex:r,groupId:s,expandedActions:a,setExpandedActions:l}=e,o="tool"===t.type&&"todo_write"!==t.toolName&&t.details,i="".concat(s,"-action-").concat(r),d=a.has(i),u=(0,c.useMemo)(()=>"thinking"===t.type&&!!t.text||"tool"===t.type&&"todo_write"===t.toolName&&!!t.details&&tJ(t.details).length>0,[t]),m=(0,c.useCallback)(()=>{if(!u)return;let e=new Set(a);d?e.delete(i):e.add(i),l(e)},[u,d,i,a,l]);return o?(0,n.jsx)("div",{className:"flex flex-col gap-1 min-w-0",children:(0,n.jsx)(tV,{result:t.details})}):(0,n.jsxs)("div",{className:"flex flex-col gap-1 min-w-0 px-1 sm:px-2",children:[(0,n.jsxs)("div",{className:"group flex items-center gap-2 text-xs text-gray-500 min-w-0 ".concat(u?"cursor-pointer hover:text-gray-400 transition-colors":""),onClick:m,children:[(0,n.jsx)("div",{className:"w-3 h-3 flex items-center justify-center flex-shrink-0",children:u?(0,n.jsxs)(n.Fragment,{children:["tool"===t.type&&"todo_write"===t.toolName?(0,n.jsx)(tB.A,{className:"w-3 h-3 group-hover:hidden"}):(0,n.jsx)(tH,{className:"w-3 h-3 group-hover:hidden"}),(0,n.jsx)(tO.A,{className:"w-3 h-3 min-w-3 flex-shrink-0 min-h-3 hidden group-hover:block transform transition-transform ".concat(d?"rotate-90":"")})]}):"tool"===t.type&&"todo_write"===t.toolName?(0,n.jsx)(tB.A,{className:"w-3 h-3"}):(0,n.jsx)(tH,{className:"w-3 h-3"})}),(0,n.jsx)("span",{className:"break-words min-w-0 flex-1",children:"tool"===t.type&&"todo_write"===t.toolName?"Updated todo list":(()=>{let e=(t.duration||0)>0?Math.max(1,Math.round((t.duration||0)/1e3)):0;return"Thought for ".concat(e," second").concat(1!==e?"s":"")})()})]}),"thinking"===t.type&&t.text&&d&&(0,n.jsx)("div",{className:"text-xs text-gray-500 prose prose-invert prose-sm max-w-none min-w-0 [&_code]:break-words [&_code]:whitespace-pre-wrap [&_code]:text-[#88C0D0] [&_strong]:text-gray-500 [&_h1]:text-gray-500 [&_h2]:text-gray-500 [&_h3]:text-gray-500 [&_li_code]:break-words [&_li_code]:overflow-wrap-anywhere [&_pre]:overflow-x-auto [&_pre]:max-w-full [&_pre]:scrollbar-thin [&_li::marker]:text-gray-500",children:(0,n.jsx)(Z.oz,{children:t.text})}),"tool"===t.type&&"todo_write"===t.toolName&&t.details&&d&&(0,n.jsx)(rn,{result:t.details,isNested:!0})]})}),re=(0,c.memo)(function(e){var t;let{group:r,inSidebar:s,onFilenameClick:a,isFirstMessage:l,isFirstMessageExpanded:o,onFirstMessageToggle:i}=e,c=r.message,d=c.thinking&&c.thinkingDurationMs&&c.thinkingDurationMs>0,u=c.text&&c.text.trim().length>0,m=c.toolResults&&c.toolResults.length>0,p=d&&!u&&!m;return(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[d&&(0,n.jsx)(tZ,{thinkingDurationMs:c.thinkingDurationMs||0}),p&&(null==(t=c.thinking)?void 0:t.text)&&(0,n.jsx)("div",{className:"text-[13px] whitespace-pre-wrap text-white/30",children:c.thinking.text}),u&&(0,n.jsx)(t7,{message:c,inSidebar:s,onFilenameClick:a,isFirstMessage:l,isFirstMessageExpanded:o,onFirstMessageToggle:i}),m&&(0,n.jsx)("div",{className:"flex flex-col gap-2",children:c.toolResults.map((e,t)=>(0,n.jsx)(tV,{result:e},e.toolCallId||"tool-result-".concat(t)))})]})}),rt=(0,c.memo)(function(e){let{group:t,groupIndex:r,expandedGroups:s,setExpandedGroups:a,expandedActions:l,setExpandedActions:o,isLoading:i,isLastGroup:d}=e,u=t.totalThinkingTime>0?Math.max(1,Math.round(t.totalThinkingTime/1e3)):0,m=t.actions.filter(e=>"tool"===e.type),p=i&&1===t.actions.length,x=(0,c.useCallback)(e=>{let t=e.replace(/_v\d+$/i,"");return"ripgrep_search"===t?"grep_search":"semantic_search_full"===t?"codebase_search":"read_semsearch_files"===t?"read_file":t},[]),{summaryText:f}=(0,c.useMemo)(()=>{let e=new Map,r=[],n=[],s=[];m.forEach(t=>{var a,l,o,i;let c=x(t.toolName);switch(c){case"list_dir":c="list_dir";try{let e=t.details&&"list_dir"===c&&t.details.result&&t.details.result.result&&t.details.result.result.value&&"files"in t.details.result.result.value&&Array.isArray(t.details.result.result.value.files)?t.details.result.result.value.files.length:0;s.push(e)}catch(e){s.push(0)}break;case"read_file":c="read_file";try{let e=JSON.parse((null==(a=t.details)?void 0:a.args)||"{}").relativeWorkspacePath;e||(e=JSON.parse((null==(l=t.details)?void 0:l.rawArgs)||"{}").target_file),e&&r.push(e)}catch(e){}break;case"edit_file":c="edit_file";break;case"delete_file":c="delete_file";try{let e=JSON.parse((null==(o=t.details)?void 0:o.args)||"{}").relativeWorkspacePath;e||(e=JSON.parse((null==(i=t.details)?void 0:i.rawArgs)||"{}").target_file),e&&n.push(e)}catch(e){}break;case"file_search":case"codebase_search":case"grep_search":c="search"}e.set(c,(e.get(c)||0)+1)});let a=[...new Set(r)],l=[...new Set(n)],o=e=>0===e.length?"":1===e.length?e[0]:2===e.length?"".concat(e[0]," and ").concat(e[1]):"".concat(e.slice(0,-1).join(", ")," and ").concat(e[e.length-1]),i=Array.from(e.entries()).map((t,r)=>{var n,i,c,d,u;let p,[f,h]=t,g="";switch(f){case"list_dir":if(0===h)g="listed items in current directory";else if(1===h){let e=s[0]||0;g=0===e?"listed items in current directory":"listed ".concat(e," items in current directory")}else{let e=s.reduce((e,t)=>e+("number"==typeof t?t:0),0);g=e>0?"listed ".concat(e," items in ").concat(h," directories"):"listed items in ".concat(h," directories")}break;case"read_file":g=a.length>0?1===a.length?"read ".concat(a[0].split("/").pop()):a.length<=3?"read ".concat(o(a.map(e=>e.split("/").pop()).filter(e=>!!e))):"read ".concat(a.length," files"):1===h?"read file":"read ".concat(h," files");break;case"edit_file":g=1===h?"edited file":"edited ".concat(h," files");break;case"run_terminal_cmd":if(1===h&&1===e.size){let e=m.find(e=>"run_terminal_cmd"===e.toolName.replace(/_v\d+$/i,""));if(e)try{let t=JSON.parse((null==(n=e.details)?void 0:n.args)||"{}").command;t||(t=JSON.parse((null==(i=e.details)?void 0:i.rawArgs)||"{}").command),g=t&&"string"==typeof t?"ran: ".concat(t.length>50?"".concat(t.substring(0,50),"..."):t):"ran terminal command"}catch(e){g="ran terminal command"}else g="ran terminal command"}else g=1===h?"ran terminal command":"ran ".concat(h," terminal commands");break;case"delete_file":g=l.length>0?1===l.length?"deleted ".concat(l[0].split("/").pop()):l.length<=3?"deleted ".concat(o(l.map(e=>e.split("/").pop()).filter(e=>!!e))):"deleted ".concat(l.length," files"):1===h?"deleted file":"deleted ".concat(h," files");break;case"search":if(1===h&&1===e.size){let e=m.find(e=>["grep_search","file_search","codebase_search","web_search","search_github","deep_search"].includes(x(e.toolName)));if(e)try{let t=JSON.parse((null==(c=e.details)?void 0:c.args)||"{}"),r=t.query||(null==(d=t.patternInfo)?void 0:d.pattern)||t.search_term;if(!r){let t=JSON.parse((null==(u=e.details)?void 0:u.rawArgs)||"{}");r=t.query||t.search_term}if(r){let t=x(e.toolName);g="grep_search"===t?'grepped codebase for "'.concat(r,'"'):"web_search"===t?'searched web for "'.concat(r,'"'):"search_github"===t?'searched GitHub for "'.concat(r,'"'):'searched for "'.concat(r,'"')}else g="searched"}catch(e){g="searched"}else g="searched"}else g=1===h?"searched":2===h?"searched twice":"searched ".concat(h," times");break;case"web_search":g=1===h?"searched the web":"searched the web ".concat(h," times");break;case"todo_write":g=1===h?"updated todo list":"updated todo list ".concat(h," times");break;case"search_replace":g=1===h?"replaced text":"replaced text ".concat(h," times");break;default:g=f&&""!==f.trim()?1===h?"used ".concat(f):"used ".concat(f," ").concat(h," times"):"planning next moves"}return 0===r?(p=g).charAt(0).toUpperCase()+p.slice(1):g}),c=[];return i.length>0&&u>0?c.push("".concat(o(i)," and thought for ").concat(u,"s")):(i.length>0&&c.push(o(i)),u>0&&(p?c.push("Planning next moves"):c.push("Thought for ".concat(u,"s")))),0===c.length&&t.actions.length>0&&c.push("Planning next moves"),{summaryText:c.join(", "),summaryParts:c}},[m,u,t.actions.length,p,x]),h=(0,c.useMemo)(()=>{var e;let n=null!=(e=t.startIndex)?e:r;return"combined-".concat(n)},[t.startIndex,r]),g=s.has(h),v=(0,c.useMemo)(()=>{if(t.actions.length>1)return!0;if(1===t.actions.length){let e=t.actions[0];if("thinking"===e.type&&e.text)return!0;if("tool"===e.type&&"todo_write"===e.toolName&&e.details)return tJ(e.details).length>0}return!1},[t.actions]),b=(0,c.useMemo)(()=>{if(!d||!v||1!==t.actions.length)return!1;let e=t.actions[0];return"thinking"===e.type&&!!e.text},[d,v,t.actions]),w=(0,c.useMemo)(()=>{if(0===t.actions.length)return(0,n.jsx)(tH,{className:"w-3 h-3 mt-0.5"});if(t.actions.length>1){let e=t.actions.filter(e=>"tool"===e.type);if(e.length>0){let t=e=>{let t=x(e);switch(t){case"file_search":case"codebase_search":case"grep_search":case"deep_search":case"web_search":case"search_github":return"search";case"search_replace":case"reapply":return"search_replace";case"read_lints":case"fix_lints":return"read_lints";case"fetch_pull_request":case"fetch_github_issue":return"fetch_pull_request";case"task":case"await_task":return"task";case"todo_write":case"todo_read":return"todo_write";default:return t}},r=t(e[0].toolName);if(e.every(e=>t(e.toolName)===r))switch(r){case"list_dir":default:break;case"read_file":case"create_diagram":return(0,n.jsx)(t_.A,{className:"w-3 h-3 mt-0.5"});case"edit_file":case"search_replace":return(0,n.jsx)(tI.A,{className:"w-3 h-3 mt-0.5"});case"run_terminal_cmd":return(0,n.jsx)(tD.A,{className:"w-3 h-3 mt-0.5"});case"delete_file":return(0,n.jsx)(tR.A,{className:"w-3 h-3 mt-0.5"});case"search_symbols":case"fetch_rules":case"knowledge_base":case"goto_definition":return(0,n.jsx)(tT.A,{className:"w-3 h-3 mt-0.5"});case"read_lints":return(0,n.jsx)(tF.A,{className:"w-3 h-3 mt-0.5"});case"fetch_pull_request":return(0,n.jsx)(tP.A,{className:"w-3 h-3 mt-0.5"});case"search":return(0,n.jsx)(eK.A,{className:"w-3 h-3 mt-0.5"});case"task":case"todo_write":return(0,n.jsx)(tB.A,{className:"w-3 h-3 mt-0.5"});case"mcp":case"background_composer_followup":return(0,n.jsx)(ec.A,{className:"w-3 h-3 mt-0.5"})}}return(0,n.jsx)(tM.A,{className:"w-3 h-3 mt-0.5"})}let e=t.actions[0];if("thinking"===e.type)return(0,n.jsx)(tH,{className:"w-3 h-3 mt-0.5"});switch(x(e.toolName)){case"list_dir":return(0,n.jsx)(tM.A,{className:"w-3 h-3 mt-0.5"});case"read_file":case"create_diagram":return(0,n.jsx)(t_.A,{className:"w-3 h-3 mt-0.5"});case"edit_file":case"search_replace":case"reapply":return(0,n.jsx)(tI.A,{className:"w-3 h-3 mt-0.5"});case"run_terminal_cmd":return(0,n.jsx)(tD.A,{className:"w-3 h-3 mt-0.5"});case"delete_file":return(0,n.jsx)(tR.A,{className:"w-3 h-3 mt-0.5"});case"search_symbols":case"fetch_rules":case"knowledge_base":case"goto_definition":return(0,n.jsx)(tT.A,{className:"w-3 h-3 mt-0.5"});case"read_lints":case"fix_lints":return(0,n.jsx)(tF.A,{className:"w-3 h-3 mt-0.5"});case"fetch_pull_request":case"fetch_github_issue":return(0,n.jsx)(tP.A,{className:"w-3 h-3 mt-0.5"});case"deep_search":case"file_search":case"grep_search":case"codebase_search":case"web_search":case"search_github":return(0,n.jsx)(eK.A,{className:"w-3 h-3 mt-0.5"});case"task":case"await_task":case"todo_write":case"todo_read":return(0,n.jsx)(tB.A,{className:"w-3 h-3 mt-0.5"});case"mcp":case"background_composer_followup":return(0,n.jsx)(ec.A,{className:"w-3 h-3 mt-0.5"});default:return(0,n.jsx)(tH,{className:"w-3 h-3 mt-0.5"})}},[t.actions,x]),y=(0,c.useCallback)(()=>{if(!v)return;let e=new Set(s);g?e.delete(h):e.add(h),a(e)},[v,g,h,s,a]);return(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[b?(0,n.jsx)("div",{className:"text-xs text-gray-500 px-1 sm:px-2 min-w-0 prose prose-invert prose-sm max-w-none [&_code]:break-words [&_code]:whitespace-pre-wrap [&_code]:text-[#88C0D0]",children:(0,n.jsx)(Z.oz,{children:t.actions[0].text||""})}):p?(0,n.jsxs)("div",{className:"flex items-start gap-2 text-xs text-gray-500 min-w-0",children:[(0,n.jsx)(tH,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),(0,n.jsx)("span",{className:"make-shine break-words min-w-0 flex-1",children:f})]}):v?(0,n.jsxs)("div",{className:"group flex items-start gap-2 text-xs text-gray-500 cursor-pointer hover:text-white/80 transition-colors px-1 sm:px-2 min-w-0",onClick:y,children:[(0,n.jsx)("div",{className:"group-hover:hidden flex-shrink-0",children:w}),(0,n.jsx)(tO.A,{className:"w-3 h-3 min-w-3 flex-shrink-0 min-h-3 mt-0.5 hidden group-hover:block transform transition-transform ".concat(g?"rotate-90":"")}),(0,n.jsx)("span",{className:"break-words min-w-0 flex-1",children:f})]}):(0,n.jsxs)("div",{className:"flex items-start gap-2 text-xs text-gray-500 px-1 sm:px-2 min-w-0",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:w}),(0,n.jsx)("span",{className:"break-words min-w-0 flex-1 ".concat("Planning next moves"===f?"make-shine":""),children:f})]}),g&&!p&&!b&&(0,n.jsx)("div",{className:"ml-7 flex flex-col gap-2",children:1===t.actions.length?(()=>{let e=t.actions[0];return"thinking"===e.type&&e.text?(0,n.jsx)("div",{className:"text-xs text-gray-500 prose prose-invert prose-sm max-w-none min-w-0 [&_code]:break-words [&_code]:whitespace-pre-wrap [&_code]:text-[#88C0D0] [&_strong]:text-gray-500 [&_h1]:text-gray-500 [&_h2]:text-gray-500 [&_h3]:text-gray-500 [&_li_code]:break-words [&_li_code]:overflow-wrap-anywhere [&_pre]:overflow-x-auto [&_pre]:max-w-full [&_pre]:scrollbar-thin",children:(0,n.jsx)(Z.oz,{children:e.text})}):"tool"===e.type&&"todo_write"===e.toolName&&e.details?(0,n.jsx)(rn,{result:e.details}):null})():t.actions.map((e,t)=>{var r;let s=(null==(r=e.details)?void 0:r.toolCallId)||"".concat(e.type,"-").concat(e.toolName,"-").concat(e.text?tq(e.text):"","-").concat(e.duration||0);return(0,n.jsx)(t9,{action:e,actionIndex:t,groupId:h,expandedActions:l,setExpandedActions:o},s)})})]})}),rr=(0,c.memo)(function(e){let{group:t,groupIndex:r,expandedGroups:s,setExpandedGroups:a,expandedActions:l,setExpandedActions:o,isLoading:i,inSidebar:c,onFilenameClick:d,isFirstMessage:u,isFirstMessageExpanded:m,onFirstMessageToggle:p,isLastGroup:x}=e;return"single"===t.type?(0,n.jsx)(re,{group:t,inSidebar:c,onFilenameClick:d,isFirstMessage:u,isFirstMessageExpanded:m,onFirstMessageToggle:p}):(0,n.jsx)(rt,{group:t,groupIndex:r,expandedGroups:s,setExpandedGroups:a,expandedActions:l,setExpandedActions:o,isLoading:i,isLastGroup:x})}),rn=(0,c.memo)(function(e){let{result:t,isNested:r=!1}=e,{todos:s}=(0,c.useMemo)(()=>({todos:tJ(t)}),[t]);return s&&0!==s.length?(0,n.jsx)("div",{className:"space-y-1.5 ".concat(r?"ml-5":""),children:s.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,n.jsx)("div",{className:"flex-shrink-0 mt-[1.5px]",children:"completed"===e.status?(0,n.jsx)(tz.A,{className:"w-3 h-3 text-gray-500/50"}):(0,n.jsx)(tU.A,{className:"w-3 h-3 text-gray-500"})}),(0,n.jsx)("div",{className:"flex-1 min-w-0",children:(0,n.jsx)("div",{className:"text-xs ".concat("completed"===e.status?"line-through text-gray-500/50":"text-gray-500"),children:e.content})})]},e.id||t))}):null});function rs(e){let{conversation:t,logs:r,isLoading:s=!1,inSidebar:a=!0,hasComposer:l=!1,hasDiff:o=!1,onFilenameClick:i,isComposerKilled:d,externalScrollRef:u}=e,[m,p]=(0,c.useState)(new Set),[x,f]=(0,c.useState)(new Set),[h,g]=(0,c.useState)(24),[v,b]=(0,c.useState)(!1),w=(0,c.useRef)(null),y=(0,c.useRef)(null),[j,C]=(0,c.useState)(!0),[N,k]=(0,c.useState)(!1),S=u||w,E=!u,L=(0,c.useRef)({length:0,lastMessageText:"",lastMessageToolResults:0}),A=(0,c.useRef)(null),M=(0,c.useRef)(null),_=(0,c.useRef)(null);(0,c.useEffect)(()=>()=>{A.current&&(clearTimeout(A.current),A.current=null),M.current&&(clearTimeout(M.current),M.current=null),_.current&&(clearTimeout(_.current),_.current=null)},[]);let I=(0,c.useCallback)(()=>{S.current&&(y.current=S.current.scrollTop),g(e=>e+8)},[S]),D=(0,c.useCallback)(()=>{if(!S.current)return!1;let e=S.current;return e.scrollHeight-e.scrollTop-e.clientHeight<=150},[S]),R=(0,c.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!S.current)return;let t=S.current,r=()=>{t&&(e?t.scrollTo({top:t.scrollHeight,behavior:"smooth"}):t.scrollTop=t.scrollHeight)};requestAnimationFrame(()=>{requestAnimationFrame(r)})},[S]);(0,c.useEffect)(()=>{if(!E||!S.current)return;let e=S.current,t=()=>{N||(M.current&&clearTimeout(M.current),M.current=setTimeout(()=>{if(!e)return;let t=e.scrollHeight-e.scrollTop-e.clientHeight,r=t<=300;!r&&t>500?C(!1):r&&C(!0),M.current=null},100))};return e.addEventListener("scroll",t,{passive:!0}),()=>{e.removeEventListener("scroll",t),M.current&&(clearTimeout(M.current),M.current=null)}},[E,S,N]),(0,c.useEffect)(()=>{E&&t.length>0&&0===L.current.length&&setTimeout(()=>{if(!S.current)return;let e=D();C(e),e&&R(!1)},300)},[t.length,R,E,S,D]),(0,c.useEffect)(()=>{E&&null!==y.current&&S.current&&(S.current.scrollTop=y.current,y.current=null)},[h,E,S]),(0,c.useEffect)(()=>{var e;if(!E||!S.current||0===t.length||null!==y.current)return;let r=t.length,n=t[t.length-1],s=(null==n?void 0:n.text)||"",a=(null==n||null==(e=n.toolResults)?void 0:e.length)||0,l=L.current,o=r>l.length,i=s!==l.lastMessageText,c=a>l.lastMessageToolResults;return(o||i||c)&&j&&(o||c?(A.current&&(clearTimeout(A.current),A.current=null),R(!1)):i&&(k(!0),A.current&&clearTimeout(A.current),_.current&&clearTimeout(_.current),A.current=setTimeout(()=>{j&&R(!1),A.current=null},32),_.current=setTimeout(()=>{k(!1),_.current=null},200))),L.current={length:r,lastMessageText:s,lastMessageToolResults:a},()=>{A.current&&(clearTimeout(A.current),A.current=null),_.current&&(clearTimeout(_.current),_.current=null)}},[t,j,R,E,S]);let{allGroups:T,visibleGroups:F}=(0,c.useMemo)(()=>{let e=[],r=null;t.forEach((t,n)=>{let s=t.thinking&&t.thinkingDurationMs&&t.thinkingDurationMs>0,a=t.toolResults&&t.toolResults.length>0,l=t.text&&t.text.trim().length>0;if(!(l||s||a))return;let o=a&&t.toolResults.some(e=>"edit_file"===e.toolName);if(t.type===ey.Jc.HUMAN||l||o)r&&(e.push(r),r=null),e.push({type:"single",message:t,index:n,totalThinkingTime:0,actions:[]});else if((a||s)&&(r||(r={type:"combined",actions:[],totalThinkingTime:0,startIndex:n,message:t}),a&&r&&t.toolResults.forEach(e=>{null==r||r.actions.push({type:"tool",toolName:e.toolName,details:e})}),s&&r)){var i;r.totalThinkingTime+=t.thinkingDurationMs||0,(null==(i=t.thinking)?void 0:i.text)&&!a&&r.actions.push({type:"thinking",toolName:"",text:t.thinking.text,duration:t.thinkingDurationMs})}}),r&&e.push(r);let n=e.slice(-h);return{allGroups:e,visibleGroups:n}},[t,h]),P=Math.max(0,T.length-h),B=t.some(e=>!e.isTemporary);return(!s||B||r&&0!==r.length||o)&&l?B||r&&0!==r.length?(0,n.jsxs)("div",{ref:E?w:void 0,className:"flex flex-col gap-3 min-w-0 ".concat(E&&a?"overflow-y-auto overflow-x-hidden max-h-full px-2 sm:px-4 pb-20 lg:pt-12":E?"h-fit overflow-hidden px-0 pb-20":"px-0 lg:px-4 pb-20 lg:pt-12"),children:[P>0&&(0,n.jsx)("div",{className:"flex justify-center w-full",children:(0,n.jsxs)("button",{onClick:I,className:"text-xs gap-x-1 justify-center items-center text-gray-500 hover:text-gray-300 transition-colors w-full p-2 flex",children:[(0,n.jsx)(H.A,{className:"w-2 h-2"}),P," earlier message",1!==P?"s":"",(0,n.jsx)(H.A,{className:"w-2 h-2"})]})}),F.map((e,r)=>{let l=e.message.bubbleId||"".concat(e.type,"-").concat(e.index||e.startIndex,"-").concat(e.message.text?tq(e.message.text.substring(0,100)):"","-").concat(e.message.type),o="single"===e.type&&e.message.type===ey.Jc.HUMAN&&t.findIndex(e=>e.type===ey.Jc.HUMAN)===(e.index||0),c=r===F.length-1;return(0,n.jsx)(rr,{group:e,groupIndex:r,expandedGroups:m,setExpandedGroups:p,expandedActions:x,setExpandedActions:f,isLoading:s,inSidebar:a,onFilenameClick:i,isFirstMessage:o,isFirstMessageExpanded:v,onFirstMessageToggle:()=>b(!v),isLastGroup:c},l)}),(()=>{let e=!t.some(e=>!e.isTemporary),s=t.filter(e=>!e.isTemporary),i=s.filter(e=>e.type===ey.Jc.HUMAN).length,c=s.filter(e=>e.type===ey.Jc.AI).length,d=1===s.length&&1===i||2===s.length&&1===i&&1===c;return r&&r.length>0&&l&&!o&&!a&&(e||d)?(0,n.jsx)(t6,{logs:r}):null})()]}):(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("div",{className:"text-white/40 text-[13px]",children:d?"Conversation expired":"No conversation yet"})})}):(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsxs)("span",{className:"text-brand-gray-300 make-shine text-[13px]",children:["Loading",(0,n.jsx)(er,{})]})})})}var ra=r(39337),rl=r(64072),ro=r(77663),ri=r(78157);let rc={normal:{y:0},animate:{y:-2,transition:{type:"spring",stiffness:200,damping:10,mass:1}}},rd=(0,c.forwardRef)((e,t)=>{let{onMouseEnter:r,onMouseLeave:s,className:a,size:l=28,...o}=e,d=(0,K.s)(),u=(0,c.useRef)(!1);(0,c.useImperativeHandle)(t,()=>(u.current=!0,{startAnimation:()=>d.start("animate"),stopAnimation:()=>d.start("normal")}));let m=(0,c.useCallback)(e=>{u.current?null==r||r(e):d.start("animate")},[d,r]),p=(0,c.useCallback)(e=>{u.current?null==s||s(e):d.start("normal")},[d,s]);return(0,n.jsx)("div",{className:(0,i.cn)(a),onMouseEnter:m,onMouseLeave:p,...o,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,n.jsxs)($.P.g,{variants:rc,animate:d,children:[(0,n.jsx)("polyline",{points:"17 8 12 3 7 8"}),(0,n.jsx)("line",{x1:"12",x2:"12",y1:"3",y2:"15"})]})]})})});rd.displayName="UploadIcon";let ru={normal:{y:0},animate:{y:-1.1}},rm={type:"spring",stiffness:500,damping:30},rp=(0,c.forwardRef)((e,t)=>{let{onMouseEnter:r,onMouseLeave:s,className:a,size:l=28,...o}=e,d=(0,K.s)(),u=(0,c.useRef)(!1);(0,c.useImperativeHandle)(t,()=>(u.current=!0,{startAnimation:()=>d.start("animate"),stopAnimation:()=>d.start("normal")}));let m=(0,c.useCallback)(e=>{u.current?null==r||r(e):d.start("animate")},[d,r]),p=(0,c.useCallback)(e=>{u.current?null==s||s(e):d.start("normal")},[d,s]);return(0,n.jsx)("div",{className:(0,i.cn)(a),onMouseEnter:m,onMouseLeave:p,...o,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsxs)($.P.g,{variants:ru,animate:d,transition:rm,children:[(0,n.jsx)("path",{d:"M3 6h18"}),(0,n.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),(0,n.jsx)($.P.path,{d:"M19 8v12c0 1-1 2-2 2H7c-1 0-2-1-2-2V8",variants:{normal:{d:"M19 8v12c0 1-1 2-2 2H7c-1 0-2-1-2-2V8"},animate:{d:"M19 9v12c0 1-1 2-2 2H7c-1 0-2-1-2-2V9"}},animate:d,transition:rm}),(0,n.jsx)($.P.line,{x1:"10",x2:"10",y1:"11",y2:"17",variants:{normal:{y1:11,y2:17},animate:{y1:11.5,y2:17.5}},animate:d,transition:rm}),(0,n.jsx)($.P.line,{x1:"14",x2:"14",y1:"11",y2:"17",variants:{normal:{y1:11,y2:17},animate:{y1:11.5,y2:17.5}},animate:d,transition:rm})]})})});function rx(e){let{added:t,removed:r}=e;return(0,n.jsxs)("div",{className:"flex items-center gap-0.5 text-[11px]",children:[t>0&&(0,n.jsxs)("span",{className:"text-[#A3BE8C]",children:["+",t]}),r>0&&(0,n.jsxs)("span",{className:"text-[#BF616A]",children:["-",r]})]})}function rf(e){let{isOpen:t,bcId:r,onClose:s,onSuccess:a}=e,[l,o]=(0,c.useState)(!1),[i,u]=(0,c.useState)(!1),m=(0,c.useRef)(null),p=(0,c.useRef)(null),{handleComposerDeletion:f,setSelectedComposerId:h}=(0,v._F)(),g=(0,c.useCallback)(()=>{l||(u(!1),p.current=setTimeout(()=>{s(),p.current=null},150))},[l,s]),b=(0,c.useCallback)(e=>{l||(e.preventDefault(),e.stopPropagation(),g())},[l,g]),w=(0,c.useCallback)(async()=>{if(!r)return void console.error("No background agent ID provided.");h(null),o(!0);try{let e=await fetch("/api/auth/archiveBackgroundComposer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:r})});if(!e.ok)throw Error("Failed to archive: ".concat(e.status," ").concat(e.statusText));await f(r),a&&await a(),(0,d.oR)("Background agent deleted"),g()}catch(e){console.error("Failed to archive background composer:",e),d.oR.error("Failed to delete background agent.")}finally{o(!1)}},[r,f,a,g,h]);if((0,c.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&!l&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),g()),"Enter"===e.key&&t&&!l&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),w())};if(t)return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}},[t,l,g,w]),(0,c.useEffect)(()=>{if(t)return document.body.style.overflow="hidden",m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{u(!0),m.current=null},10),()=>{document.body.style.overflow=""};u(!1)},[t]),(0,c.useEffect)(()=>()=>{m.current&&clearTimeout(m.current),p.current&&clearTimeout(p.current)},[]),!t)return null;let y=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 transition-opacity duration-150 ease-out ".concat(i?"opacity-100":"opacity-0"),onPointerDown:b,onClick:b,onTouchStart:e=>e.preventDefault(),style:{touchAction:"manipulation",pointerEvents:"all"}}),(0,n.jsx)("div",{className:"fixed z-[9999] w-full transition-all duration-150 ease-out\n          sm:left-1/2 sm:top-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:max-w-sm\n          max-sm:left-0 max-sm:right-0 max-sm:bottom-0\n          ".concat(i?"opacity-100 sm:scale-100 max-sm:translate-y-0":"opacity-0 sm:scale-95 max-sm:translate-y-full"),children:(0,n.jsxs)("div",{className:"shadow-lg border p-6 mx-4 sm:mx-0 pointer-events-auto\n            sm:rounded-lg\n            max-sm:rounded-t-xl max-sm:rounded-b-none max-sm:border-b-0 max-sm:mx-0 ".concat(x.Fr?"pb-[96px]":""),style:{backgroundColor:"rgb(27, 29, 33)",borderColor:"rgb(36, 38, 42)"},onPointerDown:e=>e.stopPropagation(),children:[(0,n.jsx)("div",{className:"sm:hidden flex justify-center mb-2",children:(0,n.jsx)("div",{className:"w-10 h-1 bg-gray-500 rounded-full"})}),(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4 flex-col gap-2",children:[(0,n.jsx)("span",{className:"text-gray-300 text-xl font-medium",children:"Delete background agent?"}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Deleting this background agent will remove it from your dashboard and cannot be undone."})]}),(0,n.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 ".concat(x.Fr?"flex-col-reverse":""),children:[(0,n.jsx)("button",{onClick:g,disabled:l,className:"w-full hover:text-gray-300 border border-solid border-white/10 inline-flex text-gray-500 items-center hover:bg-white/5 justify-center rounded-md px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-none focus:ring-offset-2 disabled:opacity-50 disabled:cursor-default disabled:hover:bg-transparent",children:"Cancel"}),(0,n.jsx)("button",{onClick:w,disabled:l,className:"w-full ring-0 outline-none inline-flex items-center hover:bg-red-600 justify-center rounded-md bg-red-500 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-0 disabled:opacity-50 disabled:cursor-default disabled:hover:bg-red-500",children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Deleting..."]}):"Delete"})]}),(0,n.jsx)("div",{className:"sm:hidden h-[env(safe-area-inset-bottom)]"})]})})]});return(0,ti.createPortal)(y,document.body)}rp.displayName="DeleteIcon";var rh=r(2850),rg=r(14459),rv=r(80163),rb=r(28946);function rw(e){var t,r;let{prUrl:s,bcId:a,onPrMerged:l,hideText:o=!1,isCompact:i=!1,hideViewButton:u=!1,forceSmallHeight:p=!1,compactText:x=!1,hideIfSquash:f=!1,showOnlyIfSquash:h=!1,hideLoadingState:g=!1,suppressReadyStateIfSquash:v=!1,suppressCannotMerge:b=!1,hideMergedCompact:w=!1,mergeTypeExternal:y,onMergeTypeChange:j,isDraft:C=!1,onDraftConverted:N}=e,[k,S]=(0,c.useState)(null),[E,L]=(0,c.useState)(!1),[A,M]=(0,c.useState)(!1),[_,I]=(0,c.useState)(null),[D,R]=(0,c.useState)(!1),[T,F]=(0,c.useState)(!1),[P,B]=(0,c.useState)("squash"),O=null!=y?y:P,U=null!=j?j:B,[W,H]=(0,c.useState)(!1),[q,J]=(0,c.useState)(!1),[G,Z]=(0,c.useState)(!0),{refs:V,floatingStyles:K,context:$}=(0,rh.we)({open:W,onOpenChange:H,middleware:[(0,rg.cY)(16),(0,rg.UU)(),(0,rg.BN)({padding:8})],whileElementsMounted:rv.ll,placement:i?"bottom-start":"bottom-end"}),X=(0,rh.kp)($),Y=(0,rh.s9)($),Q=(0,rh.It)($,{role:"menu"}),{getReferenceProps:ee,getFloatingProps:et}=(0,rh.bv)([X,Y,Q]),en=(0,c.useCallback)(async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(s){e&&L(!0),I(null);try{let e=new m.kz({prUrl:s}),t=await fetch("/api/background-composer/check-pull-request-mergeability",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.toJson())});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let r=await t.json(),n=m.IR.fromJson(r);S({canMerge:n.canMerge,error:n.error,mergeableState:n.mergeableState})}catch(e){console.error("Error checking PR mergeability:",e),S({canMerge:!1,error:"Failed to check PR mergeability",mergeableState:void 0})}finally{e&&L(!1)}}},[s]),es=(0,c.useCallback)(async()=>{if(s&&(null==k?void 0:k.canMerge)){M(!0),I(null);try{let e=new m.Iu({prUrl:s,mergeMethod:O}),t=await fetch("/api/background-composer/merge-pull-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.toJson())});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let r=await t.json(),n=m.o0.fromJson(r);n.success?(R(!0),d.oR.success("Pull request merged"),setTimeout(()=>{en(!1),null==l||l()},1e3)):I(n.error||"Failed to merge PR")}catch(e){console.error("Error merging PR:",e),I("Failed to merge PR")}finally{M(!1)}}},[s,null==k?void 0:k.canMerge,en,l,O]),ea=(0,c.useCallback)(async()=>{if(!a)return void d.oR.error("Cannot convert draft: missing background composer ID");F(!0),I(null);try{let e=new m.Mj({bcId:a}),t=await fetch("/api/background-composer/convert-pull-request-from-draft",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.toJson())});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let r=await t.json(),n=m.Wm.fromJson(r);n.success?(d.oR.success("PR marked as ready for review"),null==N||N(),setTimeout(()=>{en(!1)},1e3),setTimeout(()=>{en(!1).finally(()=>{F(!1)})},5e3)):(d.oR.error(n.error||"Failed to convert draft PR"),F(!1))}catch(e){console.error("Error converting draft PR:",e),d.oR.error("Failed to convert draft PR"),F(!1)}},[a,en,N]);(0,c.useEffect)(()=>{if(s){S(null),Z(!0),en(!0);let e=setTimeout(()=>{Z(!1)},1e3);return()=>clearTimeout(e)}S(null),R(!1),I(null),Z(!0)},[s,en]),(0,c.useEffect)(()=>{_&&(d.oR.error(_),I(null))},[_]),(0,c.useEffect)(()=>{if(W)J(!0);else{let e=setTimeout(()=>{J(!1)},150);return()=>clearTimeout(e)}},[W]);let[el,eo]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(q&&W){let e=requestAnimationFrame(()=>{eo(!0)});return()=>cancelAnimationFrame(e)}W||eo(!1)},[q,W]),(0,c.useEffect)(()=>{if(!s)return;let e=null==k?void 0:k.mergeableState;if("clean"===e||"dirty"===e||"blocked"===e)return;let t=setInterval(()=>{en(!1)},5e3);return()=>clearInterval(t)},[s,en,null==k?void 0:k.mergeableState]);let{prNumber:ei,repo:ec}=(()=>{try{if(!s)return{prNumber:"PR",repo:"Repository"};let e=new URL(s).pathname.split("/"),t=e[e.length-1],r=e.slice(-4,-2).join("/");return{prNumber:t,repo:r}}catch(e){return{prNumber:"PR",repo:"Repository"}}})();if(h&&"squash"!==O||f&&"squash"===O)return null;if(E&&!k){if(g)return null;if(i){let e=p?"h-[28px]":"h-[36px]";return(0,n.jsxs)("div",{className:"flex items-center gap-2 ".concat(e),children:[!u&&(0,n.jsx)("button",{disabled:!0,title:"Checking PR mergeability",className:"flex justify-center items-center px-2 rounded-md bg-[#242830] text-gray-400 text-xs font-medium ".concat(e," min-w-fit opacity-70"),children:x?"View PR":(0,n.jsx)(rl.A,{className:"w-4 h-4"})}),(0,n.jsx)("div",{className:"flex ".concat(""," items-center"),children:(0,n.jsx)("div",{"aria-label":"Loading",className:"".concat(i?"w-2 h-2 border-2 border-gray-300 border-t-transparent rounded-full animate-spin":"w-4 h-4 border-2 border-gray-300 border-t-transparent rounded-full animate-spin mr-2")})})]})}return(0,n.jsxs)("div",{className:"flex ".concat(o?"w-fit":"w-full"," justify-between items-center gap-3"),children:[(0,n.jsx)("div",{"aria-label":"Loading",className:"".concat(o?"w-2 h-2 min-w-2 min-h-2":"w-4 h-4 min-w-4 min-h-4"," border-2 border-gray-300 border-t-transparent rounded-full animate-spin")}),!o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-300",children:"Checking PR"}),(0,n.jsxs)("div",{className:"text-xs text-gray-400",children:["#",ei," in ",ec]})]}),(0,n.jsx)("div",{className:"flex items-center gap-1.5",children:(0,n.jsxs)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),className:"flex w-fit justify-start h-[36px] py-2 items-center gap-1.5 px-3 bg-[#242830] text-[#D8DEE9] text-sm font-medium rounded-md hover:bg-[#2d3138] transition-colors",children:[x?"View PR":(0,n.jsx)(rl.A,{className:"w-4 h-4"})," "]})})]})]})}if(D){if(i){if(w)return null;let e=p?"h-[28px]":"h-[36px]";return(0,n.jsx)("div",{className:"flex items-center gap-2 ".concat(e),children:(0,n.jsx)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),title:"PR merged successfully",className:"flex justify-center items-center px-3 rounded-md bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium ".concat(e," min-w-fit"),children:x?"Merged":(0,n.jsx)(rb.A,{className:"w-4 h-4"})})})}return(0,n.jsxs)("div",{className:"flex ".concat(o?"w-fit":"w-full"," justify-between items-center gap-3"),children:[(0,n.jsx)(rb.A,{className:"".concat(o?"w-2 h-2 min-w-2 min-h-2":"w-4 h-4 min-w-4 min-h-4"," text-purple-400")}),!o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-300",children:"Merged"}),(0,n.jsxs)("div",{className:"text-xs text-gray-400",children:["#",ei," in ",ec]})]}),(0,n.jsx)("div",{className:"flex items-center gap-1.5",children:(0,n.jsxs)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),className:"flex w-fit justify-start h-[36px] py-2 items-center gap-1.5 px-3 pl-2 bg-[#242830] text-[#D8DEE9] text-sm font-medium rounded-md hover:bg-[#2d3138] transition-colors",children:[(0,n.jsx)(rl.A,{className:"w-4 h-4"}),"View PR"]})})]})]})}if(C){if(i){let e=p?"h-[28px]":"h-[36px]";return(0,n.jsxs)("div",{className:"flex items-center gap-2 ".concat(e),children:[!u&&(0,n.jsx)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),title:"View PR",className:"flex justify-center items-center px-3 rounded-md bg-[#242830] hover:bg-[#2d3138] text-[#D8DEE9] text-xs font-medium ".concat(e," min-w-fit"),children:(0,n.jsx)("span",{className:"truncate",children:"View PR"})}),(0,n.jsx)("button",{onClick:ea,disabled:T,title:"Open PR",className:"flex w-[99px] h-[28px] rounded-md min-w-fit truncate justify-center items-center gap-1.5 px-3 bg-[#d8dee9] text-[#242830] text-sm font-medium hover:bg-white transition-colors disabled:cursor-default disabled:opacity-50",children:(0,n.jsxs)(n.Fragment,{children:[T?(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-[#242830] border-t-transparent rounded-full animate-spin"}):(0,n.jsx)(ra.N,{className:"w-4 h-4 text-[#242830]"}),(0,n.jsx)("span",{className:"truncate",children:"Open PR"})]})})]})}return(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row w-full h-full justify-start sm:justify-between sm:items-center gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(z.A,{className:"".concat(o?"w-3 h-3 min-w-3 min-h-3":"w-5 h-5 min-w-5 min-h-5"," text-gray-400")}),!o&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-300",children:"Draft PR"}),(0,n.jsxs)("div",{className:"text-xs text-gray-400",children:["#",ei," in ",ec]})]})})]}),!o&&(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),className:"flex w-fit justify-start h-[36px] py-2 items-center gap-1.5 px-3 bg-[#242830] text-[#D8DEE9] text-sm font-medium rounded-md hover:bg-[#2d3138] transition-colors",children:"View PR"}),(0,n.jsxs)("button",{onClick:ea,disabled:T,className:"flex w-fit justify-start h-[36px] py-2 items-center gap-1.5 px-3 bg-[#242830] text-[#D8DEE9] text-sm font-medium rounded-md hover:bg-[#2d3138] transition-colors disabled:opacity-70",children:[T?(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-[#D8DEE9] border-t-transparent rounded-full animate-spin"}):(0,n.jsx)(ra.N,{className:"w-4 h-4"}),T?"Opening...":"Open PR"]})]})]})}let ed=null==k||null==(t=k.mergeableState)?void 0:t.toLowerCase(),eu=(null==k||null==(r=k.error)?void 0:r.toLowerCase())||"",em=eu.includes("check")||eu.includes("status"),ep=!(null==k?void 0:k.canMerge)&&("unstable"===ed||"blocked"!==ed&&em&&!eu.includes("failing")&&!eu.includes("failed"));if(!(null==k?void 0:k.canMerge)){let e=(null==k?void 0:k.error)||"Cannot merge PR",t=e.toLowerCase().includes("pull request is already merged"),r=e.toLowerCase().includes("conflict"),a=e.toLowerCase().includes("check")||e.toLowerCase().includes("status");if(b&&!t)return null;if(t){if(i){if(w)return null;let e=p?"h-[28px]":"h-[36px]";return(0,n.jsx)("div",{className:"flex items-center gap-2 ".concat(e),children:(0,n.jsx)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),title:"PR is already merged",className:"flex justify-center items-center px-3 rounded-md bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium ".concat(e),children:x?"Merged":(0,n.jsx)(rb.A,{className:"w-4 h-4"})})})}return(0,n.jsxs)("div",{className:"flex ".concat(o?"w-fit":"w-full"," justify-between items-center gap-3"),children:[(0,n.jsx)(rb.A,{className:"".concat(o?"w-3 h-3 min-w-3 min-h-3":"w-5 h-5 min-w-5 min-h-5"," text-purple-400")}),!o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-300",children:"Merged"}),(0,n.jsxs)("div",{className:"text-xs text-gray-400",children:["#",ei," in ",ec]})]}),(0,n.jsx)("div",{className:"flex items-center gap-1.5",children:(0,n.jsx)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),className:"flex w-fit justify-start h-[36px] py-2 items-center gap-1.5 px-3 bg-[#242830] text-[#D8DEE9] text-sm font-medium rounded-md hover:bg-[#2d3138] transition-colors",children:(0,n.jsx)("span",{className:"truncate",children:"View PR"})})})]})]})}if(i){let t=p?"h-[28px]":"h-[36px]";return(0,n.jsx)("div",{className:"flex items-center gap-2 ".concat(t),children:(0,n.jsx)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),title:r?"Merge conflicts need resolution":a?"Required checks not passing":e,className:"flex justify-center items-center px-3 rounded-md bg-red-600 hover:bg-red-700 text-white text-[11px] font-medium ".concat(t),children:x?r?"Conflicts":a?"Checks failing":"Cannot merge":(0,n.jsx)(ri.A,{className:"w-4 h-4"})})})}return(0,n.jsxs)("div",{className:"flex ".concat(o?"w-fit":"w-full"," h-full justify-between items-center gap-3"),children:[(0,n.jsx)(ri.A,{className:"".concat(o?"w-3 h-3 min-w-3 min-h-3":"w-5 h-5 min-w-5 min-h-5"," text-red-400")}),!o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex-1 gap-0",children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-300",children:"Cannot Merge"}),(0,n.jsx)("div",{className:"text-xs text-gray-400",children:r?"Merge conflicts need resolution":a?"Required checks not passing":e})]}),(0,n.jsx)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),className:"flex w-fit justify-start h-[36px] py-2 items-center gap-1.5 px-3 bg-[#242830] text-[#D8DEE9] text-sm font-medium rounded-md hover:bg-[#2d3138] transition-colors",children:"View PR"})]})]})}if(o)return null;if(i){let e=p?"h-[28px]":"h-[36px]",t="squash"===O?"Squash merge":"rebase"===O?"Rebase merge":"Merge commit";return v&&"squash"===O?null:(0,n.jsxs)("div",{className:"flex items-center gap-2 ".concat(e),children:[!u&&(0,n.jsx)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),title:"View PR",className:"flex justify-center items-center px-3 rounded-md bg-[#242830] hover:bg-[#2d3138] text-[#D8DEE9] text-xs font-medium ".concat(e," min-w-fit"),children:x?"View PR":(0,n.jsx)(rl.A,{className:"w-4 h-4"})}),(0,n.jsxs)("div",{className:"flex relative w-auto",children:[(0,n.jsxs)("div",{className:"flex relative w-auto bg-[#347d39] ".concat(e," rounded-md overflow-hidden"),children:[(0,n.jsx)("button",{onClick:es,disabled:A||G||ep,title:A?"Merging...":ep?"Checks running...":"squash"===O?"Squash merge":"rebase"===O?"Rebase merge":"Merge commit",className:"flex justify-center items-center px-3 pr-2 font-medium text-gray-200 w-[108px]  text-[14px] transition-colors disabled:opacity-70 hover:bg-[#4a9749] rounded-none peer whitespace-nowrap ".concat(e),children:A?(0,n.jsx)("div",{className:"flex items-center gap-0 truncate",children:(0,n.jsx)(er,{})}):ep?(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}),x&&(0,n.jsx)("span",{className:"text-xs",children:"Checks"})]}):x?t:(0,n.jsx)(ro.A,{className:"w-4 h-4"})}),(0,n.jsx)("button",{ref:V.setReference,...ee(),disabled:A||G||ep,title:ep?"Checks running...":"Choose merge type",className:"flex focus:outline-none focus:ring-0 focus:ring-offset-0 items-center justify-center w-8 border-l border-white/10 hover:bg-[#4a9749] peer-hover:bg-[#4a9749] transition-colors disabled:opacity-70 rounded-none ".concat(e),onClick:e=>{e.stopPropagation(),H(!W)},children:(0,n.jsx)(eS.A,{className:"w-4 h-4 text-gray-200 transition-transform ".concat(W?"rotate-[-180deg]":"")})})]}),q&&(0,n.jsxs)(rh.XF,{children:[(0,n.jsx)("div",{className:"fixed inset-0",style:{zIndex:9999,pointerEvents:"auto",backgroundColor:"transparent"}}),(0,n.jsx)(rh.s3,{context:$,modal:W,children:(0,n.jsx)("div",{ref:V.setFloating,...et(),className:"relative",style:{...K,zIndex:1e4},children:(0,n.jsx)("div",{style:{transformOrigin:"top left",opacity:+!!el,transform:"scale(".concat(el?1:.95,")"),transition:"opacity 150ms ease-out, transform 150ms ease-out",border:"1px solid #24262a",boxShadow:"0 0 8px 2px color-mix(in srgb, rgba(0, 0, 0, 0.36) 30%, transparent)"},className:"bg-[#1b1d21] border border-white/10 min-w-[200px] p-1 rounded-lg shadow-lg flex flex-col",children:[{key:"squash",label:"Squash merge"},{key:"rebase",label:"Rebase merge"},{key:"merge",label:"Merge commit"}].map(e=>(0,n.jsx)("button",{onClick:()=>{U(e.key),H(!1)},className:"text-gray-300 outline-none ring-0 focus:ring-0 focus:outline-none flex group justify-between items-start text-sm hover:bg-white/5 cursor-pointer select-text rounded-[6px] p-2 px-2.5",children:e.label},e.key))})})})]})]})]})}return(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row w-full h-full justify-start sm:justify-between sm:items-center gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[ep?(0,n.jsx)("div",{className:"w-5 h-5 border-2 border-yellow-400 border-t-transparent rounded-full animate-spin"}):(0,n.jsx)(ro.A,{className:"w-5 h-5 text-[#a3be8c]"}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-300",children:ep?"Checks Running":"Ready to Merge"}),(0,n.jsxs)("div",{className:"text-xs text-gray-400",children:["#",ei," in ",ec]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>window.open(s,"_blank","noopener,noreferrer"),className:"flex w-fit justify-start h-[36px] py-2 items-center gap-1.5 px-3 bg-[#242830] text-[#D8DEE9] text-sm font-medium rounded-md hover:bg-[#2d3138] transition-colors",children:"View PR"}),(0,n.jsxs)("div",{className:"flex relative",children:[(0,n.jsxs)("div",{className:"flex relative bg-[#347d39] h-[36px] min-w-[138px] rounded-md overflow-hidden",children:[(0,n.jsx)("button",{onClick:es,disabled:A||G||ep,className:"flex justify-center flex-1 py-2 items-center gap-1.5 px-3 pr-2 font-medium text-gray-300 text-sm transition-colors disabled:opacity-70 hover:bg-[#4a9749] rounded-none peer",children:A?(0,n.jsxs)("div",{className:"flex items-center gap-0 truncate",children:["Merging",(0,n.jsx)(er,{})]}):ep?(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),(0,n.jsx)("span",{className:"truncate",children:"Checks running..."})]}):(0,n.jsx)("span",{className:"truncate",children:"squash"===O?"Squash merge":"rebase"===O?"Rebase merge":"Merge commit"})}),(0,n.jsx)("button",{ref:V.setReference,...ee(),disabled:A||G||ep,className:"flex focus:outline-none focus:ring-0 focus:ring-offset-0 items-center justify-center w-9 h-full border-l border-white/10 hover:bg-[#4a9749] peer-hover:bg-[#4a9749] transition-colors disabled:opacity-70 rounded-none",onClick:e=>{e.stopPropagation(),H(!W)},children:(0,n.jsx)(eS.A,{className:"w-4 h-4 text-gray-200 transition-transform ".concat(W?"rotate-[-180deg]":"")})})]}),q&&(0,n.jsxs)(rh.XF,{children:[(0,n.jsx)("div",{className:"fixed inset-0",style:{zIndex:9999,pointerEvents:"auto",backgroundColor:"transparent"}}),(0,n.jsx)(rh.s3,{context:$,modal:W,children:(0,n.jsx)("div",{ref:V.setFloating,...et(),className:"relative",style:{...K,zIndex:1e4},children:(0,n.jsx)("div",{style:{transformOrigin:"top right",opacity:+!!el,transform:"scale(".concat(el?1:.95,")"),transition:"opacity 150ms ease-out, transform 150ms ease-out",border:"1px solid #24262a",boxShadow:"0 0 8px 2px color-mix(in srgb, rgba(0, 0, 0, 0.36) 30%, transparent)"},className:"bg-[#1b1d21] border border-white/10 min-w-[220px] p-1 rounded-lg shadow-lg flex flex-col",children:[{key:"squash",label:"Squash merge"},{key:"rebase",label:"Rebase merge"},{key:"merge",label:"Merge commit"}].map(e=>(0,n.jsx)("button",{onClick:()=>{U(e.key),H(!1)},className:"text-gray-300 outline-none ring-0 focus:ring-0 focus:outline-none flex group justify-between items-start text-sm hover:bg-white/5 cursor-pointer select-text rounded-[6px] p-2 px-2.5",children:e.label},e.key))})})})]})]})]})]})}function ry(e){let{prUrl:t,onPrMerged:r,parentWidth:s,isMobile:a=!1}=e,[l,o]=(0,c.useState)(!1);return((0,c.useEffect)(()=>{o(!!t)},[t]),a)?null:(0,n.jsx)("div",{className:"fixed rounded-xl py-2 px-2.5 pl-3 bg-[#17191d] ".concat(a?"bottom-[14px]":"bottom-4"," left-[2.5rem] z-50 flex justify-center pointer-events-auto transition-all duration-50 ease-out"),style:{width:s?"".concat(s+48,"px"):"100%",maxWidth:"calc(100vw - 2rem)",marginLeft:-24,border:"1px solid var(--vscode-widget-border, rgba(255, 255, 255, 0.04))",boxShadow:"0 0 8px 2px color-mix(in srgb, var(--vscode-widget-shadow, rgba(0, 0, 0, 0.36)) 30%, transparent)",opacity:+!!l,transformOrigin:"center center",transform:l?"scale(1)":"scale(0.95)",pointerEvents:l?"auto":"none"},children:(0,n.jsx)(rw,{prUrl:t,onPrMerged:r})})}function rj(e){let{isOpen:t,onClose:r,composerName:s,composerId:a}=e,{team:l}=(0,b.M)(),[o,i]=(0,c.useState)(!1),[d,u]=(0,c.useState)(!1),m=(0,c.useRef)(null),p=(0,c.useRef)(null),f=(0,c.useRef)(null),h=(0,c.useCallback)(()=>{u(!1),f.current=setTimeout(()=>{r(),f.current=null},150)},[r]),g=(0,c.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),h()},[h]),v=()=>a?"".concat(window.location.origin,"/agents?selectedBcId=").concat(a):"",w=async()=>{let e=v();if(e)try{await navigator.clipboard.writeText(e),i(!0),setTimeout(()=>i(!1),2e3)}catch(e){console.error("Failed to copy composer link:",e)}};if((0,c.useEffect)(()=>{if(t){let e=e=>{"Escape"===e.key&&(e.preventDefault(),e.stopImmediatePropagation(),h())};return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}}},[t,h]),(0,c.useEffect)(()=>{t?(p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{u(!0),p.current=null},10)):u(!1)},[t]),(0,c.useEffect)(()=>{if(t)return document.body.style.overflow="hidden",m.current&&m.current.focus(),()=>{document.body.style.overflow=""}},[t]),(0,c.useEffect)(()=>()=>{p.current&&clearTimeout(p.current),f.current&&clearTimeout(f.current)},[]),!t)return null;let y=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 transition-opacity duration-150 ease-out ".concat(d?"opacity-100":"opacity-0"),onPointerDown:g,onClick:g,onTouchStart:e=>e.preventDefault(),style:{touchAction:"manipulation",pointerEvents:"all"}}),(0,n.jsx)("div",{ref:m,tabIndex:-1,className:"fixed z-[99999] w-full transition-all duration-150 ease-out\n          sm:left-1/2 sm:top-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:max-w-md\n          max-sm:left-0 max-sm:right-0 max-sm:bottom-0 outline-none focus:outline-none\n          ".concat(d?"opacity-100 sm:scale-100 max-sm:translate-y-0":"opacity-0 sm:scale-95 max-sm:translate-y-full"),children:(0,n.jsxs)("div",{className:"shadow-2xl bg-[#1b1d21] border border-[#24262a] outline-none focus:outline-none p-6 pointer-events-auto\n            sm:rounded-xl\n            max-sm:rounded-t-xl max-sm:rounded-b-none max-sm:border-b-0 ".concat(x.Fr?"pb-[96px]":""),style:{boxShadow:"0 0 8px 2px color-mix(in srgb, var(--vscode-widget-shadow, rgba(0, 0, 0, 0.36)) 30%, transparent)"},onPointerDown:e=>e.stopPropagation(),children:[(0,n.jsx)("div",{className:"sm:hidden flex justify-center mb-2",children:(0,n.jsx)("div",{className:"w-10 h-1 bg-gray-500 rounded-full"})}),(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4 flex-col gap-2",children:[(0,n.jsxs)("h2",{className:"text-lg font-medium text-gray-200 w-full",children:["Share `",s||a||"Untitled","` with\xa0",(null==l?void 0:l.name)||"your team"]}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"Anyone in your team with this link and repository access will be able to view this background agent"})]}),(0,n.jsx)("div",{className:"space-y-4",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"text",readOnly:!0,value:v(),className:"w-full pr-10 px-3 py-2.5 text-sm bg-[#2a2d32] border border-[#3e4147] rounded-md text-gray-300 focus:outline-none focus:ring-1 focus:ring-gray-500 focus:border-gray-500",placeholder:"Loading link..."}),(0,n.jsx)("button",{onClick:w,disabled:!v(),className:"absolute w-[32px] h-[32px] right-1 top-1/2 -translate-y-1/2 px-2 py-1 rounded hover:bg-white/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?(0,n.jsx)(ek.A,{className:"h-4 w-4 text-gray-300"}):(0,n.jsx)(ty.A,{className:"h-4 w-4 text-gray-300"})})]})}),(0,n.jsx)("div",{className:"sm:hidden h-[env(safe-area-inset-bottom)]"})]})})]});return(0,ti.createPortal)(y,document.body)}function rC(e){var t,r,s,a,l,o,i,d,u,p,f,h,g,b,w,y,j,C,N,k,S,E,L,A,M,I,D,R;let{selectedComposer:T,selectedComposerDiffStats:F,prLoading:P,existingPrUrl:B,onOpenInCursor:O,onOpenExistingPullRequest:q,onOpenPullRequest:J,onFilenameClick:G,onCloseModal:V,onPrMerged:K,isFullScreen:$=!1}=e,{detailedDiffs:X}=(0,v._F)(),[Q,ee]=(0,c.useState)(null),[et,er]=(0,c.useState)(!1);(0,c.useEffect)(()=>{ee(null),er(!1)},[null==(t=T.composer)?void 0:t.bcId]),(0,c.useEffect)(()=>{let e=!1;async function t(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!B)return void ee(null);if(!t){let e=(0,_.Le)(B);e&&ee(e)}try{let t=await fetch("/api/background-composer/get-pull-request-merge-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prUrl:B})});if(t.ok){let r=await t.json(),n=new m.Kj().fromJson(r);(0,_.bo)(B,n),e||ee(n)}}catch(e){}}t(),et&&B&&((0,_.kB)(B),t(!0));let r=setInterval(t,3e4);return()=>{e=!0,clearInterval(r)}},[B,et]),(0,c.useEffect)(()=>{if(!et||!B)return;let e=!1;async function t(){if(!e&&B)try{(0,_.kB)(B);let t=await (0,_.Jg)(B);!e&&t&&ee(t)}catch(e){}}let r=setTimeout(t,1e3),n=setTimeout(()=>{t().then(()=>{e||er(!1)})},5e3);return()=>{e=!0,clearTimeout(r),clearTimeout(n)}},[et,B]);let en=(0,c.useMemo)(()=>{if(!Q)return null;if(Q.isMerged)return(0,n.jsx)(ro.A,{className:"w-3.5 h-3.5 text-purple-400"});if(Q.isClosed)return(0,n.jsx)(U.A,{className:"w-3.5 h-3.5 text-[#BF616A]"});if(Q.isDraft)return(0,n.jsx)(W.A,{className:"w-3.5 h-3.5 text-gray-400"});if("open"===Q.state){let e=(Q.mergeableState||"").toLowerCase();return"unstable"===e||"blocked"===e||"unknown"===e?(0,n.jsx)("div",{"aria-label":"Checks running",className:"w-2 h-2 border-2 border-yellow-400 border-t-transparent rounded-full animate-spin"}):(0,n.jsx)(z.A,{className:"w-3.5 h-3.5 text-[#A3BE8C]"})}return(0,n.jsx)(ri.A,{className:"w-3.5 h-3.5 text-red-400"})},[Q]),es=(null==(r=T.composer)?void 0:r.status)===m.R6.EXPIRED,ea=null==(s=T.composer)?void 0:s.bcId,el=(0,c.useMemo)(()=>{var e,t,r,n,s,a,l;if(!T)return!1;let o=null==(e=T.composer)?void 0:e.bcId;if(!o)return!1;let i=X.get(o);if(i){let e=!!(null==(a=i.diff)||null==(s=a.diffs)?void 0:s.length),t=!!(null==(l=i.submoduleDiffs)?void 0:l.some(e=>{var t,r;return!e.errored&&(null==(r=e.diff)||null==(t=r.diffs)?void 0:t.length)}));return e||t}let c=!!(null==T||null==(r=T.diffSinceStart)||null==(t=r.diffs)?void 0:t.length),d=null==(n=T.composer)?void 0:n.status,u=!!(d&&(d===m.R6.FINISHED||d===m.R6.RUNNING||d===m.R6.EXPIRED));return!!(c&&u)},[T,X]),[eo,ei]=(0,c.useState)(!el),[ec,ed]=(0,c.useState)(!1),[eu,em]=(0,c.useState)(!1),[ep,ex]=(0,c.useState)(!1),[ef,eh]=(0,c.useState)(!1),[eg,ev]=(0,c.useState)(!1),[eb,ew]=(0,c.useState)("squash"),ey=(0,c.useRef)(null),ej=(0,c.useRef)(null),eC=(0,c.useRef)(null),eN=(0,c.useRef)(null);(0,c.useEffect)(()=>{if(eu){let e=setTimeout(()=>em(!1),2e3);return()=>clearTimeout(e)}},[eu]);let eS=(0,c.useCallback)(()=>{er(!0)},[]);(0,c.useEffect)(()=>{if(ey.current&&T.summary){let e=ey.current.scrollHeight;el?e<=200?ed(!1):ed(!0):(ei(!0),ed(!1))}},[T.summary,el]),(0,c.useEffect)(()=>{B?(0,_.Jg)(B).then(e=>{ee(e)}).catch(e=>{console.error("Error fetching PR merge status:",e),ee(null)}):ee(null)},[B,null==(a=T.composer)?void 0:a.bcId]);let eE=(0,c.useMemo)(()=>{let e=new Set;if(!T)return e;if(ea){var t,r,n,s,a;let l=X.get(ea);l?(null==(r=l.diff)||null==(t=r.diffs)||t.forEach(t=>{t.from&&e.add(t.from),t.to&&t.to!==t.from&&e.add(t.to)}),null==(n=l.submoduleDiffs)||n.forEach(t=>{var r;!t.errored&&(null==(r=t.diff)?void 0:r.diffs)&&t.diff.diffs.forEach(t=>{t.from&&e.add(t.from),t.to&&t.to!==t.from&&e.add(t.to)})})):null==T||null==(a=T.diffSinceStart)||null==(s=a.diffs)||s.forEach(t=>{t.from&&e.add(t.from),t.to&&t.to!==t.from&&e.add(t.to)})}return e},[T,ea,X]),eL=(0,c.useMemo)(()=>({code:e=>{let{children:t,...r}=e,s=String(t).replace(/\n$/,""),a=!!(/\.(js|jsx|ts|tsx|py|java|cpp|c|h|css|scss|html|xml|json|md|txt|yml|yaml|toml|ini|cfg|conf|sh|bat|sql|php|rb|go|rs|swift|kt|dart|vue|svelte|sol|move|cairo)$/i.test(s)||/[/\\]/.test(s)&&s.length>1)||!!/^(Dockerfile|Makefile|README|LICENSE|CHANGELOG|package\.json|yarn\.lock|package-lock\.json|requirements\.txt|Cargo\.toml|go\.mod|pom\.xml|build\.gradle|webpack\.config\.js|tsconfig\.json|\.env|\.gitignore|\.dockerignore)$/i.test(s),l=eE.has(s);return a&&G?(0,n.jsx)("code",{...r,className:"break-words whitespace-pre-wrap text-[#88C0D0] ".concat(l?"cursor-pointer hover:bg-[#262c34] rounded transition-colors":""),onClick:e=>{e.stopPropagation(),l&&G(s)},title:l?"Click to view ".concat(s):s,children:t}):(0,n.jsx)("code",{...r,className:"break-words whitespace-pre-wrap text-[#88C0D0]",children:t})}}),[G,eE]);return(0,ez.vC)("c, shift+c",()=>{var e;!x.Fr&&(null==(e=T.composer)?void 0:e.bcId)&&O(T.composer.bcId)},{enableOnFormTags:!1,preventDefault:!0},[null==(l=T.composer)?void 0:l.bcId,O]),(0,ez.vC)("del, backspace, shift+3",async()=>{var e,t,r;null==(e=T.composer)||!e.bcId||(null==(t=T.composer)?void 0:t.isArchived)||(null==(r=T.composer)?void 0:r.isOwnedByDifferentTeamMember)||ex(!0)},{enableOnFormTags:!1,preventDefault:!0},[null==(o=T.composer)?void 0:o.bcId,null==(i=T.composer)?void 0:i.isArchived,null==(d=T.composer)?void 0:d.isOwnedByDifferentTeamMember]),(0,ez.vC)("p, shift+p",()=>{el&&(B?q():J())},{enableOnFormTags:!1,preventDefault:!0,enabled:el},[el,B,q,J]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(rf,{isOpen:ep,bcId:null==(u=T.composer)?void 0:u.bcId,onClose:()=>{ex(!1),x.Fr&&ev(!0)},onSuccess:async()=>{null==V||V()}}),(0,n.jsx)(rj,{isOpen:ef,onClose:()=>{eh(!1),x.Fr&&ev(!0)},composerName:null==(p=T.composer)?void 0:p.name,composerId:null==(f=T.composer)?void 0:f.bcId}),x.Fr&&(0,n.jsx)(tg._s.Root,{open:eg,onOpenChange:ev,children:(0,n.jsxs)(tg._s.Portal,{children:[(0,n.jsx)(tg._s.Overlay,{className:"fixed inset-0 bg-black/50 z-50"}),(0,n.jsxs)(tg._s.Content,{className:"ring-0 outline-none bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col rounded-t-xl border border-white/10 h-auto max-h-[50vh] min-h-[240px] fixed bottom-0 left-0 right-0 z-50",children:[(0,n.jsx)("div",{className:"p-4 pb-0",children:(0,n.jsx)(tg._s.Handle,{className:"bg-white/20 h-1 w-12 rounded-full mx-auto mb-4"})}),(0,n.jsxs)("div",{className:"px-4 pb-4 flex flex-col gap-2",children:[(0,n.jsxs)("button",{onClick:()=>{eh(!0)},className:"flex w-full items-center justify-between bg-[#1B1D21] hover:bg-white/5 rounded-lg p-4 text-base text-gray-300 transition-colors",children:[(0,n.jsx)("span",{children:"Share link"}),(0,n.jsx)(rd,{size:18})]}),!(null==(h=T.composer)?void 0:h.isArchived)&&!(null==(g=T.composer)?void 0:g.isOwnedByDifferentTeamMember)&&(0,n.jsxs)("button",{onClick:()=>{ex(!0)},className:"flex w-full items-center justify-between bg-[#1B1D21] hover:bg-red-500/10 rounded-lg p-4 text-base text-gray-300 hover:text-red-300 transition-colors",children:[(0,n.jsx)("span",{children:"Delete agent"}),(0,n.jsx)(rp,{size:18,className:"text-gray-400"})]})]})]})]})}),(0,n.jsx)("div",{className:"flex justify-between text-gray-300 border-b border-gray-500/10 ".concat(x.Fr?"pb-5 px-4":$?"p-0 border-none":"pb-5 px-10"," flex-col sm:flex-row items-start flex-wrap sm:items-center gap-y-4 sm:gap-0"),children:(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 w-full ".concat(x.Fr?"flex-row":""),children:[(0,n.jsxs)("div",{className:"flex gap-y-2 w-full ".concat(x.Fr?"flex-row items-baseline gap-4 bg-[#17181c] flex-wrap":$?"flex-col items-start justify-between gap-4 bg-[#17181c] pr-4 flex-wrap":"flex-col"),children:[x.Fr&&(0,n.jsxs)("div",{className:"flex-1 flex flex-col min-w-auto ".concat(el?"max-w-[50%]":"max-w-[100%]"),children:[(0,n.jsx)("h1",{className:"font-medium text-[16px] w-fit truncate max-w-[100%]",children:(null==(w=T.composer)||null==(b=w.name)?void 0:b.length)&&T.composer.name.length>0?T.composer.name:"Background Agent"}),F&&(0,n.jsx)("span",{className:"text-gray-500 text-[11px] flex items-center gap-1 w-fit",children:(0,n.jsx)(rx,{added:F.totalAdded,removed:F.totalRemoved})})]}),!x.Fr&&(0,n.jsxs)("div",{className:"flex flex-col items-start gap-y-0 justify-between",children:[(0,n.jsx)("h1",{className:"font-medium ".concat($?"text-[16px]":"text-2xl"),style:{letterSpacing:"-0.32px"},children:(null==(j=T.composer)||null==(y=j.name)?void 0:y.length)&&T.composer.name.length>0?T.composer.name:"Background Agent"}),(0,n.jsxs)("div",{className:"text-sm text-gray-500 flex items-center gap-1 flex-wrap max-w-full",children:[(null==(C=T.composer)?void 0:C.branchName)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[B&&!es&&(0,n.jsx)("div",{className:"flex items-center justify-center w-4 h-4","aria-label":"PR status",children:en}),(0,n.jsxs)("div",{className:"truncate font-mono text-[11px] font-medium cursor-pointer text-gray-500 hover:text-gray-400 relative group max-w-[200px] sm:max-w-full flex items-center",onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(T.composer.branchName),em(!0)},children:[(0,n.jsx)(n.Fragment,{children:T.composer.branchName}),(0,n.jsx)("div",{className:"w-0 group-hover:w-auto group-hover:ml-1 overflow-hidden transition-all duration-200",children:eu?(0,n.jsx)(ek.A,{className:"w-3 h-3 text-gray-300"}):(0,n.jsx)(ty.A,{className:"w-3 h-3 text-gray-300"})})]})]}),(0,n.jsx)("span",{className:"text-gray-600 text-[11px]",children:"\xa0in\xa0"})]}),(null==(N=T.composer)?void 0:N.repoUrl)&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("span",{className:"truncate text-[11px] font-mono font-medium cursor-pointer text-gray-500 hover:text-gray-400 relative group flex items-center",onClick:e=>{e.stopPropagation();let t=T.composer.repoUrl,r="";if(t.startsWith("git@github.com:")){let e=t.replace("git@github.com:","").replace(/\.git$/,"");r="https://github.com/".concat(e)}else if(t.includes("github.com")){let e=t.match(/github\.com[/:]([^/]+\/[^/]+)/);if(e){let t=e[1].replace(/\.git$/,"");r="https://github.com/".concat(t)}else r=t.replace(/\.git$/,"")}else r=t.replace(/\.git$/,"");window.open(r,"_blank")},children:[(()=>{let e=T.composer.repoUrl.split("/");if(e.length>=2){var t;let r=null==(t=e.pop())?void 0:t.replace(/\.git$/,""),n=e.pop();return n&&r?"".concat(n,"/").concat(r):T.composer.repoUrl}return T.composer.repoUrl})(),(0,n.jsx)("div",{className:"w-0 group-hover:w-auto group-hover:ml-1 overflow-hidden transition-all duration-200",children:(0,n.jsx)(rl.A,{className:"w-3 h-3 text-gray-300"})})]})}),(null==(k=T.modelDetails)?void 0:k.modelName)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-gray-600 text-[11px]",children:"\xa0by\xa0"}),(0,n.jsx)("div",{className:"truncate text-[11px] font-mono font-medium text-gray-500 hover:text-gray-400",children:(0,n.jsx)("span",{style:{background:"linear-gradient(to right, #81a1c1, #7d7c9b)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:(null==(S=T.modelDetails)?void 0:S.modelName)==="default"?"auto":null==(E=T.modelDetails)?void 0:E.modelName})})]})]})]}),(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2 ".concat(x.Fr?"flex-row-reverse w-fit":""),children:[el&&!es&&(0,n.jsx)(n.Fragment,{children:x.Fr?B?(0,n.jsx)(rw,{prUrl:B,bcId:null==(L=T.composer)?void 0:L.bcId,onPrMerged:K,isCompact:!0,forceSmallHeight:!0,compactText:!0,suppressCannotMerge:$,hideMergedCompact:$,mergeTypeExternal:eb,onMergeTypeChange:ew,isDraft:(null==Q?void 0:Q.isDraft)||!1,onDraftConverted:eS}):(0,n.jsx)("button",{onClick:J,disabled:P||!T||es,className:"flex w-fit h-[36px] rounded-[10px] min-w-fit truncate justify-center py-2 items-center gap-1.5 px-2 bg-[#d8dee9] text-[#242830] hover:bg-white text-sm font-medium transition-colors disabled:cursor-default disabled:opacity-50",children:P?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-4 h-4 min-w-4 min-h-4 border-2 border-[#242830] border-t-transparent rounded-full animate-spin"}),(0,n.jsx)("span",{className:"truncate",children:"Create PR"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ra.N,{className:"w-4 h-4 min-w-4 min-h-4 text-[#242830]"}),(0,n.jsx)("span",{className:"truncate",children:"Create PR"})]})}):B?(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(rw,{prUrl:B,bcId:null==(A=T.composer)?void 0:A.bcId,onPrMerged:K,isCompact:!0,hideViewButton:!0,forceSmallHeight:!0,compactText:!0,suppressCannotMerge:$,hideMergedCompact:$,mergeTypeExternal:eb,onMergeTypeChange:ew,hideLoadingState:!0,isDraft:(null==Q?void 0:Q.isDraft)||!1,onDraftConverted:eS}),(0,n.jsxs)("button",{onClick:q,className:"flex w-auto justify-center h-[28px] items-center gap-1.5 px-3 pl-2 bg-[#242830]  text-[#D8DEE9] text-sm font-medium rounded-md hover:bg-[#2D3138] transition-colors",children:[(0,n.jsx)(rl.A,{className:"w-4 h-4 text-[#D8DEE9]"}),(0,n.jsx)("span",{className:"truncate",children:"View PR"})]})]}):(0,n.jsx)("button",{onClick:J,disabled:P||!T,className:"flex w-auto h-[28px] rounded-md min-w-fit truncate justify-center items-center gap-1.5 px-3 bg-[#d8dee9] text-[#242830] hover:bg-white text-sm font-medium transition-colors disabled:cursor-default disabled:opacity-50",children:P?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-4 h-4 min-w-4 min-h-4 border-2 border-[#242830] border-t-transparent rounded-full animate-spin"}),(0,n.jsx)("span",{className:"truncate",children:"Create PR"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ra.N,{className:"w-4 h-4 min-w-4 min-h-4 text-[#242830]"}),(0,n.jsx)("span",{className:"truncate",children:"Create PR"})]})})}),!x.Fr&&!(null==(M=T.composer)?void 0:M.isOwnedByDifferentTeamMember)&&(0,n.jsxs)("button",{onClick:()=>{var e;(null==(e=T.composer)?void 0:e.bcId)&&O(T.composer.bcId)},disabled:!(null==(I=T.composer)?void 0:I.bcId),className:"flex w-full min-w-fit sm:w-auto justify-center sm:justify-start py-2 sm:py-1 items-center gap-1.5 px-2 bg-[#242830]  text-[#D8DEE9] text-sm font-medium rounded-md hover:bg-[#2D3138] transition-colors disabled:opacity-50 disabled:cursor-default",children:[(0,n.jsx)("svg",{width:"15",height:"17",viewBox:"0 0 15 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M2.20489 4.81264L7.84862 8.07105L13.6631 4.63865L2.20489 4.81264ZM8.27898 1.53014L8.25521 3.99014L12.4631 3.94585L8.27898 1.53014ZM3.3016 4.04218L7.52089 3.99786L7.54473 1.53734L3.3016 4.04218ZM8.20954 8.71066L8.14441 15.4379L14.024 5.27812L8.20954 8.71066ZM1.86659 5.47967L1.80701 11.6375L7.11009 8.50701L1.86659 5.47967ZM7.40989 15.4695L7.47105 9.14653L2.02579 12.361L7.40989 15.4695ZM13.5894 12.2478L11.5194 11.0527L9.40232 14.7196L13.5894 12.2478ZM13.9628 11.6011L14.0098 6.73917L11.8928 10.406L13.9628 11.6011ZM14.6888 12.4514L7.76665 16.5378L0.922218 12.5862L1.00002 4.54813L7.92222 0.461814L14.7667 4.41345L14.6888 12.4514Z",fill:"#9599A8"})}),"Open in Cursor"]}),x.Fr?(0,n.jsx)("button",{onClick:()=>ev(!0),className:"flex w-[36px] h-[36px] aspect-1 rounded-[10px] outline-none focus:outline-none ring-0 focus:ring-0 justify-center items-center text-gray-300 hover:bg-gray-500/30 transition-colors",children:(0,n.jsx)(H.A,{size:16})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>eh(!0),onMouseEnter:()=>{var e;null==(e=eN.current)||e.startAnimation()},onMouseLeave:()=>{var e;null==(e=eN.current)||e.stopAnimation()},className:"flex w-full rounded-md outline-none focus:outline-none ring-0 focus:ring-0 sm:w-auto group justify-center sm:justify-start py-2 sm:py-1.5 items-center gap-1.5 px-2 bg-[#242830] text-[#D8DEE9] hover:bg-[#2D3138] text-sm font-medium transition-colors",children:[(0,n.jsx)(rd,{ref:eN,size:16}),(0,n.jsx)("span",{className:"block sm:hidden",children:"Share"})]}),!(null==(D=T.composer)?void 0:D.isArchived)&&!(null==(R=T.composer)?void 0:R.isOwnedByDifferentTeamMember)&&(0,n.jsxs)("button",{onClick:()=>ex(!0),onMouseEnter:()=>{var e;null==(e=ej.current)||e.startAnimation()},onMouseLeave:()=>{var e;null==(e=ej.current)||e.stopAnimation()},className:"flex w-full rounded-md outline-none focus:outline-none ring-0 focus:ring-0 sm:w-auto group justify-center sm:justify-start py-2 sm:py-1.5 items-center gap-1.5 px-2 bg-[#242830] text-[#D8DEE9]  text-sm font-medium hover:bg-red-500/30 transition-colors disabled:opacity-50 disabled:cursor-default",children:[(0,n.jsx)(rp,{ref:ej,size:16,className:"text-gray-400 group-hover:text-red-300"}),(0,n.jsx)("span",{className:"block sm:hidden",children:"Delete"})]})]})]})]}),T.summary&&!x.Fr&&!$&&(0,n.jsxs)("div",{className:"flex flex-col gap-y-2 group",onClick:()=>{eo||ei(!0)},onMouseEnter:()=>{if(!eo){var e;null==(e=eC.current)||e.startAnimation()}},onMouseLeave:()=>{if(!eo){var e;null==(e=eC.current)||e.stopAnimation()}},style:{cursor:eo||!ec?"":"pointer",maxHeight:eo?"none":"".concat(200,"px")},children:[(0,n.jsxs)("div",{className:" transition-all duration-300 overflow-hidden relative",children:[ec&&!eo&&(0,n.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-16 pointer-events-none",style:{background:"linear-gradient(to bottom, transparent 0%, rgba(21, 22, 25, 0.05) 40%, rgba(21, 22, 25, 0.2) 60%, rgba(21, 22, 25, 0.5) 80%, rgba(21, 22, 25, 0.8) 90%, rgb(21, 22, 25) 100%)"}}),(0,n.jsx)("div",{ref:ey,className:"text-sm text-gray-500 prose prose-invert prose-sm max-w-none [&_strong]:text-gray-500 [&_li_code]:break-all [&_li_code]:overflow-wrap-anywhere [&_pre]:overflow-x-auto [&_pre]:max-w-full [&_code]:before:content-none [&_code]:after:content-none",children:(0,n.jsx)(Z.oz,{components:eL,children:T.summary})})]}),ec&&(0,n.jsxs)("button",{onClick:()=>ei(!eo),className:"flex items-center justify-center w-full text-xs text-gray-500 hover:text-gray-400 transition-colors",children:[(0,n.jsx)(Y,{ref:eC,className:"mr-1 transition-transform duration-300 ease-in-out ".concat(eo?"rotate-180":""," ").concat(eo?"":"group-hover:text-gray-400"),size:16}),eo?(0,n.jsx)(n.Fragment,{children:"Show less"}):(0,n.jsx)("span",{className:"text-gray-500 group-hover:text-gray-400 transition-colors",children:"Show entire summary"})]})]})]})})]})}var rN=r(53777),rk=r(37147);let rS=e=>{var t;let{originalText:r,modifiedText:s,fileName:a,defaultExpanded:l=!1,isExpanded:o,onToggleExpanded:i,selectedComposer:u,filesBeingReverted:p,setFilesBeingReverted:f,refreshDetailedDiff:h}=e,[g,b]=(0,c.useState)(0),[w,y]=(0,c.useState)(0),[j,C]=(0,c.useState)(l),N=void 0!==o?o:j,k=(0,c.useMemo)(()=>(function(e,t){try{if(t){let e=t.toLowerCase().split(".").pop(),r=new Set(["png","jpg","jpeg","gif","bmp","ico","svg","pdf","zip","tar","gz","rar","7z","exe","dll","so","dylib","mp3","mp4","avi","mov","wav","woff","woff2","ttf","eot","bin","dat","db","sqlite"]);if(e&&r.has(e))return!1;let n=new Set(["txt","md","json","js","jsx","ts","tsx","html","htm","css","scss","sass","less","xml","yaml","yml","toml","ini","conf","py","rb","php","java","c","cpp","h","go","rs","sh","bat","ps1","sql"]);if(e&&n.has(e))return!0}if(e.includes("\0"))return!1;let r=0,n=Math.min(e.length,8192);for(let t=0;t<n;t++){let n=e.charCodeAt(t);n<32&&9!==n&&10!==n&&13!==n&&r++}if(r/n>.3)return!1;return!0}catch(e){return console.warn("Error detecting text content:",e),!0}})(s||r,a),[s,r,a]),S=(0,c.useMemo)(()=>(0,rk.ue)(a),[a]),[E,L]=(0,c.useState)(!1),[A,M]=(0,c.useState)(!1),[_,I]=(0,c.useState)(!0),[D,R]=(0,c.useState)(!1),{diffViewMode:T}=(0,v._F)(),[F,P]=(0,c.useState)(!1),[B,O]=(0,c.useState)(!1),[z,U]=(0,c.useState)(!1),[W,q]=(0,c.useState)(!1),[J,G]=(0,c.useState)(!1),[Z,V]=(0,c.useState)(!1),K=(0,c.useRef)(null),$=(0,c.useRef)(null),X=(0,c.useRef)(null),Y=(0,c.useRef)(null),[Q,ee]=(0,c.useState)(!1),[et,er]=(0,c.useState)(!1),[en,es]=(0,c.useState)(!1),ea=(0,c.useRef)(null),el=(0,c.useRef)(null),eo=(0,c.useRef)(null),ei="diff-".concat(a.replace(/[^a-zA-Z0-9]/g,"-"));(0,c.useEffect)(()=>{if(!x.Fr||!X.current)return;let e=X.current,t=()=>{if(e){let t=e.scrollWidth>e.clientWidth;L(t),t?(e.scrollLeft=e.scrollWidth-e.clientWidth,M(!0),I(!1)):(M(!1),I(!0))}},r=()=>{if(e){let t=1>Math.abs(e.scrollLeft+e.clientWidth-e.scrollWidth),r=e.scrollLeft<1;M(t),I(r)}};t(),e.addEventListener("scroll",r);let n=new ResizeObserver(()=>{t()});return n.observe(e),()=>{e.removeEventListener("scroll",r),n.disconnect()}},[a]);let ec=(0,c.useCallback)((e,t,r)=>{let n;if(e===t)return"diff --git a/".concat(r," b/").concat(r);let s=""===e?[]:e.split("\n"),a=""===t?[]:t.split("\n"),l=["diff --git a/".concat(r," b/").concat(r),"--- a/".concat(r),"+++ b/".concat(r)],o=s.length,i=a.length;if(0===o&&0===i)return l.join("\n");for(let e of(n=0===o?"@@ -0,0 +1,".concat(i," @@"):0===i?"@@ -1,".concat(o," +0,0 @@"):"@@ -1,".concat(o," +1,").concat(i," @@"),l.push(n),s))l.push("-".concat(e));for(let e of a)l.push("+".concat(e));return l.join("\n")},[]),ed=(0,c.useCallback)(async e=>{e.stopPropagation();try{let e=ec(r,s,a);await navigator.clipboard.writeText("(cd \"$(git rev-parse --show-toplevel)\" && git apply --3way <<'EOF'\n".concat(e,"\nEOF\n)")),P(!0),setTimeout(()=>P(!1),300)}catch(e){console.error("Failed to copy git apply:",e)}},[a,r,s,ec]),eu=(0,c.useCallback)(async e=>{e.stopPropagation();try{let e=ec(r,s,a);await navigator.clipboard.writeText(e),O(!0),setTimeout(()=>O(!1),300)}catch(e){console.error("Failed to copy git patch:",e)}},[a,r,s,ec]),em=(0,c.useCallback)(async e=>{var t,r;if(e.stopPropagation(),!(null==u||null==(t=u.composer)?void 0:t.bcId))return void console.error("No composer ID available for revert");q(!0),G(!1),f(e=>new Set(e).add(a));try{let e=new m.yz({bcId:u.composer.bcId,filePath:a}),t=await fetch("/api/background-composer/revert-file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.toJson())});if(!t.ok){let e=await t.json();throw Error((null==e||null==(r=e.error)?void 0:r.message)||"HTTP error! status: ".concat(t.status))}G(!0),setTimeout(()=>G(!1),2e3),h(u.composer.bcId),f(e=>{let t=new Set(e);return t.delete(a),t}),R(!1)}catch(t){console.error("Failed to revert file:",t);let e=t instanceof Error?t.message:"Failed to revert changes";d.oR.error(e,{duration:5e3}),f(e=>{let t=new Set(e);return t.delete(a),t})}finally{q(!1)}},[a,null==u||null==(t=u.composer)?void 0:t.bcId,f,h]);(0,c.useEffect)(()=>{let e=e=>{Y.current&&!Y.current.contains(e.target)&&R(!1)};return D&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[D]),(0,c.useEffect)(()=>{let e=e=>{"Escape"===e.key&&D&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),R(!1))};if(D)return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}},[D]),(0,c.useEffect)(()=>(ea.current&&(clearTimeout(ea.current),ea.current=null),el.current&&(clearTimeout(el.current),el.current=null),eo.current&&(clearTimeout(eo.current),eo.current=null),D?(er(!0),ea.current=setTimeout(()=>{ee(!0),el.current=setTimeout(()=>{es(!0)},50)},10)):(es(!1),ee(!1),eo.current=setTimeout(()=>{er(!1)},150)),()=>{ea.current&&(clearTimeout(ea.current),ea.current=null),el.current&&(clearTimeout(el.current),el.current=null),eo.current&&(clearTimeout(eo.current),eo.current=null)}),[D]);let ep=(0,c.useCallback)(async e=>{e.stopPropagation();try{await navigator.clipboard.writeText(a),U(!0),setTimeout(()=>U(!1),1500)}catch(e){console.error("Failed to copy filename:",e)}},[a]),ex=(0,c.useCallback)(()=>(0,n.jsxs)("div",{className:"relative",ref:Y,"data-menu-open":D?"true":"false",children:[(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),R(!D)},className:"flex outline-none border-none ring-0 focus:outline-none focus:ring-0 items-center justify-center hover:bg-white/5 transition-colors p-1 rounded text-white/60 hover:text-white/80","aria-label":"More options",children:(0,n.jsx)(H.A,{size:16})}),et&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0",style:{zIndex:et?1e3:-1,pointerEvents:en?"auto":"none"},onClick:()=>R(!1)}),(0,n.jsxs)("div",{"data-menu-open":D?"true":"false",className:"absolute right-0 top-full mt-2 min-w-[220px] p-1 rounded-lg shadow-lg",style:{backgroundColor:"#1b1d21",border:"1px solid #24262a",boxShadow:"0 0 8px 2px color-mix(in srgb, var(--vscode-widget-shadow, rgba(0, 0, 0, 0.36)) 30%, transparent)",opacity:+!!Q,zIndex:et?1e3:-1,pointerEvents:en?"auto":"none",transform:Q?"scale(1)":"scale(0.95)",transformOrigin:"top right",transition:"opacity 0.15s ease-out, transform 0.15s ease-out"},children:[(0,n.jsxs)("button",{onClick:ed,className:"w-full px-3 py-2 text-left text-sm text-white/80 hover:bg-white/5 transition-colors flex items-center gap-2",children:[F?(0,n.jsx)(ek.A,{size:14,className:"text-gray-300"}):(0,n.jsx)(ty.A,{size:14}),F?"Copied":"Copy git apply"]}),(0,n.jsxs)("button",{onClick:eu,className:"w-full px-3 py-2 text-left text-sm text-white/80 hover:bg-white/5 transition-colors flex items-center gap-2",children:[B?(0,n.jsx)(ek.A,{size:14,className:"text-gray-300"}):(0,n.jsx)(ty.A,{size:14}),B?"Copied":"Copy git patch"]}),(0,n.jsxs)("button",{onClick:em,disabled:W,className:"outline-none border-none focus:outline-none focus:ring-0 w-full px-3 py-2 text-left text-sm text-white/80 hover:bg-white/5 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,n.jsx)(rN.A,{size:14}),W?"Reverting...":J?"Reverted!":"Revert changes"]})]})]})]}),[D,et,en,Q,ed,F,eu,B,em,W,J]);return(0,n.jsx)("div",{id:ei,ref:$,children:(0,n.jsx)("div",{className:"flex flex-col gap-0",children:(0,n.jsxs)("div",{className:"hover:bg-white/[0.04] group hover:border-[#CCCCCC]/[0.08] border border-transparent ".concat(x.Fr?"border-b-0":"rounded-[6px]"),children:[(0,n.jsxs)("div",{className:"flex items-center p-1 group cursor-pointer ".concat(!x.Fr?"sticky top-0 z-30 bg-[#15161a] group-hover:bg-[#1e2022] rounded-md ".concat(N?"rounded-b-none":""):""," ").concat(x.Fr&&N?"pb-3":""),onClick:()=>{let e=!N;i?i(a,e):C(e)},onMouseEnter:()=>{if(!x.Fr){var e;null==(e=K.current)||e.startAnimation(),V(!0)}},onMouseLeave:()=>{if(!x.Fr){var e;null==(e=K.current)||e.stopAnimation(),V(!1),U(!1)}},children:[(0,n.jsx)("button",{"data-expand-button":!0,className:"flex outline-none border-none focus:outline-none focus:ring-0 items-center justify-center transition-colors p-1 rounded text-white/60","aria-label":"Toggle diff",children:(0,n.jsx)(tO.A,{size:16,className:"".concat(N?"rotate-90":""," transition-transform duration-200 text-[#7C818E]")})}),(0,n.jsxs)("div",{className:"flex items-center gap-0 min-w-0 flex-1",children:[(0,n.jsxs)("div",{className:"relative min-w-0",children:[(0,n.jsx)("div",{ref:X,className:"".concat(x.Fr?"text-[11px] overflow-x-auto py-2 whitespace-nowrap scrollbar-hide":"text-[13px] min-w-0 flex-shrink"," group-hover:text-[#D8DEE9] text-[#B5BDC8]"),children:(0,n.jsx)("div",{className:"".concat(x.Fr?"":"truncate"),children:a})}),x.Fr&&(0,n.jsx)("div",{className:"absolute top-0 left-0 w-8 h-full bg-gradient-to-r from-[#17191d] to-transparent pointer-events-none transition-opacity duration-300 ease-in-out z-0 ".concat(E&&!_?"opacity-100":"opacity-0")}),x.Fr&&(0,n.jsx)("div",{className:"absolute top-0 right-0 w-8 h-full bg-gradient-to-l from-[#17191d] to-transparent pointer-events-none transition-opacity duration-300 ease-in-out z-0 ".concat(E&&!A?"opacity-100":"opacity-0")})]}),(0,n.jsxs)("div",{className:"flex items-center gap-0 ml-1 t",children:[g>0&&(0,n.jsxs)("span",{className:"text-[#A3BE8C] text-xs sm:text-[13px] flex items-center gap-1 flex-shrink-0",children:["+",g]}),w>0&&(0,n.jsxs)("span",{className:"text-[#BF616A] text-xs sm:text-[13px] flex items-center gap-1 flex-shrink-0",children:["-",w]})]}),(0,n.jsx)("button",{onClick:ep,className:"flex items-center outline-none border-none focus:outline-none focus:ring-0 justify-center hover:bg-white/5 transition-all p-1 rounded text-white/60 hover:text-white/80 ml-1 ".concat(Z||x.Fr&&N?"opacity-100":"opacity-0"),onMouseLeave:()=>{U(!1)},"aria-label":"Copy file name",children:z?(0,n.jsx)(ek.A,{size:14,className:"text-gray-300"}):(0,n.jsx)(ty.A,{size:14})})]}),(0,n.jsx)("div",{className:"flex items-center gap-1 ml-auto",children:N&&ex()})]}),(0,n.jsx)("div",{"data-diff-content":!0,className:"bg-[#151619] rounded-bl-lg rounded-br-lg overflow-hidden ".concat(N?"block":"hidden"),children:k?S?(0,n.jsx)("div",{className:"flex items-center justify-center py-8 px-4",children:(0,n.jsx)("div",{className:"text-center text-gray-400",children:(0,n.jsx)("div",{className:"text-xs text-gray-500",children:"Diff hidden for lockfile"})})}):(0,n.jsx)(rk.be,{originalText:r,modifiedText:s,fileName:a,compact:!1,viewMode:T,onDidMountDiffEditor:e=>{let t=e.getLineChanges();if(t){let e=0,r=0;t.forEach(t=>{let{modifiedEndLineNumber:n,originalEndLineNumber:s,modifiedStartLineNumber:a,originalStartLineNumber:l}=t;n>=a&&(e+=n-a+1),s>=l&&(r+=s-l+1)}),b(e),y(r)}else b(0),y(0)}}):(0,n.jsx)("div",{className:"flex items-center justify-center py-8 px-4",children:(0,n.jsx)("div",{className:"text-center text-gray-400",children:(0,n.jsx)("div",{className:"text-xs text-gray-500",children:"Cannot display diff for binary file"})})})})]})})})},rE=e=>{var t,r,s,a,l,o,i,d,u,p,f,h,g,b,w,y,j,C,N,k,S;let{activeTab:E,selectedComposer:L,prUrl:A,onPrMerged:M,scrollToFilename:_,expandAllRef:I,collapseAllRef:D,viewConfig:R}=e,{detailedDiffs:T,startHashChecking:F,stopHashChecking:P,refreshDetailedDiff:B,filesBeingReverted:O,setFilesBeingReverted:z}=(0,v._F)(),[U,W]=(0,c.useState)(void 0),[H,q]=(0,c.useState)({}),J=(null==R?void 0:R.viewMode)==="full";L.summary;let G=null==(t=L.composer)?void 0:t.bcId,Z=(0,c.useMemo)(()=>G&&T.get(G)||null,[G,T]),K=(0,c.useCallback)(e=>G?"".concat("composer_diff_expanded:").concat(G,":").concat(e):null,[G]),$=(0,c.useCallback)(e=>{if(x.Fr||!G)return!1;let t=K(e);if(!t)return!1;try{return"1"===localStorage.getItem(t)}catch(e){return console.error("Failed to read diff expanded state from cache:",e),!1}},[G,K]),X=(0,c.useCallback)(e=>{if(x.Fr||!G)return{};let t={};try{return e.forEach(e=>{$(e)&&(t[e]=!0)}),t}catch(e){return console.error("Failed to load diff expanded state from cache:",e),{}}},[G,$]),Y=(0,c.useCallback)((e,t)=>{if(x.Fr||!G)return;let r=K(e);if(r)try{t?localStorage.setItem(r,"1"):localStorage.removeItem(r)}catch(e){console.error("Failed to save diff expanded state to cache:",e)}},[G,K]),Q=(0,c.useRef)(null),ee=(0,c.useRef)(null),et=(0,c.useCallback)(e=>{ee.current&&(ee.current.disconnect(),ee.current=null),e&&(W(e.clientWidth),ee.current=new ResizeObserver(e=>{for(let t of e)W(t.contentRect.width)}),ee.current.observe(e))},[]);(0,c.useEffect)(()=>()=>{ee.current&&ee.current.disconnect()},[]);let en=(0,c.useCallback)(e=>e.to&&e.from?"/dev/null"===e.to?e.from:(e.from,e.to):e.to&&"/dev/null"!==e.to?e.to:e.from&&"/dev/null"!==e.from?e.from:e.to||e.from,[]);(0,c.useEffect)(()=>{var e,t,r;if(x.Fr||!G)return;let n=[];if((null==Z||null==(e=Z.diff)?void 0:e.diffs)&&n.push(...Z.diff.diffs.map(e=>en(e)).filter(Boolean)),null==Z?void 0:Z.submoduleDiffs)for(let e of Z.submoduleDiffs)!e.errored&&(null==(r=e.diff)?void 0:r.diffs)&&n.push(...e.diff.diffs.map(e=>en(e)).filter(Boolean));(null==(t=L.diffSinceStart)?void 0:t.diffs)&&n.push(...L.diffSinceStart.diffs.map(e=>en(e)).filter(Boolean));let s=X(n),a="collapsed"!==localStorage.getItem("general-expand-mode"),l={};n.forEach(e=>{e in s?l[e]=s[e]:l[e]=a}),q(l)},[G,Z,null==(r=L.diffSinceStart)?void 0:r.diffs,en,X]);let es=(0,c.useCallback)(()=>{var e,t,r;let n=[];if((null==Z||null==(e=Z.diff)?void 0:e.diffs)&&n.push(...Z.diff.diffs.map(e=>en(e)).filter(Boolean)),null==Z?void 0:Z.submoduleDiffs)for(let e of Z.submoduleDiffs)!e.errored&&(null==(r=e.diff)?void 0:r.diffs)&&n.push(...e.diff.diffs.map(e=>en(e)).filter(Boolean));(null==(t=L.diffSinceStart)?void 0:t.diffs)&&n.push(...L.diffSinceStart.diffs.map(e=>en(e)).filter(Boolean));let s={};n.forEach(e=>{s[e]=!0,Y(e,!0)}),q(s)},[Z,null==(s=L.diffSinceStart)?void 0:s.diffs,en,Y]),ea=(0,c.useCallback)(()=>{var e,t,r;let n=[];if((null==Z||null==(e=Z.diff)?void 0:e.diffs)&&n.push(...Z.diff.diffs.map(e=>en(e)).filter(Boolean)),null==Z?void 0:Z.submoduleDiffs)for(let e of Z.submoduleDiffs)!e.errored&&(null==(r=e.diff)?void 0:r.diffs)&&n.push(...e.diff.diffs.map(e=>en(e)).filter(Boolean));(null==(t=L.diffSinceStart)?void 0:t.diffs)&&n.push(...L.diffSinceStart.diffs.map(e=>en(e)).filter(Boolean));let s={};n.forEach(e=>{s[e]=!1,Y(e,!1)}),q(s)},[Z,null==(a=L.diffSinceStart)?void 0:a.diffs,en,Y]),el=(0,c.useCallback)((e,t)=>{q(r=>({...r,[e]:t})),Y(e,t)},[Y]);(0,c.useEffect)(()=>{I&&(I.current=es),D&&(D.current=ea)},[I,D,es,ea]);let eo=(0,c.useCallback)(e=>{let t=(e=>{var t,r,n;let s=[];if((null==Z||null==(t=Z.diff)?void 0:t.diffs)&&s.push(...Z.diff.diffs.map(e=>en(e)).filter(Boolean)),null==Z?void 0:Z.submoduleDiffs)for(let e of Z.submoduleDiffs)!e.errored&&(null==(n=e.diff)?void 0:n.diffs)&&s.push(...e.diff.diffs.map(e=>en(e)).filter(Boolean));if((null==(r=L.diffSinceStart)?void 0:r.diffs)&&s.push(...L.diffSinceStart.diffs.map(e=>en(e)).filter(Boolean)),s.includes(e))return e;let a=s.filter(t=>t&&t.endsWith(e));return a.length>0?a[0]:e})(e),r="diff-".concat(t.replace(/[^a-zA-Z0-9]/g,"-")),n=document.getElementById(r);if(n){let e=n.querySelector("[data-expand-button]"),t=n.querySelector("[data-diff-content]");e&&t&&t.classList.contains("hidden")&&e.click(),setTimeout(()=>{n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),n.style.boxShadow="0 0 0 2px #5E81AC",n.style.borderRadius="8px",n.style.transition="box-shadow 0.3s ease-out",setTimeout(()=>{n.style.boxShadow=""},2e3)},100)}},[Z,L,en]);(0,c.useEffect)(()=>{_&&eo(_)},[_,eo]);let ei=G&&T.has(G),ec=G&&!ei,ed=ei&&null===Z;(0,c.useEffect)(()=>{if(G)return F(G),()=>{P(G)}},[G,null==(l=L.composer)?void 0:l.createdAtMs,null==L||null==(i=L.diffSinceStart)||null==(o=i.diffs)?void 0:o.length,F,P]);let eu=(0,c.useCallback)(e=>{let t=[],r=[];for(let n of e)if(n.lines){for(let e of n.lines)if(e.startsWith("-"))t.push(e.substring(1));else if(e.startsWith("+"))r.push(e.substring(1));else if(!e.startsWith("@@")&&!e.startsWith("diff ")&&!e.startsWith("---")&&!e.startsWith("+++")&&!e.startsWith("\\")&&!e.startsWith("index ")&&!e.startsWith("new file mode")&&!e.startsWith("deleted file mode")){let n=e.startsWith(" ")?e.substring(1):e;t.push(n),r.push(n)}}return{originalText:t.join("\n"),modifiedText:r.join("\n")}},[]);if("conversation"===E)return null;let em=(null!=(w=null==Z||null==(u=Z.diff)||null==(d=u.diffs)?void 0:d.length)?w:0)>0,ep=null!=(y=null==Z||null==(p=Z.submoduleDiffs)?void 0:p.some(e=>{var t,r,n;return!e.errored&&(null!=(n=null==(r=e.diff)||null==(t=r.diffs)?void 0:t.length)?n:0)>0}))&&y,ex=(null!=(j=null==(h=L.diffSinceStart)||null==(f=h.diffs)?void 0:f.length)?j:0)>0;if(!(em||ep)&&ex){let e=[];if((null==Z||null==(C=Z.diff)?void 0:C.diffs)&&e.push(...Z.diff.diffs),null==Z?void 0:Z.submoduleDiffs)for(let t of Z.submoduleDiffs)!t.errored&&(null==(k=t.diff)?void 0:k.diffs)&&e.push(...t.diff.diffs);0===e.length&&(null==(N=L.diffSinceStart)?void 0:N.diffs)&&e.push(...L.diffSinceStart.diffs);let t=e.filter(e=>{let t=en(e);return!O.has(t)});return 0===t.length?(0,n.jsx)("div",{className:"p-0 py-2 w-full flex items-center justify-center",children:(0,n.jsx)("div",{className:"flex items-center justify-center py-8 w-full",children:(0,n.jsx)("div",{className:"text-sm text-white/40",children:"No code changes"})})}):(0,n.jsx)("div",{className:"".concat(x.Fr?"py-5 min-h-[260px]":J||ec?"p-0 pt-2":"p-10 py-5"," w-full flex ").concat("code"===E?"pb-20":""),children:(0,n.jsx)("div",{className:"flex-col gap-6 w-full ".concat((x.Fr,"space-y-0")),children:t.map((e,r)=>{var s;let a=en(e);if(!a&&(null==(s=e.chunks)?void 0:s.length)>0){for(let t of e.chunks)if(t.lines){let e="";for(let r of t.lines){if(r.startsWith("--- a/")||r.startsWith("--- /dev/null")){e=r;continue}if(r.startsWith("+++ b/")){a=r.substring(6);break}if(r.startsWith("+++ /dev/null")){e.startsWith("--- a/")&&(a=e.substring(6));break}}if(a)break}}a||(a="Change ".concat(r+1));let{originalText:l,modifiedText:o}=eu(e.chunks||[]);return(0,n.jsx)(rS,{originalText:l,modifiedText:o,fileName:a,defaultExpanded:void 0!==H[a]?H[a]:1===t.length,isExpanded:H[a],onToggleExpanded:el,selectedComposer:L,filesBeingReverted:O,setFilesBeingReverted:z,refreshDetailedDiff:B},"".concat(r,"-").concat(a))})})})}let ef=[];if((null==Z||null==(g=Z.diff)?void 0:g.diffs)&&ef.push(...Z.diff.diffs),null==Z?void 0:Z.submoduleDiffs)for(let e of Z.submoduleDiffs)!e.errored&&(null==(S=e.diff)?void 0:S.diffs)&&ef.push(...e.diff.diffs);let eh=ef.filter(e=>{let t=en(e);return!O.has(t)});return(0,n.jsxs)("div",{className:"relative ".concat(x.Fr?"py-5":J||ec?"p-0 pt-2":"p-10 py-5"," w-full flex ").concat("code"===E?"pb-20":""),children:[(0,n.jsx)("div",{className:"flex-col gap-6 w-full",ref:et,children:ec?(0,n.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,n.jsxs)("div",{className:"text-sm text-gray-400 make-shine",children:["Loading",(0,n.jsx)(er,{})]})}):ed?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 gap-4",children:[(0,n.jsx)("div",{className:"text-sm text-gray-300",children:"No changes found yet"}),(0,n.jsx)("button",{onClick:()=>G&&B(G),className:"px-3 py-1 text-sm text-gray-300 bg-gray-500/20 hover:bg-gray-500/30 rounded transition-colors",children:"Retry"})]}):(0,n.jsx)(n.Fragment,{children:eh.length>0?(0,n.jsx)("div",{ref:Q,children:eh.map((e,t)=>{let r=en(e),s=void 0!==e.beforeFileContents?e.beforeFileContents:e.chunks&&e.chunks.length>0?eu(e.chunks).originalText:"",a=void 0!==e.afterFileContents?e.afterFileContents:e.chunks&&e.chunks.length>0?eu(e.chunks).modifiedText:"";return(0,n.jsx)(rS,{originalText:s,modifiedText:a,fileName:r,defaultExpanded:void 0!==H[r]?H[r]:1===eh.length,isExpanded:H[r],onToggleExpanded:el,selectedComposer:L,filesBeingReverted:O,setFilesBeingReverted:z,refreshDetailedDiff:B},"".concat(t,"-").concat(r))})}):!ec&&(0,n.jsx)("div",{className:"flex items-center justify-center py-8 w-full",children:(0,n.jsx)("div",{className:"text-sm text-white/40",children:"No code changes"})})})}),(null==R?void 0:R.viewMode)!=="full"&&(null==(b=L.composer)?void 0:b.status)!==m.R6.EXPIRED&&(0,n.jsx)(ry,{prUrl:A,onPrMerged:M,parentWidth:U,isMobile:x.Fr}),(0,n.jsx)(V.m_,{id:"file-name-tooltip",noArrow:!0,style:{padding:"4px 8px",fontSize:"12px",background:"rgba(0, 0, 0)",outline:"1px solid rgba(255,255,255,0.1)",fontWeight:"400",maxWidth:"600px",wordBreak:"break-all",zIndex:1e6}})]})};function rL(e){var t,r,s,a,l,o;let{selectedComposer:i,selectedComposerDiffStats:u,isComposerNotFound:p,prLoading:f,existingPrUrl:g,onOpenInCursor:b,onOpenExistingPullRequest:w,onOpenPullRequest:y,onCloseModal:j,onPrMerged:C,viewConfig:N,expandAllRef:k,collapseAllRef:S,conversationScrollRef:E,children:L}=e,{getConversationForAgent:A,logs:M,isConversationFirstLoading:_,startConversationFetching:I,stopConversationFetching:D,detailedDiffs:R,ensureDiffLoaded:T,updateComposerStatusOptimistically:F,addOptimisticMessage:P,removeOptimisticMessage:B,refetchBackgroundComposers:O}=(0,v._F)(),z=(0,h.t)(),U=(0,c.useRef)(null),W=(0,c.useRef)(null),[H,q]=(0,c.useState)("code"),[J,G]=(0,c.useState)(void 0),[Z,V]=(0,c.useState)(""),[K,$]=(0,c.useState)(""),[X,Y]=(0,c.useState)(null),Q=(0,c.useCallback)(e=>{V(e)},[]),[ee,et]=(0,c.useState)(!1),[er,en]=(0,c.useState)(!1),[es,ea]=(0,c.useState)(null),el=(0,c.useMemo)(()=>{var e,t,r,n,s,a,l,o;if(!i)return!1;let c=null==(e=i.composer)?void 0:e.bcId;if(null==(t=i.composer)?void 0:t.isKilled)return R.has(i.composer.bcId);if(!c)return!1;let d=R.get(c);if(d){let e=!!(null==(l=d.diff)||null==(a=l.diffs)?void 0:a.length),t=!!(null==(o=d.submoduleDiffs)?void 0:o.some(e=>{var t,r;return!e.errored&&(null==(r=e.diff)||null==(t=r.diffs)?void 0:t.length)}));return e||t}let u=!!(null==i||null==(n=i.diffSinceStart)||null==(r=n.diffs)?void 0:r.length),p=null==(s=i.composer)?void 0:s.status,x=!!(p&&(p===m.R6.FINISHED||p===m.R6.RUNNING||p===m.R6.EXPIRED));return!!(u&&x)},[i,R]);(0,c.useEffect)(()=>{let e=()=>{window.innerWidth>=1024?q("code"):el||q("conversation")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[el,q]);let eo=(0,c.useMemo)(()=>{var e;return A((null==i||null==(e=i.composer)?void 0:e.bcId)||"")},[A,null==i||null==(t=i.composer)?void 0:t.bcId]),ei=(0,c.useMemo)(()=>eo,[eo]),ec=(0,c.useMemo)(()=>{var e;return M.get((null==i||null==(e=i.composer)?void 0:e.bcId)||"")||[]},[M,null==i||null==(r=i.composer)?void 0:r.bcId]),ed=(0,c.useRef)(0);(0,c.useEffect)(()=>{let e=ed.current,t=ec.length;if(t>e){for(let r=e;r<t;r++){let e=ec[r];try{let t="string"==typeof e?e:JSON.stringify(e);console.debug("[BackgroundComposer][TerminalLog]",r,t)}catch(t){console.debug("[BackgroundComposer][TerminalLog]",r,e)}}ed.current=t}},[ec]);let eu=(0,c.useRef)(0);(0,c.useEffect)(()=>{let e=eu.current,t=eo.length;if(t>e){for(let r=e;r<t;r++){let e=eo[r];console.debug("[BackgroundComposer][ConversationMessage]",r,null==e?void 0:e.text,e)}eu.current=t}},[eo]);let em=(0,c.useMemo)(()=>{var e,t;return null!=i&&null!=(e=i.composer)&&!!e.bcId&&null!=(t=_.get(null==i?void 0:i.composer.bcId))&&t},[null==i||null==(s=i.composer)?void 0:s.bcId,_]);(0,c.useEffect)(()=>{var e;return(null==i||null==(e=i.composer)?void 0:e.bcId)?I(i.composer.bcId,i.composer.status):D(),()=>{D()}},[i,I,D]),(0,c.useEffect)(()=>{var e;(null==i||null==(e=i.composer)?void 0:e.bcId)&&T(i.composer.bcId)},[null==i||null==(a=i.composer)?void 0:a.bcId,null==i||null==(l=i.composer)?void 0:l.isKilled,T]);let ep=(0,c.useCallback)(async()=>{var e,t,r,n;if(!Z.trim()||!i||ee||!(null==(e=i.composer)?void 0:e.bcId))return;if(i.composer.isArchived)return void d.oR.error("Cannot send message, Agent is archived");let s=new AbortController;ea(s),et(!0);try{let e=new ey.hS({text:Z,type:ey.Jc.HUMAN});P(i.composer.bcId,e);let a=new m.FF({bcId:i.composer.bcId,followupMessage:e,synchronous:!0,followupSource:z?m._b.IOS_APP:m._b.WEBSITE}),l=await fetch("/api/auth/addAsyncFollowupBackgroundComposer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a.toJson()),signal:s.signal});if(!l.ok){let e=await l.json(),s=null==e||null==(r=e.error)||null==(t=r.details)?void 0:t.find(e=>"ERROR_UNAUTHORIZED"===e.error);if(s&&((null==(n=s.details)?void 0:n.detail)||"").includes("read-only access to this background composer")){d.oR.error("You have read-only access to this background composer."),B(i.composer.bcId,Z);return}throw B(i.composer.bcId,Z),Error("HTTP error! status: ".concat(l.status))}V(""),$(""),X&&X.update(()=>{(0,eC.NiT)().clear()}),await O()}catch(e){e instanceof Error&&"AbortError"===e.name?console.log("Conversation request was cancelled"):console.error("Error sending message:",e),B(i.composer.bcId,Z)}finally{et(!1),en(!1),ea(null)}},[Z,i,ee,X,P,B,O,z]),ex=(0,c.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||x.Fr||(e.preventDefault(),ep())},[ep]),ef=(0,c.useCallback)(e=>{el&&"code"!==H&&q("code"),setTimeout(()=>{G(e),setTimeout(()=>G(void 0),100)},el&&"code"!==H?200:0)},[el,H]),eh=(0,c.useMemo)(()=>{var e;return i?(0,n.jsx)(rC,{selectedComposer:i,selectedComposerDiffStats:u,prLoading:f,existingPrUrl:g,onOpenInCursor:b,onOpenExistingPullRequest:w,onOpenPullRequest:y,onFilenameClick:ef,onCloseModal:j,onPrMerged:C,isFullScreen:(null==N?void 0:N.viewMode)==="full"},null==(e=i.composer)?void 0:e.bcId):null},[i,u,f,g,b,w,y,ef,j,C,null==N?void 0:N.viewMode]),eg=(0,c.useMemo)(()=>ec&&0!==ec.length&&i?(0,n.jsx)("div",{className:"w-full h-full ".concat((null==N?void 0:N.viewMode)==="full"?"p-4 pt-0":"px-10 py-5"),children:(0,n.jsx)(t6,{logs:ec})}):null,[ec,i,null==N?void 0:N.viewMode]),ev=(0,c.useMemo)(()=>i?(0,n.jsx)(rE,{activeTab:H,selectedComposer:i,prUrl:g,scrollToFilename:J,expandAllRef:k||U,collapseAllRef:S||W,viewConfig:N,onPrMerged:()=>{}}):null,[i,H,g,J,k,S,U,W,N]),eb=(0,c.useMemo)(()=>{var e;return(0,n.jsx)(rs,{conversation:ei,logs:ec,isLoading:em,hasComposer:!!i,inSidebar:!1,onFilenameClick:ef,hasDiff:el,isComposerKilled:null==i||null==(e=i.composer)?void 0:e.isKilled,externalScrollRef:E})},[ei,ec,em,i,ef,el,E]),ew=(0,c.useCallback)(async()=>{var e;if(es&&es.abort(),en(!1),null==i||null==(e=i.composer)?void 0:e.bcId){let e=i.composer.bcId,t=i.composer.status;F(e,m.R6.FINISHED);try{let r=await fetch("/api/background-composer/pause",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e})});r.ok||(F(e,t),console.error("Failed to pause background composer: ".concat(r.status," ").concat(r.statusText)))}catch(r){F(e,t),console.error("Error pausing background composer:",r)}}},[es,i,F]),ej=(0,c.useMemo)(()=>{var e;return em||0===eo.length||(null==i||null==(e=i.composer)?void 0:e.isKilled)&&0===eo.length?null:(0,n.jsx)(th,{setText:Q,setRichText:$,setEditor:Y,onStop:ew,onSubmit:ep,isSubmitting:ee,isPaused:er,onKeyDown:ex,isCompact:!0,shouldAutoFocus:!1})},[em,eo.length,null==i||null==(o=i.composer)?void 0:o.isKilled,ew,ep,ee,er,ex,Q]);return L?(0,n.jsx)(n.Fragment,{children:L({activeTab:H,setActiveTab:q,hasCodeChanges:el,isComposerNotFound:p,currentConversation:eo,currentLogs:ec,hasComposer:!!i,inSidebar:!1,isLoading:em,conversationText:Z,setConversationText:Q,setConversationRichText:$,setConversationEditor:Y,handleConversationSubmit:ep,isConversationSubmitting:ee,isConversationPaused:er,handleConversationKeyDown:ex,TerminalLogsComponent:eg,handleFilenameClick:ef,HeaderComponent:eh,DiffsComponent:ev,ConversationComponent:eb,EditorComponent:ej})}):null}function rA(e){let{className:t}=e;return(0,n.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"".concat(t," icon-generating"),style:{transformOrigin:"center center"},children:(0,n.jsx)("path",{d:"M8.86853 3.94922C8.70903 3.94922 8.57003 3.88997 8.45154 3.77148C8.33305 3.65299 8.2738 3.51172 8.2738 3.34766V1.24219C8.2738 1.07812 8.33305 0.936849 8.45154 0.818359C8.57003 0.69987 8.70903 0.640625 8.86853 0.640625C9.03259 0.640625 9.17387 0.69987 9.29236 0.818359C9.41085 0.936849 9.47009 1.07812 9.47009 1.24219V3.34766C9.47009 3.51172 9.41085 3.65299 9.29236 3.77148C9.17387 3.88997 9.03259 3.94922 8.86853 3.94922ZM11.7806 5.15234C11.6667 5.03841 11.6097 4.89714 11.6097 4.72852C11.6097 4.5599 11.6667 4.41862 11.7806 4.30469L13.2777 2.82129C13.3916 2.70736 13.5306 2.65039 13.6947 2.65039C13.8633 2.65039 14.0046 2.70736 14.1185 2.82129C14.2325 2.93522 14.2894 3.0765 14.2894 3.24512C14.2894 3.40918 14.2325 3.54818 14.1185 3.66211L12.6283 5.15234C12.5144 5.26628 12.3731 5.32324 12.2045 5.32324C12.0358 5.32324 11.8946 5.26628 11.7806 5.15234ZM12.9906 8.06445C12.9906 7.90039 13.0498 7.76139 13.1683 7.64746C13.2868 7.52897 13.4258 7.46973 13.5853 7.46973H15.6908C15.8549 7.46973 15.9961 7.52897 16.1146 7.64746C16.2331 7.76139 16.2924 7.90039 16.2924 8.06445C16.2924 8.22396 16.2331 8.36296 16.1146 8.48145C15.9961 8.59993 15.8549 8.65918 15.6908 8.65918H13.5853C13.4258 8.65918 13.2868 8.59993 13.1683 8.48145C13.0498 8.36296 12.9906 8.22396 12.9906 8.06445ZM11.7806 10.9697C11.8946 10.8558 12.0358 10.7988 12.2045 10.7988C12.3731 10.7988 12.5144 10.8558 12.6283 10.9697L14.1185 12.4668C14.2325 12.5807 14.2894 12.722 14.2894 12.8906C14.2894 13.0547 14.2325 13.1937 14.1185 13.3076C14.0046 13.4215 13.8633 13.4785 13.6947 13.4785C13.5306 13.4785 13.3916 13.4215 13.2777 13.3076L11.7806 11.8174C11.6667 11.7035 11.6097 11.5622 11.6097 11.3936C11.6097 11.2249 11.6667 11.0837 11.7806 10.9697ZM8.86853 12.1797C9.03259 12.1797 9.17387 12.2389 9.29236 12.3574C9.41085 12.4759 9.47009 12.6149 9.47009 12.7744V14.8867C9.47009 15.0462 9.41085 15.1852 9.29236 15.3037C9.17387 15.4222 9.03259 15.4814 8.86853 15.4814C8.70903 15.4814 8.57003 15.4222 8.45154 15.3037C8.33305 15.1852 8.2738 15.0462 8.2738 14.8867V12.7744C8.2738 12.6149 8.33305 12.4759 8.45154 12.3574C8.57003 12.2389 8.70903 12.1797 8.86853 12.1797ZM5.96326 10.9697C6.07719 11.0837 6.13416 11.2249 6.13416 11.3936C6.13416 11.5622 6.07719 11.7035 5.96326 11.8174L4.46619 13.3076C4.35225 13.4215 4.21098 13.4785 4.04236 13.4785C3.8783 13.4785 3.7393 13.4215 3.62537 13.3076C3.51143 13.1937 3.45447 13.0547 3.45447 12.8906C3.45447 12.722 3.51143 12.5807 3.62537 12.4668L5.1156 10.9697C5.22953 10.8558 5.37081 10.7988 5.53943 10.7988C5.70805 10.7988 5.84932 10.8558 5.96326 10.9697ZM4.7533 8.06445C4.7533 8.22396 4.69405 8.36296 4.57556 8.48145C4.45707 8.59993 4.31807 8.65918 4.15857 8.65918H2.04626C1.88676 8.65918 1.74776 8.59993 1.62927 8.48145C1.51078 8.36296 1.45154 8.22396 1.45154 8.06445C1.45154 7.90039 1.51078 7.76139 1.62927 7.64746C1.74776 7.52897 1.88676 7.46973 2.04626 7.46973H4.15857C4.31807 7.46973 4.45707 7.52897 4.57556 7.64746C4.69405 7.76139 4.7533 7.90039 4.7533 8.06445ZM5.96326 5.15234C5.84932 5.26628 5.70805 5.32324 5.53943 5.32324C5.37081 5.32324 5.22953 5.26628 5.1156 5.15234L3.62537 3.66211C3.51143 3.54818 3.45447 3.40918 3.45447 3.24512C3.45447 3.0765 3.51143 2.93522 3.62537 2.82129C3.7393 2.70736 3.8783 2.65039 4.04236 2.65039C4.21098 2.65039 4.35225 2.70736 4.46619 2.82129L5.96326 4.30469C6.07719 4.41862 6.13416 4.5599 6.13416 4.72852C6.13416 4.89714 6.07719 5.03841 5.96326 5.15234Z",fill:"#88C0D0"})})}function rM(e){let{className:t}=e;return(0,n.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,n.jsx)("path",{d:"M8.87537 15.0371C7.91378 15.0371 7.01143 14.8548 6.16833 14.4902C5.32524 14.1302 4.58468 13.6312 3.94666 12.9932C3.30863 12.3551 2.80733 11.6146 2.44275 10.7715C2.08272 9.92839 1.90271 9.02604 1.90271 8.06445C1.90271 7.10286 2.08272 6.20052 2.44275 5.35742C2.80733 4.51432 3.30863 3.77376 3.94666 3.13574C4.58468 2.49316 5.32524 1.99186 6.16833 1.63184C7.01143 1.27181 7.91378 1.0918 8.87537 1.0918C9.83695 1.0918 10.7393 1.27181 11.5824 1.63184C12.4255 1.99186 13.1661 2.49316 13.8041 3.13574C14.4421 3.77376 14.9411 4.51432 15.3011 5.35742C15.6657 6.20052 15.848 7.10286 15.848 8.06445C15.848 9.02604 15.6657 9.92839 15.3011 10.7715C14.9411 11.6146 14.4421 12.3551 13.8041 12.9932C13.1661 13.6312 12.4255 14.1302 11.5824 14.4902C10.7393 14.8548 9.83695 15.0371 8.87537 15.0371ZM8.87537 13.875C9.67745 13.875 10.4294 13.7246 11.1312 13.4238C11.833 13.123 12.4506 12.7061 12.9838 12.1729C13.517 11.6396 13.934 11.0221 14.2347 10.3203C14.5355 9.61849 14.6859 8.86654 14.6859 8.06445C14.6859 7.26237 14.5355 6.51042 14.2347 5.80859C13.934 5.10221 13.517 4.4847 12.9838 3.95605C12.4506 3.42285 11.833 3.00586 11.1312 2.70508C10.4294 2.4043 9.67745 2.25391 8.87537 2.25391C8.07328 2.25391 7.32133 2.4043 6.61951 2.70508C5.91768 3.00586 5.30017 3.42285 4.76697 3.95605C4.23376 4.4847 3.81677 5.10221 3.51599 5.80859C3.21521 6.51042 3.06482 7.26237 3.06482 8.06445C3.06482 8.86654 3.21521 9.61849 3.51599 10.3203C3.81677 11.0221 4.23376 11.6396 4.76697 12.1729C5.30017 12.7061 5.91768 13.123 6.61951 13.4238C7.32133 13.7246 8.07328 13.875 8.87537 13.875ZM8.86853 9.29492C8.51762 9.29492 8.33761 9.11491 8.32849 8.75488L8.23962 5.13867C8.23507 4.96549 8.28975 4.82194 8.40369 4.70801C8.52218 4.59408 8.67485 4.53711 8.86169 4.53711C9.04399 4.53711 9.19438 4.59635 9.31287 4.71484C9.43591 4.82878 9.49516 4.97233 9.4906 5.14551L9.38806 8.75488C9.3835 9.11491 9.21033 9.29492 8.86853 9.29492ZM8.86853 11.5166C8.66801 11.5166 8.49483 11.4482 8.349 11.3115C8.20317 11.1702 8.13025 11.0016 8.13025 10.8057C8.13025 10.6097 8.20317 10.4434 8.349 10.3066C8.49483 10.1654 8.66801 10.0947 8.86853 10.0947C9.06905 10.0947 9.24223 10.1631 9.38806 10.2998C9.53389 10.4365 9.60681 10.6051 9.60681 10.8057C9.60681 11.0062 9.53162 11.1748 9.38123 11.3115C9.23539 11.4482 9.06449 11.5166 8.86853 11.5166Z",fill:"#848484"})})}function r_(e){let{className:t}=e;return(0,n.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,n.jsx)("path",{d:"M8.87537 15.0371C7.91378 15.0371 7.01143 14.8548 6.16833 14.4902C5.32524 14.1302 4.58468 13.6312 3.94666 12.9932C3.30863 12.3551 2.80733 11.6146 2.44275 10.7715C2.08272 9.92839 1.90271 9.02604 1.90271 8.06445C1.90271 7.10286 2.08272 6.20052 2.44275 5.35742C2.80733 4.51432 3.30863 3.77376 3.94666 3.13574C4.58468 2.49316 5.32524 1.99186 6.16833 1.63184C7.01143 1.27181 7.91378 1.0918 8.87537 1.0918C9.83695 1.0918 10.7393 1.27181 11.5824 1.63184C12.4255 1.99186 13.1661 2.49316 13.8041 3.13574C14.4421 3.77376 14.9411 4.51432 15.3011 5.35742C15.6657 6.20052 15.848 7.10286 15.848 8.06445C15.848 9.02604 15.6657 9.92839 15.3011 10.7715C14.9411 11.6146 14.4421 12.3551 13.8041 12.9932C13.1661 13.6312 12.4255 14.1302 11.5824 14.4902C10.7393 14.8548 9.83695 15.0371 8.87537 15.0371ZM8.87537 13.875C9.67745 13.875 10.4294 13.7246 11.1312 13.4238C11.833 13.123 12.4506 12.7061 12.9838 12.1729C13.517 11.6396 13.934 11.0221 14.2347 10.3203C14.5355 9.61849 14.6859 8.86654 14.6859 8.06445C14.6859 7.26237 14.5355 6.51042 14.2347 5.80859C13.934 5.10221 13.517 4.4847 12.9838 3.95605C12.4506 3.42285 11.833 3.00586 11.1312 2.70508C10.4294 2.4043 9.67745 2.25391 8.87537 2.25391C8.07328 2.25391 7.32133 2.4043 6.61951 2.70508C5.91768 3.00586 5.30017 3.42285 4.76697 3.95605C4.23376 4.4847 3.81677 5.10221 3.51599 5.80859C3.21521 6.51042 3.06482 7.26237 3.06482 8.06445C3.06482 8.86654 3.21521 9.61849 3.51599 10.3203C3.81677 11.0221 4.23376 11.6396 4.76697 12.1729C5.30017 12.7061 5.91768 13.123 6.61951 13.4238C7.32133 13.7246 8.07328 13.875 8.87537 13.875ZM8.12341 11.3047C8.00948 11.3047 7.90466 11.2796 7.80896 11.2295C7.71781 11.1794 7.62895 11.0996 7.54236 10.9902L5.87439 8.93945C5.76957 8.79818 5.71716 8.6569 5.71716 8.51562C5.71716 8.36523 5.76729 8.23763 5.86755 8.13281C5.97237 8.02344 6.0977 7.96875 6.24353 7.96875C6.33923 7.96875 6.42582 7.98926 6.5033 8.03027C6.58533 8.06673 6.66736 8.13965 6.74939 8.24902L8.09607 9.99219L10.933 5.43945C11.0606 5.23438 11.2201 5.13184 11.4115 5.13184C11.5528 5.13184 11.6804 5.17741 11.7943 5.26855C11.9082 5.3597 11.9652 5.48047 11.9652 5.63086C11.9652 5.70833 11.947 5.78581 11.9105 5.86328C11.8786 5.9362 11.8422 6.00456 11.8011 6.06836L8.67712 10.9902C8.54041 11.1999 8.35583 11.3047 8.12341 11.3047Z",fill:"#A3BE8C"})})}function rI(e){let{className:t}=e;return(0,n.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,n.jsx)("path",{d:"M8.87537 15.0371C7.91378 15.0371 7.01143 14.8548 6.16833 14.4902C5.32524 14.1302 4.58468 13.6312 3.94666 12.9932C3.30863 12.3551 2.80733 11.6146 2.44275 10.7715C2.08272 9.92839 1.90271 9.02604 1.90271 8.06445C1.90271 7.10286 2.08272 6.20052 2.44275 5.35742C2.80733 4.51432 3.30863 3.77376 3.94666 3.13574C4.58468 2.49316 5.32524 1.99186 6.16833 1.63184C7.01143 1.27181 7.91378 1.0918 8.87537 1.0918C9.83695 1.0918 10.7393 1.27181 11.5824 1.63184C12.4255 1.99186 13.1661 2.49316 13.8041 3.13574C14.4421 3.77376 14.9411 4.51432 15.3011 5.35742C15.6657 6.20052 15.848 7.10286 15.848 8.06445C15.848 9.02604 15.6657 9.92839 15.3011 10.7715C14.9411 11.6146 14.4421 12.3551 13.8041 12.9932C13.1661 13.6312 12.4255 14.1302 11.5824 14.4902C10.7393 14.8548 9.83695 15.0371 8.87537 15.0371ZM8.87537 13.875C9.67745 13.875 10.4294 13.7246 11.1312 13.4238C11.833 13.123 12.4506 12.7061 12.9838 12.1729C13.517 11.6396 13.934 11.0221 14.2347 10.3203C14.5355 9.61849 14.6859 8.86654 14.6859 8.06445C14.6859 7.26237 14.5355 6.51042 14.2347 5.80859C13.934 5.10221 13.517 4.4847 12.9838 3.95605C12.4506 3.42285 11.833 3.00586 11.1312 2.70508C10.4294 2.4043 9.67745 2.25391 8.87537 2.25391C8.07328 2.25391 7.32133 2.4043 6.61951 2.70508C5.91768 3.00586 5.30017 3.42285 4.76697 3.95605C4.23376 4.4847 3.81677 5.10221 3.51599 5.80859C3.21521 6.51042 3.06482 7.26237 3.06482 8.06445C3.06482 8.86654 3.21521 9.61849 3.51599 10.3203C3.81677 11.0221 4.23376 11.6396 4.76697 12.1729C5.30017 12.7061 5.91768 13.123 6.61951 13.4238C7.32133 13.7246 8.07328 13.875 8.87537 13.875ZM8.12341 11.3047C8.00948 11.3047 7.90466 11.2796 7.80896 11.2295C7.71781 11.1794 7.62895 11.0996 7.54236 10.9902L5.87439 8.93945C5.76957 8.79818 5.71716 8.6569 5.71716 8.51562C5.71716 8.36523 5.76729 8.23763 5.86755 8.13281C5.97237 8.02344 6.0977 7.96875 6.24353 7.96875C6.33923 7.96875 6.42582 7.98926 6.5033 8.03027C6.58533 8.06673 6.66736 8.13965 6.74939 8.24902L8.09607 9.99219L10.933 5.43945C11.0606 5.23438 11.2201 5.13184 11.4115 5.13184C11.5528 5.13184 11.6804 5.17741 11.7943 5.26855C11.9082 5.3597 11.9652 5.48047 11.9652 5.63086C11.9652 5.70833 11.947 5.78581 11.9105 5.86328C11.8786 5.9362 11.8422 6.00456 11.8011 6.06836L8.67712 10.9902C8.54041 11.1999 8.35583 11.3047 8.12341 11.3047Z",fill:"#6B7280"})})}function rD(e){let{status:t,className:r,isArchived:s=!1}=e,a=(0,c.useMemo)(()=>t,[t]);return s?(0,n.jsx)(rI,{className:r}):a===m.R6.RUNNING?(0,n.jsx)(eN,{className:"".concat(r," animate-spin-slow")}):a===m.R6.CREATING?(0,n.jsx)(rA,{className:"".concat(r," animate-spin-slow")}):a===m.R6.FINISHED||a===m.R6.UNSPECIFIED?(0,n.jsx)(r_,{className:r}):a===m.R6.ERROR||a===m.R6.EXPIRED?(0,n.jsx)(rM,{className:r}):(0,n.jsx)(rA,{className:r})}function rR(e){let{tabs:t,activeTabId:r,onChange:s,className:a}=e,l=(0,c.useRef)(null),o=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=()=>{let e=l.current,t=o.current;if(!e||!t)return;let{offsetLeft:r,offsetWidth:n}=t,s=r/e.offsetWidth*100,a=(r+n)/e.offsetWidth*100;e.style.clipPath="inset(0 ".concat(Number(100-a).toFixed(),"% 0 ").concat(Number(s).toFixed(),"% round 8px)")},t=requestAnimationFrame(e);return window.addEventListener("resize",e),()=>{cancelAnimationFrame(t),window.removeEventListener("resize",e)}},[r,t.length]),(0,n.jsx)("div",{className:null!=a?a:"",children:(0,n.jsxs)("div",{className:"relative inline-flex z-0",children:[(0,n.jsx)("ul",{className:"relative flex items-stretch gap-0 rounded-[8px] overflow-hidden bg-transparent",children:t.map(e=>(0,n.jsx)("li",{className:"flex",children:(0,n.jsx)("button",{ref:r===e.id?o:void 0,onMouseDown:()=>s(e.id),className:"px-2 py-1 text-[12px] leading-none transition-colors whitespace-nowrap ".concat(r===e.id?"text-white":"text-gray-400 hover:text-gray-200"),children:e.label})},e.id))}),(0,n.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0 z-10 overflow-hidden transition-all duration-200",ref:l,style:{clipPath:"inset(0 100% 0 0)",willChange:"clip-path"},children:(0,n.jsx)("ul",{className:"flex items-stretch gap-0 bg-white/5",children:t.map(e=>(0,n.jsx)("li",{className:"flex",children:(0,n.jsx)("button",{tabIndex:-1,className:"px-2 py-1 text-[12px] leading-none whitespace-nowrap text-white",children:e.label})},e.id))})})]})})}let rT={normal:{rotate:0},animate:{rotate:180}},rF=(0,c.forwardRef)((e,t)=>{let{onMouseEnter:r,onMouseLeave:s,className:a,size:l=28,...o}=e,d=(0,K.s)(),u=(0,c.useRef)(!1);(0,c.useImperativeHandle)(t,()=>(u.current=!0,{startAnimation:()=>d.start("animate"),stopAnimation:()=>d.start("normal")}));let m=(0,c.useCallback)(e=>{u.current?null==r||r(e):d.start("animate")},[d,r]),p=(0,c.useCallback)(e=>{u.current?null==s||s(e):d.start("normal")},[d,s]);return(0,n.jsx)("div",{className:(0,i.cn)(a),onMouseEnter:m,onMouseLeave:p,...o,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),(0,n.jsx)("path",{d:"M4.677 21.5a2 2 0 0 0 1.313.5H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v2.5"}),(0,n.jsxs)($.P.g,{transition:{type:"spring",stiffness:50,damping:10},variants:rT,animate:d,children:[(0,n.jsx)("path",{d:"m3.2 12.9-.9-.4"}),(0,n.jsx)("path",{d:"m3.2 15.1-.9.4"}),(0,n.jsx)("path",{d:"m4.9 11.2-.4-.9"}),(0,n.jsx)("path",{d:"m4.9 16.8-.4.9"}),(0,n.jsx)("path",{d:"m7.5 10.3-.4.9"}),(0,n.jsx)("path",{d:"m7.5 17.7-.4-.9"}),(0,n.jsx)("path",{d:"m9.7 12.5-.9.4"}),(0,n.jsx)("path",{d:"m9.7 15.5-.9-.4"}),(0,n.jsx)("circle",{cx:"6",cy:"14",r:"3"})]})]})})});rF.displayName="FileCogIcon";let rP={normal:{rotate:0,x:0,y:0},animate:{rotate:[0,0,8,-3,8,0],x:[0,2,0,-1,0]}},rB={normal:{pathLength:1,opacity:1,pathOffset:0},animate:{pathLength:[0,0,1],opacity:[0,1],pathOffset:[0,1,0]}},rO=(0,c.forwardRef)((e,t)=>{let{onMouseEnter:r,onMouseLeave:s,className:a,size:l=28,...o}=e,d=(0,K.s)(),u=(0,c.useRef)(!1);(0,c.useImperativeHandle)(t,()=>(u.current=!0,{startAnimation:()=>d.start("animate"),stopAnimation:()=>d.start("normal")}));let m=(0,c.useCallback)(e=>{u.current?null==r||r(e):d.start("animate")},[d,r]),p=(0,c.useCallback)(e=>{u.current?null==s||s(e):d.start("normal")},[d,s]);return(0,n.jsx)("div",{className:(0,i.cn)(a),onMouseEnter:m,onMouseLeave:p,...o,children:(0,n.jsxs)($.P.svg,{xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",variants:rP,transition:{duration:1},animate:d,children:[(0,n.jsx)("path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z"}),(0,n.jsx)("path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18"}),(0,n.jsx)($.P.path,{variants:rB,animate:d,transition:{duration:.8},d:"m2.3 2.3 7.286 7.286"}),(0,n.jsx)("circle",{cx:"11",cy:"11",r:"2"})]})})});rO.displayName="PenToolIcon";let rz={normal:{x:0,y:0},animate:{x:[0,0,-3,2,-2,1,-1,0],y:[0,-3,0,-2,-3,-1,-2,0],transition:{duration:6,ease:"easeInOut",repeat:1/0,repeatType:"reverse",times:[0,.15,.3,.45,.6,.75,.9,1]}}},rU={normal:{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"},animate:{d:["M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z","M4.5 16.5c-1.5 1.26-3 5.5-3 5.5s4.74-1 6-2.5c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z","M4.5 16.5c-1.5 1.26-2.2 4.8-2.2 4.8s3.94-0.3 5.2-1.8c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z","M4.5 16.5c-1.5 1.26-2.8 5.2-2.8 5.2s4.54-0.7 5.8-2.2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z","M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"],transition:{duration:2,ease:[.4,0,.2,1],repeat:1/0,times:[0,.2,.5,.8,1]}}},rW=(0,c.forwardRef)((e,t)=>{let{onMouseEnter:r,onMouseLeave:s,className:a,size:l=28,...o}=e,d=(0,K.s)(),u=(0,c.useRef)(!1);(0,c.useImperativeHandle)(t,()=>(u.current=!0,{startAnimation:()=>d.start("animate"),stopAnimation:()=>d.start("normal")}));let m=(0,c.useCallback)(e=>{u.current?null==r||r(e):d.start("animate")},[d,r]),p=(0,c.useCallback)(e=>{u.current?null==s||s(e):d.start("normal")},[d,s]);return(0,n.jsx)("div",{className:(0,i.cn)(a),onMouseEnter:m,onMouseLeave:p,...o,children:(0,n.jsxs)($.P.svg,{xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",variants:rz,animate:d,children:[(0,n.jsx)($.P.path,{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",variants:rU,animate:d}),(0,n.jsx)("path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"}),(0,n.jsx)("path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"}),(0,n.jsx)("path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"})]})})});function rH(e){let{onChipClick:t}=e,r=(0,c.useRef)(null),s=(0,c.useRef)(null),a=(0,c.useRef)(null),l=[{icon:(0,n.jsx)(rO,{ref:r,size:16}),text:"Write documentation",prompt:"Generate comprehensive documentation for all public APIs, functions, and components. Include examples and usage instructions."},{icon:(0,n.jsx)(rW,{ref:s,size:16}),text:"Optimize performance",prompt:"Analyze the codebase for performance bottlenecks and optimize them. Focus on bundle size, load times, and optimizations."},{icon:(0,n.jsx)(rF,{ref:a,size:16}),text:"Find and fix 3 bugs",prompt:"Find and fix 3 bugs in the codebase, such as logic errors, performance issues, or security vulnerabilities. Provide a detailed explanation of the bug and the fix."}],o=[r,s,a];return(0,n.jsxs)("div",{className:x.Fr?"mt-0":"mt-6",children:[(0,n.jsx)("div",{className:"text-sm text-gray-400 mb-3 text-center",children:"Try these examples to get started"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2 justify-center",children:l.map((e,r)=>(0,n.jsxs)("button",{onClick:()=>t(e.prompt),onMouseEnter:()=>{var e,t;null==(t=o[r])||null==(e=t.current)||e.startAnimation()},onMouseLeave:()=>{var e,t;null==(t=o[r])||null==(e=t.current)||e.stopAnimation()},className:"flex items-center gap-2 px-3 py-2 rounded-full bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(255,255,255,0.08)] border border-[rgba(255,255,255,0.05)] hover:border-[rgba(255,255,255,0.1)] transition-all duration-200 text-sm text-gray-300 hover:text-white group animate-in fade-in",style:{animationDelay:"".concat(50*r,"ms")},children:[(0,n.jsx)("span",{className:"text-gray-500 group-hover:text-gray-300 transition-colors",children:e.icon}),(0,n.jsx)("span",{children:e.text})]},r))})]})}rW.displayName="RocketIcon";let rq=e=>e[Math.floor(Math.random()*e.length)],rJ=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,rG={dot_cycle:["⣾","⣽","⣻","⢿","⡿","⣟","⣯","⣷"],grow_dot:[".","o","O","@","*"," "]},rZ=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,n=rG[e],s=Math.floor(t/r)%n.length;return n[s]},rV=[{text:"┌─ Initializing secure container environment",delay:300,color:"#88c0d0"},{text:"│ ▶ Starting virtualization layer...",delay:600,isRandom:!0,variants:["│ ▶ Starting virtualization layer...","│ ▶ Initializing container runtime...","│ ▶ Setting up isolated environment..."]},{text:"│ ✓ Container runtime ready",delay:900,color:"#a3be8c"},{text:"└─ Environment secure",delay:1100,color:"#a3be8c"},{text:"",delay:1200},{text:"┌─ Setting up file system",delay:1300,color:"#88c0d0"},{text:"│ ▣ Creating workspace directories...",delay:1500,isRandom:!0,variants:["│ ▣ Creating workspace directories...","│ ▣ Preparing project structure...","│ ▣ Setting up workspace..."]},{text:"│ ■ Applying permissions...",delay:1700,isRandom:!0,variants:["│ ■ Applying permissions...","│ ■ Configuring access control...","│ ■ Setting security policies..."]},{text:"│ ✓ File system ready",delay:1900,color:"#a3be8c"},{text:"└─ Workspace configured",delay:2e3,color:"#a3be8c"},{text:"",delay:2100},{text:"┌─ Downloading base environment",delay:2200,color:"#88c0d0"},{text:"│ ▦ Fetching image layers...",delay:2400,isRandom:!0,variants:["│ ▦ Fetching image layers...","│ ▦ Downloading container image...","│ ▦ Pulling runtime environment..."]},{text:"│ [████░░░░░░░░░░░░░░░░] 20%",delay:2600,color:"#ebcb8b",isProgress:!0,progressSteps:["│ [░░░░░░░░░░░░░░░░░░░░] 0%","│ [██░░░░░░░░░░░░░░░░░░] 10%","│ [████░░░░░░░░░░░░░░░░] 20%","│ [██████░░░░░░░░░░░░░░] 30%","│ [████████░░░░░░░░░░░░] 40%","│ [██████████░░░░░░░░░░] 50%","│ [████████████░░░░░░░░] 60%","│ [██████████████░░░░░░] 70%","│ [████████████████░░░░] 80%","│ [██████████████████░░] 90%","│ [████████████████████] 100%"]},{text:"│ ✓ Environment image downloaded",delay:3800,color:"#a3be8c"},{text:"└─ Image ready for deployment",delay:3900,color:"#a3be8c"},{text:"",delay:4e3},{text:"┌─ Installing dependencies",delay:4100,color:"#88c0d0"},{text:"│ ◉ Reading package.json...",delay:4300,isRandom:!0,variants:["│ ◉ Reading package.json...","│ ◉ Parsing dependency manifest...","│ ◉ Analyzing project requirements..."]},{text:"│ ◎ Resolving dependency tree...",delay:4500,isRandom:!0,variants:["│ ◎ Resolving dependency tree...","│ ◎ Computing package graph...","│ ◎ Checking version compatibility..."]},{text:"│ Installing: [██████████░░░░░░░░░░] 50%",delay:4700,color:"#ebcb8b",isProgress:!0,progressSteps:["│ Installing: [░░░░░░░░░░░░░░░░░░░░] 0%","│ Installing: [████░░░░░░░░░░░░░░░░] 20%","│ Installing: [██████████░░░░░░░░░░] 50%","│ Installing: [██████████████░░░░░░] 70%","│ Installing: [████████████████████] 100%"]},{text:"│ ✓ Dependencies installed successfully",delay:5400,color:"#a3be8c"},{text:"└─ Package installation complete",delay:5500,color:"#a3be8c"},{text:"",delay:5600},{text:"┌─ Configuring development environment",delay:5700,color:"#88c0d0"},{text:"│ ● Setting up language servers...",delay:5900,isRandom:!0,variants:["│ ● Setting up language servers...","│ ● Initializing LSP services..."]},{text:"│ ▶ Configuring debugging tools...",delay:6100,isRandom:!0,variants:["│ ▶ Configuring debugging tools...","│ ▶ Setting up breakpoint handlers...","│ ▶ Initializing debug protocols..."]},{text:"│ ◈ Configuring settings...",delay:6300,isRandom:!0,variants:["│ ◈ Configuring settings...","│ ◈ Allocating memory...","│ ◈ Adjusting runtime parameters..."]},{text:"│ ✓ Development environment ready",delay:6500,color:"#a3be8c"},{text:"└─ All tools configured",delay:6600,color:"#a3be8c"},{text:"",delay:6700},{text:"┌─ Starting background service",delay:6800,color:"#88c0d0"},{text:"│ ▶ Initializing worker processes...",delay:7e3,isRandom:!0,variants:["│ ▶ Initializing worker processes...","│ ▶ Starting execution engine...","│ ▶ Booting service manager..."]},{text:"│ ◉ Loading runtime libraries...",delay:7200,isRandom:!0,variants:["│ ◉ Loading runtime libraries...","│ ◉ Initializing system modules...","│ ◉ Loading configuration data..."]},{text:"│ ▣ Establishing secure connections...",delay:7400,isRandom:!0,variants:["│ ▣ Establishing connections...","│ ▣ Validating authentication tokens..."]},{text:"│ ✓ Background service online",delay:7600,color:"#a3be8c"},{text:"└─ System ready for task execution ►",delay:7700,color:"#a3be8c"},{text:"",delay:7800}],rK=[{variants:["│ {spinner} Finalizing workspace setup...","│ {spinner} Loading additional configurations...","│ {spinner} Initializing extension support...","│ {spinner} Preparing development tools...","│ {spinner} Setting up code completion...","│ {spinner} Building language services...","│ {spinner} Indexing project files...","│ {spinner} Validating environment...","│ {spinner} Loading editor preferences...","│ {spinner} Preparing execution context..."],color:"#5e81ac",hasSpinner:!0,spinnerType:["dot_cycle","grow_dot"]},{variants:["│ ▶ Service ready - awaiting requests...","│ ◉ All tests passed","│ ● Environment ready","│ ▣ Ready for task execution","│ ■ Standing by for user input...","│ ◈ Workspace fully configured","│ ▦ Services running optimally","│ ✓ Checks passing","│ ▶ Container ready for workload"],color:"#a3be8c",hasSpinner:!1},{variants:["│ {spinner} Loading workspace: {percent}% complete","│ {spinner} Startup progress: {percent}% done","│ {spinner} Initialization: {percent}% finished","│ {spinner} Setup progress: {percent}% complete","│ {spinner} Configuration: {percent}% loaded"],color:"#ebcb8b",hasSpinner:!0,spinnerType:["dot_cycle","grow_dot"],hasMetrics:!0}],r$=()=>({ms:Math.floor(50*Math.random())+10,percent:Math.floor(30*Math.random())+20,speed:(50*Math.random()+10).toFixed(1),count:Math.floor(20*Math.random())+5});function rX(){let{composerId:e,promptText:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[r]=(0,c.useState)(()=>e||"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))),s=e||r,a="terminal-logs-state-".concat(s),[l,o]=(0,c.useState)([]),[i,d]=(0,c.useState)(0),[u,m]=(0,c.useState)(Date.now()),[p,x]=(0,c.useState)(!1),[f,h]=(0,c.useState)([]),[g,v]=(0,c.useState)(new Map),b=(0,c.useRef)(null);(0,c.useEffect)(()=>{b.current&&(b.current.scrollTop=b.current.scrollHeight)},[l]),(0,c.useEffect)(()=>{if(0===g.size)return;let e=setInterval(()=>{let e=Date.now();o(t=>t.map((t,r)=>{let n=g.get(r);if(!n)return t;let s=rZ(n.spinnerType,e,150),a=n.template.replace("{spinner}",s);return n.metrics&&Object.entries(n.metrics).forEach(e=>{let[t,r]=e;a=a.replace("{".concat(t,"}"),String(r))}),{...t,text:a}}))},150);return()=>clearInterval(e)},[g,s]),(0,c.useEffect)(()=>{v(new Map)},[s]),(0,c.useEffect)(()=>{try{let e=sessionStorage.getItem(a);if(e){let t=JSON.parse(e),r=t.randomizedLogs&&t.randomizedLogs.length>0?t.randomizedLogs:rV.map(e=>({...e,text:e.isRandom&&e.variants?rq(e.variants):e.text,delay:e.isRandom?e.delay+rJ(-100,200):e.delay}));h(r);let n=((e,t)=>{let r=(Date.now()-e)/2,n=[],s=0,a=!1;if(0===t.length)return{startTime:e,displayedLogs:[],currentIndex:0,ongoingPhase:!1,randomizedLogs:[]};for(let e=0;e<t.length;e++){let a=t[e];if(r>=a.delay)if(a.isProgress&&a.progressSteps){let t=a.delay,l=240*a.progressSteps.length,o=r-t;if(o>=l)n.push({...a,text:a.progressSteps[a.progressSteps.length-1]}),s=e+1;else{let t=Math.max(0,Math.min(Math.floor(o/240),a.progressSteps.length-1));n.push({...a,text:a.progressSteps[t]}),s=e}}else n.push(a),s=e+1;else break}if(s>=t.length){a=!0;let e=t[t.length-1].delay,s=Math.floor((r-e)/6e3);for(let t=0;t<s&&t<10;t++){let r=rK[t%rK.length],s=rq(r.variants),a=s;if(r.hasSpinner){let e=r.spinnerType||["dot_cycle"],t=rG[e[Math.floor(Math.random()*e.length)]][0];a=s.replace("{spinner}",t),r.hasMetrics&&Object.entries(r$()).forEach(e=>{let[t,r]=e;a=a.replace("{".concat(t,"}"),String(r))})}n.push({text:a,delay:e+(t+1)*6e3,color:r.color})}}return{startTime:e,displayedLogs:n,currentIndex:s,ongoingPhase:a,randomizedLogs:t}})(t.startTime,r);m(n.startTime),o(n.displayedLogs),d(n.currentIndex),x(n.ongoingPhase)}else{let e=Date.now(),t=rV.map(e=>({...e,text:e.isRandom&&e.variants?rq(e.variants):e.text,delay:e.isRandom?e.delay+rJ(-100,200):e.delay}));m(e),h(t),sessionStorage.setItem(a,JSON.stringify({startTime:e,displayedLogs:[],currentIndex:0,ongoingPhase:!1,randomizedLogs:t}))}}catch(r){console.error("Failed to load terminal logs state:",r);let e=Date.now(),t=rV.map(e=>({...e,text:e.isRandom&&e.variants?rq(e.variants):e.text,delay:e.isRandom?e.delay+rJ(-100,200):e.delay}));m(e),h(t)}},[a]),(0,c.useEffect)(()=>{if(0!==f.length)try{sessionStorage.setItem(a,JSON.stringify({startTime:u,displayedLogs:l,currentIndex:i,ongoingPhase:p,randomizedLogs:f}))}catch(e){console.error("Failed to save terminal logs state:",e)}},[a,u,l,i,p,f]),(0,c.useEffect)(()=>{if(0===f.length)return;if(i>=f.length)return void x(!0);let e=f[i],t=Date.now()-u,r=setTimeout(()=>{if(e.isProgress&&e.progressSteps){let t=0,r=()=>{if(t<e.progressSteps.length){let n={...e,text:e.progressSteps[t]};o(e=>{let t=[...e],r=t.findIndex((e,t)=>t===i);return r>=0?t[r]=n:t.push(n),t}),++t<e.progressSteps.length?setTimeout(r,rJ(200,280)):d(e=>e+1)}};r()}else o(t=>[...t,e]),d(e=>e+1)},Math.max(0,(e.delay-t)*2));return()=>clearTimeout(r)},[i,u,f,s]),(0,c.useEffect)(()=>{if(!p)return;let e=setInterval(()=>{let e=rK[Math.floor(Math.random()*rK.length)],t=rq(e.variants);o(r=>{let n=[...r];n.length>50&&(n.splice(0,10),v(e=>{let t=new Map;return e.forEach((e,r)=>{r>=10&&t.set(r-10,e)}),t}));let s=n.length,a=t;return v(r=>{let n=new Map;if(e.hasSpinner){let r=e.spinnerType||["dot_cycle"],l=r[Math.floor(Math.random()*r.length)],o=e.hasMetrics?r$():void 0;n.set(s,{template:t,spinnerType:l,color:e.color,metrics:o});let i=rG[l][0];a=t.replace("{spinner}",i),o&&Object.entries(o).forEach(e=>{let[t,r]=e;a=a.replace("{".concat(t,"}"),String(r))})}return n}),[...n,{text:a,delay:Date.now()-u,color:e.color}]})},rJ(5e3,9e3));return()=>clearInterval(e)},[p,u,s]);let w="string"==typeof t&&t.trim().length>0?t.length>120?"".concat(t.slice(0,117),"…"):t:null;return(0,n.jsxs)("div",{className:"flex flex-col gap-2 mt-2 h-full pb-[20px]",children:[(0,n.jsxs)("div",{className:"flex items-center px-2 py-1 gap-2 text-gray-500 opacity-60 text-[12px]",children:[(0,n.jsx)(ec.A,{className:"w-3 h-3"}),(0,n.jsxs)("div",{className:"flex items-center gap-0",children:[(0,n.jsxs)("span",{className:"flex make-shine items-center",children:["Starting up Background Agent",w?" — “".concat(w,"”"):""]}),(0,n.jsx)(er,{})]})]}),(0,n.jsx)("div",{className:"bg-[#191c22] h-full border rounded-lg font-mono text-sm overflow-hidden w-full",style:{borderColor:"rgba(139, 148, 158, 0.25)"},children:(0,n.jsx)("div",{className:"h-full p-2 w-full overflow-y-auto",ref:b,children:l.map((e,t)=>(0,n.jsx)("div",{className:"flex flex-col gap-1 min-w-0",children:(0,n.jsx)("div",{className:"flex gap-3 min-w-0",children:(0,n.jsx)("pre",{className:"text-xs font-mono flex-shrink-0 whitespace-pre-wrap break-words min-w-0 flex-1 leading-relaxed tabular-nums kerning-none",style:{color:e.color||"#d8dee9",letterSpacing:"0.00982143em"},children:e.text})})},t))})})]})}var rY=r(44632);let rQ={char:.03,word:.05,line:.1},r0={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}},exit:{transition:{staggerChildren:.05,staggerDirection:-1}}},r1={hidden:{opacity:0},visible:{opacity:1},exit:{opacity:0}},r2={blur:{container:r0,item:{hidden:{opacity:0,filter:"blur(12px)"},visible:{opacity:1,filter:"blur(0px)"},exit:{opacity:0,filter:"blur(12px)"}}},"fade-in-blur":{container:r0,item:{hidden:{opacity:0,y:20,filter:"blur(12px)"},visible:{opacity:1,y:0,filter:"blur(0px)"},exit:{opacity:0,y:20,filter:"blur(12px)"}}},scale:{container:r0,item:{hidden:{opacity:0,scale:0},visible:{opacity:1,scale:1},exit:{opacity:0,scale:0}}},fade:{container:r0,item:{hidden:{opacity:0},visible:{opacity:1},exit:{opacity:0}}},slide:{container:r0,item:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0},exit:{opacity:0,y:20}}}},r5=c.memo(e=>{let{segment:t,variants:r,per:s,segmentWrapperClassName:a}=e,l="line"===s?(0,n.jsx)($.P.span,{variants:r,className:"block",children:t}):"word"===s?(0,n.jsx)($.P.span,{"aria-hidden":"true",variants:r,className:"inline-block whitespace-pre",children:t}):(0,n.jsx)($.P.span,{className:"inline-block whitespace-pre",children:t.split("").map((e,t)=>(0,n.jsx)($.P.span,{"aria-hidden":"true",variants:r,className:"inline-block whitespace-pre",children:e},"char-".concat(t)))});return a?(0,n.jsx)("span",{className:(0,i.cn)("line"===s?"block":"inline-block",a),children:l}):l});r5.displayName="AnimationComponent";let r3=e=>!!e&&"object"==typeof e&&"transition"in e,r4=(e,t)=>{if(!t)return e;let{exit:r,...n}=t;return{...e,visible:{...e.visible,transition:{...r3(e.visible)?e.visible.transition:{},...n}},exit:{...e.exit,transition:{...r3(e.exit)?e.exit.transition:{},...n,staggerDirection:-1}}}};function r8(e){var t,r,s,a,l,o,i,c;let{children:d,per:u="word",as:m="p",variants:p,className:x,preset:f="fade",delay:h=0,speedReveal:g=1,speedSegment:v=1,trigger:b=!0,onAnimationComplete:w,onAnimationStart:y,segmentWrapperClassName:j,containerTransition:C,segmentTransition:N,style:k}=e,S="line"===u?d.split("\n"):d.split(/(\s+)/),E=$.P[m],L=f?r2[f]:{container:r0,item:r1},A=rQ[u]/g,M=r3(null!=(i=null==p||null==(t=p.container)?void 0:t.visible)?i:{})?null==(r=(null==p||null==(s=p.container)?void 0:s.visible).transition)?void 0:r.staggerChildren:void 0,_=r3(null!=(c=null==p||null==(a=p.container)?void 0:a.visible)?c:{})?null==(l=(null==p||null==(o=p.container)?void 0:o.visible).transition)?void 0:l.delayChildren:void 0,I={container:r4((null==p?void 0:p.container)||L.container,{staggerChildren:null!=M?M:A,delayChildren:null!=_?_:h,...C,exit:{staggerChildren:null!=M?M:A,staggerDirection:-1}}),item:r4((null==p?void 0:p.item)||L.item,{duration:.3/v,...N})};return(0,n.jsx)(rY.N,{mode:"popLayout",children:b&&(0,n.jsxs)(E,{initial:"hidden",animate:"visible",exit:"exit",variants:I.container,className:x,onAnimationComplete:w,onAnimationStart:y,style:k,children:["line"!==u?(0,n.jsx)("span",{className:"sr-only",children:d}):null,S.map((e,t)=>(0,n.jsx)(r5,{segment:e,variants:I.item,per:u,segmentWrapperClassName:j},"".concat(u,"-").concat(t,"-").concat(e)))]})})}let r6=e=>{var t,r;return(0,n.jsx)("svg",{width:null!=(t=e.width)?t:12,height:null!=(r=e.height)?r:12,viewBox:"0 0 16 16",fill:"none","aria-hidden":!0,...e,children:(0,n.jsx)("path",{d:"M4.96208 9.64792L6.92875 8.545L6.96208 8.44917L6.92875 8.39583H6.83333L6.50417 8.37583L5.38 8.34542L4.40542 8.305L3.46125 8.25417L3.22333 8.20375L3 7.91L3.02292 7.76333L3.22292 7.62958L3.50875 7.65458L4.14208 7.6975L5.09125 7.76333L5.77958 7.80375L6.8 7.91H6.96208L6.985 7.84458L6.92917 7.80375L6.88625 7.76333L5.90375 7.09833L4.84042 6.395L4.28375 5.99L3.98208 5.78542L3.83042 5.59292L3.76458 5.17292L4.03792 4.87208L4.405 4.89708L4.49875 4.9225L4.87083 5.20833L5.66583 5.82333L6.70375 6.58708L6.85583 6.71375L6.91625 6.67083L6.92417 6.64042L6.85583 6.52625L6.29125 5.50708L5.68875 4.46958L5.42042 4.03958L5.34958 3.78167C5.32259 3.68261 5.30804 3.58057 5.30625 3.47792L5.61792 3.05583L5.79 3L6.205 3.05583L6.38 3.2075L6.63833 3.79667L7.05583 4.72542L7.70375 5.98792L7.89375 6.36208L7.995 6.70875L8.03292 6.815H8.09875V6.75417L8.15208 6.04333L8.25083 5.17042L8.34667 4.0475L8.38 3.73083L8.53667 3.35167L8.84792 3.14667L9.09125 3.26333L9.29125 3.54875L9.26333 3.73375L9.14417 4.505L8.91125 5.71458L8.75958 6.52375H8.84792L8.94917 6.42292L9.35958 5.87875L10.0479 5.01875L10.3521 4.67708L10.7063 4.30042L10.9342 4.12083H11.3646L11.6812 4.59125L11.5396 5.07708L11.0962 5.63833L10.7292 6.11417L10.2025 6.8225L9.87333 7.38917L9.90375 7.435L9.98208 7.42667L11.1721 7.17417L11.815 7.0575L12.5821 6.92625L12.9292 7.08792L12.9671 7.2525L12.8304 7.58875L12.01 7.79125L11.0479 7.98375L9.615 8.3225L9.5975 8.335L9.61792 8.36042L10.2633 8.42125L10.5392 8.43625H11.215L12.4733 8.53L12.8025 8.7475L13 9.01333L12.9671 9.21542L12.4608 9.47375L11.7775 9.31167L10.1821 8.9325L9.63542 8.79542H9.55958V8.84125L10.015 9.28625L10.8508 10.0404L11.8962 11.0112L11.9492 11.2521L11.815 11.4417L11.6733 11.4212L10.7546 10.7308L10.4 10.4196L9.5975 9.74458H9.54417V9.81542L9.72917 10.0858L10.7063 11.5529L10.7571 12.0029L10.6863 12.15L10.4329 12.2387L10.1546 12.1879L9.58208 11.3858L8.9925 10.4829L8.51625 9.67333L8.45792 9.70667L8.17708 12.7292L8.04542 12.8833L7.74167 13L7.48875 12.8079L7.35458 12.4967L7.48875 11.8817L7.65083 11.08L7.78208 10.4425L7.90125 9.65083L7.97208 9.3875L7.96708 9.37L7.90875 9.3775L7.31125 10.1971L6.40292 11.4242L5.68375 12.1929L5.51125 12.2612L5.2125 12.1071L5.24042 11.8312L5.4075 11.5858L6.4025 10.3208L7.0025 9.53667L7.39 9.08417L7.3875 9.01833H7.36458L4.72167 10.7333L4.25083 10.7942L4.04792 10.6042L4.07333 10.2933L4.16958 10.1921L4.96458 9.64542L4.96208 9.64792Z",fill:"currentColor"})})},r7=e=>{var t,r;return(0,n.jsx)("svg",{width:null!=(t=e.width)?t:12,height:null!=(r=e.height)?r:12,viewBox:"0 0 17 17",fill:"none","aria-hidden":!0,...e,children:(0,n.jsx)("path",{d:"M7.25162 7.0379V6.02635C7.25162 5.94116 7.2836 5.87725 7.35809 5.83471L9.39189 4.66345C9.66873 4.50373 9.99883 4.42924 10.3395 4.42924C11.6172 4.42924 12.4265 5.41951 12.4265 6.4736C12.4265 6.54812 12.4265 6.63331 12.4158 6.7185L10.3076 5.48333C10.1798 5.40883 10.052 5.40883 9.92422 5.48333L7.25162 7.0379ZM12.0006 10.9776V8.56052C12.0006 8.41142 11.9366 8.30494 11.8089 8.23043L9.13629 6.67585L10.0094 6.17537C10.0839 6.13283 10.1478 6.13283 10.2224 6.17537L12.2561 7.34663C12.8418 7.6874 13.2357 8.41142 13.2357 9.11413C13.2357 9.92334 12.7566 10.6687 12.0006 10.9775V10.9776ZM6.6234 8.84808L5.75028 8.33701C5.67579 8.29447 5.64381 8.23054 5.64381 8.14534V5.80284C5.64381 4.66356 6.51693 3.80102 7.69886 3.80102C8.14613 3.80102 8.56131 3.95013 8.91278 4.21631L6.81516 5.4302C6.68742 5.5047 6.62351 5.61117 6.62351 5.7603V8.84817L6.6234 8.84808ZM8.50277 9.93413L7.25162 9.23139V7.74075L8.50277 7.03801L9.75383 7.74075V9.23139L8.50277 9.93413ZM9.30668 13.1711C8.85943 13.1711 8.44425 13.022 8.09278 12.7559L10.1904 11.5419C10.3181 11.4674 10.382 11.361 10.382 11.2118V8.12397L11.2659 8.63504C11.3404 8.67758 11.3723 8.74149 11.3723 8.82671V11.1692C11.3723 12.3085 10.4885 13.171 9.30668 13.171V13.1711ZM6.78311 10.7967L4.74932 9.62542C4.16364 9.28463 3.76972 8.56063 3.76972 7.8579C3.76972 7.03802 4.25953 6.30332 5.01548 5.99451V8.4222C5.01548 8.57131 5.07941 8.67778 5.20715 8.7523L7.86916 10.2962L6.99604 10.7967C6.92154 10.8392 6.85761 10.8392 6.78311 10.7967ZM6.66605 12.5429C5.46284 12.5429 4.57904 11.6378 4.57904 10.5198C4.57904 10.4346 4.58972 10.3494 4.6003 10.2642L6.69792 11.4781C6.82566 11.5526 6.9535 11.5526 7.08123 11.4781L9.75383 9.93424V10.9458C9.75383 11.031 9.72188 11.0949 9.64736 11.1374L7.61358 12.3087C7.33672 12.4684 7.00663 12.5429 6.66594 12.5429H6.66605ZM9.30668 13.8099C10.5951 13.8099 11.6705 12.8943 11.9155 11.6804C13.108 11.3716 13.8746 10.2535 13.8746 9.11424C13.8746 8.36886 13.5552 7.64486 12.9802 7.1231C13.0335 6.89947 13.0654 6.67585 13.0654 6.45234C13.0654 4.92972 11.8303 3.79033 10.4034 3.79033C10.116 3.79033 9.83914 3.83287 9.56228 3.92876C9.08305 3.46023 8.42288 3.16211 7.69886 3.16211C6.41048 3.16211 5.3351 4.07777 5.09011 5.29166C3.89757 5.60048 3.13092 6.7185 3.13092 7.85779C3.13092 8.60317 3.45032 9.32717 4.02532 9.84893C3.97209 10.0726 3.94013 10.2962 3.94013 10.5197C3.94013 12.0423 5.1753 13.1817 6.60212 13.1817C6.88957 13.1817 7.16643 13.1392 7.44329 13.0433C7.9224 13.5118 8.58257 13.8099 9.30668 13.8099Z",fill:"currentColor"})})},r9=e=>{var t,r;return(0,n.jsx)("svg",{width:null!=(t=e.width)?t:15,height:null!=(r=e.height)?r:17,viewBox:"0 0 15 17",fill:"none","aria-hidden":!0,...e,children:(0,n.jsx)("path",{d:"M2.20489 4.81264L7.84862 8.07105L13.6631 4.63865L2.20489 4.81264ZM8.27898 1.53014L8.25521 3.99014L12.4631 3.94585L8.27898 1.53014ZM3.3016 4.04218L7.52089 3.99786L7.54473 1.53734L3.3016 4.04218ZM8.20954 8.71066L8.14441 15.4379L14.024 5.27812L8.20954 8.71066ZM1.86659 5.47967L1.80701 11.6375L7.11009 8.50701L1.86659 5.47967ZM7.40989 15.4695L7.47105 9.14653L2.02579 12.361L7.40989 15.4695ZM13.5894 12.2478L11.5194 11.0527L9.40232 14.7196L13.5894 12.2478ZM13.9628 11.6011L14.0098 6.73917L11.8928 10.406L13.9628 11.6011ZM14.6888 12.4514L7.76665 16.5378L0.922218 12.5862L1.00002 4.54813L7.92222 0.461814L14.7667 4.41345L14.6888 12.4514Z",fill:"#9599A8"})})};function ne(e){let{composer:t}=e,[r,s]=(0,c.useState)(null),a=t.prUrl;if((0,c.useEffect)(()=>{if(a){let e=(0,_.Le)(a);e?s(e):(0,_.Jg)(a).then(e=>s(e)).catch(()=>s(null))}else s(null)},[a]),!a||!r)return null;let l=r.isMerged?(0,n.jsx)(z.A,{className:"w-3 h-3 text-purple-400"}):r.isClosed?(0,n.jsx)(U.A,{className:"w-3 h-3 text-[#BF616A]"}):r.isDraft?(0,n.jsx)(W.A,{className:"w-3 h-3 text-gray-400"}):"open"===r.state?(0,n.jsx)(z.A,{className:"w-3 h-3 text-[#A3BE8C]"}):null,o=r.isMerged?"Pull request merged":r.isClosed?"Pull request closed":r.isDraft?"Draft pull request":"open"===r.state?"Pull request open":null;return l&&o?(0,n.jsx)("span",{"data-tooltip-id":"pr-status-tooltip","data-tooltip-content":o,className:"flex items-center",children:l}):null}function nt(e){let{section:t,selectedComposerId:r,highlightedComposerId:s,detailedComposers:a,detailedDiffs:l,onSelectComposer:o,onClearHighlight:i,groupBy:d}=e,u=(0,c.useMemo)(()=>"Errored"===t.name||"Expired"===t.name||t.composers.every(e=>{var t;let r=null!=(t=e.status)?t:0;return 3===r||5===r}),[t.composers,t.name]),[p,x]=(0,c.useState)(!u),[f,h]=(0,c.useState)(!1),[g,v]=(0,c.useState)(null),[b,w]=(0,c.useState)(null),[y,j]=(0,c.useState)(null);(0,c.useEffect)(()=>{if(!g)return;let e=e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),"function"==typeof e.stopImmediatePropagation&&e.stopImmediatePropagation(),v(null))};return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}},[g]);let C=async e=>{try{await navigator.clipboard.writeText(e),w(e),setTimeout(()=>{w(t=>t===e?null:t)},800)}catch(e){console.error("Failed to copy request ID",e)}};return(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsxs)("div",{className:"px-2 py-1 text-[11px] font-medium text-gray-500 cursor-pointer hover:text-gray-400 flex items-center gap-1 transition-colors",style:{fontWeight:"400",lineHeight:"150%",letterSpacing:"0.12px",whiteSpace:"nowrap"},onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),onClick:()=>x(!p),children:[(0,n.jsx)("span",{children:t.name}),(0,n.jsx)("div",{className:"flex items-center justify-center transition-opacity duration-200 ".concat(f?"opacity-60":"opacity-0"),children:(0,n.jsx)(Y,{className:"transition-transform duration-200 ".concat(p?"":"-rotate-90"),size:10})})]}),p&&t.composers.map(e=>{var c;let u=a.get(e.bcId),p=l.get(e.bcId),x=u?(0,_.xH)(u,p):null,f=g===e.bcId;return(0,n.jsxs)("div",{id:"composer-".concat(e.bcId),"data-composer-item":!0,"data-composer-id":e.bcId,onClick:t=>{if(!t.target.closest("[data-item-menu]")){if(t.metaKey||t.ctrlKey){t.preventDefault(),t.stopPropagation();try{let t=new URL(window.location.href);t.searchParams.set("selectedBcId",e.bcId),window.open(t.toString(),"_blank","noopener,noreferrer")}catch(t){o(e)}return}o(e),i()}},onAuxClick:t=>{if(1===t.button){t.preventDefault(),t.stopPropagation();try{let t=new URL(window.location.href);t.searchParams.set("selectedBcId",e.bcId),window.open(t.toString(),"_blank","noopener,noreferrer")}catch(e){}}},className:"group relative py-[6px] h-[48px] px-[8px] rounded-[6px] cursor-pointer transition-colors text-sm hover:bg-white/[0.01]",style:{border:r===e.bcId?"1px solid color-mix(in srgb, color-mix(in srgb, #7b88a1 12%, transparent) 80%, transparent)":s===e.bcId?"1px solid color-mix(in srgb, #7b88a1 20%, transparent)":"1px solid transparent",backgroundColor:r===e.bcId?"rgba(255, 255, 255, 0.02)":s===e.bcId?"rgba(255, 255, 255, 0.01)":"",color:r===e.bcId?"#fff":s===e.bcId?"#a1b2c3":"#7b88a1"},children:[(0,n.jsx)("button",{"data-item-menu":!0,className:"absolute top-1 right-1 z-50 p-1 rounded-md text-gray-400 hover:text-gray-200 hover:bg-white/5 transition-colors outline-none focus:outline-none ".concat(f?"opacity-100":"opacity-0 group-hover:opacity-70"),onMouseDown:t=>{t.preventDefault(),t.stopPropagation(),v(t=>t===e.bcId?null:e.bcId)},onClick:e=>{e.preventDefault(),e.stopPropagation()},onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),t.stopPropagation(),v(t=>t===e.bcId?null:e.bcId)),"Escape"===t.key&&(t.preventDefault(),v(null))},"aria-haspopup":"menu","aria-expanded":f,children:(0,n.jsx)(H.A,{size:14})}),(0,n.jsx)(tC,{open:f,composerId:e.bcId,onClose:()=>v(null),onCopy:()=>C(e.bcId),onDelete:()=>{j(e.bcId),v(null)},copied:b===e.bcId}),(0,n.jsxs)("div",{className:"flex items-center gap-1 min-w-0",children:[(0,n.jsx)("div",{className:"pr-[4px] flex items-center justify-center",children:(()=>{var r;let s=!!e.prUrl,a=null!=(r=e.status)?r:0;return"merge"!==d||"Ready to open"!==t.name||s||a!==m.R6.FINISHED?s&&a!==m.R6.EXPIRED?(0,n.jsx)(ne,{composer:e}):(0,n.jsx)(rD,{status:a,isArchived:e.isArchived,className:"w-[14px] h-[14px]"}):(0,n.jsx)(W.A,{className:"w-3 h-3 text-[#A3BE8C]"})})()}),(0,n.jsx)("div",{className:"".concat(r===e.bcId?"text-gray-300":s===e.bcId?"text-gray-350":"text-gray-400"," truncate flex-1 min-w-0 text-[12px]"),style:{lineHeight:"140%",letterSpacing:"0px"},children:e.name||"New Background Agent"}),(0,n.jsxs)("div",{className:"flex items-center gap-1 text-[10px] flex-shrink-0 h-[16px]",style:{opacity:x&&(x.totalAdded>0||x.totalRemoved>0)?1:0},children:[x&&x.totalAdded>0&&(0,n.jsxs)("span",{className:"text-[#A3BE8C]",children:["+",x.totalAdded]}),x&&x.totalRemoved>0&&(0,n.jsxs)("span",{className:"text-[#BF616A]",children:["-",x.totalRemoved]})]})]}),(0,n.jsxs)("div",{className:"flex pl-[22px] items-center gap-1 text-[11px] text-gray-500 whitespace-nowrap",style:{lineHeight:"150%",letterSpacing:"0.07px"},children:[(0,n.jsx)("span",{children:(()=>{let t=new Date(e.createdAtMs||0),r=new Date().getTime()-t.getTime(),n=Math.floor(r/6e4),s=Math.floor(r/36e5),a=Math.floor(r/864e5);return n<1?"Just now":n<60?"".concat(n,"m"):s<24?"".concat(s,"h"):a<7?"".concat(a,"d"):t.toLocaleDateString()})()}),(null==u||null==(c=u.modelDetails)?void 0:c.modelName)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"•"}),(0,n.jsx)("span",{className:"truncate",children:(()=>{let e=u.modelDetails.modelName.replace(/^cursor-/,"");return"default"===e.toLowerCase()?"auto":e})()})]})]}),(0,n.jsx)("div",{className:"pointer-events-none rounded-[6px] absolute inset-y-0 right-0 w-[80px] opacity-0 group-hover:opacity-100 transition-opacity",style:{background:"linear-gradient(to left, ".concat((e.bcId,"#1c1e21"),", rgba(255,255,255,0))")}})]},e.bcId)}),(0,n.jsx)(rf,{isOpen:!!y,bcId:y||void 0,onClose:()=>j(null),onSuccess:async()=>{j(null)}})]})}function nr(e){var t;let{allSections:r,detailedComposers:s,detailedDiffs:a,selectedComposerId:l,selectedComposer:o,isComposerNotFound:i,prLoading:d,existingPrUrl:u,isConversationCollapsed:p,viewConfig:x,filterConfig:f,inputBoxRef:h,githubConnected:g,githubError:b,onCloseModal:w,onCollapseConversation:y,onSelectComposer:j,onFocusChange:C,onDropdownOpenChange:N,onBeforeSubmit:k,onViewConfigChange:S,onFilterConfigChange:E,onConnectGithub:L,onOpenExistingPullRequest:A,onOpenPullRequest:M,onPrMerged:I,isInputFocused:D,isAnyDropdownOpen:R,backgroundComposers:F,backgroundComposersLoading:P,deeplinkData:z}=e,[U,W]=(0,c.useState)(()=>{{let e=localStorage.getItem("agents-left-panel-width");return e?Math.max(180,Math.min(400,parseInt(e,10))):220}}),[K,$]=(0,c.useState)(()=>{{let e=localStorage.getItem("agents-right-panel-width");return e?Math.max(300,Math.min(600,parseInt(e,10))):400}}),[X,Y]=(0,c.useState)(!1),[Q,ee]=(0,c.useState)(!1),[es,ea]=(0,c.useState)(!1),[el,eo]=(0,c.useState)(!0),[ei,ec]=(0,c.useState)(!1),[ed,eu]=(0,c.useState)(!1),[em,ep]=(0,c.useState)(!1),ex=(0,c.useRef)(null),{diffViewMode:ef,setDiffViewMode:eh}=(0,v._F)(),eg=(0,c.useRef)(null),ev=(0,c.useRef)(null),[eb,ey]=(0,c.useState)(!1),[ej,eC]=(0,c.useState)(!1),eN=(0,c.useRef)(null),ek=async()=>{var e;if(null==o||null==(e=o.composer)?void 0:e.bcId)try{await navigator.clipboard.writeText(o.composer.bcId),eC(!0),setTimeout(()=>eC(!1),350)}catch(e){console.error("Failed to copy request ID",e)}},eS=()=>{var e;let t="Feedback ".concat((null==o||null==(e=o.composer)?void 0:e.bcId)?"[".concat(o.composer.bcId,"]"):""),r="mailto:background-agent-feedback@cursor.com?subject=".concat(encodeURIComponent(t));window.open(r,"_blank"),ey(!1)},eE=e=>{eh(e)},eL=()=>{eg.current&&eg.current()},eA=()=>{ev.current&&ev.current()},[eM,e_]=(0,c.useState)(""),[eI,eD]=(0,c.useState)(!1),[eR,eT]=(0,c.useState)(!1);(0,c.useEffect)(()=>{localStorage.setItem("agents-left-panel-width",U.toString())},[U]),(0,c.useEffect)(()=>{localStorage.setItem("agents-right-panel-width",K.toString())},[K]),(0,c.useEffect)(()=>{if(p)eo(!1);else{let e=setTimeout(()=>{eo(!0)},151);return()=>clearTimeout(e)}},[p]),(0,c.useEffect)(()=>{ec(!0);let e=setTimeout(()=>{ec(!1)},150);return()=>clearTimeout(e)},[p]);let[eF,eP]=(0,c.useState)(null),eB=(0,c.useMemo)(()=>{let e=eM.trim()?r.map(e=>({...e,composers:e.composers.filter(e=>{var t,r;let n=eM.toLowerCase().trim();return!!((null==(t=e.name)?void 0:t.toLowerCase().includes(n))||e.repoUrl&&e.repoUrl.split("/").slice(-2).join("/").toLowerCase().includes(n))||null!=(r=e.branchName)&&!!r.toLowerCase().includes(n)})})).filter(e=>e.composers.length>0):r,t=e.flatMap(e=>e.composers),n=t.filter(e=>{var t;return(null!=(t=e.status)?t:0)===3}),s=t.filter(e=>{var t;return(null!=(t=e.status)?t:0)===5}),a=e.filter(e=>"Errored"!==e.name&&"Expired"!==e.name).map(e=>({...e,composers:e.composers.filter(e=>{var t;let r=null!=(t=e.status)?t:0;return 3!==r&&5!==r})})).filter(e=>e.composers.length>0),l=[];return n.length&&l.push({name:"Errored",composers:n}),s.length&&l.push({name:"Expired",composers:s}),[...a,...l]},[r,eM]),[eO,ez]=(0,c.useState)(null);(0,c.useEffect)(()=>{var e;if(!(null==o||null==(e=o.composer)?void 0:e.bcId))return void ez(null);let t=a.get(o.composer.bcId);ez((0,_.xH)(o,t))},[o,a]);let eU=(0,c.useMemo)(()=>{var e;let t=null==o||null==(e=o.composer)?void 0:e.promptGroupId;return t?r.flatMap(e=>e.composers).filter(e=>e.promptGroupId===t).sort((e,t)=>(e.createdAtMs||0)-(t.createdAtMs||0)):[]},[null==o||null==(t=o.composer)?void 0:t.promptGroupId,r]),eW=(0,c.useMemo)(()=>eU.filter(e=>{var t,r,n;return!!(null==(n=s.get(e.bcId))||null==(r=n.modelDetails)||null==(t=r.modelName)?void 0:t.trim())}),[eU,s]);(0,c.useMemo)(()=>(null==o?void 0:o.summary)&&o.summary.split(/\r?\n/)[0]||"",[null==o?void 0:o.summary]);let eq=(0,c.useMemo)(()=>!!(null==o?void 0:o.summary)&&o.summary.includes("\n"),[null==o?void 0:o.summary]),eJ=(0,c.useMemo)(()=>{var e,t;let r=new Set;if(!o)return r;let n=null==(e=o.composer)?void 0:e.bcId;if(!n)return r;let s=a.get(n);return(null==s||null==(t=s.diff)?void 0:t.diffs)&&s.diff.diffs.forEach(e=>{e.filename&&r.add(e.filename)}),r},[o,a]),eG=(0,c.useMemo)(()=>({code:e=>{let{node:t,children:r,...s}=e,a=String(null!=r?r:"").replace(/\n$/,""),l=/^[a-zA-Z0-9].*\.[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)*$/.test(a.trim()),o=eJ.has(a);return l&&o?(0,n.jsx)("code",{...s,className:"break-words whitespace-pre-wrap text-[#88C0D0] cursor-pointer hover:bg-[#262c34] rounded transition-colors",onClick:e=>{e.stopPropagation(),console.log("Clicked filename:",a)},title:"Click to view ".concat(a),children:r}):(0,n.jsx)("code",{...s,className:"break-words whitespace-pre-wrap text-[#88C0D0]",children:r})},p:e=>{let{className:t,children:r,...s}=e;return(0,n.jsx)("p",{...s,className:"p-0 m-0 ".concat(null!=t?t:"").trim(),children:r})},ul:e=>{let{className:t,children:r,...s}=e;return(0,n.jsx)("ul",{...s,className:"p-0 m-0 grid pl-3 ".concat(null!=t?t:"").trim(),children:r})}}),[eJ]),eZ=(0,c.useRef)(null);(0,c.useEffect)(()=>{if(!(null==h?void 0:h.current))return;let e=e=>{var t;if(D||R||e.metaKey||e.ctrlKey||e.altKey||1!==e.key.length)return;let r=e.target;if(!r)return;let n=r.tagName;if(r.isContentEditable||["INPUT","TEXTAREA","SELECT"].includes(n))return;e.preventDefault(),null==(t=h.current)||t.focus();let s=e.key;setTimeout(()=>{var e,t;null==(t=h.current)||null==(e=t.insertTextAtCursor)||e.call(t,s)},0)};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[D,R,h]),(0,c.useEffect)(()=>{eP(null)},[l]),(0,c.useEffect)(()=>{if(p)return;let e=eZ.current;e&&requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight})},[l,p]),(0,c.useEffect)(()=>{let e=eZ.current;if(!e||p)return void ep(!1);let t=()=>{ep(e.scrollTop>100)};return t(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[p,l]);let eV=()=>{let e=eZ.current;e&&e.scrollTo({top:0,behavior:"smooth"})},eK=(0,c.useMemo)(()=>{let e=new Map;return r.forEach(t=>t.composers.forEach(t=>e.set(t.bcId,t))),e},[r]),e$=(0,c.useRef)(null),eX=(0,c.useCallback)(e=>{h.current&&h.current.setPrompt(e)},[h]),eY=0===F.length&&!P;return(0,n.jsxs)("div",{className:"w-full h-screen flex",children:[!eY&&(0,n.jsxs)("div",{ref:e$,tabIndex:0,role:"listbox","aria-activedescendant":eF||l?"composer-".concat(eF||l):void 0,onKeyDown:e=>{if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault();let t=e$.current;if(!t)return;let r=Array.from(t.querySelectorAll("[data-composer-item]"));if(0===r.length)return;let n=eF||l,s=r.findIndex(e=>e.getAttribute("data-composer-id")===n);-1===s&&(s=0);let a=s+("ArrowDown"===e.key?1:-1);a<0&&(a=r.length-1),a>=r.length&&(a=0);let o=r[a],i=o.getAttribute("data-composer-id");i&&(eP(i),o.scrollIntoView({block:"nearest"}));return}if("Enter"===e.key){if(e.preventDefault(),eF){let e=eK.get(eF);e&&(j(e),eP(null))}return}if("Escape"===e.key){e.preventDefault(),eP(null);return}},onClick:e=>{if(e.target===e.currentTarget){var t;null==(t=e$.current)||t.focus()}},className:"relative flex-none outline-none focus:outline-none border-r border-gray-500/10 z-[1] bg-[#17191D] flex flex-col ".concat(X?"":"transition-all duration-150 ease-in-out"),style:{width:"".concat(U,"px")},children:[(0,n.jsx)("div",{className:"absolute top-0 bottom-0 cursor-col-resize flex items-center justify-center",style:{right:"-12px",width:"24px",zIndex:50},onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),Y(!0);let t=e.clientX,r=e=>{W(Math.max(180,Math.min(400,U+(e.clientX-t))))},n=()=>{Y(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",n)},children:(0,n.jsx)("div",{className:"w-0.5 h-full bg-border hover:bg-border-hover transition-colors"})}),(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"p-4 pb-0",children:[(0,n.jsx)("div",{className:"mb-[14px]",children:(0,n.jsx)(B.g,{hideText:!0,disableClick:!1,href:"/home?from=agents",size:24})}),(0,n.jsxs)("div",{className:"mb-3 relative",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search agents...",value:eM,onChange:e=>e_(e.target.value),className:"w-full px-[8px] py-[3px] pr-16 h-[30px] text-xs rounded-[6px] text-gray-300 placeholder-gray-500 focus:outline-none border border-gray-500/10 transition-colors",style:{background:"rgba(255, 255, 255, 0.02)"}}),(0,n.jsxs)("div",{className:"absolute right-1 z-[99] top-1/2 transform -translate-y-1/2 flex items-center gap-0.5",children:[(0,n.jsx)(e8,{filterConfig:f,onFilterConfigChange:E}),(0,n.jsx)(eH,{viewConfig:x,onViewConfigChange:S})]})]}),(0,n.jsxs)("button",{onClick:()=>{if(l)w();else if(!D){var e,t;null==(t=h.current)||null==(e=t.focus)||e.call(t)}},className:"group w-full outline-none focus:outline-none min-h-[32px] bg-[#70A7D7] hover:bg-[#90BAE0] flex items-center justify-center gap-1 text-white text-[11px] font-medium py-1 px-2 rounded-[6px] transition-colors duration-200",style:{color:"#2A2A2A",fontSize:"12px",fontWeight:"600",lineHeight:"150%"},onMouseDown:()=>{var e;null==(e=ex.current)||e.startAnimation()},children:[(0,n.jsx)(et,{ref:ex,size:12}),"New agent"]})]}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto",children:eB.length>0?(0,n.jsx)("div",{className:"flex flex-col gap-2 p-2",children:eB.filter(e=>e.composers.length>0).map(e=>(0,n.jsx)(nt,{section:e,selectedComposerId:l,highlightedComposerId:eF,selectedComposerDiffStats:eO,detailedComposers:s,detailedDiffs:a,onSelectComposer:j,onClearHighlight:()=>eP(null),groupBy:x.groupBy},e.name))}):(0,n.jsx)("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 p-4",children:(0,n.jsx)("span",{className:"text-sm text-gray-500/[0.64] text-center",children:eM.trim()?"No agents match search":"No agents match filter"})})}),(0,n.jsx)("div",{className:"p-2 border-t border-gray-500/10 flex-shrink-0",children:(0,n.jsx)("div",{className:"flex flex-col gap-0",children:(0,n.jsxs)("button",{onClick:()=>eu(!0),className:"w-full outline-none focus:outline-none text-left flex items-center gap-2 px-[8px] py-[6px] text-[11px] text-gray-500 hover:text-gray-300 hover:bg-white/5 rounded-[6px] transition-colors duration-200",children:[(0,n.jsx)(q.A,{size:12}),"Settings"]})})})]})]}),(0,n.jsx)("div",{className:"flex-1 flex flex-col h-full overflow-hidden z-[0]",children:l&&o?(0,n.jsx)("div",{className:"h-full bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col",children:(0,n.jsx)(rL,{selectedComposer:o,selectedComposerDiffStats:eO,selectedComposerId:l,isComposerNotFound:i,prLoading:d,existingPrUrl:u,onOpenInCursor:_.Q1,onOpenExistingPullRequest:A,onOpenPullRequest:M,onPrMerged:I,viewConfig:x,expandAllRef:eg,collapseAllRef:ev,children:e=>{var t,r,a,i,c;let{isComposerNotFound:d,currentConversation:u,currentLogs:f,hasComposer:h,HeaderComponent:g,DiffsComponent:v,TerminalLogsComponent:b,ConversationComponent:C,EditorComponent:N}=e,k=!(null==o?void 0:o.summary)&&f&&f.length>0&&h&&!u.some(e=>!e.isTemporary)&&(!eO||0===eO.totalAdded&&0===eO.totalRemoved),S=!(null==o?void 0:o.summary)&&h&&!u.some(e=>!e.isTemporary)&&(!eO||0===eO.totalAdded&&0===eO.totalRemoved),E=null==o||null==(t=o.composer)?void 0:t.status,L=null==o||null==(r=o.composer)?void 0:r.hasStartedVm,A=E===m.R6.CREATING&&!L&&S&&!d&&(!f||0===f.length),M=!eO||0===eO.totalAdded&&0===eO.totalRemoved,_="full"===x.viewMode&&M&&!k&&!A;return(0,n.jsxs)("div",{className:"h-full flex flex-col overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between px-6 py-3 bg-[#17191D] border-b border-gray-500/10 flex-shrink-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:["full"!==x.viewMode&&(0,n.jsx)("button",{onClick:w,className:"flex items-center gap-2 p-1 text-white opacity-60 hover:opacity-100 transition-opacity cursor-pointer flex-shrink-0",children:(0,n.jsx)(T.A,{className:"w-4 h-4"})}),(0,n.jsx)("div",{className:"flex-1 min-w-0",children:g})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[u.length>0&&!k&&!_&&(0,n.jsx)("div",{className:"relative -mt-1",children:(0,n.jsx)("button",{"data-tooltip-place":"bottom","data-tooltip-id":"toggle-chat","data-tooltip-content":p?"Show chat":"Hide chat",onMouseDown:y,className:"flex outline-none rounded-md ".concat(p?"bg-transparent":"bg-white/10"," focus:outline-none items-center rounded-[16px] p-1 mt-2 gap-2 text-gray-300 hover:opacity-100 transition-opacity cursor-pointer"),children:(0,n.jsx)(J.A,{size:16})})}),(0,n.jsxs)("div",{className:"relative -mt-1",children:[(0,n.jsx)("button",{ref:eN,onClick:()=>ey(!eb),className:"flex outline-none focus:outline-none items-center rounded-[16px] p-1 mt-2 gap-2 text-gray-300 hover:opacity-100 transition-opacity cursor-pointer",children:(0,n.jsx)(H.A,{size:16})}),(0,n.jsx)(tA,{isOpen:eb,onClose:()=>ey(!1),diffViewMode:ef,onViewModeToggle:eE,onExpandAll:eL,onCollapseAll:eA,onCopyRequestId:ek,onSendFeedback:eS,selectedComposerBcId:null==o||null==(a=o.composer)?void 0:a.bcId,isCopied:ej})]})]})]}),(0,n.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden relative",children:(0,n.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,n.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden relative",children:d?(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-white text-lg font-medium",children:"Background composer not found"}),(0,n.jsx)("div",{className:"text-gray-400 text-sm",children:"You do not have access to this Background Agent or it does not exist"})]})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex-1 flex flex-col gap-1 relative ".concat(A?"px-4 pt-0 overflow-hidden":"overflow-y-auto"),children:[eW.length>1&&(0,n.jsx)("div",{className:"px-6 py-2 pb-0",children:(0,n.jsx)(rR,{tabs:eW.map(e=>{var t,r;return{id:e.bcId,label:function(e){let t=e?e.replace(/^cursor-/,""):"Model",r=t.toLowerCase(),s=null,a=t;return"default"===r?(a="auto",s=(0,n.jsx)(r9,{className:"w-[14px] h-[14px]"})):r.includes("claude")?s=(0,n.jsx)(r6,{className:"w-5 h-5"}):(r.startsWith("gpt")||r.startsWith("o3")||r.startsWith("o1"))&&(s=(0,n.jsx)(r7,{className:"w-5 h-5"})),(0,n.jsxs)("span",{className:"inline-flex items-center gap-1",children:[s,a]})}(null==(r=s.get(e.bcId))||null==(t=r.modelDetails)?void 0:t.modelName)}}),activeTabId:l||"",onChange:e=>{if(e!==l){let t=eW.find(t=>t.bcId===e);t&&j(t)}}})}),(null==o?void 0:o.summary)&&(0,n.jsxs)("div",{className:"".concat(eW.length>1?"pl-[36px]":"pl-[24px]"," pr-5 py-4 border-b border-gray-500/10"),children:[(null==o||null==(i=o.prompt)?void 0:i.text)&&(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsxs)("div",{className:"text-[11px] flex items-start gap-4 text-gray-500 whitespace-pre-wrap break-words max-w-[768px]",children:[(0,n.jsx)("span",{className:"text-gray-500 w-[47px] min-w-[47px] font-mono",children:"Prompt"}),(0,n.jsx)("div",{className:"flex-1 min-w-0 font-normal text-xs not-italic whitespace-pre-wrap break-words",children:(0,n.jsx)(Z.oz,{components:eG,children:tW(o.prompt.text)})})]})}),(null==o?void 0:o.summary)&&(0,n.jsx)("div",{className:"relative group w-full",children:(0,n.jsx)("div",{className:"pr-6 text-[12px] ".concat(!eI&&eq?"group-hover:text-white":"text-gray-300"," leading-relaxed prose prose-invert prose-sm [&_strong]:text-gray-500 [&_code]:before:content-none [&_code]:after:content-none max-w-none"),children:(0,n.jsxs)("div",{className:"text-[11px] flex items-start gap-4 text-gray-500 whitespace-pre-wrap break-words max-w-[768px]",children:[(0,n.jsx)("span",{className:"text-gray-500 w-[47px] min-w-[47px] font-mono",children:"Summary"}),(0,n.jsx)("div",{className:"flex-1 min-w-0 font-normal text-xs not-italic whitespace-pre-wrap break-words",children:(0,n.jsx)("div",{className:"flex flex-col text-xs",children:(0,n.jsx)(Z.oz,{components:eG,children:o.summary})})})]})})})]}),(k||A)&&(k?b:(0,n.jsx)(rX,{composerId:l||void 0,promptText:null==o||null==(c=o.prompt)?void 0:c.text})),_&&(0,n.jsx)("div",{className:"px-6 py-4 flex-1 overflow-y-auto",children:C}),!k&&!A&&!_&&(0,n.jsx)("div",{className:"flex w-full",children:(0,n.jsx)("div",{className:"flex-1 min-w-0 flex flex-col ".concat(o.summary?"p-4 pt-2":"p-4 pt-6"),children:(0,n.jsx)("div",{className:"flex-1 min-w-0",children:v})})})]}),!(k||A)&&(0,n.jsx)("div",{className:"absolute bottom-0 left-0 pointer-events-none right-0 flex items-center justify-center py-4 z-[999999999999]",children:(0,n.jsx)("div",{className:"max-w-[468px] w-full",children:N})})]})}),(0,n.jsxs)("div",{className:"relative flex-none border-l border-gray-500/10 flex flex-col ".concat(Q?"":"transition-all duration-150 ease-in-out"),style:{width:"".concat(p||0===u.length||k||_?0:K,"px")},children:[!p&&!k&&(0,n.jsx)("div",{className:"absolute top-0 bottom-0 cursor-col-resize flex items-center justify-center",style:{left:"-12px",width:"24px",zIndex:50},onClick:e=>{e.stopPropagation(),es||y(),ea(!1)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),ee(!0),ea(!1);let t=e.clientX,r=e=>{$(Math.max(300,Math.min(600,K+(t-e.clientX)))),ea(!0)},n=()=>{ee(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",n)},children:(0,n.jsx)("div",{className:"w-0.5 h-full bg-border hover:bg-border-hover transition-colors"})}),(0,n.jsx)("div",{className:"flex flex-col h-full overflow-hidden",style:{opacity:p||k||_?0:1,pointerEvents:p||k||_?"none":"auto"},children:(0,n.jsxs)("div",{className:"h-full flex flex-col transition-opacity delay-0 relative",style:{opacity:+!!el},children:[(0,n.jsx)("div",{className:"flex-1 overflow-y-auto transition-opacity delay-0 p-4",style:{opacity:+!!el},ref:eZ,children:!_&&C}),!p&&u.length>0&&(0,n.jsx)("button",{onClick:eV,"data-tooltip-id":"scroll-to-top-tooltip","data-tooltip-content":"Scroll to top","aria-label":"Scroll to top of conversation",className:"absolute bottom-4 right-4 w-10 h-10 bg-[#242830] hover:bg-[#2D3138] outline-none rounded-full flex items-center justify-center text-white transition-all duration-150 ease-out hover:scale-105 z-50 focus:outline-none ".concat(em?"opacity-100 scale-100 pointer-events-auto":"opacity-0 scale-95 pointer-events-none"),children:(0,n.jsx)(G.A,{size:16})})]})})]})]})})]})}})}):l&&!i?(0,n.jsxs)("div",{className:"h-full bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between px-6 py-3 bg-[#17191D] border-b border-gray-500/10 flex-shrink-0",children:[(0,n.jsxs)("div",{className:"flex gap-y-2 w-full flex-col items-start justify-between gap-4 bg-[#17181c] pr-4 flex-wrap",children:[(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("div",{className:"flex items-center gap-3",children:(0,n.jsx)("h1",{className:"text-gray-300 font-medium text-[16px]",style:{letterSpacing:"-0.32px"},children:(0,n.jsx)(r8,{per:"char",preset:"fade",children:"Background agent"})})}),(0,n.jsx)("span",{className:"truncate opacity-40 gap-0 flex-grow-0 font-mono h-[20px] text-[11px] font-medium text-gray-500 relative max-w-[200px] sm:max-w-full flex items-center",children:(0,n.jsxs)("div",{className:"flex items-center gap-0",children:[(0,n.jsx)("span",{className:"make-shine",children:"Loading"}),(0,n.jsx)("span",{className:"font-normal",children:(0,n.jsx)(er,{})})]})})]}),(0,n.jsx)("div",{className:"flex w-[106px] h-[28px] rounded-md min-w-fit truncate justify-center items-center gap-1.5 px-3 text-[#D8DEE9] text-sm font-medium transition-colors disabled:cursor-default disabled:opacity-50"})]}),(0,n.jsx)("div",{className:"flex items-center gap-2 flex-shrink-0",children:(0,n.jsx)(en.i,{})})]}),(0,n.jsx)("div",{className:"w-full flex-1 flex flex-col overflow-hidden h-full px-4",children:(0,n.jsx)("div",{className:"flex-1"})})]}):l&&i?(0,n.jsxs)("div",{className:"h-full bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 py-3 bg-[#17191D] border-b border-gray-500/10 flex-shrink-0",children:[(0,n.jsx)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:(0,n.jsx)("div",{className:"flex-1 min-w-0",children:(0,n.jsx)("div",{className:"flex items-center gap-3",children:(0,n.jsx)("h1",{className:"text-gray-300 font-medium text-[16px]",style:{letterSpacing:"-0.32px"},children:"Agent not found"})})})}),(0,n.jsx)("div",{className:"flex items-center gap-2 flex-shrink-0",children:(0,n.jsx)(en.i,{})})]}),(0,n.jsx)("div",{className:"w-full flex-1 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-white text-lg font-medium",children:"Background Agent not found"}),(0,n.jsx)("div",{className:"text-gray-400 text-sm",children:"You do not have access to this Background Agent or it does not exist"}),(0,n.jsx)("button",{onClick:w,className:"mt-4 w-fit ring-0 outline-none inline-flex items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-0",children:"Create new Agent"})]})})]}):(0,n.jsxs)("div",{className:"h-full flex flex-col bg-gradient-to-b from-[#17191D] to-[#121315]",children:[!eY&&(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 pt-[32px] pr-[44px] flex-shrink-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-6 justify-center flex-1",children:[(0,n.jsx)("span",{className:"text-white cursor-default transition-colors",children:(0,n.jsx)(O.o5,{children:"Agents"})}),(0,n.jsx)("a",{href:"/dashboard",className:"text-gray-400 hover:text-gray-200 cursor-pointer transition-colors",children:(0,n.jsx)(O.o5,{children:"Dashboard"})})]}),(0,n.jsx)("div",{className:"flex items-center gap-2 flex-shrink-0",children:(0,n.jsx)(en.i,{})})]}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("div",{className:"max-w-[768px] w-full px-8 pb-[200px]",children:(0,n.jsxs)("div",{"data-fullscreen-input":!0,children:[(0,n.jsx)(tw,{onFocusChange:C,onDropdownOpenChange:N,onBeforeSubmit:k,deeplinkData:z,viewConfig:x,onViewConfigChange:S,filterConfig:f,onFilterConfigChange:E,inputRef:h,githubConnected:g,onConnectGithub:L,githubError:b,hasOpenModal:!!l,isFloating:!0}),0===F.length&&!P&&(0,n.jsx)(rH,{onChipClick:eX})]})})})]})}),(0,n.jsx)(V.m_,{id:"pr-status-tooltip",noArrow:!0,style:{padding:"4px 8px",fontSize:"12px",background:"rgba(0, 0, 0)",outline:"1px solid rgba(255,255,255,0.1)",fontWeight:"400"}}),(0,n.jsx)(ew,{open:ed,onClose:()=>eu(!1)})]})}var nn=r(61216),ns=r(3422);function na(e){let{isOpen:t,onClose:r}=e,[s,a]=(0,c.useState)(!1),l=(0,c.useRef)(null),o=(0,c.useRef)(null),i=(0,c.useCallback)(()=>{a(!1),o.current=setTimeout(()=>{r(),o.current=null},150)},[r]),d=(0,c.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),i()},[i]);if((0,c.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),i())};if(t)return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}},[t,i]),(0,c.useEffect)(()=>{if(t)return document.body.style.overflow="hidden",l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{a(!0),l.current=null},10),()=>{document.body.style.overflow=""};a(!1)},[t]),(0,c.useEffect)(()=>()=>{l.current&&clearTimeout(l.current),o.current&&clearTimeout(o.current)},[]),!t)return null;let u=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 transition-opacity duration-150 ease-out ".concat(s?"opacity-100":"opacity-0"),onPointerDown:d,onClick:d,onTouchStart:e=>e.preventDefault(),style:{touchAction:"manipulation",pointerEvents:"all"}}),(0,n.jsx)("div",{className:"fixed z-[9999] w-full transition-all duration-150 ease-out\n          sm:left-1/2 sm:top-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:max-w-lg\n          max-sm:left-0 max-sm:right-0 max-sm:top-0 max-sm:bottom-0\n          ".concat(s?"opacity-100 sm:scale-100 max-sm:translate-y-0":"opacity-0 sm:scale-95 max-sm:translate-y-full"),children:(0,n.jsxs)("div",{className:"shadow-lg mx-4 sm:mx-0 pointer-events-auto overflow-hidden\n            rounded-[12px] bg-[#141414] max-sm:mx-0 max-sm:h-full max-sm:flex max-sm:flex-col ".concat(x.Fr?"pb-[env(safe-area-inset-bottom)]":""),style:{boxShadow:"0px 0px 2px 0px rgba(255, 255, 255, 0.08) inset, 0px 0px 2px 0px rgba(0, 0, 0, 0.25), 0px 12px 24px 0px rgba(0, 0, 0, 0.24), 0px 20px 40px 0px rgba(0, 0, 0, 0.12)"},onPointerDown:e=>e.stopPropagation(),children:[(0,n.jsx)("button",{onClick:i,className:"absolute top-4 right-4 z-[9999] p-2 rounded-full bg-black/20 hover:bg-black/40 transition-colors backdrop-blur-[10px]",style:{pointerEvents:"auto"},children:(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M12 4L4 12M4 4L12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white"})})}),(0,n.jsx)("div",{className:"relative w-full aspect-video",children:(0,n.jsx)("iframe",{src:"https://www.youtube.com/embed/hHTKtrSO6os?controls=0&modestbranding=1&showinfo=0&rel=0&iv_load_policy=3&disablekb=1&showinfo=0&controls=0&autohide=1",title:"Announcement Video",className:"w-full h-full min-h-[288px]",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),(0,n.jsxs)("div",{className:"p-6 flex-1 flex flex-col",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,n.jsx)("p",{className:"text-[11px] font-regular text-gray-500",children:"New"}),(0,n.jsx)("h2",{className:"text-[16px] font-medium text-gray-300 mb-6",children:"Cursor Agents on Web"})]}),(0,n.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",children:(0,n.jsx)(nn.A,{className:"w-4 h-4 text-gray-500"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-0 text-[12px]",children:[(0,n.jsx)("h3",{className:"text-gray-300 font-medium",children:"Work across devices"}),(0,n.jsx)("p",{className:"text-gray-500 text-[12px]",children:"Run agents from any device with seamless handoff to desktop"})]})]}),(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",children:(0,n.jsx)(eo.A,{className:"w-4 h-4 text-gray-500"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-0 text-[12px]",children:[(0,n.jsx)("h3",{className:"text-gray-300 font-medium",children:"Team collaboration"}),(0,n.jsx)("p",{className:"text-gray-500 text-[12px]",children:"Share links with team members to review and collaborate"})]})]}),(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",children:(0,n.jsx)(ns.A,{className:"w-4 h-4 text-gray-500"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-0 text-[12px]",children:[(0,n.jsx)("h3",{className:"text-gray-300 font-medium",children:"Slack integration"}),(0,n.jsx)("p",{className:"text-gray-500 text-[12px]",children:"Trigger agents with @Cursor or get notified when agents finish"})]})]})]}),(0,n.jsx)("div",{className:"flex-1 flex items-end gap-2",children:(0,n.jsx)("button",{onClick:i,className:"w-full bg-[#81a1c1] hover:bg-[#81a1c1]/80 text-[#191C22] font-medium py-2.5 px-4 rounded-lg text-[12px] transition-colors",children:"Get started"})})]})]})})]});return(0,ti.createPortal)(u,document.body)}var nl=r(83408);let no={times:[0,.4,1],duration:.5},ni={normal:{x:0},animate:{x:[0,-1.5,0]}},nc=(0,c.forwardRef)((e,t)=>{let{onMouseEnter:r,onMouseLeave:s,className:a,size:l=28,...o}=e,d=(0,K.s)(),u=(0,c.useRef)(!1);(0,c.useImperativeHandle)(t,()=>(u.current=!0,{startAnimation:()=>d.start("animate"),stopAnimation:()=>d.start("normal")}));let m=(0,c.useCallback)(e=>{u.current?null==r||r(e):d.start("animate")},[d,r]),p=(0,c.useCallback)(e=>{u.current?null==s||s(e):d.start("normal")},[d,s]);return(0,n.jsx)("div",{className:(0,i.cn)(a),onMouseEnter:m,onMouseLeave:p,...o,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}),(0,n.jsx)("path",{d:"M15 3v18"}),(0,n.jsx)($.P.path,{transition:no,variants:ni,animate:d,d:"m10 15-3-3 3-3"})]})})});function nd(e){var t,r,s,a,l,o,i;let{activeTab:d,selectedComposer:u,isConversationLoading:m,isConversationCollapsed:p,onToggleCollapse:x,onFilenameClick:f,isResizing:h,setIsResizing:g}=e,{conversations:b,getConversationForAgent:w,logs:y,detailedDiffs:j}=(0,v._F)(),[C,N]=(0,c.useState)(!1),[k,S]=(0,c.useState)(!0),[E,L]=(0,c.useState)(()=>{{let e=localStorage.getItem("background-composer-sidebar-width");return e?Math.max(254,Math.min(600,parseInt(e,10))):400}}),[A,M]=(0,c.useState)(!1),_=function(){let[e,t]=(0,c.useState)(window.innerWidth);return(0,c.useEffect)(()=>{let e=()=>t(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}()>=1024,I=(0,c.useMemo)(()=>{var e;let t=null==u||null==(e=u.composer)?void 0:e.bcId;return!!t&&j.has(t)},[null==u||null==(t=u.composer)?void 0:t.bcId,j]);(0,c.useEffect)(()=>{N(!0)},[]),(0,c.useEffect)(()=>{localStorage.setItem("background-composer-sidebar-width",E.toString())},[E]),(0,c.useEffect)(()=>{if(!_)return void S(!0);if(p)S(!1);else{let e=setTimeout(()=>{S(!0)},151);return()=>clearTimeout(e)}},[p,_]);let D=(0,c.useMemo)(()=>{var e;return w((null==u||null==(e=u.composer)?void 0:e.bcId)||"")},[w,null==u||null==(r=u.composer)?void 0:r.bcId]),R=(0,c.useMemo)(()=>{var e;return y.get((null==u||null==(e=u.composer)?void 0:e.bcId)||"")||[]},[y,null==u||null==(s=u.composer)?void 0:s.bcId]),T=(0,c.useMemo)(()=>{if(!u)return!1;let e=!u.summary,t=!I,r=R.length>0,n=D.filter(e=>!e.isTemporary),s=n.filter(e=>e.type===ey.Jc.HUMAN).length,a=n.filter(e=>e.type===ey.Jc.AI).length,l=1===n.length&&1===s,o=2===n.length&&1===s&&1===a;return e&&t&&r&&(l||o)},[u,I,R.length,D]);if(!_&&!("conversation"===d||_))return null;let F=(null==u||null==(a=u.composer)?void 0:a.isKilled)&&0===D.length;if(!_)return(0,n.jsx)("div",{className:"flex relative flex-col h-full overflow-hidden w-full",children:(0,n.jsxs)("div",{className:"flex flex-col h-full px-10 py-2 pb-6",children:[(0,n.jsx)(rs,{conversation:D,logs:R,isLoading:m,hasComposer:!!u,hasDiff:I,inSidebar:!0,onFilenameClick:f,isComposerKilled:null==u||null==(o=u.composer)?void 0:o.isKilled}),T?(0,n.jsx)("div",{className:"mt-2",children:(0,n.jsx)(t6,{logs:R})}):null,(0,n.jsx)("div",{className:"transition-opacity duration-200",children:(0,n.jsx)("div",{children:!C||m||F?null:(0,n.jsx)("div",{className:"w-full mt-4",children:(0,n.jsx)(tw,{isFollowUp:!0,customPlaceholder:"Follow up with this agent...",hideDropdowns:!0,hideFooterButtons:!1,selectedComposer:u,hasOpenModal:!0})})})})]})});let P=p?0:E;return(0,n.jsxs)("div",{className:"relative h-full ".concat(h?"":"transition-all duration-150 ease-in-out"),style:{width:"".concat(P,"px")},children:[!p&&(0,n.jsx)("div",{className:"absolute top-0 bottom-0 cursor-col-resize flex items-center justify-center",style:{left:"-12px",width:"24px",zIndex:50},onClick:e=>{e.stopPropagation(),A||x(),M(!1)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),g(!0),M(!1);let t=e.clientX,r=e=>{L(Math.max(254,Math.min(600,E+(t-e.clientX)))),M(!0)},n=()=>{g(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",n)},children:(0,n.jsx)("div",{className:"w-0.5 h-full bg-border hover:bg-border-hover transition-colors"})}),(0,n.jsx)("div",{className:"flex flex-col h-full overflow-hidden",style:{opacity:+!p,pointerEvents:p?"none":"auto"},children:(0,n.jsxs)("div",{className:"flex flex-col h-full transition-opacity delay-0",style:{opacity:+!!k},children:[(0,n.jsx)(rs,{conversation:D,logs:R,isLoading:m,hasComposer:!!u,hasDiff:I,inSidebar:!0,onFilenameClick:f,isComposerKilled:null==u||null==(l=u.composer)?void 0:l.isKilled}),T?(0,n.jsx)("div",{className:"p-2 pt-0",children:(0,n.jsx)(t6,{logs:R})}):null,(0,n.jsx)("div",{className:"transition-opacity duration-200 mt-auto",style:{opacity:+!!k},children:(0,n.jsx)("div",{className:"p-2 pt-0",children:C&&!m&&((null==u||null==(i=u.composer)?void 0:i.isKilled)&&0===D.length?null:(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)(tw,{isFollowUp:!0,customPlaceholder:"Follow up with this agent...",hideDropdowns:!0,hideFooterButtons:!1,selectedComposer:u,hasOpenModal:!0})}))})})]})})]})}nc.displayName="PanelRightOpenIcon";var nu=r(66984),nm=r(34277);function np(e){let{activeTab:t,setActiveTab:r}=e,s=(0,c.useRef)(null),a=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=()=>{let e=s.current;if(t&&e){let t=a.current;if(t){let{offsetLeft:r,offsetWidth:n}=t;e.style.clipPath="inset(0 ".concat(Number(100-(r+n)/e.offsetWidth*100).toFixed(),"% 0 ").concat(Number(r/e.offsetWidth*100).toFixed(),"% round ").concat(x.Fr?"100px":"6px",")")}}},r=requestAnimationFrame(()=>{e()});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e),cancelAnimationFrame(r)}},[t,a,s]),(0,n.jsx)("div",{className:"px-4",children:(0,n.jsxs)("div",{className:"relative flex flex-col items-center w-fit mx-6 ".concat(x.Fr?"py-2":"pt-4"),children:[(0,n.jsx)("ul",{className:"relative flex w-full justify-center",children:nx.map(e=>(0,n.jsx)("li",{children:(0,n.jsxs)("button",{ref:t===e.name?a:null,"data-tab":e.name,onMouseDown:()=>{r(e.name)},className:"flex ".concat(x.Fr?"h-[24px] text-[14px] rounded-[100px] min-w-[100px] justify-center":"h-[28px] text-[11px] rounded"," items-center gap-2 px-2 font-medium text-gray-500 no-underline"),children:[!x.Fr&&e.icon,e.displayName]})},e.name))}),(0,n.jsx)("div",{"aria-hidden":!0,className:"absolute z-10 w-full overflow-hidden transition-all duration-250 ease-in-out",ref:s,style:{clipPath:"inset(0px 75% 0px 0% round 3px)"},children:(0,n.jsx)("ul",{className:"relative flex w-full justify-center bg-gray-500/20",children:nx.map(e=>(0,n.jsx)("li",{children:(0,n.jsxs)("button",{"data-tab":e.name,onMouseDown:()=>{r(e.name)},className:"flex ".concat(x.Fr?"h-[24px] text-[14px] rounded-[100px] min-w-[100px] justify-center":"h-[28px] text-[11px] "," items-center gap-2 rounded px-2 font-medium text-white no-underline"),tabIndex:-1,children:[!x.Fr&&e.icon,e.displayName]})},e.name))})})]})})}let nx=[{name:"code",displayName:"Diff",icon:(0,n.jsx)(nu.A,{size:14})},{name:"conversation",displayName:"Chat",icon:(0,n.jsx)(nm.A,{size:14})}];function nf(e){var t,r;let{selectedComposerId:s,isModalVisible:a,handleCloseModal:l,isConversationCollapsed:o,isConversationLoading:i,selectedComposer:d,selectedComposerDiffStats:u,isComposerNotFound:m,prLoading:p,existingPrUrl:x,onOpenInCursor:f,onOpenExistingPullRequest:h,onOpenPullRequest:g,handleCollapseConversation:b,onSelectPrevious:w,onSelectNext:y,hasPrevious:j,hasNext:C,onPrMerged:N}=e,k=(0,c.useRef)(null),S=(0,c.useRef)(null),E=(0,c.useRef)(null),{diffViewMode:L,setDiffViewMode:A}=(0,v._F)(),[M,_]=(0,c.useState)(!1),I=(0,c.useRef)(null),D=(0,c.useRef)(null),[R,F]=(0,c.useState)(!1),[P,B]=(0,c.useState)(!1),[O,z]=(0,c.useState)(!1),U=(0,c.useRef)(null),[W,q]=(0,c.useState)(()=>{{let e=localStorage.getItem("background-composer-sidebar-width");return e?Math.max(254,Math.min(600,parseInt(e,10))):400}});(0,c.useEffect)(()=>{let e=()=>{{let e=localStorage.getItem("background-composer-sidebar-width");q(e?Math.max(254,Math.min(600,parseInt(e,10))):400)}};window.addEventListener("storage",e);let t=setInterval(e,100);return()=>{window.removeEventListener("storage",e),clearInterval(t)}},[]),(0,c.useEffect)(()=>{z(!0);let e=setTimeout(()=>{z(!1)},150);return()=>clearTimeout(e)},[o]);let J=null!=(r=null==d||null==(t=d.composer)?void 0:t.isOwnedByDifferentTeamMember)&&r,G=async()=>{var e;if(null==d||null==(e=d.composer)?void 0:e.bcId)try{await navigator.clipboard.writeText(d.composer.bcId),B(!0),setTimeout(()=>B(!1),350)}catch(e){console.error("Failed to copy request ID:",e)}},Z=()=>{var e,t;let r="Feedback ".concat((null==d||null==(e=d.composer)?void 0:e.bcId)?"[".concat(null==d||null==(t=d.composer)?void 0:t.bcId,"]"):""),n="mailto:background-agent-feedback@cursor.com?subject=".concat(encodeURIComponent(r));window.open(n,"_blank"),F(!1)},V=e=>{A(e)},K=()=>{I.current&&I.current()},$=()=>{D.current&&D.current()},X=(0,c.useRef)([]);return(0,ez.vC)("arrowleft, j",()=>{j&&w&&w()},{enabled:null!==s&&a&&!J,enableOnFormTags:!1,preventDefault:!0},[s,a,j,w,J]),(0,ez.vC)("arrowright, k",()=>{C&&y&&y()},{enabled:null!==s&&a&&!J,enableOnFormTags:!1,preventDefault:!0},[s,a,C,y,J]),(0,n.jsx)("div",{className:"fixed inset-0 flex items-center justify-center duration-300 ".concat(s&&a?"opacity-100 bg-black/50 pointer-events-auto z-50":"opacity-0 pointer-events-none -z-[1]"),style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:l,children:(0,n.jsx)(rL,{selectedComposer:d,selectedComposerDiffStats:u,selectedComposerId:s,isComposerNotFound:m,prLoading:p,existingPrUrl:x,onOpenInCursor:f,onOpenExistingPullRequest:h,onOpenPullRequest:g,onCloseModal:l,onPrMerged:N,expandAllRef:I,collapseAllRef:D,conversationScrollRef:k,children:e=>{var t;let{activeTab:r,setActiveTab:c,isComposerNotFound:m,currentConversation:p,currentLogs:x,hasComposer:f,isLoading:h,handleFilenameClick:g,HeaderComponent:v,DiffsComponent:N,TerminalLogsComponent:A,ConversationComponent:I,EditorComponent:D}=e;X.current=x;let B=!(null==d?void 0:d.summary)&&x&&x.length>0&&f&&!p.some(e=>!e.isTemporary)&&(!u||0===u.totalAdded&&0===u.totalRemoved),z=!(null==d?void 0:d.summary)&&f&&!p.some(e=>!e.isTemporary)&&(!u||0===u.totalAdded&&0===u.totalRemoved)&&!m&&(!x||0===x.length);return(0,n.jsxs)("div",{className:"bg-gradient-to-b from-[#17191D] to-[#121315] rounded-[20px] shadow-2xl h-[85vh] w-[90vw] max-w-7xl flex flex-col overflow-hidden border border-white/10 lg:duration-300",style:{pointerEvents:s&&a?"auto":"none",transitionProperty:s&&a?"opacity, transform":"",transitionDuration:"150ms",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transform:s&&a?"scale(1)":"scale(0.95)",zIndex:s&&a?1e3:-10,opacity:s&&a?1:0},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("div",{ref:k,className:"flex-1 ".concat(o||i?"overflow-y-auto":"overflow-hidden"),children:(0,n.jsxs)("div",{className:"flex lg:flex-row h-full flex-col",children:[(0,n.jsxs)("div",{ref:S,className:"flex-1 flex flex-col gap-0 ".concat(o||i?"":"lg:border-r border-white/10 overflow-y-auto"),children:[(0,n.jsx)("div",{className:"sticky top-0 z-10 flex items-center justify-between p-4 py-3 bg-[#17191D] flex-shrink-0",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:l,className:"flex items-center gap-2 p-1 text-white opacity-60 hover:opacity-100 transition-opacity cursor-pointer",children:(0,n.jsx)(T.A,{className:"w-4 h-4"})}),!J&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:w,disabled:!j,className:"flex justify-center p-1 items-center gap-2 text-white transition-opacity ".concat(j?"opacity-60 hover:opacity-100 cursor-pointer":"opacity-30 cursor-default"),children:(0,n.jsx)(eX.A,{className:"w-4 h-4"})}),(0,n.jsx)("button",{onClick:y,disabled:!C,className:"flex justify-center p-1 items-center gap-2 text-white transition-opacity ".concat(C?"opacity-60 hover:opacity-100 cursor-pointer":"opacity-30 cursor-default"),children:(0,n.jsx)(nl.A,{className:"w-4 h-4"})})]})]})}),(0,n.jsx)("div",{className:"flex flex-col gap-1 flex-1 lg:min-h-0 pt-0",children:m?(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-white text-lg font-medium",children:"Background Agent not found"}),(0,n.jsx)("div",{className:"text-gray-400 text-sm",children:"You do not have access to this Background Agent or it does not exist"}),(0,n.jsx)("button",{onClick:l,className:"mt-4 w-fit ring-0 outline-none inline-flex items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-0",children:"Create new Agent"})]})}):(0,n.jsxs)(n.Fragment,{children:[v,(0,n.jsxs)("div",{className:"flex flex-col gap-1 flex-1 h-full lg:min-h-0",children:[(0,n.jsx)("div",{className:"flex justify-center sm:justify-start lg:hidden flex-shrink-0 relative",children:(0,n.jsx)(np,{activeTab:r,setActiveTab:c})}),(B||z)&&(B?A:(0,n.jsx)(rX,{composerId:s||void 0})),!B&&!z&&N,"conversation"===r&&!B&&!z&&(0,n.jsx)("div",{className:"flex-1 flex flex-col px-10 py-5 lg:hidden",children:(0,n.jsx)("div",{className:"flex-1",children:I})})]})]})})]}),!i&&(0,n.jsx)("div",{className:"hidden lg:block","data-conversation-chat":!0,children:(0,n.jsx)(nd,{activeTab:r,onToggleCollapse:b,selectedComposer:null!=d?d:null,isConversationCollapsed:o,isConversationLoading:h,onFilenameClick:g,isResizing:M,setIsResizing:_})})]})}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"absolute top-2 z-10 hidden lg:block transition-opacity duration-300 ease-in-out ".concat(O||M?"opacity-0 pointer-events-none":"opacity-100"),style:{right:i?"8px":o?"40px":"".concat(W+12,"px")},children:[(0,n.jsx)("button",{ref:U,onClick:()=>{F(!R)},className:"flex outline-none focus:outline-none items-center rounded-[16px] p-1 gap-2 text-white opacity-60 hover:opacity-100 transition-opacity cursor-pointer",children:(0,n.jsx)(H.A,{size:16})}),(0,n.jsx)(tA,{isOpen:R,onClose:()=>F(!1),diffViewMode:L,onViewModeToggle:V,onExpandAll:K,onCollapseAll:$,onCopyRequestId:G,onSendFeedback:Z,selectedComposerBcId:null==d||null==(t=d.composer)?void 0:t.bcId,isCopied:P})]}),"conversation"===r&&!h&&p.length>0&&(0,n.jsx)("div",{className:"lg:hidden block",children:D}),!i&&(0,n.jsx)("button",{"data-tooltip-place":"bottom","data-tooltip-id":"toggle-chat","data-tooltip-content":o?"Show chat":"Hide chat",onMouseDown:()=>{if(o){var e;null==(e=E.current)||e.startAnimation()}b()},className:"absolute right-2 top-2 z-10 hidden lg:flex items-center rounded-[16px] p-1 gap-2 text-white opacity-60 hover:opacity-100 transition-opacity cursor-pointer ".concat(o?"":"bg-white/10"),children:(0,n.jsx)(nc,{ref:E,size:16})})]})]})}})})}let nh=e=>{let{videoRef:t}=e;return(0,n.jsx)("div",{className:"container flex h-screen w-screen items-center justify-center text-white",children:(0,n.jsx)("div",{className:"flex flex-col items-center gap-4 -mt-[44px]",children:(0,n.jsx)("video",{ref:t,width:84,height:84,muted:!0,playsInline:!0,preload:"auto",loop:!0,className:"-mb-4","aria-label":"Cursor video logo animation",style:{mixBlendMode:"screen"},src:"/cursor-website-proxy/assets/videos/logo/logo-loading.gif",poster:"/cursor-website-proxy/assets/videos/logo/logo-loading.gif",suppressHydrationWarning:!0})})})};function ng(e){let{selectedComposerId:t,isModalVisible:r,handleCloseModal:s,selectedComposer:a,selectedComposerDiffStats:o,isComposerNotFound:i,prLoading:d,existingPrUrl:u,onOpenExistingPullRequest:m,onOpenPullRequest:p,onPrMerged:x}=e,f=(0,c.useRef)(null),h=(0,c.useRef)(null),g=(0,c.useRef)("background-composer-".concat(Math.random().toString(36).substr(2,9))),v=(0,c.useRef)({code:0,conversation:0}),b=!!(t&&r);(0,c.useEffect)(()=>{(0,l.KZ)(g.current,b)},[b]);let w=()=>{if(!f.current||!h.current)return 0;let e=f.current,t=h.current,r=e.getBoundingClientRect(),n=t.getBoundingClientRect().top-r.top;return e.scrollTop+n};(0,c.useEffect)(()=>{requestAnimationFrame(()=>{let e=Math.max(w(),0);v.current={code:e,conversation:e}})},[t]);let y=(0,c.useMemo)(()=>({code:e=>{let{children:t,...r}=e;return(0,n.jsx)("code",{...r,className:"break-words whitespace-pre-wrap text-[#88C0D0]",children:t})}}),[]);return(0,n.jsx)(tg._s.Root,{open:b,onOpenChange:e=>{(0,l.KZ)(g.current,e),e||s()},children:(0,n.jsxs)(tg._s.Portal,{children:[(0,n.jsx)(tg._s.Overlay,{className:"fixed inset-0 bg-black/50 z-50"}),(0,n.jsxs)(tg._s.Content,{className:"ring-0 outline-none bg-[#16181b] flex flex-col rounded-t-xl border border-white/10 h-[85vh] mt-24 fixed bottom-0 left-0 right-0 z-50",children:[(0,n.jsx)("div",{className:"p-4 pb-0",children:(0,n.jsx)(tg._s.Handle,{className:"bg-white/20 h-1 w-12 rounded-full mx-auto mb-4"})}),(0,n.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:(0,n.jsx)(rL,{selectedComposer:a,selectedComposerDiffStats:o,selectedComposerId:t,isComposerNotFound:i,prLoading:d,existingPrUrl:u,onOpenInCursor:_.Q1,onOpenExistingPullRequest:m,onOpenPullRequest:p,onCloseModal:()=>{(0,l.KZ)(g.current,!1),s()},onPrMerged:x,conversationScrollRef:f,children:e=>{var t,r,l,i;let{activeTab:c,HeaderComponent:d,DiffsComponent:u,setActiveTab:m,currentLogs:p,hasComposer:x,currentConversation:g,ConversationComponent:b,EditorComponent:j,TerminalLogsComponent:C,isComposerNotFound:N}=e;return(0,n.jsxs)(n.Fragment,{children:[d,(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto relative z-20",ref:f,children:[(null==a?void 0:a.summary)&&(0,n.jsx)("div",{className:"flex flex-col gap-y-2 group p-4",children:(0,n.jsx)("div",{className:" transition-all duration-300 overflow-hidden relative",children:(0,n.jsx)("div",{className:"text-sm text-gray-500 prose prose-invert prose-sm max-w-none [&_strong]:text-gray-500 [&_li_code]:break-all [&_li_code]:overflow-wrap-anywhere [&_pre]:overflow-x-auto [&_pre]:max-w-full [&_code]:before:content-none [&_code]:after:content-none",children:(0,n.jsx)(Z.oz,{components:y,children:a.summary})})})}),(0,n.jsxs)("span",{className:"text-gray-500 p-4 pt-1 text-[13px] flex items-center gap-1",children:[null==a||null==(t=a.modelDetails)?void 0:t.modelName,(null==a||null==(r=a.modelDetails)?void 0:r.modelName)&&(null==a||null==(l=a.composer)?void 0:l.branchName)&&" • ",null==a||null==(i=a.composer)?void 0:i.branchName]}),(0,n.jsx)("div",{className:"flex flex-col h-full",children:N?(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center px-4",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-white text-lg font-medium",children:"Background Agent not found"}),(0,n.jsx)("div",{className:"text-gray-400 text-sm",children:"The background agent you're looking for doesn't exist or has been removed."}),(0,n.jsx)("button",{onClick:s,className:"mt-4 w-fit ring-0 outline-none inline-flex items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-0",children:"Create new Agent"})]})}):(0,n.jsx)("div",{className:"flex flex-col gap-0",children:(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[!(p&&p.length>0&&x&&0===g.length&&(!o||0===o.totalAdded&&0===o.totalRemoved))&&(0,n.jsx)("div",{ref:h,className:"flex sticky bg-[#16181b] -top-[1px] z-10 justify-center sm:justify-start mb-0 sm:mb-6 px-5 flex-shrink-0 transition-colors duration-200",children:(0,n.jsx)(np,{activeTab:c,setActiveTab:e=>{let t=f.current;if(t){let e=Math.max(t.scrollTop,w());"code"===c?v.current.code=e:"conversation"===c&&(v.current.conversation=e)}m(e),requestAnimationFrame(()=>{t&&(t.scrollTop=v.current[e])})}})}),p&&p.length>0&&x&&0===g.length&&(!o||0===o.totalAdded&&0===o.totalRemoved)&&C,!(p&&p.length>0&&x&&0===g.length&&(!o||0===o.totalAdded&&0===o.totalRemoved))&&(0,n.jsxs)(n.Fragment,{children:["code"===c&&(0,n.jsx)("div",{children:u}),"conversation"===c&&(0,n.jsx)("div",{className:"px-4 py-5 min-h-[200px]",children:(0,n.jsx)("div",{className:"pb-4",children:b})})]})]})})})]}),j&&(0,n.jsx)("div",{className:"flex-shrink-0 border-t border-white/10 bg-[#16181b]",children:(0,n.jsx)("div",{className:"px-4 py-3",children:j})})]})}})})]})]})})}var nv=r(18185),nb=r(59357);function nw(e){var t,r,s,a;let l,o,i,{backgroundComposer:d,detailedBackgroundComposer:u,onSelect:m,isKanban:p,prLoading:f,onOpenExistingPullRequest:h,viewConfig:g}=e,{refetchBackgroundComposers:b,fetchDetailedComposer:w,detailedDiffs:y}=(0,v._F)(),j=d.prUrl||void 0,[C,N]=(0,c.useState)(null),[k,S]=(0,c.useState)(!1),E=(0,c.useRef)(null);(0,c.useEffect)(()=>{j?(0,_.s9)(d.bcId,j):(0,_.xh)(d.bcId)},[j,d.bcId]);let[L,A]=(0,c.useState)(null);(0,c.useEffect)(()=>{if(u){let e=y.get(d.bcId);A((0,_.xH)(u,e))}},[u,d.bcId,y]),(0,c.useEffect)(()=>{j?(0,_.Jg)(j).then(e=>{N(e)}).catch(e=>{console.error("Error fetching PR merge status:",e),N(null)}):N(null)},[j,d.bcId]);let M=()=>j&&C?C.isMerged?(0,n.jsx)(z.A,{className:"w-3 h-3 text-purple-400 text-[11px]"}):C.isClosed?(0,n.jsx)(U.A,{className:"w-3 h-3 text-[#BF616A] text-[11px]"}):C.isDraft?(0,n.jsx)(W.A,{className:"w-3 h-3 text-gray-400 text-[11px]"}):"open"===C.state?(0,n.jsx)(z.A,{className:"w-3 h-3 text-[#A3BE8C] text-[11px]"}):null:null,I=async e=>{if(console.log("handleClick",e),e.metaKey||e.ctrlKey){let e=new URL(window.location.href);e.searchParams.set("selectedBcId",d.bcId),window.open(e.toString(),"_blank");return}if(m&&u)m(u);else if(!u&&m)try{let e=await w(d.bcId);e?m(e):console.error("Failed to refetch detailed background composer")}catch(e){console.error("Error refetching detailed background composer:",e)}},D=e=>{switch(e){case"name":case"status":case"model":case"date":case"diff":case"prompt":return!0;case"repo":return!!d.repoUrl;case"branch":return!!d.branchName;default:return!1}},R=e=>{switch(e){case"name":case"status":case"date":case"prompt":return!0;case"model":return!!(null==u?void 0:u.modelDetails);case"repo":return!!d.repoUrl;case"branch":return!!d.branchName;case"diff":return!!(L&&(L.totalAdded>0||L.totalRemoved>0));default:return!1}},T=g.properties.filter(e=>{if(!e.visible)return!1;if(g.groupBy){let t={status:"status",repo:"repo",model:"model",date:"date",prompt:"prompt"}[g.groupBy];if(t&&e.id===t)return!1}return!0}).sort((e,t)=>e.order-t.order);p?(l=T.filter(e=>"name"===e.id||"diff"===e.id),o=T.filter(e=>"name"!==e.id&&"diff"!==e.id)):(l=T.filter(e=>("repo"!==g.groupBy||"model"!==e.id)&&0===(e.row||0)),o=T.filter(e=>"repo"===g.groupBy&&"model"===e.id||1===(e.row||0)));let F=l.filter(e=>D(e.id)),P=o.filter(e=>D(e.id));if(p)i=null==(t=F.find(e=>"name"===e.id))?void 0:t.id;else{let e=["name","prompt","branch","repo"];(i=null==(r=F.find(t=>e.includes(t.id)))?void 0:r.id)||(i=null==(s=F.find(e=>"model"===e.id))?void 0:s.id),i||0!==F.length||(i=null==(a=P.find(t=>e.includes(t.id)))?void 0:a.id)}let B=function(e){var t,r,s,a;let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e){case"name":return(0,n.jsx)("div",{className:l?"font-medium ".concat(p?"leading-[140%] text-[12px]":"sm:text-sm leading-[150%] text-[14px]"," text-gray-300 group-hover:text-white group-active:text-white sm:opacity-100 group-hover:opacity-100 truncate"):"truncate text-gray-500",children:(null==(t=d.name)?void 0:t.length)>0?d.name:"New Background Agent"});case"status":return(0,n.jsx)(rD,{status:d.status,className:"w-5 h-5 sm:w-4 sm:h-4 flex-shrink-0",isArchived:d.isArchived});case"model":return(null==u?void 0:u.modelDetails)?l?(0,n.jsx)("span",{className:"leading-[150%] text-gray-300 font-medium truncate text-[14px]",children:null==u?void 0:u.modelDetails.modelName}):p||"repo"===g.groupBy?(0,n.jsx)("span",{className:"text-gray-500 text-[12px] truncate",children:null==u?void 0:u.modelDetails.modelName}):(0,n.jsx)("div",{className:"truncate px-1 py-0 bg-[#1d222d] text-[11px] font-mono font-medium rounded text-gray-500 hover:text-gray-400",children:(0,n.jsx)("span",{style:{background:"linear-gradient(to right, #81a1c1, #7d7c9b)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:null==u?void 0:u.modelDetails.modelName})}):(0,n.jsx)(n.Fragment,{});case"date":return(0,n.jsx)("span",{className:"text-gray-500 text-[12px] flex-shrink-0",children:(e=>{let t=Math.floor((Date.now()-e)/1e3);if(t<60)return"Just now";if(t<3600){let e=Math.floor(t/60);return"".concat(e,"m")}if(t<86400){let e=Math.floor(t/3600);return"".concat(e,"h")}if(t<604800){let e=Math.floor(t/86400);return"".concat(e,"d")}if(t<2592e3){let e=Math.floor(t/604800);return"".concat(e,"w")}else if(t<31536e3){let e=Math.floor(t/2592e3);return"".concat(e,"mo")}else{let e=Math.floor(t/31536e3);return"".concat(e,"y")}})(null!=(r=d.createdAtMs)?r:0)});case"repo":return d.repoUrl?(0,n.jsx)("span",{className:l?"leading-[150%] text-gray-300 font-medium truncate text-[14px]":"text-gray-500 text-[12px] truncate",children:(()=>{let e=d.repoUrl.split("/");if(e.length>=2){var t;let r=null==(t=e.pop())?void 0:t.replace(/\.git$/,""),n=e.pop();return n&&r?"".concat(n,"/").concat(r):d.repoUrl}return d.repoUrl})()}):null;case"branch":return d.branchName?(0,n.jsxs)("div",{className:"flex items-center gap-1 truncate ".concat(l?"leading-[150%] text-gray-300 font-medium text-[14px]":"text-gray-500 text-[12px]"),children:[M()&&(0,n.jsx)("span",{"data-tooltip-id":"branch-icon-tooltip","data-tooltip-place":"top","data-tooltip-content":j&&C?C.isClosed?"Pull request closed":C.isDraft?"Draft pull request":"open"===C.state?"Pull request open":null:null,children:M()}),(0,n.jsx)("span",{className:"truncate",children:d.branchName})]}):null;case"diff":return L&&(L.totalAdded>0||L.totalRemoved>0)?(0,n.jsx)("div",{className:"flex-shrink-0 ".concat(p?"text-[10px] opacity-70":"ml-1"),children:(0,n.jsx)(rx,{added:L.totalAdded,removed:L.totalRemoved})}):(0,n.jsx)(n.Fragment,{});case"prompt":return(null==u||null==(s=u.prompt)?void 0:s.text)?(0,n.jsx)("span",{className:"truncate ".concat(l?"leading-[150%] text-gray-300 font-medium text-[14px]":"text-gray-500 text-[12px]"),children:(null==u||null==(a=u.prompt)?void 0:a.text)||"No prompt"}):(0,n.jsx)("span",{className:"truncate ".concat(l?"leading-[150%] text-gray-300 font-medium text-[14px]":"text-gray-500 text-[12px]"),children:"No prompt"});default:return null}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(rf,{isOpen:k,bcId:d.bcId,onClose:()=>S(!1)}),(0,n.jsxs)("div",{className:"flex relative group gap-2 ".concat(p?"rounded-lg border border-white/5 bg-gray-500/10 py-2 px-2.5 pr-4.5":"py-1.5 rounded-md px-3.5"," justify-between items-center ").concat(!x.Fr?"hover:bg-[rgba(255,255,255,0.04)]":""," transition-all duration-100 ").concat(u?"cursor-pointer":""," ").concat(x.Fr?"min-h-[60px]":"min-w-[272px]"),style:{backgroundBlendMode:"overlay"},onClick:I,onMouseDown:I,children:[p?(0,n.jsxs)("div",{className:"flex gap-1.5 min-w-0 flex-1",children:[T.some(e=>"status"===e.id&&D(e.id))&&(0,n.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:B("status",!1)}),(0,n.jsxs)("div",{className:"flex flex-col gap-0 min-w-0 flex-1",children:[F.length>0&&(0,n.jsx)("div",{className:"flex items-center gap-2 min-w-0 overflow-hidden",children:F.filter(e=>"status"!==e.id).map(e=>{let t=["repo","branch","name","prompt","model"].includes(e.id);return(0,n.jsx)("div",{className:"flex items-center gap-0 ".concat(t?"min-w-0 flex-shrink overflow-hidden flex-1":"min-w-0 flex-shrink"),children:(0,n.jsx)("div",{className:t?"truncate overflow-hidden min-w-0":"",children:B(e.id,e.id===i)})},e.id)})}),P.filter(e=>"status"!==e.id).length>0&&(0,n.jsx)("div",{className:"flex items-center text-[12px] text-gray-500 min-w-0 overflow-hidden",children:P.filter(e=>"status"!==e.id).map((e,t,r)=>{let s=["repo","branch","name","prompt","model"].includes(e.id),a="diff"===e.id||"date"===e.id;return(0,n.jsxs)("div",{className:"flex items-center gap-0 ".concat(a?"flex-shrink-0":s?"min-w-0 flex-shrink overflow-hidden":"min-w-0 flex-shrink"," ").concat(s&&!a?"max-w-full":""),children:[(0,n.jsx)("div",{className:s?"truncate overflow-hidden min-w-0":"",children:B(e.id,!1)}),r.slice(t+1).some(e=>R(e.id))&&(0,n.jsx)("span",{className:"flex-shrink-0 text-gray-600 mx-1",children:"•"})]},e.id)})})]})]}):(0,n.jsxs)("div",{className:"flex flex-col gap-0 min-w-0 flex-1 ".concat(x.Fr?"pr-2":""),children:[F.length>0&&(0,n.jsx)("div",{className:"flex items-center gap-2 min-w-0 overflow-hidden",children:F.map(e=>{let t=["repo","branch","name","prompt","model"].includes(e.id),r="status"===e.id||"diff"===e.id||"date"===e.id;return(0,n.jsx)("div",{className:"flex items-center gap-1 ".concat(r?"flex-shrink-0":t?"min-w-0 flex-shrink overflow-hidden":"min-w-0 flex-shrink"," ").concat(e.id!==i||r?t&&!r?"max-w-full":"":"flex-1"),children:(0,n.jsx)("div",{className:t?"truncate overflow-hidden min-w-0":"",children:B(e.id,e.id===i)})},e.id)})}),P.length>0&&(0,n.jsx)("div",{className:"flex items-center ".concat(p?"text-[12px]":"leading-[150%] text-[11px] "," text-gray-500 min-w-0 overflow-hidden"),children:P.map((e,t)=>{let r=["repo","branch","name","prompt","model"].includes(e.id),s="status"===e.id||"diff"===e.id||"date"===e.id;return(0,n.jsxs)("div",{className:"flex items-center gap-0 ".concat(s?"flex-shrink-0":r?"min-w-0 flex-shrink overflow-hidden":"min-w-0 flex-shrink"," ").concat(e.id!==i||s?r&&!s?"max-w-full":"":"flex-1"),children:[(0,n.jsx)("div",{className:r?"truncate overflow-hidden min-w-0":"",children:B(e.id,e.id===i)}),"status"===e.id?null:P.slice(t+1).some(e=>R(e.id))&&(0,n.jsx)("span",{className:"flex-shrink-0 text-gray-600 mx-1",children:"•"})]},e.id)})})]}),!x.Fr&&(0,n.jsxs)("div",{className:"flex items-center transition-opacity opacity-0 group-hover:opacity-100 duration-100 absolute right-2 w-fit h-full group-hover:bg-[linear-gradient(to_right,transparent_0%,#1e1f22_30px,#1e1f22_100%)] pl-4",style:{height:"calc(100% - 4px)"},children:[(0,n.jsx)(V.m_,{id:"open-pr-tooltip",noArrow:!0,style:{padding:"0px 6px",fontSize:"12px",background:"rgba(0, 0, 0, 1.0)",opacity:1,outline:"1px solid rgba(255,255,255,0.02)",fontWeight:"500"}}),j&&!f&&(0,n.jsx)("button",{className:"opacity-0 group-hover:opacity-80 py-1 px-2 hover:!opacity-100 hover:bg-white/10 rounded-md text-sm text-[rgba(204,204,204,0.80)]","data-tooltip-id":"open-pr-tooltip","data-tooltip-place":"top","data-tooltip-content":"View PR",onClick:e=>{e.stopPropagation(),h()},onMouseDown:e=>{e.stopPropagation()},children:(0,n.jsx)(nb.A,{className:"w-4 h-4"})}),!d.isOwnedByDifferentTeamMember&&!!u&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(V.m_,{id:"open-in-cursor-tooltip",noArrow:!0,style:{padding:"0px 6px",fontSize:"12px",background:"rgba(0, 0, 0, 1.0)",opacity:1,outline:"1px solid rgba(255,255,255,0.02)",fontWeight:"500"}}),(0,n.jsx)("button",{className:"opacity-0 group-hover:opacity-80 py-1 px-2 hover:!opacity-100 hover:bg-white/10 rounded-md text-sm text-[rgba(204,204,204,0.80)]","data-tooltip-id":"open-in-cursor-tooltip","data-tooltip-place":"top","data-tooltip-content":"Open in Cursor",onClick:e=>{e.stopPropagation(),(0,_.Q1)(d.bcId)},onMouseDown:e=>{e.stopPropagation()},children:(0,n.jsx)("svg",{width:"15",height:"17",viewBox:"0 0 15 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M2.20489 4.81264L7.84862 8.07105L13.6631 4.63865L2.20489 4.81264ZM8.27898 1.53014L8.25521 3.99014L12.4631 3.94585L8.27898 1.53014ZM3.3016 4.04218L7.52089 3.99786L7.54473 1.53734L3.3016 4.04218ZM8.20954 8.71066L8.14441 15.4379L14.024 5.27812L8.20954 8.71066ZM1.86659 5.47967L1.80701 11.6375L7.11009 8.50701L1.86659 5.47967ZM7.40989 15.4695L7.47105 9.14653L2.02579 12.361L7.40989 15.4695ZM13.5894 12.2478L11.5194 11.0527L9.40232 14.7196L13.5894 12.2478ZM13.9628 11.6011L14.0098 6.73917L11.8928 10.406L13.9628 11.6011ZM14.6888 12.4514L7.76665 16.5378L0.922218 12.5862L1.00002 4.54813L7.92222 0.461814L14.7667 4.41345L14.6888 12.4514Z",fill:"rgba(204,204,204,0.80)"})})})]}),!d.isArchived&&!d.isOwnedByDifferentTeamMember&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(V.m_,{id:"archive-tooltip",noArrow:!0,style:{padding:"0px 6px",fontSize:"12px",background:"rgba(0, 0, 0, 1.0)",opacity:1,outline:"1px solid rgba(255,255,255,0.02)",fontWeight:"500"}}),(0,n.jsx)(V.m_,{id:"branch-icon-tooltip",noArrow:!0,style:{padding:"0px 6px",fontSize:"12px",background:"rgba(0, 0, 0, 1.0)",opacity:1,outline:"1px solid rgba(255,255,255,0.02)",fontWeight:"500"}}),(0,n.jsx)("button",{className:"opacity-0 group-hover:opacity-80 py-1 outline-none focus:outline-none ring-0 focus:ring-0 px-2 hover:!opacity-100 hover:bg-white/10 rounded-md text-sm text-[rgba(204,204,204,0.80)]","data-tooltip-id":"archive-tooltip","data-tooltip-place":"top","data-tooltip-content":"Delete",onMouseEnter:e=>{var t;e.stopPropagation(),null==(t=E.current)||t.startAnimation()},onMouseLeave:e=>{var t;e.stopPropagation(),null==(t=E.current)||t.stopAnimation()},onClick:e=>{e.stopPropagation(),S(!0)},onMouseDown:e=>{e.stopPropagation()},children:(0,n.jsx)(rp,{ref:E,size:16})})]}),(0,n.jsx)(tO.A,{className:"w-4 h-4 text-[rgba(204,204,204,0.60)] opacity-0 ".concat(u?"group-hover:opacity-100":""," transition-opacity duration-100"),onMouseEnter:e=>{e.stopPropagation()}})]}),x.Fr&&(0,n.jsx)("div",{className:"flex items-center gap-3 transition-opacity duration-100 mt-1 mb-auto flex-shrink-0",children:(0,n.jsx)(tO.A,{className:"w-4 h-4 text-white/[0.17] flex-shrink-0"})})]})]})}function ny(e){let{title:t,composers:r,sectionPagination:s,setSectionPagination:a,flattenedComposers:l,selectedIndex:o,detailedComposers:i,prLoading:d,onOpenExistingPullRequest:u,onSelectComposer:m,viewConfig:p}=e,f=s[t]||0,h=5*f,g=r.slice(h,h+5),v=Math.ceil(r.length/5),b=f>0,w=f<v-1,y=(0,c.useCallback)(()=>{a(e=>({...e,[t]:Math.max(0,f-1)}))},[a,t,f]),j=(0,c.useCallback)(()=>{a(e=>({...e,[t]:Math.min(v-1,f+1)}))},[a,t,f,v]),C=(0,c.useCallback)(e=>{a(r=>({...r,[t]:e}))},[a,t]),N=(0,c.useCallback)(()=>{w&&j()},[w,j]),k=(0,c.useCallback)(()=>{b&&y()},[b,y]),[S,E]=(0,c.useState)(!1),L=(0,c.useRef)(null),A=(0,nv.useDrag)(e=>{let{movement:[t],direction:[r],velocity:[n],cancel:s,canceled:a}=e;if(!x.Fr||v<=1)return;let l=Math.abs(t)>50;(n>.2||l)&&(r>0&&b?k():r<0&&w&&N(),s())},{from:()=>[0,0],filterTaps:!0,bounds:{left:-100,right:100},rubberband:!0,preventScroll:!0,preventScrollAxis:"y",onDragStart:()=>E(!0),onDragEnd:()=>E(!1)});return 0===r.length?null:x.Fr&&v>1?(0,n.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,n.jsx)("div",{className:"px-3 pt-[8px] pr-[14px]",children:(0,n.jsx)("div",{className:"text-gray-600 text-[12px] leading-[150%] tabular-nums",children:t})}),(0,n.jsx)("div",{ref:L,className:"relative overflow-hidden transition-opacity duration-200 w-full ".concat(S?"opacity-80":"opacity-100"),...A(),children:(0,n.jsx)("div",{className:"flex transition-transform duration-300 ease-out",style:{transform:"translateX(-".concat(100/v*f,"%)"),width:"".concat(100*v,"%")},children:Array.from({length:v},(e,t)=>{let s=5*t,a=r.slice(s,s+5);return(0,n.jsx)("div",{className:"flex flex-col gap-1 min-h-[264px] flex-shrink-0 min-w-0",style:{width:"".concat(100/v,"%")},children:a.map(e=>{let t=l.findIndex(t=>t.bcId===e.bcId),r=i.get(e.bcId);return(0,n.jsx)("div",{className:"w-full min-w-0 ".concat(o===t?"ring-2 ring-white/10 rounded-md":""),children:(0,n.jsx)(nw,{backgroundComposer:e,prLoading:d,onOpenExistingPullRequest:u,detailedBackgroundComposer:r,onSelect:()=>{m(e)},viewConfig:p})},e.bcId)})},t)})})}),(0,n.jsx)("div",{className:"flex justify-center items-center gap-2 py-2",children:Array.from({length:v},(e,t)=>(0,n.jsx)("button",{onClick:()=>C(t),className:"w-2 h-2 rounded-full transition-all duration-200 ".concat(f===t?"bg-white/80":"bg-white/20 hover:bg-white/40"),"aria-label":"Go to page ".concat(t+1)},t))})]}):(0,n.jsxs)("div",{ref:L,className:"flex flex-col gap-0 transition-opacity duration-200 ".concat(S?"opacity-80":"opacity-100"),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between px-3 py-[7px] pr-[14px]",children:[v>1&&(0,n.jsxs)("div",{className:"text-gray-600 text-[12px] leading-[150%] tabular-nums",children:[t," • ",f+1," of ",v]}),1===v&&(0,n.jsx)("div",{className:"text-gray-600 text-[12px] leading-[150%] tabular-nums",children:t}),v>1&&(0,n.jsxs)("div",{className:"flex items-center gap-0",children:[(0,n.jsx)("button",{onClick:y,disabled:!b,className:"p-1 text-[11px] min-w-5 rounded min-h-5 w-5 h-5 flex items-center justify-center px-2 py-0.5 transition-opacity ".concat(b?"text-gray-600  hover:text-gray-400 hover:bg-gray-500/10 active:bg-gray-500/20 cursor-pointer":"text-[#30363f] cursor-default"),children:(0,n.jsx)(eX.A,{className:"w-4 h-4 min-w-4 min-h-4"})}),(0,n.jsx)("button",{onClick:j,disabled:!w,className:"p-1 text-[11px] min-w-5 rounded min-h-5 w-5 h-5 flex items-center justify-center px-2 py-0.5 transition-opacity ".concat(w?"text-gray-600 hover:text-gray-400 hover:bg-gray-500/10 active:bg-gray-500/20 cursor-pointer":"text-[#30363f] cursor-default"),children:(0,n.jsx)(nl.A,{className:"w-4 h-4 min-w-4 min-h-4"})})]})]}),(0,n.jsx)("div",{className:"flex flex-col gap-1 sm:gap-0 ".concat(v>1?"min-h-[264px]":""),children:g.map(e=>{let t=l.findIndex(t=>t.bcId===e.bcId),r=i.get(e.bcId);return(0,n.jsx)("div",{className:"".concat(o===t?"ring-2 ring-white/10 rounded-md":""),children:(0,n.jsx)(nw,{backgroundComposer:e,prLoading:d,onOpenExistingPullRequest:u,detailedBackgroundComposer:r,onSelect:()=>{m(e)},viewConfig:p})},e.bcId)})})]})}function nj(e){let{showUpgradeModal:t,setShowUpgradeModal:r,onUpgradeToPro:s,isUpgrading:a}=e;return(0,n.jsx)("div",{className:"fixed inset-0 flex items-center justify-center transition-all duration-300 ".concat(t?"opacity-100 bg-black/50 z-50 pointer-events-auto":"opacity-0 pointer-events-none z-[-1] [*]:pointer-events-none"),style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:()=>r(!1),children:(0,n.jsx)("div",{className:"bg-gradient-to-b shadow-lg border p-6 mx-4 sm:mx-0 pointer-events-auto\n            sm:rounded-lg\n            max-sm:rounded-t-xl max-sm:rounded-b-none max-sm:border-b-0 max-sm:mx-0 from-[#17191D] to-[#121315] rounded-xl w-[380px] flex flex-col gap-2 border-white/10 transition-all duration-300 ".concat(t?"scale-100 opacity-100":"scale-95 opacity-0 pointer-events-none"),style:{borderColor:"rgb(36, 38, 42)"},onClick:e=>e.stopPropagation(),children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("span",{className:"text-gray-300 text-xl font-medium",children:"Paid subscription required"}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Get access to background agent, fast models, and priority support."}),(0,n.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 mt-4",children:[(0,n.jsx)("button",{onClick:()=>r(!1),className:"w-full border border-solid border-white/10 inline-flex text-white/50 items-center hover:bg-white/5 justify-center rounded-md px-4 py-2 text-sm font-medium text-white transition-colors focus:outline-none focus:ring-none focus:ring-offset-2",children:"Cancel"}),(0,n.jsx)("button",{onClick:s,disabled:a,className:"w-full inline-flex items-center hover:bg-brand-dashboard-highlight/30 justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Processing...":"Upgrade to Pro"})]})]})})})}var nC=r(56301);function nN(e){let{showUsagePricingModal:t,setShowUsagePricingModal:r,handleHardLimitToggle:s,stripeStatus:a,limitOptions:l,selectedLimit:o,customValue:i,handleLimitSelect:c,handleCustomLimitChange:d}=e;return(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center transition-all duration-300 ".concat(t?"opacity-100 bg-black/50 pointer-events-auto":"opacity-0 pointer-events-none"),style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:()=>r(!1),children:(0,n.jsxs)("div",{className:"bg-gradient-to-b from-[#17191D] to-[#121315] rounded-xl shadow-2xl w-[380px] flex flex-col gap-2 p-6 border border-white/10 transition-all duration-300 ".concat(t?"scale-100 opacity-100":"scale-95 opacity-0"),onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("div",{className:"flex items-center justify-between mb-0",children:(0,n.jsx)(O.DZ,{variant:"subheading-2",className:"text-white",children:"Usage-based pricing required"})}),(0,n.jsx)(nC.V,{stripeStatus:a,limitOptions:l,selectedLimit:o,customValue:i,handleLimitSelect:c,handleCustomLimitChange:d,onCancel:()=>r(!1),onEnable:s})]})})}function nk(e){let{inputBoxRef:t,onFocusChange:r,onDropdownOpenChange:s,onBeforeSubmit:a,viewConfig:l,onViewConfigChange:o,filterConfig:i,onFilterConfigChange:d,showFAB:u,githubConnected:m,isGithubLoading:p,onConnectGithub:x}=e,[f,h]=(0,c.useState)(!1),[g,v]=(0,c.useState)(!1),b=(0,c.useRef)(null),w=(0,c.useCallback)(()=>{h(!0),v(!1)},[]),y=(0,c.useCallback)(()=>{v(!0),setTimeout(()=>{h(!1),v(!1)},300)},[]);(0,c.useEffect)(()=>{if(!f)return;let e=e=>{"Escape"===e.key&&y()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[f,y]),(0,c.useEffect)(()=>(f?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[f]);let j=(0,c.useCallback)(()=>{y()},[y]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed bottom-6 right-6 z-40 transition-all duration-300 ease-out ".concat(u?"opacity-100 scale-100 pointer-events-auto":"opacity-0 scale-75 pointer-events-none"),children:(0,n.jsx)("button",{onClick:w,className:"flex items-center justify-center w-14 h-14 bg-white rounded-full shadow-2xl hover:shadow-3xl transition-all duration-200 hover:scale-105 active:scale-95",style:{boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3), 0 4px 16px rgba(0, 0, 0, 0.2)"},onMouseEnter:()=>{var e;return null==(e=b.current)?void 0:e.startAnimation()},onMouseLeave:()=>{var e;return null==(e=b.current)?void 0:e.stopAnimation()},children:(0,n.jsx)(et,{ref:b,className:"text-black",size:24})})}),f&&(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 transition-opacity duration-300 ".concat(g?"opacity-0":"opacity-100"),onClick:y,children:(0,n.jsx)("div",{className:"w-full max-w-2xl bg-gradient-to-b from-[#17191D] to-[#1B1D21] rounded-[14px] border border-white/10 shadow-2xl transform transition-all ease-out duration-300 ".concat(g?"animate-out fade-out-0 zoom-out-95":"animate-in fade-in-0 zoom-in-95"),onClick:e=>e.stopPropagation(),children:(0,n.jsx)("div",{className:"p-1.5",children:(0,n.jsx)(tw,{onFocusChange:r,onDropdownOpenChange:s,onBeforeSubmit:()=>{var e;let t=null==(e=null==a?void 0:a())||e;return t&&setTimeout(j,100),t},viewConfig:l,isFloating:!0,onViewConfigChange:o,filterConfig:i,onFilterConfigChange:d,inputRef:t,githubConnected:m,isGithubLoading:p,onConnectGithub:x,hasOpenModal:!0})})})})]})}function nS(e){let{isOpen:t,onClose:r,onConnect:s}=e,[a,l]=(0,c.useState)(!1),[o,i]=(0,c.useState)(!1),d=(0,c.useRef)(null),u=(0,c.useRef)(null),m=(0,c.useCallback)(()=>{a||(i(!1),u.current=setTimeout(()=>{r(),u.current=null},150))},[a,r]),p=(0,c.useCallback)(e=>{a||(e.preventDefault(),e.stopPropagation(),m())},[a,m]),f=(0,c.useCallback)(async()=>{l(!0);try{await s(),m()}catch(e){console.error("Failed to connect GitHub:",e)}finally{l(!1)}},[s,m]);if((0,c.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&!a&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),m()),"Enter"===e.key&&t&&!a&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),f())};if(t)return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0})}},[t,a,m,f]),(0,c.useEffect)(()=>{if(t)return document.body.style.overflow="hidden",d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{i(!0),d.current=null},10),()=>{document.body.style.overflow=""};i(!1)},[t]),(0,c.useEffect)(()=>()=>{d.current&&clearTimeout(d.current),u.current&&clearTimeout(u.current)},[]),!t)return null;let h=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 transition-opacity duration-150 ease-out ".concat(o?"opacity-100":"opacity-0"),onPointerDown:p,onClick:p,onTouchStart:e=>e.preventDefault(),style:{touchAction:"manipulation",pointerEvents:"all"}}),(0,n.jsx)("div",{className:"fixed z-[9999] w-full transition-all duration-150 ease-out\n          sm:left-1/2 sm:top-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:max-w-sm\n          max-sm:left-0 max-sm:right-0 max-sm:bottom-0\n          ".concat(o?"opacity-100 sm:scale-100 max-sm:translate-y-0":"opacity-0 sm:scale-95 max-sm:translate-y-full"),children:(0,n.jsxs)("div",{className:"shadow-lg border p-6 mx-4 sm:mx-0 pointer-events-auto\n            sm:rounded-lg\n            max-sm:rounded-t-xl max-sm:rounded-b-none max-sm:border-b-0 max-sm:mx-0 ".concat(x.Fr?"pb-[96px]":""),style:{backgroundColor:"rgb(27, 29, 33)",borderColor:"rgb(36, 38, 42)"},onPointerDown:e=>e.stopPropagation(),children:[(0,n.jsx)("div",{className:"sm:hidden flex justify-center mb-2",children:(0,n.jsx)("div",{className:"w-10 h-1 bg-gray-500 rounded-full"})}),(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4 flex-col gap-2",children:[(0,n.jsx)("span",{className:"text-gray-300 text-xl font-medium",children:"Connect GitHub"}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"GitHub connection is required to use background agents. This allows us to access your repositories and create pull requests with the generated code changes."})]}),(0,n.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 ".concat(x.Fr?"flex-col-reverse":""),children:[(0,n.jsx)("button",{onClick:m,disabled:a,className:"w-full hover:text-gray-300 border border-solid border-white/10 inline-flex text-gray-500 items-center hover:bg-white/5 justify-center rounded-md px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-none focus:ring-offset-2 disabled:opacity-50 disabled:cursor-default disabled:hover:bg-transparent",children:"Cancel"}),(0,n.jsx)("button",{onClick:f,disabled:a,className:"w-full ring-0 outline-none inline-flex items-center hover:bg-brand-dashboard-highlight justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-0 disabled:opacity-50 disabled:cursor-default disabled:hover:bg-brand-dashboard-highlight",children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Connecting..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(nb.A,{className:"h-4 w-4 mr-2"}),"Connect GitHub"]})})]}),(0,n.jsx)("div",{className:"sm:hidden h-[env(safe-area-inset-bottom)]"})]})})]});return(0,ti.createPortal)(h,document.body)}function nE(e){let{title:t,composers:r,detailedComposers:s,prLoading:a,onOpenExistingPullRequest:l,onSelectComposer:o,viewConfig:i,hasMultipleColumns:d}=e,[u,m]=(0,c.useState)(6),p=(0,c.useRef)(null);if(0===r.length)return null;let x=r.slice(0,u),f=u<r.length;return(0,n.jsxs)("div",{className:"flex flex-col min-h-0",style:{maxWidth:d?"272px":"544px"},children:[(0,n.jsx)("div",{className:"flex items-start justify-between py-1 h-[36px]",children:(0,n.jsxs)("div",{className:"flex items-center justify-start gap-1 flex-1 min-w-0",children:[(0,n.jsx)("h3",{className:"text-[11px] text-gray-400 min-w-0 w-fit truncate",children:t}),(0,n.jsx)("span",{className:"text-xs text-gray-500",children:r.length})]})}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("div",{className:"space-y-1.5 flex-1",children:x.map(e=>{let t=s.get(e.bcId);return(0,n.jsx)(nw,{backgroundComposer:e,prLoading:a,isKanban:!0,onOpenExistingPullRequest:l,detailedBackgroundComposer:t,onSelect:()=>{o(e)},viewConfig:i},e.bcId)})}),f&&(0,n.jsx)("div",{className:"pt-2 pb-1 w-full",children:(0,n.jsx)("button",{onClick:()=>{m(e=>Math.min(e+6,r.length))},onMouseEnter:()=>{p.current&&p.current.startAnimation()},onMouseLeave:()=>{p.current&&p.current.stopAnimation()},className:"flex w-full justify-center p-2 items-center gap-1.5 text-gray-500 text-[12px] font-medium rounded-lg hover:bg-[#242830]/30 hover:text-gray-300 transition-colors disabled:opacity-50 disabled:cursor-default disabled:hover:bg-[#242830]",children:(0,n.jsx)(Y,{ref:p,size:14})})})]})]})}function nL(e){let{groupedSections:t,categorizedComposers:r,detailedComposers:s,prLoading:a,onOpenExistingPullRequest:l,onSelectComposer:o,viewConfig:i,onFilterConfigChange:d,isShowingArchived:u=!1,inputBoxRef:m,filterConfig:p,isLoadingDetailedDataForGrouping:x}=e,f=(0,c.useCallback)(e=>{m.current&&m.current.setPrompt(e)},[m]),h=(0,c.useMemo)(()=>{if(t&&t.length>0)return t.map(e=>({key:e.name,title:e.name,composers:e.composers}));let e=[{key:"needAttention",title:"Completed",composers:r.needAttention},{key:"inProgress",title:"In Progress",composers:r.inProgress},{key:"other",title:"Other",composers:r.other}];return u&&r.archived.length>0&&e.push({key:"archived",title:"Archived",composers:r.archived}),e},[t,r,u]);if(t&&0===t.length)return(null==p?void 0:p.rules)&&p.rules.length>0||null!==i.groupBy?(0,n.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center h-64 text-gray-500",children:[(0,n.jsx)("span",{className:"text-sm text-gray-400",children:"No agents match filter"}),(0,n.jsx)("button",{className:"text-sm text-gray-500 bg-gray-500/5 hover:bg-gray-500/10 hover:text-gray-300 transition-colors rounded-md px-2 py-1",onClick:()=>{d(L)},children:"Clear filters"})]}):x?(0,n.jsxs)("div",{className:"flex items-center justify-center h-64 text-gray-500 opacity-50",children:[(0,n.jsx)("span",{className:"text-sm make-shine",children:"Agents populating"}),(0,n.jsx)(er,{})]}):(0,n.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500 max-w-[544px] mx-auto",children:(0,n.jsx)(rH,{onChipClick:f})});let g=h.filter(e=>e.composers.length>0);return 0===g.length?(0,n.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500 max-w-[544px] mx-auto",children:(0,n.jsx)(rH,{onChipClick:f})}):(0,n.jsx)("div",{className:"w-full h-full overflow-hidden",children:(0,n.jsx)("div",{className:"h-full overflow-x-auto overflow-y-hidden",children:(0,n.jsx)("div",{className:"grid h-full gap-2.5 p-4 px-20 pt-0 min-w-max justify-center mx-auto",style:{gridTemplateColumns:1===g.length?"repeat(1, 544px)":"repeat(".concat(g.length,", 1fr)"),gridAutoFlow:"column",maxWidth:"".concat(272*g.length+(g.length-1)*10,"px")},children:g.map(e=>(0,n.jsx)(nE,{title:e.title,composers:e.composers,detailedComposers:s,prLoading:a,onOpenExistingPullRequest:l,onSelectComposer:o,viewConfig:i,hasMultipleColumns:g.length>1},e.key))})})})}let nA=e=>{let{showUpgradeModal:t,setShowUpgradeModal:r,onUpgradeToPro:s}=e;return(0,n.jsx)(tg._s.Root,{open:t,onOpenChange:e=>{e||r(!1)},children:(0,n.jsxs)(tg._s.Portal,{children:[(0,n.jsx)(tg._s.Overlay,{className:"fixed inset-0 bg-black/50 z-50"}),(0,n.jsxs)(tg._s.Content,{className:"bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col rounded-t-xl border border-white/10 h-fit max-h-[70vh] fixed bottom-0 left-0 right-0 z-50",children:[(0,n.jsx)("div",{className:"p-4 pb-0",children:(0,n.jsx)(tg._s.Handle,{className:"bg-white/20 h-1 w-12 rounded-full mx-auto mb-4"})}),(0,n.jsxs)("div",{className:"p-6 pt-0",children:[(0,n.jsx)("div",{className:"flex items-center justify-between mb-0",children:(0,n.jsx)(O.DZ,{variant:"subheading-2",className:"text-white",children:"Paid Subscription Required"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(O.o5,{className:"text-sm text-white/70",children:"Upgrade to continue"}),(0,n.jsx)(O.o5,{className:"text-xs text-white/50",children:"Get access to advanced tools, priority support, and enhanced functionality with Cursor Pro."}),(0,n.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 mt-4",children:[(0,n.jsx)("button",{onClick:()=>r(!1),className:"w-full border border-solid border-white/10 inline-flex text-white/50 items-center hover:bg-white/5 justify-center rounded-md px-4 py-2 text-sm font-medium text-white transition-colors focus:outline-none focus:ring-none focus:ring-offset-2",children:"Cancel"}),(0,n.jsx)("button",{onClick:s,className:"w-full inline-flex items-center hover:bg-brand-dashboard-highlight/30 justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2",children:"Upgrade to Pro"})]})]})]})]})]})})},nM=e=>{let{showUsagePricingModal:t,setShowUsagePricingModal:r,handleHardLimitToggle:s,stripeStatus:a,limitOptions:l,selectedLimit:o,customValue:i,handleLimitSelect:c,handleCustomLimitChange:d}=e;return(0,n.jsx)(tg._s.Root,{open:t,onOpenChange:e=>{e||r(!1)},children:(0,n.jsxs)(tg._s.Portal,{children:[(0,n.jsx)(tg._s.Overlay,{className:"fixed inset-0 bg-black/50 z-50"}),(0,n.jsxs)(tg._s.Content,{className:"bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col rounded-t-xl border border-white/10 h-fit max-h-[70vh] fixed bottom-0 left-0 right-0 z-50",children:[(0,n.jsx)("div",{className:"p-4 pb-0",children:(0,n.jsx)(tg._s.Handle,{className:"bg-white/20 h-1 w-12 rounded-full mx-auto mb-4"})}),(0,n.jsxs)("div",{className:"p-6 pt-0",children:[(0,n.jsx)("div",{className:"flex items-center justify-between mb-0",children:(0,n.jsx)(O.DZ,{variant:"subheading-2",className:"text-white",children:"Usage-based pricing required"})}),(0,n.jsx)(nC.V,{stripeStatus:a,limitOptions:l,selectedLimit:o,customValue:i,handleLimitSelect:c,handleCustomLimitChange:d,onCancel:()=>r(!1),onEnable:s})]})]})]})})};var n_=r(81798);let nI=e=>{let{isLoadingPrivacyMode:t,isEnforcedByTeam:r,onCancel:s}=e,a=(0,n_.useRouter)(),l=(0,c.useCallback)(()=>{a.push("/dashboard?tab=settings")},[a]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex items-center justify-between mb-0",children:(0,n.jsx)(O.DZ,{variant:"subheading-2",className:"text-white",children:"Privacy Mode change required"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)(O.o5,{className:"text-sm text-white/70",children:["Background agents require code storage to function properly. Your current privacy mode prevents this.",r?"Your privacy mode is enforced by your team admin. Please contact them to change privacy settings.":"To use background agents, please update your privacy mode in settings to allow code storage."]}),!r&&(0,n.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 mt-4",children:[(0,n.jsx)("button",{onClick:s,className:"w-full border border-solid border-white/10 inline-flex text-white/50 items-center hover:bg-white/5 justify-center rounded-md px-4 py-2 text-sm font-medium text-white transition-colors focus:outline-none focus:ring-none focus:ring-offset-2",children:"Cancel"}),(0,n.jsx)("button",{onClick:l,disabled:t,className:"w-full inline-flex items-center hover:bg-brand-dashboard-highlight/30 justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Loading...":"Open settings"})]})]})]})};function nD(e){let{showPrivacyModeModal:t,setShowPrivacyModeModal:r,isLoadingPrivacyMode:s,isEnforcedByTeam:a,isMobile:l,hoursRemainingInGracePeriod:o=0}=e,i=()=>r(!1);if(o>0){let e=(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"text-left",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-white mb-2",children:["Privacy mode change ",l?"on desktop":"in Cursor"," required"]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)("p",{className:"text-sm text-brand-gray-400",children:["Background agents require code storage to function properly.\xa0",a?"Please contact your team admin to change privacy settings.":"Please update your privacy mode in settings to allow code storage."]}),(0,n.jsx)("p",{className:"text-sm text-brand-gray-400",children:l?"Please open Cursor on desktop to configure your privacy settings.":"Configure your privacy settings in the Cursor app"})]})]}),(0,n.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,n.jsx)("button",{onClick:i,className:"px-4 w-full h-fit py-2 rounded-lg border border-white/20 text-white hover:bg-white/5 transition-colors",children:"Close"}),!l&&(0,n.jsx)("button",{onClick:()=>{let e="localhost"===window.location.hostname;window.location.href="".concat(e?"cursor-dev":"cursor","://anysphere.cursor-deeplink/settings")},className:"w-full h-fit inline-flex items-center hover:bg-brand-dashboard-highlight/30 justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-brand-dashboard-highlight focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Open settings"})]})]});return l?(0,n.jsx)(tg._s.Root,{open:t,onOpenChange:e=>{e||r(!1)},children:(0,n.jsxs)(tg._s.Portal,{children:[(0,n.jsx)(tg._s.Overlay,{className:"fixed inset-0 bg-black/50 z-50"}),(0,n.jsxs)(tg._s.Content,{className:"ring-0 outline-none bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col rounded-t-xl border border-white/10 h-auto mt-24 fixed bottom-0 left-0 right-0 z-50",children:[(0,n.jsx)("div",{className:"p-4 pb-0",children:(0,n.jsx)(tg._s.Handle,{className:"bg-white/20 h-1 w-12 rounded-full mx-auto mb-4"})}),(0,n.jsx)("div",{className:"p-6",children:e})]})]})}):(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center transition-all duration-300 ".concat(t?"opacity-100 bg-black/50 pointer-events-auto":"opacity-0 pointer-events-none"),style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:i,children:(0,n.jsx)("div",{className:"bg-gradient-to-b from-[#17191D] to-[#121315] rounded-xl shadow-2xl w-[380px] flex flex-col gap-2 p-6 border border-white/10 transition-all duration-300 ".concat(t?"scale-100 opacity-100":"scale-95 opacity-0"),onClick:e=>e.stopPropagation(),children:e})})}return l?(0,n.jsx)(tg._s.Root,{open:t,onOpenChange:e=>{e||r(!1)},children:(0,n.jsxs)(tg._s.Portal,{children:[(0,n.jsx)(tg._s.Overlay,{className:"fixed inset-0 bg-black/50 z-50"}),(0,n.jsxs)(tg._s.Content,{className:"ring-0 outline-none bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col rounded-t-xl border border-white/10 h-auto mt-24 fixed bottom-0 left-0 right-0 z-50",children:[(0,n.jsx)("div",{className:"p-4 pb-0",children:(0,n.jsx)(tg._s.Handle,{className:"bg-white/20 h-1 w-12 rounded-full mx-auto mb-4"})}),(0,n.jsx)("div",{className:"p-6",children:(0,n.jsx)(nI,{isLoadingPrivacyMode:s,isEnforcedByTeam:a,onCancel:i})})]})]})}):(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center transition-all duration-300 ".concat(t?"opacity-100 bg-black/50 pointer-events-auto":"opacity-0 pointer-events-none"),style:{boxShadow:"0px 36px 100px 0px rgba(0, 0, 0, 0.40), 0px 0px 3px 0px rgba(0, 0, 0, 0.25), 0px 15px 27.9px 0px rgba(0, 0, 0, 0.25), 0px 23px 31.8px 6px rgba(0, 0, 0, 0.22), 0px 0px 3px 0px rgba(255, 255, 255, 0.10) inset"},onClick:i,children:(0,n.jsx)("div",{className:"bg-gradient-to-b from-[#17191D] to-[#121315] rounded-xl shadow-2xl w-[380px] flex flex-col gap-2 p-6 border border-white/10 transition-all duration-300 ".concat(t?"scale-100 opacity-100":"scale-95 opacity-0"),onClick:e=>e.stopPropagation(),children:(0,n.jsx)(nI,{isLoadingPrivacyMode:s,isEnforcedByTeam:a,onCancel:i})})})}let nR="conversation-sidebar-collapsed";function nT(e,t,r,n){var s,a,l,o;let i="asc"===r.sortDirection?1:-1;if(!r.sortBy)return(0,_.JJ)(e,t)*i;switch(r.sortBy){case"name":{let r=e.name||"",n=t.name||"";return r.localeCompare(n)*i}case"status":{let r=null!=(s=e.status)?s:m.R6.UNSPECIFIED;return(r-(null!=(a=t.status)?a:m.R6.UNSPECIFIED))*i}case"model":{let r=n.get(e.bcId),s=n.get(t.bcId),a=(null==r||null==(l=r.modelDetails)?void 0:l.modelName)||"",c=(null==s||null==(o=s.modelDetails)?void 0:o.modelName)||"";return a.localeCompare(c)*i}case"date":{let r=(0,_.IB)(e);return(r-(0,_.IB)(t))*i}case"repo":{let r=e.repoUrl||"",n=t.repoUrl||"";return r.localeCompare(n)*i}case"branch":{let r=e.branchName||"",n=t.branchName||"";return r.localeCompare(n)*i}default:return(0,_.JJ)(e,t)}}function nF(e){var t,r,s,a,l,o;let{showFAB:i,deeplinkData:w,onViewModeChange:y}=e,{user:j,error:C,isLoading:N}=(0,u.Jd)(),{backgroundComposers:k,detailedComposers:D,detailedDiffs:R,getConversationForAgent:T,isLoading:F,startConversationFetching:B,stopConversationFetching:O,fetchDetailedComposer:z,refetchBackgroundComposers:U,showUsagePricingModal:W,setShowUsagePricingModal:H,showUpgradePaidModal:q,setShowUpgradePaidModal:J,showPrivacyModeModal:G,setShowPrivacyModeModal:Z,updateComposerPrUrl:V,selectedComposerId:K,setSelectedComposerId:$}=(0,v._F)(),X=(0,c.useRef)(null),{githubConnected:Y,isLoading:Q,installations:ee,loadingMoreRepos:et,error:er}=(0,f.d)(),{stripeStatus:en,updateHardLimit:es,createCheckoutUrl:ea}=(0,b.M)();(0,c.useEffect)(()=>{er&&d.oR.error("Unable to connect to GitHub. Please try again later.")},[er]);let{userPrivacyMode:el,isLoadingPrivacyMode:eo,isEnforcedByTeam:ei,hoursRemainingInGracePeriod:ec}=(0,g.W)(),ed=(0,h.t)(),{isPWAInstalled:eu,canInstall:em,isIOS:ep,isAndroid:ex,showInstallPrompt:ef,promptInstall:eh,dismissPrompt:eg}=(0,M.H)(),ev=(0,c.useRef)(null),{filterConfig:eb,updateFilterConfig:ew}=function(){let[e,t]=(0,c.useState)(()=>{{let e=localStorage.getItem(A);if(e)try{let t=JSON.parse(e);if(void 0!==t.status||void 0!==t.source||!t.rules)return console.log("Old filter config detected, resetting to default"),L;if(!Array.isArray(t.rules))return console.log("Invalid rules array, resetting to default"),L;return t.rules&&t.rules.forEach(e=>{if("createdAt"===e.property&&e.value){if("between"===e.operator&&"object"==typeof e.value){if(e.value.from&&"string"==typeof e.value.from){let t=e.value.from.includes("T")?e.value.from.split("T")[0]:e.value.from;e.value.from=E(t)}if(e.value.to&&"string"==typeof e.value.to){let t=e.value.to.includes("T")?e.value.to.split("T")[0]:e.value.to;e.value.to=E(t)}}else if("string"==typeof e.value){let t=e.value.includes("T")?e.value.split("T")[0]:e.value;e.value=E(t)}}}),t}catch(e){console.error("Failed to parse stored filter config:",e)}}return L});return(0,c.useEffect)(()=>{localStorage.setItem(A,JSON.stringify(e))},[e]),{filterConfig:e,updateFilterConfig:(0,c.useCallback)(e=>{t(e)},[]),resetFilterConfig:(0,c.useCallback)(()=>{t(L)},[])}}(),[ey,ej]=(0,c.useState)(()=>{{let e=localStorage.getItem(nR);return!!e&&"true"===e}}),eC=(0,c.useMemo)(()=>["$".concat(50),"$".concat(100),"$".concat(150)],[]),[eN,ek]=(0,c.useState)(eC[0]),[eS,eE]=(0,c.useState)(null),[eL,eA]=(0,c.useState)(null),[eM,e_]=(0,c.useState)(null);(0,c.useEffect)(()=>{{let e=window.sessionStorage.getItem("pendingChipText");e&&eA(e)}},[]),(0,c.useEffect)(()=>{eL?window.sessionStorage.setItem("pendingChipText",eL):window.sessionStorage.removeItem("pendingChipText")},[eL]),(0,c.useEffect)(()=>{localStorage.setItem(nR,ey.toString())},[ey]),(0,c.useEffect)(()=>{{let e=window.sessionStorage.getItem("pendingPromptText");e&&e_(e)}},[]);let{viewConfig:eI,updateViewConfig:eD}=S();(0,c.useEffect)(()=>{y&&eI.viewMode&&y(eI.viewMode)},[eI.viewMode,y]),(0,c.useEffect)(()=>{var e;Y&&eM&&(null==(e=X.current)?void 0:e.setPrompt)&&(console.log("[GitHub Connection] Restoring prompt text:",eM),X.current.setPrompt(eM),e_(null),window.sessionStorage.removeItem("pendingPromptText")),Y&&(window._bypassBeforeUnload=!1,console.log("[GitHub Connection] Reset bypass flag after successful connection"))},[Y,eM]);let[eR,eT]=(0,c.useState)({promptSet:!1,branchSet:!1,repoSet:!1,allProcessed:!1}),eF=(0,c.useRef)(null);(0,c.useEffect)(()=>{if(!w||!X.current)return;let{bugReport:e,repoOwner:t,repoName:r,branch:n}=w,s={...eR},a=!1;if(!s.promptSet&&X.current.setPrompt){let t=e.locations.map(e=>"".concat(e.file,":").concat(e.startLine,"-").concat(e.endLine)).join(", "),r="Fix this bug:\n\n".concat(e.description,"\n\nAffected files: ").concat(t);console.log("[BugBot] Setting prompt from deeplink data:",{promptLength:r.length,bugId:e.id,fileLocations:t}),X.current.setPrompt(r),s.promptSet=!0,a=!0}!s.repoSet&&t&&r&&Y&&X.current.setRepo&&(ee.some(e=>e.repos.some(e=>e.owner===t&&e.name===r))?(console.log("[BugBot] Setting repo from deeplink data:",{repoOwner:t,repoName:r}),X.current.setRepo(t,r),s.repoSet=!0,a=!0,eF.current&&(clearTimeout(eF.current),eF.current=null)):eF.current||(eF.current=window.setTimeout(()=>{eT(e=>e.repoSet?e:(d.oR.error('Repository "'.concat(t,"/").concat(r,'" not found in your GitHub installations')),{...e,repoSet:!0})),eF.current=null},5e3))),!s.branchSet&&n&&X.current.setBranch&&(!(t&&r)||s.repoSet)&&(console.log("[BugBot] Setting branch from deeplink data:",{branch:n}),X.current.setBranch(n),s.branchSet=!0,a=!0);let l=!!n,o=!!(t&&r);if(s.promptSet&&(!l||s.branchSet)&&(!o||s.repoSet)&&!s.allProcessed){s.allProcessed=!0,a=!0;{let e=new URL(window.location.href);e.searchParams.has("data")&&(e.searchParams.delete("data"),window.history.replaceState({},"",e.toString()),console.log("[BugBot] Cleared URL param after all deeplink data processed"))}}a&&eT(s)},[w,Q,et.size,ee,Y,eR.promptSet,eR.repoSet,eR.branchSet,eR.allProcessed,eR]),(0,c.useEffect)(()=>()=>{eF.current&&(clearTimeout(eF.current),eF.current=null)},[]),(0,c.useEffect)(()=>{ev.current&&ev.current.play()},[]);let eP=(0,c.useMemo)(()=>K?D.get(K):null,[K,D]),eB=(0,c.useRef)(null);(0,c.useEffect)(()=>{var e,t;if("undefined"==typeof document)return;null===eB.current&&(eB.current=document.title);let r=null==eP||null==(t=eP.composer)||null==(e=t.name)?void 0:e.trim();if(r){let e=(eB.current||"Agents").replace(/^[^–—-]+\s+[–—-]\s+/,"");document.title="".concat(r," – ").concat(e)}else eB.current&&(document.title=eB.current);return()=>{eB.current&&(document.title=eB.current)}},[null==eP||null==(t=eP.composer)?void 0:t.name]);let[eO,eU]=(0,c.useState)(!1),[eW,eH]=(0,c.useState)(!1),eq=(0,c.useMemo)(()=>!!K&&!F&&!eO&&!k.some(e=>e.bcId===K),[K,F,k,eO]);(0,c.useEffect)(()=>{let e=setTimeout(()=>{eH(eq)},100);return()=>clearTimeout(e)},[eq]);let[eJ,eG]=(0,c.useState)(null),[eZ,eV]=(0,c.useState)(!1),[eK,e$]=(0,c.useState)(!1),[eX,eY]=(0,c.useState)(!1),eQ=(null==eP||null==(r=eP.composer)?void 0:r.prUrl)||void 0,[e0,e1]=(0,c.useState)(!1),[e2,e5]=(0,c.useState)(!1),[e3,e4]=(0,c.useState)(!1),[e8,e6]=(0,c.useState)(!1),[e7,e9]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(e7){let e=setTimeout(()=>e9(!1),2e3);return()=>clearTimeout(e)}},[e7]);let te=(0,c.useCallback)(()=>{e6(!1),setTimeout(()=>e4(!1),200)},[]),tt=(0,c.useCallback)(()=>{e4(!0),setTimeout(()=>e6(!0),10)},[]);(0,c.useEffect)(()=>{if(!e3)return;let e=e=>{"Escape"!==e.key||eK||te()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[e3,te,eK]),(0,c.useEffect)(()=>(e3?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e3]);let tr=x.Fr&&!!K&&e0;!function(e){let{isAnyDrawerOpen:t,defaultColor:r="#17191d",drawerOpenColor:n="#0b0c0e"}=e;(0,c.useEffect)(()=>{let e=document.querySelector('meta[name="theme-color"]');e||((e=document.createElement("meta")).name="theme-color",document.head.appendChild(e));let s=t?n:r;return e.content=s,()=>{e&&(e.content=r)}},[t,r,n])}({isAnyDrawerOpen:x.Fr&&eK||tr});let[tn,ts]=(0,c.useState)({Completed:0,"In Progress":0,Other:0,Archived:0}),ta=(0,c.useMemo)(()=>el===p.YTt.NO_STORAGE||el===p.YTt.UNSPECIFIED,[el]),tl=(0,c.useMemo)(()=>("prompt"===eI.groupBy||"model"===eI.groupBy)&&k.some(e=>!e.isArchived&&!e.isOwnedByDifferentTeamMember&&!D.has(e.bcId)),[eI.groupBy,k,D]),to=(0,c.useCallback)(()=>!ta||(Z(!0),!1),[ta,Z]),ti=(0,c.useCallback)(()=>{e5(!0)},[]),tc=(0,c.useCallback)(async()=>{try{var e;if(null==(e=X.current)?void 0:e.getPrompt){let e=X.current.getPrompt();e&&e.trim()&&(window.sessionStorage.setItem("pendingPromptText",e),console.log("[GitHub Connection] Saving prompt text:",e))}}catch(e){console.error("Failed to save prompt text to sessionStorage",e)}try{if(null==j?void 0:j.sub){let e={sub:j.sub,timestamp:Date.now(),source:"BACKGROUND_AGENT_WEB"};window.sessionStorage.setItem("githubLinkSession",JSON.stringify(e))}}catch(e){console.error("Failed to write githubLinkSession to sessionStorage",e)}window.open("/api/auth/connect-github?from=website&source=BACKGROUND_AGENT_WEB","_blank","noopener,noreferrer")},[null==j?void 0:j.sub]),td=(0,c.useCallback)(async()=>{var e,t,r,n;if(eP){eY(!0);try{let r=await (0,_.jC)(eP);r.error?(d.oR.error(r.error),(null==(e=eP.composer)?void 0:e.repoUrl)&&(null==(t=eP.composer)?void 0:t.branchName)&&(I(eP.composer.repoUrl,"main",eP.composer.branchName)||console.error("Failed to open GitHub compare view"))):r.prUrl&&eP.composer&&(V(eP.composer.bcId,r.prUrl),await U())}catch(e){console.error("Failed to create PR:",e),d.oR.error("Failed to create PR"),(null==(r=eP.composer)?void 0:r.repoUrl)&&(null==(n=eP.composer)?void 0:n.branchName)&&(I(eP.composer.repoUrl,"main",eP.composer.branchName)||console.error("Failed to open GitHub compare view"))}finally{eY(!1)}}},[eP,U,V]),tu=(0,c.useCallback)(()=>{eQ&&(0,_.g3)(eQ)},[eQ]);(0,c.useEffect)(()=>{!K||F||D.get(K)||(console.log("Fetching detailed composer for selected composer id",K),eU(!0),z(K).catch(e=>{console.error("Failed to fetch detailed composer:",e)}).finally(()=>{eU(!1)}))},[K,F,D,z]),(0,c.useEffect)(()=>{K&&!e0?e1(!0):!K&&e0&&e1(!1)},[K,e0]),(0,c.useEffect)(()=>{var e,t;eQ&&(null==eP||null==(e=eP.composer)?void 0:e.bcId)?(0,_.s9)(eP.composer.bcId,eQ):(null==eP||null==(t=eP.composer)?void 0:t.bcId)&&(0,_.xh)(eP.composer.bcId)},[eQ,null==eP||null==(s=eP.composer)?void 0:s.bcId]);let tm=(0,c.useCallback)(e=>{if(!e)return"";let t=e.trim();return(t=(t=(t=t.replace(/^https?:\/\//,"")).replace(/\.git$/,"")).replace(/\/+$/,"")).toLowerCase()},[]),tp=(0,c.useCallback)((e,t)=>{var r,n,s;let a,{property:l,operator:o,value:i}=t;switch(l){case"status":a=null!=(r=e.status)?r:m.R6.CREATING;break;case"model":{let t=D.get(e.bcId);if(!t)return!0;a=(null==(n=t.modelDetails)?void 0:n.modelName)||null;break}case"prompt":{let t=D.get(e.bcId);if(!t)return!0;a=(null==(s=t.prompt)?void 0:s.text)||null;break}case"branchName":a=e.branchName||null;break;case"repoUrl":a=e.repoUrl?tm(e.repoUrl):null;break;case"createdAt":a=new Date(e.createdAtMs||0);break;case"merge":{let t=e.prUrl;if(t){let e=(0,_.Le)(t);a=(null==e?void 0:e.isMerged)||!1}else a=!1;break}case"isArchived":a=e.isArchived||!1;break;default:a=null}switch(o){case"is":if("repoUrl"===l&&"string"==typeof i)return a===tm(i);return a===i;case"is_not":if("repoUrl"===l&&"string"==typeof i)return a!==tm(i);return a!==i;case"contains":if("string"==typeof a&&"string"==typeof i){if("repoUrl"===l)return a.includes(tm(i));return a.toLowerCase().includes(i.toLowerCase())}return!1;case"does_not_contain":if("string"==typeof a&&"string"==typeof i){if("repoUrl"===l)return!a.includes(tm(i));return!a.toLowerCase().includes(i.toLowerCase())}return!0;case"starts_with":if("string"==typeof a&&"string"==typeof i){if("repoUrl"===l)return a.startsWith(tm(i));return a.toLowerCase().startsWith(i.toLowerCase())}return!1;case"ends_with":if("string"==typeof a&&"string"==typeof i){if("repoUrl"===l)return a.endsWith(tm(i));return a.toLowerCase().endsWith(i.toLowerCase())}return!1;case"is_empty":return!a||""===a||Array.isArray(a)&&0===a.length;case"is_not_empty":return a&&""!==a&&(!Array.isArray(a)||a.length>0);case"any_of":if(Array.isArray(i)){if("repoUrl"===l)return i.map(e=>tm(e)).includes(a);return i.includes(a)}return!1;case"none_of":if(Array.isArray(i)){if("repoUrl"===l)return!i.map(e=>tm(e)).includes(a);return!i.includes(a)}return!0;case"before":if(a instanceof Date&&i instanceof Date)return a<i;return!1;case"after":if(a instanceof Date&&i instanceof Date)return a>i;return!1;case"between":if(a instanceof Date&&"object"==typeof i&&i.from&&i.to){let e=new Date(i.from),t=new Date(i.to);return e.setHours(0,0,0,0),t.setHours(23,59,59,999),a>=e&&a<=t}return!1;default:return!0}},[D,tm]),tx=(0,c.useCallback)(e=>{if(!eb.rules||!Array.isArray(eb.rules))return!0;for(let t of eb.rules)if(!tp(e,t))return!1;return!0},[eb,tp]),tf=(0,c.useMemo)(()=>{let e=[],t=[],r=[],n=[];for(let a of k){var s;if(a.isOwnedByDifferentTeamMember||!tx(a))continue;if(a.isArchived){n.push(a);continue}let l=null!=(s=a.status)?s:m.R6.CREATING;l===m.R6.CREATING||l===m.R6.RUNNING?t.push(a):l===m.R6.FINISHED||l===m.R6.UNSPECIFIED?e.push(a):r.push(a)}return{needAttention:e,inProgress:t,other:r,archived:n}},[k,tx]),th=(0,c.useMemo)(()=>{if(!eI.groupBy)return null;let e=new Map,t=k.filter(e=>!e.isArchived&&!e.isOwnedByDifferentTeamMember&&tx(e)).filter(e=>"prompt"!==eI.groupBy&&"model"!==eI.groupBy||void 0!==D.get(e.bcId));return("prompt"===eI.groupBy||"model"===eI.groupBy)&&0===t.length?null:(t.forEach(t=>{var r,n,s,a;let l="Other";switch(eI.groupBy){case"status":l=(e=>{let t=null!=e?e:m.R6.CREATING;return t===m.R6.CREATING||t===m.R6.RUNNING?"In Progress":t===m.R6.FINISHED||t===m.R6.UNSPECIFIED?"Completed":t===m.R6.ERROR?"Error":t===m.R6.EXPIRED?"Expired":"Other"})(t.status);break;case"branch":l=t.branchName||"No Branch";break;case"repo":if(t.repoUrl){let e=t.repoUrl.split("/");if(e.length>=2){let n=null==(r=e.pop())?void 0:r.replace(/\.git$/,""),s=e.pop();l=s&&n?"".concat(s,"/").concat(n):t.repoUrl}else l=t.repoUrl}else l="No Repository";break;case"model":{let e=D.get(t.bcId);l=(null==e||null==(n=e.modelDetails)?void 0:n.modelName)||"Unknown Model";break}case"date":{let e=new Date(t.createdAtMs||0),r=new Date,n=new Date(r);n.setDate(n.getDate()-1),l=e.toDateString()===r.toDateString()?"Today":e.toDateString()===n.toDateString()?"Yesterday":e>new Date(r.getTime()-6048e5)?"This Week":e>new Date(r.getTime()-2592e6)?"This Month":"Older";break}case"merge":{let e=null!=(s=t.status)?s:m.R6.CREATING;if(e===m.R6.CREATING||e===m.R6.RUNNING){l="In Progress";break}let r=t.prUrl;if(r){let e=(0,_.Le)(r);e?e.isMerged?l="Merged":e.isClosed?l="Closed":e.isDraft?l="Ready to open":(e.state,l="Open"):l="Open"}else l="Ready to open";break}case"prompt":{let e=D.get(t.bcId),r=null==e||null==(a=e.prompt)?void 0:a.text;l=r||"No Prompt"}}e.has(l)||e.set(l,[]),e.get(l).push(t)}),Array.from(e.entries()).map(e=>{let[t,r]=e;return{name:t,composers:r.sort((e,t)=>nT(e,t,eI,D))}}).sort((e,t)=>{let r="asc"===eI.sortDirection?-1:1;if(eI.groupBy===eI.sortBy){if("date"===eI.groupBy){let n=["Today","Yesterday","This Week","This Month","Older"],s=n.indexOf(e.name),a=n.indexOf(t.name);if(-1!==s&&-1!==a)return(s-a)*r}return e.name.localeCompare(t.name)*r}if("prompt"===eI.groupBy){let r="No Prompt"===e.name,n="No Prompt"===t.name;return r&&!n?1:!r&&n?-1:e.name.localeCompare(t.name)}if("model"===eI.groupBy){let r="Unknown Model"===e.name,n="Unknown Model"===t.name;return r&&!n?1:!r&&n?-1:e.name.localeCompare(t.name)}if("merge"===eI.groupBy){let r=["In Progress","Open","Ready to open","Merged","Closed"],n=r.indexOf(e.name),s=r.indexOf(t.name);if(-1!==n&&-1!==s)return n-s;if(-1!==n&&-1===s)return -1;if(-1===n&&-1!==s)return 1}return e.name.localeCompare(t.name)}))},[k,eI,D,tx]),tg=(0,c.useMemo)(()=>{if(th)return th;if("prompt"===eI.groupBy||"model"===eI.groupBy)return[];let e=new Map;return k.filter(e=>!e.isArchived&&!e.isOwnedByDifferentTeamMember&&tx(e)).forEach(t=>{let r=new Date(t.createdAtMs||0),n=new Date,s=new Date(n);s.setDate(s.getDate()-1);let a="Older";r.toDateString()===n.toDateString()?a="Today":r.toDateString()===s.toDateString()?a="Yesterday":r>new Date(n.getTime()-6048e5)?a="This Week":r>new Date(n.getTime()-2592e6)&&(a="This Month"),e.has(a)||e.set(a,[]),e.get(a).push(t)}),Array.from(e.entries()).map(e=>{let[t,r]=e;return{name:t,composers:r.sort((e,t)=>nT(e,t,eI,D))}}).sort((e,t)=>{let r=["Today","Yesterday","This Week","This Month","Older"],n=r.indexOf(e.name),s=r.indexOf(t.name);return -1!==n&&-1!==s?n-s:e.name.localeCompare(t.name)})},[k,th,eI,D,tx]),tv=(0,c.useMemo)(()=>tg.filter(e=>e.composers.length>0).map((e,t)=>({...e,index:t})),[tg]),tb=(0,c.useCallback)(()=>{if(!eJ||0===tv.length)return 0;for(let e=0;e<tv.length;e++)if(tv[e].composers.some(e=>e.bcId===eJ))return e;return 0},[eJ,tv]),ty=(0,c.useCallback)(()=>{if(0===tv.length)return;let e=(tb()+1)%tv.length,t=tv[e];t&&t.composers.length>0&&(ts(e=>({...e,[t.name]:0})),eG(t.composers[0].bcId))},[tv,tb]),tj=(0,c.useCallback)(()=>{if(0===tv.length)return;let e=tb(),t=0===e?tv.length-1:e-1,r=tv[t];r&&r.composers.length>0&&(ts(e=>({...e,[r.name]:0})),eG(r.composers[0].bcId))},[tv,tb]),tC=(0,c.useCallback)(()=>tv.length>0?tv[0]:null,[tv]),tN=(0,c.useCallback)(e=>{for(let t of tv)if(t.composers.some(t=>t.bcId===e))return t;return null},[tv]),tk=(0,c.useCallback)(e=>{let t=tv.find(t=>t.name===e);if(!t)return;let r=tn[e]||0;r<Math.ceil(t.composers.length/5)-1&&ts(t=>({...t,[e]:r+1}))},[tv,tn]),tS=(0,c.useCallback)(e=>{let t=tn[e]||0;t>0&&ts(r=>({...r,[e]:t-1}))},[tn]),tE=(0,c.useMemo)(()=>tg.flatMap(e=>e.composers),[tg]),tL=(0,c.useMemo)(()=>eJ?tE.findIndex(e=>e.bcId===eJ):-1,[eJ,tE]),tA=(0,c.useCallback)(()=>{$(null)},[$]),tM=(0,c.useCallback)(()=>{ej(e=>!e)},[]),t_=(0,c.useCallback)(async e=>{$(e.bcId);try{await fetch("/api/auth/notifyBackgroundComposerShown",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e.bcId})})}catch(e){console.error("Failed to notify background composer shown:",e)}if(!D.get(e.bcId))try{var t,r,n;let s=await fetch("/api/background-composer/get-detailed-composer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e.bcId,n:1,includeDiff:!0,includeTeamWide:!0})}),a=new m.VF().fromJson(await s.json(),{ignoreUnknownFields:!0});(null==(n=a.composers)||null==(r=n[0])||null==(t=r.composer)?void 0:t.bcId)&&$(a.composers[0].composer.bcId)}catch(e){console.error("Failed to fetch detailed composer:",e)}},[D,$]),tI=(0,c.useCallback)(e=>{let t=null,r=-1,n=-1;for(let s=0;s<tg.length;s++){let a=tg[s],l=a.composers.findIndex(t=>t.bcId===e);if(-1!==l){t=a,r=s,n=l;break}}if(!t)return null;if(n<t.composers.length-1){let e=t.composers[n+1],r=Math.floor((n+1)/5);if(t){let e=t.name;r!==(tn[e]||0)&&ts(t=>({...t,[e]:r}))}return e}for(let e=r+1;e<tg.length;e++){let t=tg[e];if(t.composers.length>0)return ts(e=>({...e,[t.name]:0})),t.composers[0]}return null},[tg,tn]),tD=(0,c.useCallback)(e=>{let t=null,r=-1,n=-1;for(let s=0;s<tg.length;s++){let a=tg[s],l=a.composers.findIndex(t=>t.bcId===e);if(-1!==l){t=a,r=s,n=l;break}}if(!t)return null;if(n>0){let e=t.composers[n-1],r=Math.floor((n-1)/5);if(t){let e=t.name;r!==(tn[e]||0)&&ts(t=>({...t,[e]:r}))}return e}for(let e=r-1;e>=0;e--){let t=tg[e];if(t.composers.length>0){let e=t.composers[t.composers.length-1],r=Math.floor((t.composers.length-1)/5);return ts(e=>({...e,[t.name]:r})),e}}return null},[tg,tn]);!function(e){let{selectedComposerId:t,isInputFocused:r,isAnyDropdownOpen:n,highlightedComposerId:s,setHighlightedComposerId:a,selectedIndex:l,flattenedComposers:o,findNextComposer:i,findPrevComposer:c,handleSelectComposer:d,handleCloseModal:u,navigateToNextSection:m,navigateToPreviousSection:p,getFirstRenderedSection:x,getSectionContainingComposer:f,navigateToNextPageInSection:h,navigateToPreviousPageInSection:g,sectionPagination:v,prLoading:b,openExistingPullRequest:w}=e,y=r||n||t||0===o.length;(0,ez.vC)("esc",()=>{!n&&(document.querySelectorAll('[data-menu-open="true"], .menu-open, [aria-expanded="true"]').length>0||(t?u():a(null)))},{enabled:!r,preventDefault:!n},[t,u,a,r,n]),(0,ez.vC)("down",()=>{if(!s){o.length>0&&a(o[0].bcId);return}let e=i(s);e&&a(e.bcId)},{enabled:!y,preventDefault:!0},[s,o,i,a,y]),(0,ez.vC)("up",()=>{if(!s){o.length>0&&a(o[o.length-1].bcId);return}let e=c(s);e&&a(e.bcId)},{enabled:!y,preventDefault:!0},[s,o,c,a,y]),(0,ez.vC)("enter",()=>{l>=0&&l<o.length&&d(o[l])},{enabled:!y,preventDefault:!0},[l,o,d,y]),(0,ez.vC)("p, shift+p",()=>{l>=0&&l<o.length&&o[l].prUrl&&!b&&w()},{enabled:!y,preventDefault:!0},[l,o,b,w,y]),(0,ez.vC)("j, shift+j",()=>{m()},{enabled:!y,preventDefault:!0},[m,y]),(0,ez.vC)("k, shift+k",()=>{p()},{enabled:!y,preventDefault:!0},[p,y]),(0,ez.vC)("left",()=>{if(s){let e=f(s);if(e){let t=v[e.name]||0;if(t>0){g(e.name);let r=(t-1)*5;e.composers[r]&&a(e.composers[r].bcId)}}}else{let e=x();if(e){let t=v[e.name]||0;if(t>0){g(e.name);let r=(t-1)*5;e.composers[r]&&a(e.composers[r].bcId)}}}},{enabled:!y,preventDefault:!0},[s,x,v,g,a,f,y]),(0,ez.vC)("right",()=>{if(s){let e=f(s);if(e){let t=v[e.name]||0;if(t<Math.ceil(e.composers.length/5)-1){h(e.name);let r=(t+1)*5;e.composers[r]&&a(e.composers[r].bcId)}}}else{let e=x();if(e){let t=v[e.name]||0;if(t<Math.ceil(e.composers.length/5)-1){h(e.name);let r=(t+1)*5;e.composers[r]&&a(e.composers[r].bcId)}}}},{enabled:!y,preventDefault:!0},[s,x,v,h,a,f,y]),(0,ez.vC)("c, shift+c",()=>{if(l>=0&&l<o.length){let e=o[l];(0,_.Q1)(e.bcId)}},{enabled:!y,preventDefault:!0},[l,o,y])}({selectedComposerId:K,isInputFocused:eZ,isAnyDropdownOpen:eK,highlightedComposerId:eJ,setHighlightedComposerId:eG,selectedIndex:tL,flattenedComposers:tE,detailedComposers:D,findNextComposer:tI,findPrevComposer:tD,handleSelectComposer:t_,handleCloseModal:tA,navigateToNextSection:ty,navigateToPreviousSection:tj,getFirstRenderedSection:tC,getSectionContainingComposer:tN,navigateToNextPageInSection:tk,navigateToPreviousPageInSection:tS,sectionPagination:tn,prLoading:eX,openExistingPullRequest:tu}),(0,c.useEffect)(()=>{if(C||!N&&!j){let e=encodeURIComponent(window.location.href);window.location.href="/api/auth/login?redirect_uri=".concat(e)}},[j,C,N]);let tR=(0,c.useCallback)(async()=>{try{let e=50;e="Custom"===eN?eS||50:parseInt(eN.replace("$",""))||50,await es(e,void 0),H(!1)}catch(e){console.error("Failed to toggle hard limit:",e)}},[eN,es,H,eS]),tT=(0,c.useCallback)(e=>{ek(e),"Custom"!==e&&eE(null)},[]),tF=(0,c.useCallback)(e=>{e>1e5?eE(1e5):eE(e),ek("Custom")},[]),[tP,tB]=(0,c.useState)(!1),[tO,tz]=(0,c.useState)(null);(0,c.useEffect)(()=>{tz("true"===localStorage.getItem("hasSeenAnnouncementModal"))},[]);let tU=(0,c.useCallback)(()=>{tz(!0),localStorage.setItem("hasSeenAnnouncementModal","true")},[]),tW=(0,c.useCallback)(async()=>{if(!tP){tB(!0);try{let e=await ea({tier:"pro",isFromAgentsPage:!0});window.open(e,"_blank","noopener,noreferrer")}catch(e){console.error("[Upgrade] Error creating checkout URL:",e)}finally{setTimeout(()=>{tB(!1)},3e3)}}},[tP,ea]),[tH,tq]=(0,c.useState)(null);(0,c.useEffect)(()=>{var e;if("full"===eI.viewMode||!(null==eP||null==(e=eP.composer)?void 0:e.bcId))return void tq(null);let t=R.get(eP.composer.bcId);tq((0,_.xH)(eP,t))},[eP,R,eI.viewMode]);let tJ=(0,c.useMemo)(()=>{var e;return T((null==eP||null==(e=eP.composer)?void 0:e.bcId)||"")},[T,null==eP||null==(a=eP.composer)?void 0:a.bcId]),tG=(0,c.useRef)(null),tZ=(0,c.useRef)(new Map),tV=null==eP||null==(l=eP.composer)?void 0:l.bcId,tK=null==eP||null==(o=eP.composer)?void 0:o.status;(0,c.useEffect)(()=>(tV?B(tV,tK):(O(),tG.current=null),()=>{O()}),[tV,tK,B,O]),(0,c.useEffect)(()=>()=>{tZ.current.clear()},[]);let t$=(0,c.useMemo)(()=>{if(!K)return null;for(let e=0;e<tg.length;e++){let t=tg[e],r=t.composers.findIndex(e=>e.bcId===K);if(-1!==r)return{sectionIndex:e,composerIndex:r,section:t}}return null},[K,tg]),tX=(0,c.useMemo)(()=>{if(!t$)return!1;let{sectionIndex:e,composerIndex:t}=t$;if(t>0)return!0;for(let t=e-1;t>=0;t--)if(tg[t].composers.length>0)return!0;return!1},[t$,tg]),tY=(0,c.useMemo)(()=>{if(!t$)return!1;let{sectionIndex:e,composerIndex:t,section:r}=t$;if(t<r.composers.length-1)return!0;for(let t=e+1;t<tg.length;t++)if(tg[t].composers.length>0)return!0;return!1},[t$,tg]),tQ=(0,c.useCallback)(e=>{X.current&&X.current.setPrompt(e)},[X]);return N||!j||F?(0,n.jsx)(nh,{videoRef:ev}):(0,n.jsxs)("div",{className:"flex flex-col gap-4 h-full",children:[x.Fr&&(0,n.jsxs)("div",{className:"container mx-auto px-4 sm:px-14 py-0 max-w-[660px] flex flex-col gap-4 sm:gap-1.5",children:[(0,n.jsx)(tw,{onFocusChange:eV,onDropdownOpenChange:e$,onBeforeSubmit:to,viewConfig:eI,onViewConfigChange:eD,filterConfig:eb,onFilterConfigChange:ew,inputRef:X,githubConnected:Y,isGithubLoading:Q,onConnectGithub:ti,githubError:er,deeplinkData:w}),0===k.length&&!F&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(rH,{onChipClick:tQ})})]}),k.length>0&&"kanban"===eI.viewMode&&(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)(nL,{groupedSections:tg,categorizedComposers:tf,detailedComposers:D,prLoading:eX,onOpenExistingPullRequest:tu,onSelectComposer:t_,viewConfig:eI,inputBoxRef:X,filterConfig:eb,onFilterConfigChange:ew,isLoadingDetailedDataForGrouping:tl})}),"full"===eI.viewMode&&(0,n.jsx)(nr,{allSections:tg,detailedComposers:D,detailedDiffs:R,selectedComposerId:K,selectedComposer:null!=eP?eP:null,isComposerNotFound:eW,prLoading:eX,existingPrUrl:eQ,isConversationCollapsed:ey,isInputFocused:eZ,isAnyDropdownOpen:eK,viewConfig:eI,filterConfig:eb,inputBoxRef:X,githubConnected:Y,githubError:er,onCloseModal:tA,onCollapseConversation:tM,onSelectComposer:t_,onSetSelectedComposerId:$,onFocusChange:eV,onDropdownOpenChange:e$,onBeforeSubmit:to,backgroundComposers:k,backgroundComposersLoading:F,onViewConfigChange:eD,onFilterConfigChange:ew,onConnectGithub:ti,onOpenExistingPullRequest:tu,onOpenPullRequest:td,deeplinkData:w,onOpenNewAgentModal:tt}),k.length>0&&"kanban"!==eI.viewMode&&"full"!==eI.viewMode&&tg.length>0&&(0,n.jsx)("div",{className:"container mx-auto px-4 sm:px-14 py-0 max-w-[660px] flex flex-col gap-4 sm:gap-1.5 ".concat(x.Fr?"pb-[96px]":""),children:(0,n.jsx)("div",{className:"   flex flex-col ".concat("prompt"===eI.groupBy?"gap-[32px]":"gap-[16px]"),children:tg.filter(e=>e.composers.length>0).map(e=>(0,n.jsx)("div",{children:(0,n.jsx)(ny,{title:e.name,composers:e.composers,sectionPagination:tn,setSectionPagination:ts,flattenedComposers:tE,selectedIndex:tL,detailedComposers:D,prLoading:eX,onOpenExistingPullRequest:tu,onSelectComposer:t_,viewConfig:eI})},e.name))})}),k.length>0&&"kanban"!==eI.viewMode&&"full"!==eI.viewMode&&0===tg.length&&((null==eb?void 0:eb.rules)&&eb.rules.length>0||eI.groupBy)&&!tl&&(0,n.jsx)("div",{className:"container mx-auto px-4 sm:px-14 py-0 max-w-[660px]",children:(0,n.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center h-64 text-gray-500",children:[(0,n.jsx)("span",{className:"text-sm text-gray-400",children:"No agents match filter"}),(0,n.jsx)("button",{className:"text-sm text-gray-500 bg-gray-500/5 hover:bg-gray-500/10 hover:text-gray-300 transition-colors rounded-md px-2 py-1",onClick:()=>{ew(L),eD({...eI,groupBy:null})},children:"Clear filters"})]})}),"full"!==eI.viewMode&&(0,n.jsx)(n.Fragment,{children:x.Fr?(0,n.jsx)(ng,{selectedComposerId:K,isModalVisible:e0,handleCloseModal:tA,selectedComposer:eP,selectedComposerDiffStats:tH,isComposerNotFound:eW,prLoading:eX,existingPrUrl:eQ,onOpenExistingPullRequest:tu,onOpenPullRequest:td}):(0,n.jsx)(nf,{selectedComposerId:K,isModalVisible:e0,handleCloseModal:tA,isConversationCollapsed:ey,isConversationLoading:0===tJ.length||F,selectedComposer:eP,selectedComposerDiffStats:tH,isComposerNotFound:eW,prLoading:eX,existingPrUrl:eQ,onOpenInCursor:_.Q1,onOpenExistingPullRequest:tu,onOpenPullRequest:td,handleCollapseConversation:tM,onSelectPrevious:()=>{if(K){let e=tD(K);e&&t_(e)}},onSelectNext:()=>{if(K){let e=tI(K);e&&t_(e)}},hasPrevious:tX,hasNext:tY})}),x.Fr?(0,n.jsx)(nA,{showUpgradeModal:q,setShowUpgradeModal:J,onUpgradeToPro:()=>{tW()}}):(0,n.jsx)(nj,{showUpgradeModal:q,setShowUpgradeModal:J,onUpgradeToPro:tW,isUpgrading:tP}),x.Fr?(0,n.jsx)(nM,{showUsagePricingModal:W,setShowUsagePricingModal:H,handleHardLimitToggle:tR,stripeStatus:en,limitOptions:eC,selectedLimit:eN,customValue:eS,handleLimitSelect:tT,handleCustomLimitChange:tF}):(0,n.jsx)(nN,{showUsagePricingModal:W,setShowUsagePricingModal:H,handleHardLimitToggle:tR,stripeStatus:en,limitOptions:eC,selectedLimit:eN,customValue:eS,handleLimitSelect:tT,handleCustomLimitChange:tF}),(0,n.jsx)(nD,{showPrivacyModeModal:G,setShowPrivacyModeModal:Z,isLoadingPrivacyMode:eo,isEnforcedByTeam:ei,isMobile:x.Fr,hoursRemainingInGracePeriod:ec}),(0,n.jsx)(nS,{isOpen:e2,onClose:()=>e5(!1),onConnect:tc}),(0,n.jsx)(P,{isVisible:ef&&!eu&&Y&&!ed,isIOS:ep,isAndroid:ex,canInstall:em,onInstall:eh,onDismiss:eg}),(0,n.jsx)(na,{isOpen:!1===tO&&!x.Fr&&!eu&&0===k.length&&!F&&!K,onClose:tU}),Y&&(0,n.jsx)(nk,{inputBoxRef:X,showFAB:i,onFocusChange:eV,onDropdownOpenChange:e$,onBeforeSubmit:to,viewConfig:eI,onViewConfigChange:eD,filterConfig:eb,onFilterConfigChange:ew,githubConnected:Y,isGithubLoading:Q,onConnectGithub:ti}),e3&&(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center transition-all duration-200 ease-out ".concat(e8?"bg-black/50 opacity-100":"bg-black/0 opacity-0"),onClick:te,children:(0,n.jsx)("div",{className:"w-full max-w-2xl mx-4 bg-gradient-to-b from-[#17191D] to-[#1B1D21] rounded-[16px] border border-gray-500/10 shadow-2xl transition-all duration-200 ease-out ".concat(e8?"scale-100 opacity-100 translate-y-0":"scale-95 opacity-0 translate-y-2"),onClick:e=>e.stopPropagation(),style:{minHeight:"120px"},children:(0,n.jsx)("div",{className:"p-1.5",children:(0,n.jsx)(tw,{onFocusChange:eV,onDropdownOpenChange:e$,onBeforeSubmit:()=>{let e=to();return e&&setTimeout(()=>te(),100),e},viewConfig:eI,isFloating:!0,onViewConfigChange:eD,filterConfig:eb,onFilterConfigChange:ew,inputRef:X,githubConnected:Y,onConnectGithub:ti,githubError:er,hasOpenModal:!0})})})})]})}let nP="web-push-permission-requested",nB="web-push-token",nO="web-push-device-id";var nz=r(55943);async function nU(e){try{let t=await (0,nz.J)(e);if("BUGBOT_FIX_IN_WEB"!==t.type)throw Error("Invalid deeplink type");if(1!==t.version)throw Error("Unsupported payload version");return t}catch(e){throw console.error("JWT validation failed:",e),e}}async function nW(e,t){try{let r=await fetch("/api/bugbot/encrypted-data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({redis_key:e,encryption_key:t})});if(!r.ok)throw Error("Failed to fetch bug data: ".concat(r.status));return(await r.json()).bugReport}catch(e){throw console.error("Failed to fetch bug data:",e),e}}async function nH(e){try{let t=await nU(e);return{bugReport:await nW(t.data.redisKey,t.data.encryptionKey),repoOwner:t.data.repoOwner,repoName:t.data.repoName,branch:t.data.branch,prNumber:t.data.prNumber,commitSha:t.data.commitSha}}catch(e){return console.error("Failed to handle bugbot deeplink:",e),d.oR.error("Failed to handle bugbot deeplink: ".concat(e instanceof Error?e.message:"Unknown error")),null}}var nq=r(80085),nJ=r.n(nq);function nG(e){let{viewMode:t}=e,{backgroundComposers:r,isLoading:s}=(0,v._F)(),a=0===r.length&&!s,l=(0,h.t)(),{isPWAInstalled:o}=(0,M.H)(),i=o||l||"full"===t&&!a;return i?null:(0,n.jsx)("div",{className:"px-4 sm:px-9 pt-6",children:(0,n.jsxs)("div",{className:"grid ".concat(i?"grid-cols-2":"grid-cols-3"," items-center p-2 w-full h-[64px]"),children:[(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsx)(B.g,{hideText:!0,href:i?void 0:"/?from=home",disableClick:i})}),!i&&(0,n.jsxs)("div",{className:"flex items-center gap-6 justify-center",children:[(0,n.jsx)("div",{className:"transition-colors flex items-center gap-2 group text-white cursor-default",children:(0,n.jsx)(O.o5,{className:"text-white cursor-default",children:"Agents"})}),(0,n.jsx)(nJ(),{href:"/dashboard",className:"text-gray-400 cursor-pointer hover:text-gray-200 transition-colors",children:(0,n.jsx)(O.o5,{children:"Dashboard"})})]}),(0,n.jsx)("div",{className:"flex items-center gap-2 justify-end",children:(0,n.jsx)(en.i,{})})]})})}function nZ(){let e=(0,c.useRef)(null),[t,r]=(0,c.useState)(!1),[s,l]=(0,c.useState)(null),u=function(){let[e,t]=(0,c.useState)({isSupported:!1,permissionStatus:null,isRegistered:!1,isLoading:!1,error:null});(0,c.useEffect)(()=>{let e=x.xl&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window;t(t=>({...t,isSupported:e,permissionStatus:e?Notification.permission:null}))},[]);let r=()=>"true"===localStorage.getItem(nP),n=(0,c.useCallback)(()=>localStorage.getItem(nB),[]),s=(0,c.useCallback)(e=>{localStorage.setItem(nB,e)},[]),a=(0,c.useCallback)(()=>{localStorage.removeItem(nB)},[]),l=async()=>{if(!("serviceWorker"in navigator))throw Error("Service Worker not supported");try{let e=await navigator.serviceWorker.register("/service-worker.js",{scope:"/"});return await navigator.serviceWorker.ready,e}catch(e){throw console.error("Service Worker registration failed:",e),e}},o=async e=>await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){let t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(r),s=new Uint8Array(n.length);for(let e=0;e<n.length;++e)s[e]=n.charCodeAt(e);return s}("BACmRDpfKPQIh4RAQhbb3lsdesotPXWZmUTMgAGSAiWt8U60nrRpPkL4sdrice12Ni3KRdwQ9b4xfmPAR5tES_o")}),i=(0,c.useCallback)(async e=>{let t=function(){let e=localStorage.getItem(nO);if(e)return e;let t="web-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,11));return localStorage.setItem(nO,t),t}(),r=JSON.stringify(e.toJSON()),n=new m.nL({token:r,deviceId:t,platform:m.ir.WEB}),a=await fetch("/api/auth/registerPushNotificationToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.toJson())});if(!a.ok)throw Error("Failed to register push token: ".concat(a.statusText));s(r)},[s]),d=(0,c.useCallback)(async()=>{if(!e.isSupported)return t(e=>({...e,error:"Push notifications are not supported on this device"})),!1;if(r()||"granted"===Notification.permission)return!0;t(e=>({...e,isLoading:!0,error:null}));try{let e=await Notification.requestPermission();if(localStorage.setItem(nP,"true"),t(t=>({...t,permissionStatus:e})),"granted"!==e)return t(e=>({...e,isLoading:!1})),!1;let r=await l(),n=await o(r);return await i(n),t(e=>({...e,isRegistered:!0,isLoading:!1})),!0}catch(e){return console.error("Error requesting push permission:",e),t(t=>({...t,error:e instanceof Error?e.message:"Failed to set up push notifications",isLoading:!1})),!1}},[e.isSupported,i]);return(0,c.useEffect)(()=>{e.isSupported&&(async()=>{try{n()&&"granted"===Notification.permission&&((await navigator.serviceWorker.getRegistrations()).length>0?t(e=>({...e,isRegistered:!0})):a())}catch(e){console.error("Error checking push registration:",e)}})()},[e.isSupported,n,a]),{...e,requestPermission:d,hasBeenAskedForPermission:r,shouldRequestPermission:e.isSupported&&!r()&&"default"===Notification.permission}}(),[p,f]=(0,c.useState)(null);return(0,c.useEffect)(()=>{let t=e.current;if(!t)return;let n=()=>{r(t.scrollTop>182)};return n(),t.addEventListener("scroll",n,{passive:!0}),()=>{t.removeEventListener("scroll",n)}},[]),(0,c.useEffect)(()=>{(async()=>{let e=new URLSearchParams(window.location.search).get("data");if(e)try{let t=await nH(e);if(t){f(t),setTimeout(()=>{let e=new URL(window.location.href);e.searchParams.has("data")&&(e.searchParams.delete("data"),window.history.replaceState({},"",e.toString()))},6e3);let e=t.bugReport.id||"unknown";try{await fetch("/api/bugbotDeeplinkEvent",{method:"POST",headers:{"Content-Type":"application/json"},body:new o.i9({userId:0,bugId:e,event:o.A4.HANDLED_FIX_IN_WEB}).toJsonString()})}catch(e){}}}catch(e){console.error("Failed to handle BugBot deeplink:",e),setTimeout(()=>{let e=new URL(window.location.href);e.searchParams.has("data")&&(e.searchParams.delete("data"),window.history.replaceState({},"",e.toString()))},6e3);try{await fetch("/api/bugbotDeeplinkEvent",{method:"POST",headers:{"Content-Type":"application/json"},body:new o.i9({userId:0,bugId:"unknown",event:o.A4.ERROR}).toJsonString()})}catch(e){}}})()},[]),(0,c.useEffect)(()=>{localStorage.setItem("hasVisitedAgents","true")},[]),(0,c.useEffect)(()=>{(async()=>{u.shouldRequestPermission&&(await u.requestPermission()?console.log("Web push notifications enabled"):console.log("Web push notifications permission denied or failed"))})()},[u.shouldRequestPermission,u.requestPermission,u]),(0,n.jsxs)(b.q,{children:[(0,n.jsx)(a(),{id:"6ab12870f5b27be0",children:"html{overscroll-behavior:none}@media(min-width:769px){.agents-page ::-webkit-scrollbar{width:8px;height:8px}.agents-page ::-webkit-scrollbar-track{background:transparent}.agents-page ::-webkit-scrollbar-thumb{background:rgba(156,163,175,.3);border-radius:4px}.agents-page ::-webkit-scrollbar-thumb:hover{background:rgba(156,163,175,.3)}.agents-page *{scrollbar-width:thin;scrollbar-color:rgba(156,163,175,.3)transparent}.agents-page *:hover{scrollbar-color:rgba(156,163,175,.3)transparent}}@media(max-width:768px){.agents-page ::-webkit-scrollbar{display:none;width:0;height:0;-webkit-appearance:none}.agents-page *::-webkit-scrollbar{display:none;width:0;height:0;-webkit-appearance:none}.agents-page *{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch}.agents-page div{scrollbar-width:none;-ms-overflow-style:none}}"}),(0,n.jsx)(d.l$,{theme:"dark",position:"bottom-left",toastOptions:{style:{background:"#1b1d21",color:"d1d5db",borderColor:"#24262a"}}}),(0,n.jsx)(v.UQ,{children:(0,n.jsxs)("div",{ref:e,style:{fontFamily:'"SF Pro Display", "SF Pro", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',lineHeight:"1.4",background:"linear-gradient(180deg, #17191D 0%, #121315 100%)"},className:"jsx-6ab12870f5b27be0 "+((0,i.cn)("agents-page flex min-h-screen flex-col h-screen overflow-y-auto bg-gradient-to-b from-[#17191D] to-[#121315]")||""),children:[(0,n.jsx)(nG,{viewMode:s}),(0,n.jsx)(c.Suspense,{fallback:(0,n.jsx)(n.Fragment,{children:" "}),children:(0,n.jsx)(nF,{showFAB:t,deeplinkData:p,onViewModeChange:l})})]})})]})}},78072:(e,t,r)=>{"use strict";r.d(t,{A4:()=>s,i9:()=>a});var n=r(91090);let s=n.C.makeEnum("aiserver.v1.BugbotDeeplinkEventKind",[{no:0,name:"BUGBOT_DEEPLINK_EVENT_KIND_UNSPECIFIED",localName:"UNSPECIFIED"},{no:1,name:"BUGBOT_DEEPLINK_EVENT_KIND_CLICKED",localName:"CLICKED"},{no:2,name:"BUGBOT_DEEPLINK_EVENT_KIND_HANDLED_DIALOG_SHOWN",localName:"HANDLED_DIALOG_SHOWN"},{no:3,name:"BUGBOT_DEEPLINK_EVENT_KIND_HANDLED_CHAT_CREATED",localName:"HANDLED_CHAT_CREATED"},{no:4,name:"BUGBOT_DEEPLINK_EVENT_KIND_ERROR",localName:"ERROR"},{no:5,name:"BUGBOT_DEEPLINK_EVENT_KIND_HANDLED_FIX_IN_WEB",localName:"HANDLED_FIX_IN_WEB"}]),a=n.C.makeMessageType("aiserver.v1.LogDeeplinkEventRequest",()=>[{no:1,name:"user_id",kind:"scalar",T:5},{no:2,name:"bug_id",kind:"scalar",T:9},{no:3,name:"comment_id",kind:"scalar",T:3,opt:!0},{no:4,name:"event",kind:"enum",T:n.C.getEnumType(s)}])}},e=>{e.O(0,[9350,9573,9209,762,8288,463,1804,2920,8030,1131,85,4122,5841,163,999,9631,1090,4441,1456,8292,2014,3247,6484,251,1853,7805,6969,37,2068,2775,5622,2453,7937,6727,8158,7358],()=>e(e.s=6867)),_N_E=e.O()}]);