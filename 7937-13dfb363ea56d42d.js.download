"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7937],{111:(e,t,a)=>{a.d(t,{H:()=>s});var r=a(10689),n=a(34441);function s(){let[e,t]=(0,r.useState)(!1),[a,s]=(0,r.useState)(!1),[o,i]=(0,r.useState)(null),[l,d]=(0,r.useState)(!1),c="pwa-install-dismissed",u="pwa-install-dismissed-timestamp";(0,r.useEffect)(()=>{let e=e=>{e.preventDefault(),i(e),s(!0)},a=()=>{t(!0),s(!1),d(!1),i(null),localStorage.removeItem(c),localStorage.removeItem(u)};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",a),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",a)}},[]),(0,r.useEffect)(()=>{let e=()=>{let e=(()=>{if(n.xl)return!1;let e=window.matchMedia("(display-mode: standalone)").matches,t=!0===navigator.standalone,a=window.matchMedia("(display-mode: fullscreen)").matches;return e||t||a})();t(e),e||!n.Fr||(()=>{let e=localStorage.getItem(c),t=localStorage.getItem(u);return!!e&&!!t&&Date.now()-parseInt(t)<6048e5})()?d(!1):d(n.m0&&a||n.un)};e();let r=window.matchMedia("(display-mode: standalone)"),s=()=>e();r.addEventListener?r.addEventListener("change",s):r.addListener(s);let o=setInterval(e,5e3);return()=>{r.removeEventListener?r.removeEventListener("change",s):r.removeListener(s),clearInterval(o)}},[a]);let m=async()=>{if(o&&n.m0)try{await o.prompt();let{outcome:e}=await o.userChoice;"accepted"===e?(s(!1),d(!1)):h(),i(null)}catch(e){console.error("Error prompting PWA install:",e)}},h=()=>{d(!1),localStorage.setItem(c,"true"),localStorage.setItem(u,Date.now().toString())};return{isPWAInstalled:e,canInstall:a&&n.m0,isIOS:n.un,isAndroid:n.m0,isMobile:n.Fr,showInstallPrompt:l,promptInstall:m,dismissPrompt:h}}},4341:(e,t,a)=>{a.d(t,{NI:()=>s,gu:()=>n});var r=a(9381);let n=e=>{let{className:t,...a}=e;return(0,r.jsx)("svg",{className:t,fill:"currentColor",viewBox:"0 0 69 13",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,r.jsx)("path",{d:"M.61621 6.43836c0-3.50869 2.23066-5.4743 5.49005-5.4743h3.91414v2.09026H6.23091c-1.99579 0-3.35255 1.13895-3.35255 3.38404 0 2.2451 1.35676 3.38404 3.35255 3.38404h3.78949v2.0903H6.10626c-3.25939 0-5.49005-1.99582-5.49005-5.47434ZM12.0472 8.41982V.96549h2.1834v7.00164c0 1.35676.702 1.83964 1.8554 1.83964h1.3095c1.139 0 1.8554-.48288 1.8554-1.83964V.96549h2.1677v7.47008c0 2.35533-1.5588 3.47723-3.6648 3.47723h-2.0273c-2.1205 0-3.6806-1.1232-3.6806-3.49298h.0013ZM23.7734.96549h6.4716c2.2149 0 3.3223 1.18487 3.3223 3.08749 0 1.21636-.5773 2.19917-1.4971 2.46422.9513.10891 1.404.79517 1.404 1.62182v3.77378H31.275V8.65338c0-.57734-.1719-.9828-.9513-.9828h-4.3511v4.24222h-2.1992V.96548Zm6.1763 4.66338c.9986 0 1.404-.53011 1.404-1.30952 0-.84241-.4054-1.29379-1.4341-1.29379h-3.9457v2.60463h3.9772l-.0014-.00132ZM35.5162 9.83815h6.0359c.7334 0 1.2006-.40545 1.2006-1.13895 0-.76367-.4829-1.06022-1.2479-1.1232l-3.0416-.23356c-1.9183-.1404-3.2278-1.10746-3.2278-3.16623 0-2.04302 1.4499-3.21214 3.3525-3.21214h5.9729v2.07451h-5.8482c-.8424 0-1.2794.40545-1.2794 1.1232 0 .74793.4684 1.06022 1.2951 1.13895l3.0875.21781c1.8869.14041 3.1347 1.13895 3.1347 3.15048 0 1.93408-1.3252 3.24368-3.2436 3.24368h-6.1921V9.83815h.0014ZM46.0576 6.42277c0-3.32237 2.4013-5.64488 5.6147-5.64488h.0315c3.2122 0 5.6305 2.32382 5.6305 5.64488 0 3.3368-2.417 5.67633-5.6305 5.67633h-.0315c-3.2121 0-5.6147-2.33953-5.6147-5.67633Zm5.6305 3.55593c1.98 0 3.4312-1.404 3.4312-3.54018 0-2.12044-1.4499-3.54019-3.4312-3.54019-1.9656 0-3.4156 1.41975-3.4156 3.54019 0 2.13618 1.45 3.54018 3.4156 3.54018ZM59.0635.96549h6.4715c2.2149 0 3.3224 1.18487 3.3224 3.08749 0 1.21636-.5774 2.19917-1.4972 2.46422.9513.10891 1.404.79517 1.404 1.62182v3.77378h-2.1991V8.65338c0-.57734-.1719-.9828-.9514-.9828h-4.3511v4.24222h-2.1991V.96548Zm6.1763 4.66338c.9985 0 1.404-.53011 1.404-1.30952 0-.84241-.4055-1.29379-1.4342-1.29379H61.264v2.60463h3.9771l-.0013-.00132Z"})})},s=e=>{let{className:t,...a}=e;return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"104",height:"104",fill:"none",viewBox:"0 0 104 104",className:t,...a,children:[(0,r.jsx)("rect",{width:"104",height:"104",fill:"#0C0C0C",rx:"22"}),(0,r.jsx)("path",{fill:"#939393",d:"M51.998 90.405v-37.8L20 71.504z"}),(0,r.jsx)("path",{fill:"#E3E3E3",d:"M84 33.703 52.001 90.404v-37.8z"}),(0,r.jsx)("path",{fill:"#fff",d:"M20 33.703h63.995l-31.998 18.9z"}),(0,r.jsx)("path",{fill:"#444",d:"M52.002 14.804v18.9h31.997z"}),(0,r.jsx)("path",{fill:"#939393",d:"M20 33.705h31.998v-18.9zM84 71.504l-16-9.45-15.998 28.35z"}),(0,r.jsx)("path",{fill:"#444",d:"m83.996 33.703-15.999 28.35 15.999 9.45zM51.998 52.604 20 71.504v-37.8z"})]})}},6259:(e,t,a)=>{a.d(t,{t:()=>n});var r=a(10689);function n(){let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(()=>{if(window.ReactNativeWebView)return t(!0);if("undefined"!=typeof navigator){let e=navigator.userAgent||"";(e.includes("ReactNative")||e.includes("wv"))&&t(!0)}})()},[]),e}},11097:(e,t,a)=>{a.d(t,{A:()=>r});let r={src:"/_next/static/media/placeholder-logo.da8a9d2b.webp",height:72,width:72,blurDataURL:"data:image/webp;base64,UklGRqwAAABXRUJQVlA4WAoAAAAQAAAABwAABwAAQUxQSDsAAAABT6CgkaQ2+b3RJeAGLUREwNF+P+ILKKptJcIhBBXYEYE6RnBphdnXPKL/IVHFTysDdIJNsAHqtxeJKgBWUDggSgAAANABAJ0BKggACAACQDglpAAC/7YLJhgAAM4/o7wZrg0OwEYLw7df7zG0R+ts4nxq5X6884or03ZMb578JIq4/NdpRns3Sn3gAAAA",blurWidth:8,blurHeight:8}},11116:(e,t,a)=>{a.d(t,{N:()=>s});var r=a(9381),n=a(78230);let s=e=>{let{value:t,caption:a,isActive:s=!1,onClick:o,standalone:i=!1,tooltip:l}=e;return(0,r.jsxs)("div",{onClick:o,className:"dashboard-chart-tile ".concat(s?"dashboard-chart-tile-active":""," ").concat(!o?"dashboard-chart-tile-no-click":""," ").concat(i?"dashboard-chart-tile-standalone":""),children:[(0,r.jsx)("div",{className:"dashboard-chart-tile-value ".concat(void 0===t?"dashboard-text-quaternary":""),children:void 0===t?"—":t}),(0,r.jsxs)("div",{className:"dashboard-chart-tile-caption",children:[a,l&&(0,r.jsx)("div",{className:"w-3 h-3 flex items-center justify-center cursor-help","data-tooltip-id":l.id,"data-tooltip-content":l.content,onClick:e=>e.stopPropagation(),children:(0,r.jsx)(n.A,{className:"w-3 h-3"})})]})]})}},14066:(e,t,a)=>{a.d(t,{U:()=>d});var r=a(9381),n=a(41801),s=a(85524),o=a(10689),i=a(49105),l=a(28790);let d=e=>{let{customRange:t,setCustomRange:a}=e,[d,c]=(0,o.useState)(!1),[u,m]=(0,o.useState)(t),[h,p]=(0,o.useState)(()=>{if(!(null==t?void 0:t.from)||!(null==t?void 0:t.to))return 1;let e=(e=>{if(!(null==e?void 0:e.from)||!(null==e?void 0:e.to))return 1;let t=new Date(e.from);t.setHours(0,0,0,0);let a=new Date(e.to);return a.setHours(0,0,0,0),Math.floor((a.getTime()-t.getTime())/864e5)+1})(t);return 1===e||7===e||30===e?e:7}),g=new Date("2024-01-12"),x=new Date;x.setHours(23,59,59,999);let f=e=>{let t=(e=>{let t=new Date;t.setHours(23,59,59,999);let a=new Date(t);return(a.setDate(t.getDate()-(e-1)),a.setHours(0,0,0,0),a<g)?{from:g,to:t}:{from:a,to:t}})(e);p(e),a(t),c(!1)};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)("button",{onClick:()=>{m(t),c(!d)},className:"rounded dashboard-base transition-all cursor-pointer",style:{height:"28px",padding:"0px 8px",fontSize:"12px",fontWeight:400,lineHeight:"16px",color:"var(--dashboard-text-primary)",outline:"1px solid var(--dashboard-stroke-secondary)",outlineOffset:"-1px",background:"transparent",border:"none",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},onMouseEnter:e=>{e.currentTarget.style.outline="1px solid var(--dashboard-stroke-primary)",e.currentTarget.style.background="var(--dashboard-bg-secondary)"},onMouseLeave:e=>{e.currentTarget.style.outline="1px solid var(--dashboard-stroke-secondary)",e.currentTarget.style.background="transparent"},children:[(0,r.jsx)("span",{className:"dashboard-tabular-nums",children:(null==t?void 0:t.from)&&(null==t?void 0:t.to)?"".concat(new Date(Number(t.from)).toLocaleString("en-US",{month:"short",day:"2-digit",timeZone:"UTC"})," – ").concat(new Date(Number(t.to)).toLocaleString("en-US",{month:"short",day:"2-digit",timeZone:"UTC"})):"Select Date"}),(0,r.jsx)(s.A,{className:"h-3.5 w-3.5 transition-transform ".concat(d?"rotate-180":""),style:{color:"var(--dashboard-icon-secondary)"}})]}),(0,r.jsxs)("div",{className:"dashboard-segmented-control",children:[(0,r.jsx)("button",{onClick:()=>f(1),className:"dashboard-segmented-control-option ".concat(1===h?"dashboard-segmented-control-option-active":"dashboard-segmented-control-option-inactive"),style:{textAlign:"center",justifyContent:"center"},children:"1d"}),(0,r.jsx)("button",{onClick:()=>f(7),className:"dashboard-segmented-control-option ".concat(7===h?"dashboard-segmented-control-option-active":"dashboard-segmented-control-option-inactive"),style:{textAlign:"center",justifyContent:"center"},children:"7d"}),(0,r.jsx)("button",{onClick:()=>f(30),className:"dashboard-segmented-control-option ".concat(30===h?"dashboard-segmented-control-option-active":"dashboard-segmented-control-option-inactive"),style:{textAlign:"center",justifyContent:"center"},children:"30d"})]})]}),d&&(0,r.jsxs)("div",{className:"dashboard-date-picker",children:[(0,r.jsx)(i.hv,{mode:"single",selected:null==u?void 0:u.from,onSelect:e=>{e&&m(((e,t)=>{let a=new Date(e);a.setHours(0,0,0,0);let r=new Date(a);return(r.setDate(a.getDate()+(t-1)),r.setHours(23,59,59,999),r>x)?{from:a,to:x}:{from:a,to:r}})(e,h))},modifiers:{range_start:(null==u?void 0:u.from)?[u.from]:[],range_end:(null==u?void 0:u.to)?[u.to]:[],range_middle:(null==u?void 0:u.from)&&(null==u?void 0:u.to)?[{after:u.from,before:u.to}]:[],todayNotInRange:e=>{let t=new Date;t.setHours(0,0,0,0);let a=(0,n.r)(e,t),r=(null==u?void 0:u.from)&&(null==u?void 0:u.to)&&e>=u.from&&e<=u.to;return a&&!r}},numberOfMonths:1,defaultMonth:(null==u?void 0:u.from)||new Date,fromDate:g,toDate:x,classNames:{months:"flex flex-col space-y-4",month:"space-y-4",caption:"flex justify-between pt-1 relative items-center",caption_label:"dashboard-lg font-medium pl-1",nav:"space-x-1 flex items-center absolute right-0",nav_button:"h-8 w-8 flex items-center justify-center rounded-md dashboard-date-picker-nav-button focus:outline-none",nav_button_previous:"",nav_button_next:"",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-brand-gray-400 rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-1",cell:"h-8 w-8 text-center text-sm p-0 relative",day:"flex items-center justify-center h-full w-full p-1 dashboard-date-picker-day rounded-md",day_disabled:"dashboard-text-quaternary cursor-not-allowed hover:bg-transparent"},modifiersStyles:{selected:{backgroundColor:"#333333",fontWeight:"bold",borderRadius:"0.375rem",color:"white"},range_start:{backgroundColor:"#81A1C1",color:"white",fontWeight:"bold",borderTopLeftRadius:((null==u?void 0:u.from)&&(null==u?void 0:u.to)&&(0,n.r)(u.from,u.to),"0.375rem"),borderBottomLeftRadius:((null==u?void 0:u.from)&&(null==u?void 0:u.to)&&(0,n.r)(u.from,u.to),"0.375rem"),borderTopRightRadius:(null==u?void 0:u.from)&&(null==u?void 0:u.to)&&(0,n.r)(u.from,u.to)?"0.375rem":"0",borderBottomRightRadius:(null==u?void 0:u.from)&&(null==u?void 0:u.to)&&(0,n.r)(u.from,u.to)?"0.375rem":"0"},range_end:{backgroundColor:"#333333",color:"white",borderTopRightRadius:"0.375rem",borderBottomRightRadius:"0.375rem",borderTopLeftRadius:"0",borderBottomLeftRadius:"0"},range_middle:{backgroundColor:"#333333",color:"white",borderRadius:"0"}},modifiersClassNames:{todayNotInRange:"dashboard-day-today-not-in-range"}}),(0,r.jsxs)("div",{className:"mt-5 flex justify-end gap-2",children:[(0,r.jsx)(l.j,{onClick:()=>c(!1),size:"medium",children:"Cancel"}),(0,r.jsx)(l.j,{size:"medium",onClick:()=>{(null==u?void 0:u.from)&&(null==u?void 0:u.to)&&(a(u),c(!1))},disabled:!(null==u?void 0:u.from)||!(null==u?void 0:u.to),children:"Apply"})]})]})]})}},14980:(e,t,a)=>{a.d(t,{M:()=>z});var r=a(9381),n=a(51673),s=a(90037),o=a(24977),i=a(23899),l=a(84195),d=a.n(l),c=a(61266),u=a.n(c),m=a(20996),h=a(26703),p=a(4754);a(96486),a(56959);var g=a(10798),x=a(10689),f=a(20742),b=a(8144),v=a(54392),y=a(12061),w=a(6259),j=a(43693),N=a(11116),k=a(28790),C=a(88640),S=a(64149);function E(e){let{value:t,maxValue:a,className:n=""}=e,s=1===a&&t>0?100:a>0?Math.min(t/a*100,100):0;return(0,r.jsxs)("div",{className:"h-1 w-full py-2 flex gap-px ".concat(n),children:[(0,r.jsx)("div",{className:"bg-[#81A1C1]",style:{width:"".concat(s,"%"),height:"4px"}}),(0,r.jsx)("div",{className:"bg-[#81A1C1] opacity-10 flex-grow",style:{height:"4px"}})]})}var A=a(89888);let T=e=>{let{balanceCents:t}=e;if(!t||t>=0)return null;let a=Math.abs(t);return(0,r.jsx)(o.Z,{className:"border-0 bg-brand-dashboard-card p-6 dark:bg-brand-dashboard-card",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(A.o5,{as:"h3",className:"text-base font-medium",children:"Credits"}),(0,r.jsx)(A.o5,{variant:"label",className:"text-xs text-brand-gray-300 tracking-[0]",children:"Your account has a credit balance that will be automatically applied to your next invoice."})]}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsxs)(A.o5,{className:"text-xl font-medium",children:["$",(a/100).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})})};var R=a(34896),L=a(14066),M=a(30548),I=a(67369),F=a(52151),B=function(e){return e[e.INITIAL=0]="INITIAL",e[e.LOADING=1]="LOADING",e[e.READY=2]="READY",e[e.NO_USER=3]="NO_USER",e[e.ERROR=4]="ERROR",e}(B||{}),D=function(e){return e.DAILY_USERS="dailyUsers",e.LINES_OF_CODE="linesOfCode",e.TABS="tabs",e.ALL_REQUESTS="allRequests",e}(D||{}),O=function(e){return e.NAME="name",e.ROLE="role",e.REQUESTS="requests",e.SPEND="spend",e}(O||{}),P=function(e){return e.ASC="asc",e.DESC="desc",e}(P||{});let U={primary:"#88C0D0",secondary:"#7B88A155",tertiary:"rgb(233, 179, 59)",quaternary:"rgb(234, 151, 227)",quinary:"rgb(71, 147, 203)",gray:"rgb(102, 102, 102)"},_=[U.primary,U.secondary,U.tertiary,U.quaternary,U.quinary,U.gray],W=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isInCents:a=!1,showDecimals:r=!0,minimumFractionDigits:n=2*!!r,maximumFractionDigits:s=2*!!r}=t;return(a?e/100:e).toLocaleString("en-US",{minimumFractionDigits:n,maximumFractionDigits:s})},z=e=>{let{onOpenPrivacyModal:t,onNavigateToSettings:a,onOpenStartSubscriptionModal:l,onNavigateToAnalytics:c}=e,{adminOnlyUsagePricing:A,stripeStatus:B,viewerRole:D,team:O,selectedUserId:P,hardLimit:U,monthlyInvoice:z,teamSpendData:H,analyticsData:J,hardLimitPerUser:V,userAnalyticsData:q,createCheckoutUrl:K,inviteLink:G,users:Y,setSelectedUserId:$,setSelectedMenu:Z,analyticsLoadingState:Q,isRefreshingData:X,updateHardLimit:ee,isUsageDataLoading:et,customRange:ea,setCustomRange:er,usageDataError:en,hasNewPricing:es,usage:eo}=(0,y.M)(),{user:ei}=(0,n.Jd)(),el=(0,w.t)(),[ed,ec]=(0,x.useState)(D===s.acM.OWNER||D===s.acM.FREE_OWNER?"dailyUsers":"linesOfCode"),[eu,em]=(0,x.useState)("name"),[eh,ep]=(0,x.useState)("asc"),[eg,ex]=(0,x.useState)(!1),[ef,eb]=(0,x.useState)(!1),[ev,ey]=(0,x.useState)(!1),[ew,ej]=(0,x.useState)(!1),[eN,ek]=(0,x.useState)(!1),[eC,eS]=(0,x.useState)(!1),[eE,eA]=(0,x.useState)(50),[eT,eR]=(0,x.useState)(""),[eL,eM]=(0,x.useState)(!1),eI=(0,x.useMemo)(()=>["trialing","active"].includes(B.subscriptionStatus||"unknown")&&B.paymentId,[B.subscriptionStatus,B.paymentId]),eF=(0,x.useMemo)(()=>{if(B.membershipType===v.V.FREE_TRIAL&&"trialing"===B.subscriptionStatus&&"number"==typeof B.daysRemainingOnTrial){let e=new Date;e.setDate(e.getDate()+B.daysRemainingOnTrial);let t=e.getDate(),a=e.toLocaleDateString(void 0,{month:"long"});return"Your subscription will start on ".concat(a," ").concat(t).concat((e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(t),".")}return null},[B.membershipType,B.subscriptionStatus,B.daysRemainingOnTrial]);(0,x.useEffect)(()=>{"dailyUsers"===ed&&(D!==s.acM.OWNER&&D!==s.acM.FREE_OWNER||!O||P)&&ec("linesOfCode"),"allRequests"!==ed||O||ec("linesOfCode")},[ed,D,O,P]),(0,x.useCallback)(async()=>{G&&(await navigator.clipboard.writeText(G),ex(!0),setTimeout(()=>ex(!1),2e3))},[G]);let eB=(0,x.useMemo)(()=>{let e=new Map;if(H){var t;null==(t=H.teamMemberSpend)||t.forEach(t=>{e.set(t.userId,{spendCents:t.spendCents,fastPremiumRequests:t.fastPremiumRequests,hardLimitOverrideDollars:t.hardLimitOverrideDollars})})}return e},[H]),eD=()=>{let e=!P&&J?J:q;return e&&e.dailyMetrics&&0!==e.dailyMetrics.length?e.dailyMetrics.map(e=>({date:new Date(Number(e.date)).toLocaleString("en-US",{month:"short",day:"2-digit",timeZone:"UTC"}),activeUsers:Number(e.activeUsers||0),linesAdded:Number(e.linesAdded||0),linesDeleted:Number(e.linesDeleted||0),acceptedLinesAdded:Number(e.acceptedLinesAdded||0),acceptedLinesDeleted:Number(e.acceptedLinesDeleted||0),totalTabsShown:Number(e.totalTabsShown||0),totalTabsAccepted:Number(e.totalTabsAccepted||0),subscriptionIncluded:Number(e.subscriptionIncludedReqs||0),apikeyreqs:Number(e.apiKeyReqs||0),usagebasedreqs:Number(e.usageBasedReqs||0)})):[]},eO=(0,x.useMemo)(()=>(null==z?void 0:z.items)?z.items.filter(e=>!e.description.includes("Mid-month")).reduce((e,t)=>e+t.cents,0):0,[z]),eP=async e=>{let t=e||(B.membershipType===v.V.FREE||B.membershipType===v.V.FREE_TRIAL?"pro":B.membershipType===v.V.PRO?"pro_plus":"ultra");if("pro"===t){if(ef)return;eb(!0)}else if("pro_plus"===t){if(ev)return;ey(!0)}else{if(ew)return;ej(!0)}try{let e=await K({tier:t});window.location.href=e}catch(e){console.error("[Upgrade] Error creating checkout URL:",e)}finally{setTimeout(()=>{"pro"===t?eb(!1):"pro_plus"===t?ey(!1):ej(!1)},3e3)}},eU=()=>{ek(!0)},e_=async()=>{eS(!0);try{let e="custom"===eE?parseInt(eT,10):eE;if("custom"===eE&&(!eT||isNaN(e)||e<=0))return;await ee(e),ek(!1),eA(50),eR("")}catch(e){console.error("Failed to set usage limit:",e)}finally{eS(!1)}},eW=()=>{ek(!1),eA(50),eR("")},ez=async()=>{if(!eL){eM(!0);try{let e=await (0,b.g2)();if(e&&e.includes("https://"))window.open(e,"_blank");else throw Error("No valid portal URL found")}catch(e){console.error("[Portal URL] Failed to open billing portal:",e),alert("Error fetching billing portal: ".concat(e instanceof Error?e.message:"unknown"))}finally{eM(!1)}}};(0,x.useCallback)(e=>{eu===e?ep("asc"===eh?"desc":"asc"):(em(e),ep("asc"))},[eu,eh]);let eH=!O&&(B.membershipType===v.V.PRO||B.membershipType===v.V.PRO_PLUS||B.membershipType===v.V.ULTRA);return(0,r.jsxs)("div",{className:"flex flex-col gap-5",children:[!el&&(()=>{var e,t,n;if(et)return(0,r.jsx)(o.Z,{variant:"dashboard",className:"flex h-40 items-center justify-center",children:(0,r.jsx)(R.K,{})});if(en)return(0,r.jsx)(o.Z,{variant:"dashboard",children:(0,r.jsxs)("div",{className:"text-brand-red-400 text-center",children:["Error loading usage data: ",en]})});let d=null==(e=eo["gpt-4"])?void 0:e.numRequests,c=(null==O?void 0:O.id)?500*O.requestQuotaPerSeat:null==(t=eo["gpt-4"])?void 0:t.maxRequestUsage,u=null!=c?Math.min(null!=d?d:0,c):null!=d?d:0,g=O&&void 0!==V&&"no-limit"!==V,x=D===s.acM.OWNER||D===s.acM.FREE_OWNER,b=(null==ei?void 0:ei.email)?(e=>{var t,a;if(!H)return{spendCents:0,hardLimitOverrideDollars:void 0};let r=null==(t=H.teamMemberSpend)?void 0:t.find(t=>t.email===e);if(r)return{spendCents:r.spendCents||0,hardLimitOverrideDollars:r.hardLimitOverrideDollars};{let t=null==Y||null==(a=Y.find(t=>t.email===e))?void 0:a.id;if(t){let e=eB.get(parseInt(t,10));if(e)return{spendCents:e.spendCents||0,hardLimitOverrideDollars:e.hardLimitOverrideDollars}}}return{spendCents:0,hardLimitOverrideDollars:void 0}})(ei.email):{spendCents:0,hardLimitOverrideDollars:void 0},y=null!=(n=b.hardLimitOverrideDollars)?n:"no-limit"!==V?V:void 0,w=b.spendCents,N=x||!O?eO:w,k=x?U:g?y:U,C=!O&&"no-usage-based"!==U&&U?100*U:0,S=!O&&(null==z?void 0:z.lastHardLimitCents)?z.lastHardLimitCents:0,T=!O&&S>C&&C>0&&N>C,L=!O&&T?S:"number"==typeof k&&k>0?100*k:0,M=L/100,I=!O&&L>0?Math.min(N,L):"number"==typeof k&&k>0?Math.min(N,100*k):N,F=(()=>{switch(B.membershipType){case v.V.FREE:return"Free Plan";case v.V.FREE_TRIAL:return"Pro Trial";case v.V.PRO:return"Pro Plan";case v.V.PRO_PLUS:return"Pro+ Plan";case v.V.ULTRA:return"Ultra Plan";default:return"Unknown Plan"}})(),P=(()=>{switch(B.membershipType){case v.V.FREE:return"Limited Tab completions and Agent requests.";case v.V.FREE_TRIAL:case v.V.PRO:return"Unlimited Tab completions, extended Agent limits, and access to most features.";case v.V.PRO_PLUS:return"Unlimited Tab completions, access to all Pro features, and 3x more usage than Pro.";case v.V.ULTRA:return"Unlimited Tab completions, priority access to new features, and 20x more usage than Pro."}})(),_="no-usage-based"!==k&&null!=k,J=O?(null==H?void 0:H.subscriptionCycleStart)?new Date(Number(H.subscriptionCycleStart)):null:eo.startOfMonth?new Date(eo.startOfMonth):null,q=J?J.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):null,K=!!O||!1===es;if(B.membershipType===v.V.FREE||B.membershipType===v.V.FREE_TRIAL){let e=1+ +(B.membershipType===v.V.FREE)+ +!!es;return(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 ".concat(4===e?"md:grid-cols-2 lg:grid-cols-4":3===e?"md:grid-cols-3":"md:grid-cols-2"),children:[K&&(0,r.jsxs)("div",{className:"flex flex-col gap-4 p-2",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 w-full min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-1.5 w-full min-w-0 overflow-hidden",children:[(0,r.jsx)("div",{className:"dashboard-xl font-medium flex-shrink-0",children:u}),(0,r.jsxs)("div",{className:"dashboard-xl font-medium dashboard-text-tertiary truncate",children:["/ ",null!=c?c:0]})]}),(0,r.jsx)(E,{value:u,maxValue:c||0}),(0,r.jsx)("div",{className:"dashboard-base font-medium dashboard-text-secondary",children:"Included Requests Used"})]}),(0,r.jsxs)("div",{className:"dashboard-sm dashboard-text-tertiary",children:[null!=c?c:0," requests included in your plan.",q&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),"Last reset on: ",q]})]})]},"premium-models"),!K&&(0,r.jsx)(o.Z,{variant:"dashboard",className:"h-full",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4 justify-between h-full",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"text-base font-medium",children:F}),(0,r.jsx)(j.m,{label:B.membershipType===v.V.FREE_TRIAL||"trialing"===B.subscriptionStatus?void 0!==B.daysRemainingOnTrial?"".concat(B.daysRemainingOnTrial," Day").concat(1!==B.daysRemainingOnTrial?"s":""," Left"):"Trial":"Active"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("div",{className:"dashboard-base dashboard-text-secondary",children:P}),eF&&(0,r.jsx)("div",{className:"dashboard-base dashboard-text-secondary",children:eF})]})]}),B.membershipType===v.V.FREE_TRIAL&&eI&&(0,r.jsx)(i.Button,{className:"w-fit !py-1 rounded-md !px-2 !text-sm !text-gray-900 disabled:opacity-50 !bg-[#81A1C1] !border-none mt-2",variant:"secondary",onClick:l,children:"Start Pro Now"}),B.membershipType===v.V.FREE_TRIAL&&!eI&&(0,r.jsx)(i.Button,{className:"w-fit !py-1 rounded-md !px-2 !text-sm text-white disabled:opacity-50 !bg-transparent hover:!bg-transparent",variant:"secondary",onClick:()=>eP("pro"),disabled:ef,children:ef?"Processing...":"Upgrade to Pro"})]})},"current-plan-free"),B.membershipType===v.V.FREE&&(0,r.jsx)(o.Z,{variant:"dashboard",className:"h-full",children:(0,r.jsxs)("div",{className:"flex flex-col justify-between h-full",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsx)("div",{className:"text-base font-medium",children:"Pro"}),(0,r.jsx)("div",{className:"dashboard-base dashboard-text-secondary",children:"Extended limits on Agent, unlimited Tab completions, max context windows, and more."})]}),(0,r.jsx)(i.Button,{className:"w-fit !py-1 rounded-md !px-2 !text-sm text-white disabled:opacity-50 !bg-transparent hover:!bg-transparent mt-4",variant:"secondary",onClick:()=>eP("pro"),disabled:ef,children:ef?"Processing...":B.trialEligible&&"trialing"!==B.subscriptionStatus?"Start 14-day trial":"Upgrade to Pro"})]})}),es&&(0,r.jsx)(o.Z,{variant:"dashboard",className:"h-full",children:(0,r.jsxs)("div",{className:"flex flex-col justify-between h-full",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"text-base font-medium",children:"Ultra"}),(0,r.jsx)("div",{className:"dashboard-base dashboard-text-secondary",children:"20x higher limits for OpenAI, Claude, Gemini, Grok models, and early access to advanced features."})]}),(0,r.jsx)(i.Button,{className:"w-fit !py-1 rounded-md !px-2 !text-sm !text-gray-900 disabled:opacity-50 !bg-[#81A1C1] !border-none mt-4",variant:"secondary",onClick:()=>eP("ultra"),disabled:ew,children:ew?"Processing...":(0,r.jsxs)("div",{className:"gap-1.5 flex items-center flex-row text-gray-900",children:[(0,r.jsx)(m.A,{className:"size-4 text-gray-900"}),"Upgrade to Ultra"]})})]})})]})}return B.membershipType===v.V.ENTERPRISE?(0,r.jsx)(o.Z,{variant:"dashboard",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-[1.5fr_1fr_1fr]",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 p-2",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 w-full min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-1.5 w-full min-w-0 overflow-hidden",children:[(0,r.jsx)("div",{className:"dashboard-xl font-medium flex-shrink-0",children:u}),(0,r.jsxs)("div",{className:"dashboard-xl font-medium dashboard-text-tertiary truncate",children:["/ ",c]})]}),(0,r.jsx)(E,{value:u,maxValue:c||0}),(0,r.jsx)("div",{className:"dashboard-base font-medium opacity-50",children:"Included Requests Used"})]}),(0,r.jsxs)("div",{className:"dashboard-sm dashboard-text-tertiary",children:[c," requests included in your plan.",q&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),"Last reset on: ",q]})]})]},"premium-models"),(0,r.jsxs)("div",{className:"flex flex-col gap-4 p-2 relative group",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 w-full min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-1.5 w-full min-w-0 overflow-hidden",children:[(0,r.jsx)("div",{className:"dashboard-xl font-medium flex-shrink-0",children:_?"$".concat(W(I,{isInCents:!0})):"Off"}),"number"==typeof k&&(x||g)&&(0,r.jsxs)("div",{className:"dashboard-xl font-medium dashboard-text-tertiary truncate",children:["/ $",W(k,{isInCents:!1})]})]}),(0,r.jsx)(E,{value:I,maxValue:!O&&L>0?L:"number"==typeof k&&k>0?100*k:1}),(0,r.jsx)("div",{className:"dashboard-base font-medium opacity-50",children:x?"Usage-Based Spending (Team)":"Usage-Based Spending"})]}),x&&g&&void 0!==y&&(0,r.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 px-3 py-2 bg-brand-neutrals-900 text-white dashboard-base rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10 pointer-events-none",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[(0,r.jsx)("span",{className:"text-gray-300",children:"Your individual spend:"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",W(w,{isInCents:!0})]}),(0,r.jsxs)("span",{className:"text-gray-400",children:["/ $",W(y,{isInCents:!1})]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-1",children:(0,r.jsx)("div",{className:"bg-[#81A1C1] h-1 rounded-full",style:{width:"".concat(y>0?Math.min(w/(100*y)*100,100):0,"%")}})})]})}),(0,r.jsxs)("div",{className:"dashboard-sm dashboard-text-tertiary",children:["Pay for extra requests beyond your plan limits.",x&&g&&" Hover to see your individual spend."]})]},"usage-spend"),(0,r.jsx)("div",{className:"flex flex-col items-start gap-2",children:(0,r.jsx)(i.Button,{size:"sm",variant:"secondary",className:"!border-none bg-brand-dashboard-card text-white w-full justify-start",onClick:()=>{a?a():Z("settings")},children:(0,r.jsxs)("div",{className:"flex flex-col items-start w-full min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 w-full min-w-0",children:[(0,r.jsx)(h.A,{className:"size-4 shrink-0"}),(0,r.jsx)("span",{className:"font-medium dashboard-base",children:x||!A?"Set Spending Limit":"View Spending Limit"})]}),(0,r.jsx)("span",{className:"dashboard-base dashboard-text-secondary pl-6 text-left",children:(()=>{if(_){if(x)return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:["$","number"==typeof U?W(U,{isInCents:!1}):"0"," ","team spend"]}),g?(0,r.jsxs)("div",{children:["$","number"==typeof V?W(V,{isInCents:!1}):""," ","per user"]}):(0,r.jsx)("div",{children:"No user limits"})]});let e=void 0!==V&&"no-limit"!==V,t=e?V:U;return"$".concat("number"==typeof t?W(t,{isInCents:!1}):"0"," ").concat(e?"per user":"team spend")}return"Off"})()})]})})},"actions")]})}):(0,r.jsxs)(o.Z,{variant:"dashboard",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[K&&(0,r.jsxs)("div",{className:"flex flex-col gap-4 p-2",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 w-full min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-1.5 w-full min-w-0 overflow-hidden",children:[(0,r.jsx)("div",{className:"dashboard-xl font-medium flex-shrink-0",children:null!=u?u:0}),(0,r.jsxs)("div",{className:"dashboard-xl font-medium dashboard-text-tertiary truncate",children:["/ ",null!=c?c:0]})]}),(0,r.jsx)(E,{value:u,maxValue:c||0}),(0,r.jsx)("div",{className:"dashboard-base font-medium dashboard-text-secondary",children:"Included Requests Used"})]}),(0,r.jsxs)("div",{className:"dashboard-sm dashboard-text-tertiary",children:[null!=c?c:0," requests included in your plan.",q&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),"Last reset on: ",q]})]})]},"premium-models"),!K&&(0,r.jsxs)("div",{className:"flex flex-col gap-4 justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"text-base font-medium",children:F}),(0,r.jsx)(j.m,{label:"trialing"===B.subscriptionStatus?void 0!==B.daysRemainingOnTrial?"".concat(B.daysRemainingOnTrial," day").concat(1!==B.daysRemainingOnTrial?"s":""," left"):"Trial":"Active"})]}),(0,r.jsx)("div",{className:"dashboard-base dashboard-text-secondary",children:P}),eF&&(0,r.jsx)("div",{className:"dashboard-base dashboard-text-secondary",children:eF})]}),eI&&(0,r.jsx)(i.Button,{className:"w-fit !py-1 rounded-md !px-2 !text-sm text-white disabled:opacity-50 !bg-transparent hover:!bg-transparent",variant:"secondary",onClick:ez,disabled:eL,children:eL?"Processing...":"Manage Subscription"})]},"current-plan"),(0,r.jsx)("div",{className:"flex flex-col gap-4",children:eN?(0,r.jsx)("div",{className:"bg-brand-dashboard-card rounded-xl",style:{padding:"12px 16px 16px 16px"},children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsx)("div",{className:"text-base font-medium",children:"Set Spend Limit"}),(0,r.jsx)("div",{className:"dashboard-base dashboard-text-secondary",children:"Set a monthly spend limit for extra requests"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mt-2.5",children:[[50,100,200,500].map(e=>(0,r.jsxs)("button",{onClick:()=>{eA(e),eR("")},className:"rounded-md px-1.5 h-6 dashboard-base font-medium transition-colors border min-w-[40px] ".concat(eE===e?"bg-[#81A1C1]/10 text-[#81A1C1] border-[#81A1C1]":"bg-transparent text-gray-400 border-gray-600 hover:border-gray-500"),children:["$",e]},e)),(0,r.jsx)("input",{type:"number",value:eT,onChange:e=>{eR(e.target.value),eA("custom")},onFocus:()=>eA("custom"),placeholder:"Custom",className:"rounded-md px-1.5 h-6 dashboard-base font-medium transition-colors text-center border min-w-[40px] w-20 ".concat("custom"===eE?"bg-[#81A1C1]/10 text-[#81A1C1] placeholder-[#81A1C1]/60 border-[#81A1C1]":"bg-transparent text-gray-400 placeholder-gray-500 border-gray-600 hover:border-gray-500"," focus:outline-none focus:ring-2 focus:ring-[#81A1C1] [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"),min:"1"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-5",children:[(0,r.jsx)(i.Button,{className:"!py-1 rounded-md !px-3 !text-sm text-gray-300 !bg-transparent hover:!bg-brand-dashboard-highlight",variant:"secondary",onClick:e_,disabled:eC,children:eC?"Saving...":"Save"}),(0,r.jsx)(i.Button,{className:"!py-1 rounded-md !px-3 !text-sm text-gray-400 !bg-transparent hover:!bg-brand-dashboard-highlight !border-none",variant:"secondary",onClick:eW,disabled:eC,children:"Cancel"})]})]})}):_?(0,r.jsx)("div",{className:"bg-brand-dashboard-card rounded-xl",style:{padding:"12px 16px 16px 16px"},children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-1 w-full min-w-0 overflow-hidden",children:[(0,r.jsxs)("div",{className:"text-base font-medium",children:["$",W(I,{isInCents:!0,showDecimals:!1})]}),(0,r.jsxs)("div",{className:"text-base font-medium dashboard-text-secondary truncate",children:["/ $",W(O?k:M,{isInCents:!1,showDecimals:!1}),T&&" (Last limit)"]}),T&&(0,r.jsx)(p.A,{className:"w-3 h-3 dashboard-text-secondary ml-0.5 cursor-help","data-tooltip-id":"last-hard-limit-tooltip-overview","data-tooltip-place":"top","data-tooltip-content":"Showing the spending limit that was active when charges were incurred, as you've exceeded your current limit."})]}),(0,r.jsx)(E,{value:I,maxValue:!O&&L>0?L:"number"==typeof k&&k>0?100*k:1}),(0,r.jsx)("div",{className:"dashboard-base dashboard-text-secondary mt-2 min-h-[32px]",children:"Usage-Based Spending this Month"})]}),(0,r.jsx)(i.Button,{className:"w-fit !py-1 rounded-md !px-2 !text-sm text-white disabled:opacity-50 !bg-transparent hover:!bg-transparent",style:{marginTop:"20px"},variant:"secondary",onClick:eU,disabled:ef||ew,children:"Edit Limit"})]})}):"trialing"!==B.subscriptionStatus?(0,r.jsx)("div",{className:"bg-brand-dashboard-card rounded-xl",style:{padding:"12px 16px 16px 16px"},children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsx)("div",{className:"text-base font-medium text-white",children:"Usage-Based Pricing is Off"}),(0,r.jsx)("div",{className:"h-1 w-full mt-2 flex",children:(0,r.jsx)("div",{className:"w-full",style:{height:"4px",backgroundImage:"radial-gradient(circle, rgb(102, 102, 102) 2px, transparent 2px)",backgroundSize:"8px 4px",backgroundPosition:"0 center",backgroundRepeat:"repeat-x",opacity:.3}})}),(0,r.jsx)("div",{className:"dashboard-base dashboard-text-secondary mt-2 min-h-[32px]",children:"Get requests beyond your plan's included quota with Usage-Based Pricing"})]}),(0,r.jsx)(i.Button,{className:"w-fit !py-1 rounded-md !px-2 !text-sm text-white disabled:opacity-50 !bg-transparent hover:!bg-transparent",style:{marginTop:"20px"},variant:"secondary",onClick:eU,disabled:ef||ew,children:"Enable Usage-Based Pricing"})]})}):null},"usage-spend")]}),T&&(0,r.jsx)(f.m_,{id:"last-hard-limit-tooltip-overview",className:"max-w-xs dashboard-base !text-white !bg-[#333] border !border-brand-borders",style:{padding:"8px 12px",fontSize:"12px",borderRadius:"6px"}})]})})(),!el&&(0,r.jsx)(T,{balanceCents:B.customerBalance}),!el&&(()=>{var e,t;let a=!O&&(B.membershipType===v.V.PRO||B.membershipType===v.V.PRO_PLUS||B.membershipType===v.V.ULTRA);if(!O&&!a)return(0,r.jsx)(I.X,{});let n=(()=>{var e;let t=eD(),a=!P&&O;if(0===t.length)return{latestActiveUsers:0,latestLinesOfCode:0,latestTabsAccepted:0,latestRequests:0};let r=a&&J&&"activeUsers"in J&&(null==(e=J.activeUsers)?void 0:e.current)?J.activeUsers.current:0,n=t.reduce((e,t)=>e+t.linesAdded+t.linesDeleted+t.acceptedLinesAdded+t.acceptedLinesDeleted,0);return{latestActiveUsers:r,latestLinesOfCode:n,latestTabsAccepted:t.reduce((e,t)=>e+t.totalTabsAccepted,0),latestRequests:t.reduce((e,t)=>e+t.subscriptionIncluded+t.apikeyreqs+t.usagebasedreqs,0)}})(),i=D===s.acM.OWNER||D===s.acM.FREE_OWNER,l=O&&Y&&P?null!=(t=null==(e=Y.find(e=>e.id===P))?void 0:e.email)?t:"Selected User":"Your",m=2===Q&&(J||q);return(0,r.jsxs)(o.Z,{variant:"dashboard",children:[(0,r.jsxs)("div",{className:"mb-6 flex flex-wrap items-center justify-between gap-3",children:[(0,r.jsx)("div",{className:"flex flex-wrap items-center gap-3 min-w-0",children:(0,r.jsx)("div",{className:"min-w-[180px]",children:(0,r.jsx)(L.U,{customRange:ea,setCustomRange:er})})}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[i&&O&&(0,r.jsx)("div",{className:"min-w-[160px]",children:(0,r.jsx)(F.T,{users:Y,selectedUser:P,onUserSelect:$})}),(O||![v.V.PRO,v.V.PRO_PLUS,v.V.ULTRA].includes(B.membershipType))&&(0,r.jsx)(k.j,{size:"medium",leadingIcon:(0,r.jsx)(g.A,{className:"h-3.5 w-3.5 shrink-0"}),onClick:c,children:"More Analytics"})]})]}),i&&P&&O&&(0,r.jsxs)("div",{className:"dashboard-base mb-4 font-medium",children:["Displaying analytics for: ",l]}),a&&(0,r.jsx)("div",{className:"dashboard-base mb-4 font-medium",children:"Your Analytics"}),3!==Q&&(0,r.jsxs)(C.l,{children:[i&&O&&!P&&(0,r.jsx)(N.N,{value:m?n.latestActiveUsers.toLocaleString():"—",caption:"Total Users",isActive:"dailyUsers"===ed,onClick:()=>ec("dailyUsers")}),(0,r.jsx)(N.N,{value:m?n.latestLinesOfCode.toLocaleString():"—",caption:"Lines of Agent Edits",isActive:"linesOfCode"===ed,onClick:()=>ec("linesOfCode")}),(0,r.jsx)(N.N,{value:m?n.latestTabsAccepted.toLocaleString():"—",caption:"Tabs Accepted",isActive:"tabs"===ed,onClick:()=>ec("tabs")}),O&&(0,r.jsx)(N.N,{value:m?n.latestRequests.toLocaleString():"—",caption:"Chats",isActive:"allRequests"===ed,onClick:()=>ec("allRequests")})]}),(0,r.jsx)("div",{className:"mt-6 min-h-[350px]",children:1===Q||0===Q||X?(0,r.jsx)("div",{className:"flex h-[350px] w-full items-center justify-center",children:(0,r.jsx)(R.K,{})}):3!==Q||a?4===Q?(0,r.jsx)("div",{className:"flex h-[350px] w-full items-center justify-center",children:(0,r.jsx)("div",{className:"dashboard-text-secondary",children:"Could not load analytics data."})}):m?(()=>{switch(ed){case"dailyUsers":return(()=>{let e=eD();if(0===e.length)return(0,r.jsx)("div",{className:"flex h-[350px] w-full items-center justify-center",children:(0,r.jsx)(S.n,{title:"No Analytics Available Yet",description:"Continue using Cursor to view usage analytics and trends"})});let t={chart:{type:"line",height:350,backgroundColor:"transparent"},title:{text:"",style:{color:"var(--foreground)"}},xAxis:{categories:e.map(e=>e.date),labels:{style:{color:"var(--foreground)"}},gridLineColor:"var(--borders)",gridLineWidth:1,tickmarkPlacement:"on"},yAxis:{title:{text:"Users",style:{color:"var(--foreground)"}},labels:{style:{color:"var(--foreground)"}},gridLineColor:"var(--borders)",min:0},series:[{name:"Active Users",data:e.map(e=>e.activeUsers),color:_[0]}],legend:{enabled:!1},tooltip:{backgroundColor:"var(--background)",style:{color:"var(--foreground)"},pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b> active users'},credits:{enabled:!1},plotOptions:{line:{marker:{radius:2},lineWidth:2,states:{hover:{lineWidth:3}}}}};return(0,r.jsx)("div",{className:"h-[350px] w-full",children:(0,r.jsx)(u(),{highcharts:d(),options:t})})})();case"linesOfCode":default:return(()=>{let e=eD();if(0===e.length)return(0,r.jsx)("div",{className:"flex h-[350px] w-full items-center justify-center",children:(0,r.jsx)(S.n,{title:"No Analytics Available Yet",description:"Continue using Cursor to view usage analytics and trends"})});let t={chart:{type:"line",height:350,backgroundColor:"transparent"},title:{text:"",style:{color:"var(--foreground)"}},xAxis:{categories:e.map(e=>e.date),labels:{style:{color:"var(--foreground)"}},gridLineColor:"var(--borders)",gridLineWidth:1,tickmarkPlacement:"on"},yAxis:{title:{text:"Lines",style:{color:"var(--foreground)"}},labels:{style:{color:"var(--foreground)"}},gridLineColor:"var(--borders)",min:0},series:[{name:"Suggested Lines",data:e.map(e=>e.linesAdded+e.linesDeleted),color:_[0]},{name:"Accepted Lines",data:e.map(e=>e.acceptedLinesAdded+e.acceptedLinesDeleted),color:_[1]}],legend:{enabled:!1},tooltip:{backgroundColor:"var(--background)",style:{color:"var(--foreground)"},shared:!0,pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b> lines<br/>'},credits:{enabled:!1}};return(0,r.jsx)("div",{className:"h-[350px] w-full",children:(0,r.jsx)(u(),{highcharts:d(),options:t})})})();case"tabs":return(()=>{let e=eD();if(0===e.length)return(0,r.jsx)("div",{className:"flex h-[350px] w-full items-center justify-center",children:(0,r.jsx)(S.n,{title:"No Analytics Available Yet",description:"Continue using Cursor to view usage analytics and trends"})});let t={chart:{type:"column",height:350,backgroundColor:"transparent"},title:{text:"",style:{color:"var(--foreground)"}},xAxis:{categories:e.map(e=>e.date),labels:{style:{color:"var(--foreground)"}},gridLineColor:"var(--borders)",gridLineWidth:1,tickmarkPlacement:"on"},yAxis:{title:{text:"Tabs",style:{color:"var(--foreground)"}},labels:{style:{color:"var(--foreground)"}},gridLineColor:"var(--borders)",min:0},series:[{name:"Tabs Accepted",data:e.map(e=>e.totalTabsAccepted),color:_[0]}],legend:{enabled:!1},tooltip:{backgroundColor:"var(--background)",style:{color:"var(--foreground)"},shared:!0,pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b> tabs<br/>'},credits:{enabled:!1},plotOptions:{column:{borderWidth:0}}};return(0,r.jsx)("div",{className:"h-[350px] w-full",children:(0,r.jsx)(u(),{highcharts:d(),options:t})})})();case"allRequests":return(()=>{let e=eD();if(0===e.length)return(0,r.jsx)("div",{className:"flex h-[350px] w-full items-center justify-center",children:(0,r.jsx)(S.n,{title:"No Analytics Available Yet",description:"Continue using Cursor to view usage analytics and trends"})});let t={chart:{type:"line",height:350,backgroundColor:"transparent"},title:{text:"",style:{color:"var(--foreground)"}},xAxis:{categories:e.map(e=>e.date),labels:{style:{color:"var(--foreground)"}},gridLineColor:"var(--borders)",gridLineWidth:1,tickmarkPlacement:"on"},yAxis:{title:{text:"Chats",style:{color:"var(--foreground)"}},labels:{style:{color:"var(--foreground)"}},gridLineColor:"var(--borders)",min:0},series:[{name:"Subscription Included",data:e.map(e=>e.subscriptionIncluded||0),color:_[0]},{name:"API Key Chats",data:e.map(e=>e.apikeyreqs||0),color:_[2]},{name:"Usage Based Chats",data:e.map(e=>e.usagebasedreqs||0),color:_[3]}],legend:{enabled:!1},tooltip:{backgroundColor:"var(--background)",style:{color:"var(--foreground)"},shared:!0,pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b> chats<br/>'},credits:{enabled:!1},plotOptions:{line:{marker:{radius:2},lineWidth:2,states:{hover:{lineWidth:3}}}}};return(0,r.jsx)("div",{className:"h-[350px] w-full",children:(0,r.jsx)(u(),{highcharts:d(),options:t})})})()}})():(0,r.jsx)("div",{className:"flex h-[350px] w-full items-center justify-center",children:(0,r.jsx)("div",{className:"dashboard-text-secondary",children:"No analytics data available for the selected period."})}):null})]})})(),(0,r.jsx)(M.Y,{team:O,source:"OVERVIEW",onOpenPrivacyModal:t}),!O&&eH&&!el&&(0,r.jsx)(I.X,{})]})}},18089:(e,t,a)=>{a.d(t,{i:()=>b});var r=a(9381),n=a(51673),s=a(47529),o=a(96486),i=a(86773),l=a(80085),d=a.n(l),c=a(81798),u=a(10689),m=a(34441),h=a(82336),p=a(51455),g=a(67473),x=a(80895),f=a(44064);let b=()=>{let{user:e,isLoading:t}=(0,n.Jd)(),a=(0,c.usePathname)(),{downloadCursor:l,platform:b}=(0,s.useDownload)(),v=(0,u.useContext)(x.Yq),y=(null==v?void 0:v.isLoading)||!1,[w,j]=(0,u.useState)(!1),[N,k]=(0,u.useState)(!1),[C,S]=(0,u.useState)(!1),[E,A]=(0,u.useState)(!1),T=(0,u.useRef)(null);(0,u.useEffect)(()=>{let e="dropdown-animation-styles";if(!document.getElementById(e)){let t=document.createElement("style");t.id=e,t.textContent="\n        @keyframes dropdown-in {\n          from {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          to {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        @keyframes dropdown-out {\n          from {\n            opacity: 1;\n            transform: scale(1);\n          }\n          to {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n        }\n      ",document.head.appendChild(t)}},[]);let R=(0,u.useCallback)(()=>{w&&!N&&(m.Fr?j(!1):(k(!0),setTimeout(()=>{j(!1),k(!1)},150)))},[w,N,m.Fr]);(0,u.useEffect)(()=>{if(!m.Fr)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)};function e(e){T.current&&!T.current.contains(e.target)&&R()}},[R,m.Fr]),(0,u.useEffect)(()=>{if(w&&!m.Fr)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){"Escape"===e.key&&(e.preventDefault(),R())}},[w,R,m.Fr]);let L=(0,u.useCallback)(()=>{(0,f.fQ)(),window.location.href="/api/auth/logout"},[]),M=(0,u.useMemo)(()=>{var t,a,r;if(!e)return"";if(e.name){let r=e.name.split(" ");return((null==(t=r[0])?void 0:t[0])||"")+((null==(a=r[1])?void 0:a[0])||"")}return e.email&&(null==(r=e.email[0])?void 0:r.toUpperCase())||""},[e]),I=(0,u.useCallback)(async t=>{if(!E&&(null==e?void 0:e.email)){A(!0);try{await navigator.clipboard.writeText(e.email),(0,p.oR)("Copied to clipboard",t?{position:t}:void 0),S(!0),setTimeout(()=>{S(!1)},600)}catch(e){console.error("Failed to copy to clipboard:",e)}finally{A(!1)}}},[E,null==e?void 0:e.email]),F=(0,u.useCallback)(()=>{I()},[I]),B=(0,u.useCallback)(()=>{I("top-center")},[I]);return e?(0,r.jsxs)("div",{className:"relative",ref:T,children:[(0,r.jsx)("button",{onClick:()=>{m.Fr?j(!0):w?R():j(!0)},className:"flex h-12 w-12 items-center justify-center rounded-full outline-none focus:outline-none","aria-label":"User menu",children:(0,r.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-gray-500/20",children:(0,r.jsx)("span",{className:"text-sm font-medium",children:M})})}),!m.Fr&&(w||N)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-40",onClick:R}),(0,r.jsxs)("div",{className:"absolute right-0 top-full z-[1000] mt-2 min-w-[220px] p-1 rounded-lg shadow-lg",style:{backgroundColor:"#1b1d21",border:"1px solid #24262a",boxShadow:"0 0 8px 2px color-mix(in srgb, var(--vscode-widget-shadow, rgba(0, 0, 0, 0.36)) 30%, transparent)",opacity:1,transform:"scale(1)",transformOrigin:"top right",transition:"opacity 0.15s ease-out, transform 0.15s ease-out",animation:N?"dropdown-out 0.15s ease-out forwards":"dropdown-in 0.15s ease-out forwards"},children:[(0,r.jsxs)("div",{onClick:F,className:"flex group justify-between items-start hover:bg-white/5 cursor-pointer select-text rounded-[6px] p-2 px-2.5 transition-colors",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-sm font-medium truncate text-gray-300",children:e.name}),(0,r.jsx)("span",{className:"text-xs truncate text-gray-400",children:e.email})]}),C?(0,r.jsx)(o.A,{className:"h-4 w-4 text-gray-300 group-hover:opacity-100 opacity-0 transition-opacity"}):(0,r.jsx)(h.A,{className:"h-4 w-4 text-gray-300 group-hover:opacity-100 opacity-0 transition-opacity"})]}),(0,r.jsxs)("button",{onClick:()=>{l()},className:"flex rounded-[6px] w-full text-gray-300 items-center justify-between p-2 px-2.5 text-sm hover:bg-white/10 transition-colors",children:["Download for ",function(e){switch(e){case"darwin":return"MacOS";case"win32":return"Windows";case"linux":return"Linux";default:return e}}(b)]}),(0,r.jsx)("div",{className:"h-px w-full bg-white/10 my-1"}),(0,r.jsxs)("button",{onClick:L,className:"flex rounded-[6px] w-full text-gray-300 items-center justify-between p-2 px-2.5 text-sm hover:bg-white/10 transition-colors",children:["Log Out ",(0,r.jsx)(i.A,{className:"h-4 w-4 text-gray-300"})]})]})]}),m.Fr&&(0,r.jsx)(g._s.Root,{open:w,onOpenChange:j,children:(0,r.jsxs)(g._s.Portal,{children:[(0,r.jsx)(g._s.Overlay,{className:"fixed inset-0 bg-black/50 z-50"}),(0,r.jsxs)(g._s.Content,{className:"ring-0 min-h-[40vh] outline-none bg-gradient-to-b from-[#17191D] to-[#121315] flex flex-col rounded-t-xl border border-white/10 h-auto max-h-[50vh] fixed bottom-0 left-0 right-0 z-50",children:[(0,r.jsx)("div",{className:"p-4 pb-0",children:(0,r.jsx)(g._s.Handle,{className:"bg-white/20 h-1 w-12 rounded-full mx-auto mb-4"})}),(0,r.jsx)("div",{className:"px-4 pb-4",children:(0,r.jsxs)("div",{onClick:B,className:"flex group justify-between items-center bg-[#1B1D21] hover:bg-white/5 cursor-pointer rounded-lg p-4 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-brand-borders",children:(0,r.jsx)("span",{className:"text-base font-medium",children:M})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-base font-medium text-gray-300",children:e.name}),(0,r.jsx)("span",{className:"text-sm text-gray-400",children:e.email})]})]}),C?(0,r.jsx)(o.A,{className:"h-5 w-5 text-gray-300"}):(0,r.jsx)(h.A,{className:"h-5 w-5 text-gray-300"})]})}),(0,r.jsx)("div",{className:"px-4 pb-4",children:(0,r.jsxs)("button",{onClick:L,className:"flex w-full items-center justify-between bg-[#1B1D21] hover:bg-white/5 rounded-lg p-4 text-base text-gray-300 transition-colors",children:["Log Out ",(0,r.jsx)(i.A,{className:"h-5 w-5 text-gray-300"})]})})]})]})})]}):t||y?null:(0,r.jsx)(d(),{href:a?"/api/auth/login?redirect_uri=".concat(encodeURIComponent(a)):"/api/auth/login",className:"rounded-lg border border-brand-borders px-3 py-2 text-sm hover:bg-brand-borders/20",children:"Sign In"})}},24906:(e,t,a)=>{a.d(t,{Y:()=>l});var r=a(9381),n=a(10689),s=a(82839),o=a(12061),i=a(7566);let l=()=>{let{userApiKeys:e,isUserApiKeysLoading:t,isCreatingUserApiKey:a,isDeletingUserApiKey:l,createUserApiKey:d,deleteUserApiKey:c}=(0,o.M)(),[u,m]=(0,n.useState)(!1),h=(0,n.useCallback)(async e=>{let t=await d(e);return t&&m(!1),t},[d]);return(0,r.jsx)("div",{children:(0,r.jsx)(s.z,{apiKeys:e,isLoading:t,isCreating:a,isDeleting:l,onCreateKey:h,onDeleteKey:c,keyType:"API Key",showInlineCreation:u,onShowInlineCreation:()=>m(!0),onHideInlineCreation:()=>m(!1),emptyStateAction:{label:"New API Key",onClick:()=>m(!0),icon:(0,r.jsx)(i.A,{className:"size-3"})}})})}},27650:(e,t,a)=>{a.d(t,{U:()=>P});var r=a(9381),n=a(51673),s=a(90037),o=a(23899),i=a(54153),l=a(13715),d=a(89858),c=a(24977),u=a(89888),m=a(10689),h=a(37095),p=a(17487),g=a(99651),x=a(85677),f=a(64445),b=a(71579),v=a(17281),y=a(76681),w=a(3278),j=a(20503),N=a(76185),k=a(7845),C=a(11113),S=a(20742),E=a(12061);function A(e){if(null==e)return"";let t=String(e);return t.includes(",")||t.includes("\n")||t.includes('"')?'"'.concat(t.replace(/"/g,'""'),'"'):t}let T=async e=>{try{let t=await fetch("/api/dashboard/get-yearly-upgrade-eligibility",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(new s.DLp({teamId:e}).toJson())});if(!t.ok)throw Error("HTTP error ".concat(t.status));let a=await t.json();return!s.R$$.fromJson(a).eligible}catch(e){return console.error("Error checking team annual billing:",e),!1}};var R=a(82879);let L=e=>{var t;let{team:a,members:n,onAdjustmentComplete:l}=e,d=null!=n?n:0,h=null!=(t=a.purchasedSeats)?t:0,p=d+h,[g,x]=(0,m.useState)(p),[f,b]=(0,m.useState)(!1),[v,y]=(0,m.useState)(null),[w,j]=(0,m.useState)(null),[N,k]=(0,m.useState)(!0);(0,m.useEffect)(()=>{(async()=>{if(a.id){k(!0);try{let e=await T(a.id);j(e)}catch(r){var e,t;console.error("Failed to check annual billing:",r),j(null!=(t=null==(e=a.subscriptionStatus)?void 0:e.includes("yearly"))&&t)}finally{k(!1)}}})()},[a.id,a.subscriptionStatus]);let C=null!=w&&w?384:40,S=null!=w&&w?"year":"month",E=g-p,A=E>0,L=E<0,M=0!==E,I=Math.max(0,g-d),F=p*C,B=g*C,D=Math.abs(E)*C,O=(0,m.useMemo)(()=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}),[]),P=g<n,U=async e=>{e.preventDefault(),b(!0),y(null);try{let e=new s.HZm({teamId:a.id,newSeats:g}),d=await fetch("/api/dashboard/change-seat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!d.ok){var t,r,n,o,i;throw Error(null!=(i=null==(o=(await d.json()).error)||null==(n=o.details)||null==(r=n[0])||null==(t=r.details)?void 0:t.detail)?i:"Failed to update seats")}if(!(await s.lRG.fromJson(await d.json())).success)throw Error("Seat change failed");null==l||l()}catch(e){y(e instanceof Error?e.message:"Failed to update seats")}finally{b(!1)}};return(0,r.jsxs)(c.Z,{className:"flex flex-col gap-4 border-0 bg-brand-dashboard-card p-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(u.o5,{variant:"p1",className:"text-xl font-semibold mb-1",children:"Adjust Team Seats"}),(0,r.jsx)(u.o5,{variant:"p2-mono",className:"text-sm text-brand-neutrals-600",children:N?"Loading billing information...":(0,r.jsxs)(r.Fragment,{children:["Current total: ",p," seats (",d," active +"," ",h," pre-purchased) \xb7"," ",O.format(F),"/",S]})})]}),(0,r.jsxs)("form",{onSubmit:U,className:"space-y-6","aria-disabled":P||N,children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(i.Label,{htmlFor:"seat-count",className:"text-sm font-medium",children:"Total team seats"}),(0,r.jsx)(u.o5,{variant:"p3-mono",className:"text-xs text-brand-neutrals-600 mb-1",children:"Set the total number of seats for your team. This includes both active members and pre-purchased seats."}),(0,r.jsx)("div",{className:"flex items-center gap-3",children:(0,r.jsx)(R.Q,{id:"seat-count",name:"seat-count",ariaLabel:"Total number of team seats",value:g,onChange:x,min:1,decrementFloor:1,emptyBehavior:"zero",disabled:f||N})}),(0,r.jsx)(u.o5,{variant:"p3-mono",className:"text-xs text-brand-neutrals-600",children:N?"Loading pricing information...":"Price per seat: ".concat(O.format(C),"/").concat(S)})]}),(0,r.jsx)("div",{className:"rounded-lg border border-brand-neutrals-800/50 bg-black/20 p-4",children:N?(0,r.jsx)("div",{className:"text-center text-brand-neutrals-600",children:"Loading billing information..."}):(0,r.jsxs)("div",{className:"grid grid-cols-2 items-center gap-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"text-brand-neutrals-600",children:["Current seats (",p,")"]}),(0,r.jsxs)("div",{className:"text-right",children:[O.format(F),"/",S]}),(0,r.jsxs)("div",{className:"text-xs text-brand-neutrals-500 pl-4 flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500/60"}),"Active members: ",d]}),(0,r.jsx)("div",{className:"text-xs text-brand-neutrals-500 text-right"}),(0,r.jsxs)("div",{className:"text-xs text-brand-neutrals-500 pl-4 flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500/60"}),"Pre-purchased: ",h]}),(0,r.jsx)("div",{className:"text-xs text-brand-neutrals-500 text-right"}),M&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"col-span-2 my-2 border-t border-brand-neutrals-800/50"}),(0,r.jsxs)("div",{className:L?"text-red-400":"text-brand-neutrals-600",children:[A?"Additional seats":L?"Seats to remove":"Change"," (",Math.abs(E),")"]}),(0,r.jsxs)("div",{className:"text-right ".concat(L?"text-red-400":""),children:[A?"+":"-",O.format(D),"/",S]})]}),(0,r.jsx)("div",{className:"col-span-2 my-2 border-t border-brand-neutrals-800/50"}),(0,r.jsxs)("div",{className:"font-semibold",children:["New total (",g,")"]}),(0,r.jsxs)("div",{className:"text-right font-semibold",children:[O.format(B),"/",S]}),(0,r.jsxs)("div",{className:"text-xs text-brand-neutrals-500 pl-4 flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500/60"}),"Active members: ",d]}),(0,r.jsx)("div",{className:"text-xs text-brand-neutrals-500 text-right"}),(0,r.jsxs)("div",{className:"text-xs text-brand-neutrals-500 pl-4 flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500/60"}),"Pre-purchased: ",I]}),(0,r.jsx)("div",{className:"text-xs text-brand-neutrals-500 text-right"})]})}),v&&(0,r.jsx)(u.o5,{variant:"p3-mono",className:"text-sm text-red-600",children:v}),(0,r.jsx)(o.Button,{type:"submit",disabled:f||!M||P||N,size:"default",className:"w-full",variant:L?"secondary":"default",children:f?"Processing...":N?"Loading...":M?P?"Cannot remove members":A?"Add ".concat(E," ").concat(1===E?"seat":"seats"):"Remove ".concat(Math.abs(E)," ").concat(1===Math.abs(E)?"seat":"seats"):"Update seats"}),(0,r.jsx)(u.o5,{variant:"p3-mono",className:P?"text-red-400":"text-brand-neutrals-600",children:N?"Loading billing information...":(0,r.jsxs)(r.Fragment,{children:[P&&(0,r.jsxs)(r.Fragment,{children:["You cannot remove active seats from your team. Please remove"," ",n-g," team members first."]}),!P&&(0,r.jsxs)(r.Fragment,{children:[A&&(0,r.jsxs)(r.Fragment,{children:["You'll pay a prorated amount today. Your recurring"," ",S,"ly total will be updated to reflect the new seat count."]}),L&&(0,r.jsxs)(r.Fragment,{children:["You'll receive a prorated credit for removed seats. Your recurring ",S,"ly total will be updated to reflect the new seat count."]}),!M&&(0,r.jsx)(r.Fragment,{children:"Adjust the seat count above to add or remove seats from your team."})]})]})})]})]})};var M=a(34896),I=a(72586);function F(e){let{isOpen:t,onClose:a,currentLimit:n,onSave:s}=e,[d,c]=(0,m.useState)(n&&n>0?String(n):""),[h,g]=(0,m.useState)(!1),[x,f]=(0,m.useState)(null);if(!t)return null;let b=async e=>{e.preventDefault();let t=""===d.trim()?0:parseInt(d.trim(),10);if(Number.isNaN(t)||t<0)return void f("Please enter a non-negative number");f(null),g(!0);try{await s(t),a()}catch(e){f(e instanceof Error?e.message:"Failed to set limit")}finally{g(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,r.jsxs)("div",{className:"relative w-full max-w-md rounded-lg border border-brand-borders bg-[#222222] p-5 dark:border-brand-neutrals-800",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)(u.DZ,{as:"h2",variant:"subheading-2",children:"Set Spend Cap"}),(0,r.jsx)(o.Button,{variant:"secondary",onClick:a,className:"!size-8 !p-0",children:(0,r.jsx)(p.A,{className:"size-4"})})]}),(0,r.jsxs)("form",{onSubmit:b,className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(i.Label,{htmlFor:"limit-input",className:"text-sm font-medium",children:"Limit in USD (0 to clear)"}),(0,r.jsx)(l.p,{id:"limit-input",type:"number",min:0,value:d,onChange:e=>c(e.target.value),className:"!h-9",disabled:h,autoFocus:!0})]}),x&&(0,r.jsx)("div",{className:"text-sm text-red-600",children:x}),(0,r.jsxs)("div",{className:"mt-2 flex justify-end gap-2",children:[(0,r.jsx)("button",{className:"flex items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 hover:text-brand-gray-400",onClick:a,type:"button",disabled:h,children:"Cancel"}),(0,r.jsxs)("button",{className:"flex items-center justify-center rounded-md bg-brand-dashboard-highlight px-4 py-2 hover:text-brand-gray-400",type:"submit",disabled:h,children:[h&&(0,r.jsx)(I.A,{className:"mr-2 size-4 animate-spin"}),"Save"]})]})]})]})})}var B=a(67369);let D=e=>{let{isOpen:t,onClose:a,inviteLink:n,isFetchingLink:s,onCopyLink:d,justCopiedLink:c,onSendInvites:u,isSendingInvites:m,inviteStatus:b,inviteEmails:v,setInviteEmails:y}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm dark:bg-black/50",onClick:a,children:(0,r.jsx)("div",{className:(0,h.cn)("relative w-full max-w-lg rounded-lg border border-brand-borders bg-[#222222] shadow-xl","dark:border-brand-neutrals-800","animate-in fade-in-90 slide-in-from-bottom-10 duration-200 ease-out"),onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"p-5",children:[" ",(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Invite Team Members"}),(0,r.jsx)(o.Button,{variant:"secondary",onClick:a,className:"!size-8 !p-0",children:(0,r.jsx)(p.A,{className:"size-4"})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(i.Label,{className:"text-sm font-medium",children:"Invite link"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.p,{type:"text",value:s?"Loading...":null!=n?n:"Error fetching link",readOnly:!0,className:"!h-9 flex-1 text-sm",disabled:s||!n}),(0,r.jsx)("button",{disabled:s||!n,onClick:d,className:"!h-9 w-[90px] bg-brand-dashboard-highlight rounded-md",children:(0,r.jsxs)("span",{className:"flex items-center justify-center gap-1.5 text-xs",children:[c?(0,r.jsx)(g.A,{className:"size-3.5"}):(0,r.jsx)(x.A,{className:"size-3.5"}),c?"Copied!":"Copy"]})})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(i.Label,{className:"text-sm font-medium",children:"Invite by email"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.p,{type:"email",placeholder:"Email, comma separated",value:v,onChange:e=>y(e.target.value),className:"!h-9 flex-1 text-sm",disabled:m}),(0,r.jsx)("button",{title:"Send invite",onClick:u,disabled:!v||m||!v.split(",").every(e=>/\S+@\S+\.\S+/.test(e.trim())),className:"!h-9 w-[90px] bg-brand-dashboard-highlight rounded-md",children:(0,r.jsxs)("span",{className:"flex items-center justify-center gap-1.5 text-xs",children:[m?(0,r.jsx)(M.K,{}):(0,r.jsx)(f.A,{className:"size-3.5"}),"Send"]})})]})]}),b&&(0,r.jsxs)("div",{className:"mt-1 text-xs",children:[" ",b.successes>0&&(0,r.jsxs)("span",{className:"text-green-600",children:["Sent ",b.successes," invite(s)."," "]}),b.errors.length>0&&(0,r.jsxs)("span",{className:"text-red-600",children:["Failed to send ",b.errors.length," invite(s)."]})]})]})]})})}):null},O=e=>{var t,a;let{member:n,isCurrentUser:o,team:i,viewerRole:l,onRefresh:c,showLimitColumn:u,onLimitChange:p,onRoleChange:g,onNavigateToUsage:x}=e,{setSelectedUserId:f,setSelectedMenu:w}=(0,E.M)(),[j,N]=(0,m.useState)(0),[k,C,S]=(()=>{let[e,t]=(0,m.useState)(null);return[e,e=>t(e),()=>t(null)]})(),[A,T]=(0,m.useState)(!1),[R,L]=(0,m.useState)(null),[I,B]=(0,m.useState)(n.role===s.acM.OWNER?"owner":n.role===s.acM.FREE_OWNER?"free_owner":"member");(0,m.useEffect)(()=>{let e=e=>{if(!e.target)return;let t=e.target,a=document.getElementById("dropdown");a&&!a.contains(t)&&S()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[S]),(0,m.useEffect)(()=>{let e=()=>{S()};return window.addEventListener("click",e),window.addEventListener("scroll",e),()=>{window.removeEventListener("click",e),window.removeEventListener("scroll",e)}},[S]);let D=async()=>{N(3);let e="owner"===I?s.acM.OWNER:"free_owner"===I?s.acM.FREE_OWNER:s.acM.MEMBER,t=n.role;g(n.id,e);try{let t=await fetch("/api/dashboard/change-role",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(new s.$ht({userId:parseInt(n.id,10),teamId:i.id,role:e}).toJson())});if(!t.ok)throw Error("Failed to update role");await s.BrS.fromJson(await t.json()),N(0)}catch(e){console.error("Failed to update role:",e),void 0!==t&&g(n.id,t),N(0)}},O=l===s.acM.OWNER||l===s.acM.FREE_OWNER||o;return(0,r.jsxs)("div",{className:(0,h.cn)("flex w-full flex-row gap-4 overflow-hidden rounded px-3 py-2 transition hover:bg-brand-neutrals-50 dark:hover:bg-brand-neutrals-900",{"bg-brand-neutrals-50 dark:bg-brand-neutrals-900":0!==j||k}),children:[(0,r.jsx)("div",{className:"flex flex-grow flex-row gap-4 overflow-hidden",children:1!==j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{className:"flex w-[150px] items-center gap-2 overflow-hidden text-ellipsis whitespace-nowrap text-sm",children:[(0,r.jsx)("span",{className:"truncate",title:n.name||"Unnamed",children:n.name||"Unnamed"}),o&&(0,r.jsx)(d.E,{variant:"default",className:"!text-xs",children:"You"})]}),(0,r.jsx)("button",{className:"w-[240px] overflow-hidden text-ellipsis whitespace-nowrap text-left text-sm opacity-70 focus:outline-none ".concat(l===s.acM.OWNER||l===s.acM.FREE_OWNER?"hover:underline hover:opacity-100":"","\n              }"),onClick:()=>{(l===s.acM.OWNER||l===s.acM.FREE_OWNER)&&(f(n.id),x?x():w("usage"))},title:"View usage for ".concat(n.email),disabled:l!==s.acM.OWNER&&l!==s.acM.FREE_OWNER,children:n.email||"-"}),(0,r.jsx)("span",{className:"w-[100px] text-sm text-right",children:O?null!=(t=n.fastPremiumRequests)?t:0:""}),(0,r.jsx)("span",{className:"w-[100px] text-sm text-right",children:O?(e=>void 0===e?"$0.00":"$".concat((e/100).toFixed(2)))(n.spendCents):""}),u&&(0,r.jsx)("span",{className:"w-[80px] text-right text-sm",children:O&&void 0!==n.hardLimitOverrideDollars&&null!==n.hardLimitOverrideDollars?"$".concat(n.hardLimitOverrideDollars):"-"})]}):(0,r.jsxs)("span",{className:"text-sm",children:["Are you sure you want to remove"," ",(0,r.jsxs)("b",{children:[n.name||"this member"," (",n.email,")"]}),"?"]})}),(0,r.jsx)("div",{className:"ml-auto flex flex-row gap-3 text-sm",children:0===j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-brand-gray-600",children:(()=>{switch(n.role){case s.acM.OWNER:return"Admin";case s.acM.FREE_OWNER:return"Unpaid Admin";default:return"Member"}})()}),(l===s.acM.OWNER||l===s.acM.FREE_OWNER)&&(0,r.jsx)("button",{onClick:e=>{e.stopPropagation();let t=e.currentTarget.getBoundingClientRect();C({x:t.right+4,y:t.bottom})},children:(0,r.jsx)("span",{className:(0,h.cn)("opacity-70 hover:opacity-90",k&&"opacity-100"),children:(0,r.jsx)(b.A,{className:"size-4"})})})]}):1===j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"cursor-pointer text-brand-gray-600 underline opacity-75 hover:opacity-100",onClick:()=>N(0),children:"Cancel"}),(0,r.jsx)("span",{className:"cursor-pointer text-red-600 underline opacity-75 hover:opacity-100",onClick:()=>{N(3),L(null),fetch("/api/dashboard/remove-member",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(new s.mig({userId:parseInt(n.id,10),teamId:i.id}).toJson())}).then(async e=>{if(200!==e.status)throw await e.json();return e}).then(async e=>s.sX9.fromJson(await e.json())).then(async()=>{await c(),N(0)}).catch(e=>{L(e.error.details[0].details.detail)})},children:"Remove"})]}):2===j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("select",{className:"rounded border border-solid border-[#eaeaea] bg-transparent px-1 outline-none",value:I,onChange:e=>B(e.target.value),children:[(0,r.jsx)("option",{value:"owner",children:"Admin"}),(0,r.jsx)("option",{value:"member",children:"Member"}),i.seats&&i.seats>1&&(0,r.jsx)("option",{value:"free_owner",children:"Unpaid Admin"}),i.seats&&0===i.seats&&(0,r.jsx)("option",{value:"free_owner",disabled:!0,children:"Unpaid Admin"})]}),(0,r.jsx)("span",{className:"cursor-pointer text-brand-gray-600 underline opacity-75 hover:opacity-100",onClick:()=>N(0),children:"Cancel"}),(0,r.jsx)("span",{className:"cursor-pointer underline opacity-75 hover:opacity-100",onClick:D,children:"Save"})]}):3===j?R?(0,r.jsx)("span",{className:"text-xs text-red-600",children:R}):(0,r.jsx)(M.K,{}):null}),k&&(0,r.jsxs)("div",{id:"dropdown",className:"fade-in-fast fixed z-10 flex w-[140px] -translate-x-full flex-col items-start gap-1 rounded border border-solid border-brand-borders bg-brand-white p-1 text-sm text-brand-foreground shadow-sm",style:{left:k.x,top:k.y},onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("button",{className:"flex w-full items-center gap-1.5 rounded px-2 py-1 text-left hover:bg-brand-neutrals-100 dark:hover:bg-brand-neutrals-800",onClick:()=>{S(),N(2),B(n.role===s.acM.OWNER?"owner":n.role===s.acM.FREE_OWNER?"free_owner":"member")},children:[(0,r.jsx)(v.A,{className:"size-4"}),"Change Role"]}),(0,r.jsxs)("button",{className:"flex w-full items-center gap-1.5 rounded px-2 py-1 text-left hover:bg-brand-neutrals-100 dark:hover:bg-brand-neutrals-800",onClick:()=>{S(),T(!0)},children:[(0,r.jsx)(v.A,{className:"size-4"}),"Set Cap"]}),(0,r.jsxs)("button",{className:"flex w-full items-center gap-1.5 rounded px-2 py-1 text-left text-red-600 hover:bg-brand-neutrals-100 dark:hover:bg-brand-neutrals-800",onClick:()=>{S(),N(1)},children:[(0,r.jsx)(y.A,{className:"size-4"}),"Remove"]})]}),(0,r.jsx)(F,{isOpen:A,onClose:()=>T(!1),currentLimit:null!=(a=n.hardLimitOverrideDollars)?a:null,onSave:async e=>{await fetch("/api/dashboard/set-user-hard-limit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:i.id,userId:parseInt(n.id,10),hardLimitDollars:e})}),p(n.id,0===e?null:e),await c()}})]})},P=e=>{let{onNavigateToUsage:t}=e,{user:a}=(0,n.Jd)(),{team:i,refreshTeam:l,getTeamInviteLink:d,sendTeamInvites:h,hardLimitPerUser:p}=(0,E.M)(),[g,x]=(0,m.useState)("name"),[f,b]=(0,m.useState)("asc"),[v,y]=(0,m.useState)(""),[T,R]=(0,m.useState)(!0),[I,F]=(0,m.useState)([]),[P]=(0,m.useState)(50),[U,_]=(0,m.useState)(1),[W,z]=(0,m.useState)(1),[H,J]=(0,m.useState)(0),[V,q]=(0,m.useState)(""),[K,G]=(0,m.useState)(0),[Y,$]=(0,m.useState)({[s.acM.OWNER]:0,[s.acM.FREE_OWNER]:0,[s.acM.MEMBER]:0,[s.acM.UNSPECIFIED]:0}),Z=(0,m.useMemo)(()=>Y[s.acM.OWNER]+Y[s.acM.MEMBER]+Y[s.acM.UNSPECIFIED],[Y]),Q=(0,m.useMemo)(()=>I.some(e=>e.role===s.acM.FREE_OWNER),[I]),[X,ee]=(0,m.useState)(null),[et,ea]=(0,m.useState)(!1),[er,en]=(0,m.useState)(!1),[es,eo]=(0,m.useState)(""),[ei,el]=(0,m.useState)(!1),[ed,ec]=(0,m.useState)(null),[eu,em]=(0,m.useState)(!1),[eh,ep]=(0,m.useState)(!1),[eg,ex]=(0,m.useState)(!1),ef=(null==i?void 0:i.role)||s.acM.MEMBER,eb=(0,m.useMemo)(()=>null!=p&&"no-limit"!==p,[p]);(0,m.useEffect)(()=>{let e=setTimeout(()=>{q(v)},300);return()=>clearTimeout(e)},[v]),(0,m.useEffect)(()=>{(async()=>{if(i&&!X){ea(!0);try{let e=await d();ee(e)}catch(e){console.error("Failed to fetch invite link:",e)}finally{ea(!1)}}})()},[i,d,X]);let ev=e=>/\S+@\S+\.\S+/.test(e.trim()),ey=async()=>{if(!i||!es||!es.split(",").every(ev))return;el(!0),ec(null);let e=es.split(",").map(e=>e.trim()).filter(e=>e);try{let t=await h(e);ec(t),eo(""),console.log("Invites sent:",t)}catch(e){console.error("Failed to send invites:",e),ec({successes:0,errors:["An unexpected error occurred."]})}finally{el(!1),setTimeout(()=>ec(null),5e3)}},ew=(0,m.useCallback)(async()=>{if(i){R(!0);try{let e={teamId:i.id,page:U,pageSize:P,sortBy:g,sortDirection:f};V&&(e.searchTerm=V);let t=await fetch("/api/dashboard/get-team-spend",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json(),r=s.R2E.fromJson(a),n=r.teamMemberSpend.map(e=>({id:String(e.userId),name:e.name||"Unnamed",email:e.email||"",role:e.role,spendCents:e.spendCents,fastPremiumRequests:e.fastPremiumRequests,hardLimitOverrideDollars:e.hardLimitOverrideDollars}));G(Number(r.subscriptionCycleStart)),F(n),z(r.totalPages||1),J(r.totalMembers||0),$(r.totalByRole.reduce((e,t)=>(e[t.role]=t.count,e),{[s.acM.OWNER]:0,[s.acM.FREE_OWNER]:0,[s.acM.MEMBER]:0,[s.acM.UNSPECIFIED]:0}))}catch(e){console.error("Error fetching team members:",e)}finally{R(!1)}}},[i,U,P,g,f,V]);(0,m.useEffect)(()=>{ew()},[ew]);let ej=(0,m.useCallback)(async()=>{await l(),await ew()},[ew,l]);(0,m.useEffect)(()=>{_(1)},[g,f,V]);let eN=e=>{g===e?b("asc"===f?"desc":"asc"):(x(e),"spendCents"===e||"fastPremiumRequests"===e?b("desc"):b("asc"))},ek=e=>g!==e?null:"asc"===f?(0,r.jsx)(w.A,{className:"ml-1 inline-block size-3"}):(0,r.jsx)(j.A,{className:"ml-1 inline-block size-3"}),eC=e=>{_(e)},eS=(e,t)=>{F(a=>a.map(a=>a.id===e?{...a,hardLimitOverrideDollars:null!=t?t:void 0}:a))},eE=(e,t)=>{F(a=>a.map(a=>a.id===e?{...a,role:t}:a))},eA=(0,m.useMemo)(()=>{var e;return null!=(e=null==i?void 0:i.purchasedSeats)?e:0},[i]),eT=(0,m.useMemo)(()=>{var e;return null!=(e=null==i?void 0:i.purchasedSeats)?e:0},[i]),eR=async()=>{if(i&&!eg){ex(!0);try{let e=[],t=1,a=!0,r={teamId:i.id,pageSize:5e3,sortBy:g,sortDirection:f};for(V&&(r.searchTerm=V);a;){let n=await fetch("/api/dashboard/get-team-spend",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,page:t})});if(!n.ok)throw Error("Failed to fetch members page ".concat(t));let o=await n.json(),i=s.R2E.fromJson(o),l=i.teamMemberSpend.map(e=>({name:e.name||"Unnamed",email:e.email||"",role:e.role===s.acM.OWNER?"Admin":e.role===s.acM.FREE_OWNER?"Unpaid Admin":"Member",fastPremiumRequests:e.fastPremiumRequests||0,spendDollars:function(e){return null==e?"":(e/100).toFixed(2)}(e.spendCents),hardLimitOverrideDollars:void 0!==e.hardLimitOverrideDollars&&null!==e.hardLimitOverrideDollars?e.hardLimitOverrideDollars:""}));e.push(...l);let d=i.totalPages||1;a=t<d,t++,a&&await new Promise(e=>setTimeout(e,100))}let n=[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"role",label:"Role"},{key:"fastPremiumRequests",label:"Premium Requests"},{key:"spendDollars",label:"Spend ($)"}];eb&&n.push({key:"hardLimitOverrideDollars",label:"Limit ($)"});let o=function(e,t){return[t.map(e=>A(e.label)).join(","),...e.map(e=>t.map(t=>A(e[t.key])).join(","))].join("\n")}(e,n),l=new Date().toISOString().split("T")[0];!function(e,t){let a=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(a),n=document.createElement("a");n.setAttribute("href",r),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}(o,"team-members-".concat(i.id,"-").concat(l,".csv")),console.log("Successfully exported ".concat(e.length," team members to CSV"))}catch(e){console.error("Error exporting to CSV:",e)}finally{ex(!1)}}};if(!i)return(0,r.jsx)(B.X,{});let eL="flex items-center hover:text-brand-primary focus:outline-none  text-sm";return(0,r.jsxs)("div",{className:"px-6 pb-6",children:[i.seats>0&&"SELF_SERVE"===i.membershipType&&"trialing"!==i.subscriptionStatus&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-brand-dashboard-card rounded-lg border border-brand-borders",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-8",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-sm font-medium text-brand-gray-600 mb-1 flex items-center justify-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500/60"}),Q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{"data-tooltip-id":"billable-seats-tooltip","data-tooltip-place":"top","data-tooltip-content":"Free admins are not billable and do not count towards your seat limit.",children:"Billable Seats"}),(0,r.jsx)(N.A,{className:"size-3.5 cursor-help opacity-70 hover:opacity-100","data-tooltip-id":"billable-seats-tooltip","data-tooltip-place":"top","data-tooltip-content":"Free admins are not billable and do not count towards your seat limit."})]}):(0,r.jsx)("span",{children:"Billable Seats"})]}),(0,r.jsx)("div",{className:"text-2xl font-semibold text-brand-foreground flex justify-center",children:T?(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-4 w-6 bg-brand-dashboard-card/30 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-3 w-4 bg-brand-dashboard-card/30 rounded animate-pulse"})]}):Z})]}),(0,r.jsx)("div",{className:"w-px h-12 bg-brand-borders"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-sm font-medium text-brand-gray-600 mb-1 flex items-center justify-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500/60"}),(0,r.jsx)("span",{"data-tooltip-id":"pre-purchased-seats-tooltip","data-tooltip-place":"top","data-tooltip-content":"These are seats you've already purchased. When a new member joins your team, they will automatically use an available pre-purchased seat.",children:"Pre-Purchased Seats"}),(0,r.jsx)(N.A,{className:"size-3.5 cursor-help opacity-70 hover:opacity-100","data-tooltip-id":"pre-purchased-seats-tooltip","data-tooltip-place":"top","data-tooltip-content":"These are seats you've already purchased. When a new member joins your team, they will automatically use an available pre-purchased seat."})]}),(0,r.jsx)("div",{className:"text-2xl font-semibold text-brand-foreground flex justify-center",children:T?(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("div",{className:"h-4 w-6 bg-brand-dashboard-card/30 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-3 w-4 bg-brand-dashboard-card/30 rounded animate-pulse"})]}):eT>0?eT:eA})]})]}),(ef===s.acM.OWNER||ef===s.acM.FREE_OWNER)&&(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(o.Button,{variant:"secondary",size:"sm",onClick:()=>ep(!0),className:"text-sm",children:"Manage Seats"})})]})}),(0,r.jsxs)("div",{className:"flex w-full flex-row items-center justify-between mb-4",children:[(0,r.jsx)("div",{className:"flex items-center gap-8",children:K>0&&(0,r.jsxs)("span",{className:"text-sm text-brand-gray-600",children:["Fast Requests last reset on:"," ",new Date(K).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex items-center px-2.5 py-1.5 bg-brand-dashboard-card rounded-md w-60",children:(0,r.jsxs)("div",{className:"flex items-center w-full",children:[(0,r.jsx)(k.A,{className:"size-3.5 text-brand-gray-500 mr-2"}),(0,r.jsx)("input",{type:"text",placeholder:"Search members...",value:v,onChange:e=>y(e.target.value),className:"h-7 text-sm w-full border-none bg-transparent outline-none"})]})}),(0,r.jsx)("div",{className:"flex items-center px-2.5 py-1.5 bg-brand-dashboard-card rounded-md",children:(0,r.jsx)("button",{onClick:eR,className:"flex items-center justify-center gap-1.5 h-7 text-sm px-2.5 hover:bg-brand-borders/30 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:T||eg||0===H,children:eg?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.K,{size:"sm"}),"Exporting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.A,{className:"size-3.5"}),"Export CSV"]})})}),(0,r.jsx)("div",{className:"flex items-center px-2.5 py-1.5 bg-brand-dashboard-card rounded-md",children:(0,r.jsx)("button",{onClick:()=>em(!0),className:"flex items-center justify-center gap-1.5 h-7 text-sm px-2.5 hover:bg-brand-borders/30 rounded-md",children:"Invite Team"})})]})]}),(0,r.jsx)(c.Z,{className:"p-4 bg-brand-dashboard-card dark:bg-brand-dashboard-card rounded-xl border-none",children:T?(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex w-full flex-row gap-4 px-3 py-2 text-sm font-semibold text-brand-gray-600",children:[(0,r.jsx)("span",{className:"w-[150px] text-left",children:"Name"}),(0,r.jsx)("span",{className:"w-[240px] text-left",children:"Email"}),(0,r.jsx)("span",{className:"w-[100px] text-right",children:"Premium Requests"}),(0,r.jsx)("span",{className:"w-[100px] text-right",children:"Spend"}),eb&&(0,r.jsx)("span",{className:"w-[80px] text-right",children:"Limit"}),(0,r.jsx)("span",{className:"ml-auto",children:"Role"}),(0,r.jsx)("span",{className:"w-[15px]"})]}),(0,r.jsx)("div",{className:"mt-2 flex flex-col gap-1",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"flex w-full flex-row gap-4 overflow-hidden rounded px-3 py-2",children:[(0,r.jsxs)("div",{className:"flex flex-grow flex-row gap-4 overflow-hidden",children:[(0,r.jsx)("div",{className:"w-[150px] flex items-center gap-2",children:(0,r.jsx)("div",{className:"h-4 w-20 bg-brand-dashboard-card/30 rounded animate-pulse"})}),(0,r.jsx)("div",{className:"w-[240px]",children:(0,r.jsx)("div",{className:"h-4 w-32 bg-brand-dashboard-card/30 rounded animate-pulse"})}),(0,r.jsx)("div",{className:"w-[100px] flex justify-end",children:(0,r.jsx)("div",{className:"h-4 w-8 bg-brand-dashboard-card/30 rounded animate-pulse"})}),(0,r.jsx)("div",{className:"w-[100px] flex justify-end",children:(0,r.jsx)("div",{className:"h-4 w-12 bg-brand-dashboard-card/30 rounded animate-pulse"})}),eb&&(0,r.jsx)("div",{className:"w-[80px] flex justify-end",children:(0,r.jsx)("div",{className:"h-4 w-6 bg-brand-dashboard-card/30 rounded animate-pulse"})})]}),(0,r.jsx)("div",{className:"ml-auto",children:(0,r.jsx)("div",{className:"h-4 w-16 bg-brand-dashboard-card/30 rounded animate-pulse"})}),(0,r.jsx)("div",{className:"w-[15px]"})]},t))})]}):I.length>0?(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex w-full flex-row gap-4 px-3 py-2 text-sm font-semibold text-brand-gray-600",children:[(0,r.jsxs)("button",{onClick:()=>eN("name"),className:"w-[150px] text-left ".concat(eL),children:["Name",ek("name")]}),(0,r.jsxs)("button",{onClick:()=>eN("email"),className:"w-[240px] text-left ".concat(eL),children:["Email",ek("email")]}),(0,r.jsxs)("button",{onClick:()=>eN("fastPremiumRequests"),className:"w-[100px] text-right justify-end ".concat(eL),children:["Premium Requests",ek("fastPremiumRequests")]}),(0,r.jsxs)("button",{onClick:()=>eN("spendCents"),className:"w-[100px] text-right justify-end ".concat(eL),children:["Spend",ek("spendCents")]}),eb&&(0,r.jsx)("span",{className:"w-[80px] text-right flex items-center justify-end hover:text-brand-primary focus:outline-none",children:"Limit"}),(0,r.jsxs)("button",{onClick:()=>eN("role"),className:"ml-auto ".concat(eL),children:["Role",ek("role")]}),(0,r.jsx)("span",{className:"w-[15px]"})," "]}),(0,r.jsx)("div",{className:"mt-2 flex flex-col gap-1",children:I.map(e=>(0,r.jsx)(O,{member:e,isCurrentUser:e.email===(null==a?void 0:a.email),team:i,viewerRole:ef,onRefresh:async()=>{await ej()},showLimitColumn:eb,onLimitChange:eS,onRoleChange:eE,onNavigateToUsage:t},e.id))}),W>1&&(0,r.jsxs)("div",{className:"flex justify-between items-center mt-6 px-3",children:[(0,r.jsxs)("div",{className:"text-sm text-brand-gray-600",children:["Showing ",(U-1)*P+1,"-",Math.min(U*P,H)," of"," ",H," members"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>eC(1),disabled:1===U,className:"p-1 rounded ".concat(1===U?"opacity-50 cursor-not-allowed":"hover:bg-brand-neutrals-100"),"aria-label":"Jump to first page",children:(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("polyline",{points:"11 17 6 12 11 7"}),(0,r.jsx)("polyline",{points:"18 17 13 12 18 7"})]})}),(0,r.jsx)("button",{onClick:()=>eC(U-1),disabled:1===U,className:"p-1 rounded ".concat(1===U?"opacity-50 cursor-not-allowed":"hover:bg-brand-neutrals-100"),"aria-label":"Previous page",children:(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("polyline",{points:"15 18 9 12 15 6"})})}),(0,r.jsxs)("span",{className:"text-sm",children:["Page ",U," of ",W]}),(0,r.jsx)("button",{onClick:()=>eC(U+1),disabled:U===W,className:"p-1 rounded ".concat(U===W?"opacity-50 cursor-not-allowed":"hover:bg-brand-neutrals-100"),"aria-label":"Next page",children:(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("polyline",{points:"9 18 15 12 9 6"})})}),(0,r.jsx)("button",{onClick:()=>eC(W),disabled:U===W,className:"p-1 rounded ".concat(U===W?"opacity-50 cursor-not-allowed":"hover:bg-brand-neutrals-100"),"aria-label":"Jump to last page",children:(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("polyline",{points:"6 17 11 12 6 7"}),(0,r.jsx)("polyline",{points:"13 17 18 12 13 7"})]})})]})]})]}):(0,r.jsx)(u.o5,{className:"text-brand-gray-300 mt-4 text-center",children:v?"No members match your filter criteria.":"No team members found."})}),(0,r.jsx)(S.m_,{id:"pre-purchased-seats-tooltip",className:"max-w-xs !text-white !bg-[#333] border !border-brand-borders",style:{padding:"8px 12px",fontSize:"12px",borderRadius:"6px"}}),(0,r.jsx)(S.m_,{id:"billable-seats-tooltip",className:"max-w-xs !text-white !bg-[#333] border !border-brand-borders",style:{padding:"8px 12px",fontSize:"12px",borderRadius:"6px"}}),(0,r.jsx)(D,{isOpen:eu,onClose:()=>em(!1),inviteLink:X,isFetchingLink:et,onCopyLink:()=>{X&&(navigator.clipboard.writeText(X),en(!0),setTimeout(()=>en(!1),2e3))},justCopiedLink:er,onSendInvites:ey,isSendingInvites:ei,inviteStatus:ed,inviteEmails:es,setInviteEmails:eo}),eh&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm dark:bg-black/50",onClick:()=>ep(!1),children:(0,r.jsx)("div",{className:"relative w-full max-w-2xl rounded-lg border border-brand-borders bg-[#222222] shadow-xl animate-in fade-in-90 slide-in-from-bottom-10 duration-200 ease-out",onClick:e=>e.stopPropagation(),children:(0,r.jsx)("div",{className:"p-1",children:(0,r.jsx)(L,{team:i,members:Z,onAdjustmentComplete:async()=>{window.location.reload()}})})})})]})}},27800:(e,t,a)=>{a.d(t,{W:()=>l});var r=a(90037),n=a(10689);let s=new Map;function o(e){return s.has(e)||s.set(e,{isLoading:!1,error:null,canSend:null,lastSentTimestamp:null,subscribers:new Set}),s.get(e)}function i(e,t){let a=o(e);Object.assign(a,t),a.subscribers.forEach(e=>e())}function l(e,t){let a="".concat(e,"-").concat(t),s=o(a),[,l]=(0,n.useState)({}),d=(0,n.useRef)(()=>l({}));(0,n.useEffect)(()=>{let e=d.current;return s.subscribers.add(e),()=>{s.subscribers.delete(e)}},[s]);let c=(0,n.useCallback)(async()=>{if(!e||!t)return void i(a,{error:"Team ID and request type are required"});i(a,{isLoading:!0,error:null});try{let s="privacy-mode"===t?r.or6.PRIVACY_MODE:r.or6.UNSPECIFIED,o=await fetch("/api/dashboard/get-admin-notification-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:e,requestType:s})});if(!o.ok){var n;let e=await o.json().catch(()=>({}));throw Error((null==e||null==(n=e.error)?void 0:n.message)||"Failed to check admin notification status: ".concat(o.status))}let l=await o.json();i(a,{canSend:l.canSend,lastSentTimestamp:l.lastSentTimestamp||null,isLoading:!1})}catch(e){i(a,{error:e instanceof Error?e.message:"Failed to check admin notification status",isLoading:!1}),console.error("Error checking admin notification status:",e)}},[e,t,a]),u=(0,n.useCallback)(async()=>{if(!e||!t)throw Error("Team ID and request type are required");i(a,{isLoading:!0,error:null});try{let l="privacy-mode"===t?r.or6.PRIVACY_MODE:r.or6.UNSPECIFIED,d=await fetch("/api/dashboard/notify-team-admins",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:e,requestType:l})});if(!d.ok){var n,s,o;let e=await d.json().catch(()=>({}));if(429===d.status||(null==e||null==(s=e.error)||null==(n=s.message)?void 0:n.includes("already sent")))throw Error("Admin notification already sent today. Please try again tomorrow.");throw Error((null==e||null==(o=e.error)?void 0:o.message)||"Failed to send admin notification: ".concat(d.status))}let c=await d.json();if(!c.success)throw Error(c.errorMessage||"Failed to send admin notification");i(a,{canSend:!1,lastSentTimestamp:Date.now(),isLoading:!1})}catch(e){throw i(a,{error:e instanceof Error?e.message:"Failed to send admin notification",isLoading:!1}),console.error("Error sending admin notification:",e),e}},[e,t,a]);return{isLoading:s.isLoading,error:s.error,canSend:s.canSend,lastSentTimestamp:s.lastSentTimestamp,sendNotification:u,checkStatus:c}}},29227:(e,t,a)=>{a.r(t),a.d(t,{Switch:()=>i});var r=a(9381),n=a(24948),s=a(10689),o=a(37095);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.bL,{className:(0,o.cn)("peer inline-flex h-5 w-[34px] shrink-0","rounded-full border-2 border-transparent","bg-brand-borders data-[state=checked]:bg-brand-green-400","cursor-pointer","transition-colors","focus-visible:outline-none focus-visible:ring-2","focus-visible:ring-brand-foreground focus-visible:ring-offset-2","focus-visible:ring-offset-brand-background","disabled:cursor-not-allowed disabled:opacity-50","motion-reduce:transition-none",a),...s,ref:t,children:(0,r.jsx)(n.zi,{className:(0,o.cn)("block h-4 w-4","rounded-full bg-brand-white shadow-lg dark:bg-brand-black","pointer-events-none","transition-transform","data-[state=unchecked]:translate-x-0","data-[state=checked]:translate-x-[14px]","ring-0")})})});i.displayName=n.bL.displayName},30548:(e,t,a)=>{a.d(t,{Y:()=>T});var r=a(9381),n=a(90037),s=a(87020),o=a(93973),i=a(10689),l=a(54392),d=a(8236),c=a(12061),u=a(27800),m=a(83299),h=a(51455),p=a(70529),g=a(93468),x=a(80586);class f{async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await fetch(e,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error(JSON.stringify(await a.json().catch(()=>({error:"Unknown error"}))));return a.json()}async getAuthUrl(){let e=new n._9N({}),t=await this.makeRequest("/api/dashboard/get-linear-auth-url",e.toJson());return n.wet.fromJson(t).authUrl}async disconnect(){let e=new n.Xqi({});await this.makeRequest("/api/dashboard/disconnect-linear",e.toJson())}async getAuthStatus(){let e=new n.xGO({}),t=await this.makeRequest("/api/dashboard/get-linear-status",e.toJson());return JSON.parse(n.zOq.fromJson(t).status)}async startLinearAuth(){let e=await this.getAuthUrl();window.open(e,"_blank")}}let b=new f;var v=a(8231),y=a(91302),w=a(89888),j=a(80325),N=a(28790),k=a(64030);let C=e=>{let{icon:t,title:a,description:n,connectedStatus:s,isConnected:o,isLoading:i=!1,isDisabled:l=!1,errorMessage:d,buttonText:c,onClick:u,hideExternalIcon:m=!1,actionComponent:h}=e;return(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2.5 flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-brand-borders/30 [&>svg]:h-5 [&>svg]:w-5 [&>img]:h-5 [&>img]:w-5",children:t}),(0,r.jsxs)("div",{children:[(0,r.jsx)(w.o5,{className:"text-sm text-brand-gray-900",children:a}),(0,r.jsx)(w.o5,{className:"text-xs text-brand-gray-400 leading-tight",children:n}),o&&s&&(0,r.jsx)(w.o5,{className:"text-brand-gray-500 dark:text-brand-gray-300 text-xs mt-0.5",children:s}),d&&(0,r.jsx)("div",{className:"text-brand-gray-300 text-xs mt-0.5",children:d})]})]}),(0,r.jsx)("div",{className:"self-start sm:self-auto flex-none shrink-0 whitespace-nowrap",children:h||(o?(0,r.jsx)(N.j,{onClick:u,disabled:i||l,trailingIcon:!m&&(0,r.jsx)(j.A,{className:"h-3 w-3 mb-0.5 text-brand-gray-500"}),children:i?"Loading...":c}):(0,r.jsx)(k.B,{onClick:u,disabled:i||l,trailingIcon:!m&&(0,r.jsx)(j.A,{className:"h-3 w-3 mb-0.5 text-[#191C22]"}),children:i?"Loading...":c}))})]})},S=e=>{let{source:t}=e,{githubConnected:a,isLoading:s,installations:l,githubUsernames:d,fetchInstallations:c}=(0,p.d)(),{disconnectGithub:u,isLoading:m}=function(e){let{onSuccess:t}=e,[a,r]=(0,i.useState)(!1),[s,o]=(0,i.useState)(null),[l,d]=(0,i.useState)(null);return{disconnectGithub:async()=>{r(!0),o(null);try{let a=new n.D57({}),r=await fetch("/api/dashboard/disconnect-github",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a.toJson())});if(!r.ok){var e;let t=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw Error((null==(e=t.error)?void 0:e.message)||"Failed to disconnect GitHub")}d("Disconnected"),null==t||t()}catch(t){let e=t instanceof Error?t.message:"Failed to disconnect GitHub";o(e),h.oR.error(e)}finally{r(!1)}},isLoading:a,error:s,result:l}}({onSuccess:()=>c()}),g=i.useMemo(()=>{if(!l||0===l.length)return[];let e=new Set;return l.forEach(t=>{t.repos&&t.repos.length>0&&e.add(t.repos[0].owner)}),Array.from(e).sort()},[l]),x=i.useMemo(()=>{if(!a||0===d.length)return;let e=d.map(e=>"'".concat(e,"'")).join(", ");if(0===g.length)return"Connected as ".concat(e);let t=g.join(", ");return"Connected as ".concat(e," to repositories in GitHub organizations: ").concat(t)},[a,d,g]),f=a?(0,r.jsx)(y.m,{trigger:"Manage",items:[{label:"Manage in GitHub",href:"/api/auth/connect-github?from=website".concat(void 0!==t?"&source=".concat(t):"")},{label:"Disconnect Account",onClick:()=>u()}],isLoading:s||m}):void 0;return(0,r.jsx)(C,{icon:(0,r.jsx)(o.default,{className:"opacity-60",src:"/assets/images/github.svg",alt:"GitHub",width:24,height:24}),title:"GitHub",description:"Connect GitHub for Background Agents, Bugbot and enhanced codebase context",connectedStatus:x,isConnected:a,isLoading:s,buttonText:a?void 0:"Connect",onClick:a?void 0:()=>{window.open("/api/auth/connect-github?from=website".concat(void 0!==t?"&source=".concat(t):""),"_blank")},actionComponent:f})},E=e=>{let{isIntegrationsRestricted:t,isFree:a,isTeamMember:s,team:l,viewerRole:d,onOpenPrivacyModal:c}=e,[m,h]=(0,i.useState)(!1),{slackInstallUrl:p,refreshInstallUrl:x,isEnabled:f}=(0,g.XJ)(),{hasSlackAuth:b}=(0,g.m7)(),{isLoading:v,canSend:y,sendNotification:w,checkStatus:j}=(0,u.W)(null==l?void 0:l.id,"privacy-mode"),N=d===n.acM.OWNER||d===n.acM.FREE_OWNER,k=s&&!N,S=t&&N,E=t&&k&&y&&!v,A=t&&k&&!y,T=async()=>{h(!0);try{fetch("/api/dashboard/log-clicked-connect-slack",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(new n.Not({origin:n.kBR.WEBSITE}))}).catch(e=>{});let e=await x();window.open(e,"_blank","noopener,noreferrer")}catch(e){console.error("Failed to refresh Slack install URL:",e)}finally{h(!1)}},R=async()=>{try{await w(),setTimeout(()=>j(),100)}catch(e){console.error("Failed to send admin notification:",e)}};i.useEffect(()=>{k&&j()},[k,j]);let L=(0,i.useMemo)(()=>S?{text:"Update Privacy Mode",disabled:!1,onClick:c||(()=>window.location.href="/dashboard?tab=settings&openPrivacy=true")}:E?{text:"Request Access",disabled:!1,onClick:R}:A?{text:"Requested",disabled:!0,onClick:()=>{}}:b?{text:"Manage",disabled:!1,onClick:T}:{text:"Connect",disabled:!p||a,onClick:T},[S,E,A,b,p,a,R,T,c]),M=(0,r.jsx)("em",{children:(0,r.jsx)("a",{href:"/privacy-overview",className:"text-brand-accent hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Learn more"})}),I=t?(0,r.jsxs)("div",{children:[N||k?"Slack integration is not supported in Privacy Mode (Legacy). Ask a team admin to switch the team's privacy setting to allow storage.":"Slack integration is not supported in Privacy Mode (Legacy). You must change your privacy setting in the Cursor app (version 1.1+)."," ",M]}):void 0;return f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mx-4",children:(0,r.jsx)("div",{className:"h-px bg-brand-borders"})}),(0,r.jsx)(C,{icon:(0,r.jsx)(o.default,{className:"opacity-60",src:"/assets/images/slack.svg",alt:"Slack",width:24,height:24}),title:"Slack",description:"Work with Background Agents from Slack",isConnected:b,isDisabled:L.disabled,isLoading:m,errorMessage:I,buttonText:L.text,onClick:L.onClick})]}):null},A=e=>{let t,{team:a,viewerRole:l}=e,[d,c]=(0,i.useState)(!1),{isLoading:u,isConnected:m,linearOrgName:h,failedToFetch:p,refetch:g}=function(){var e,t;let[a,r]=(0,i.useState)(!1),[n,s]=(0,i.useState)(null),o=(0,i.useCallback)(async()=>{r(!0);try{let e=await b.getAuthStatus();s({...e,failedToFetch:!1})}catch(e){console.error("Failed to fetch Linear auth status:",e),s({isConnected:!1,failedToFetch:!0})}finally{r(!1)}},[]);return(0,i.useEffect)(()=>{o()},[o]),{isLoading:a,isConnected:null!=(e=null==n?void 0:n.isConnected)&&e,linearOrgName:null==n?void 0:n.linearOrgName,linearUserId:null==n?void 0:n.linearUserId,failedToFetch:null!=(t=null==n?void 0:n.failedToFetch)&&t,refetch:o}}(),x=(0,s.useGateValue)("background_composer_linear_access_allowed"),f=l===n.acM.OWNER||l===n.acM.FREE_OWNER,v=async()=>{c(!0);try{await b.startLinearAuth()}catch(e){console.error("Failed to start linear auth",e),window.location.href="/linear-connected?error_type=connect_linear"}finally{c(!1)}},w=async()=>{c(!0);try{await b.disconnect(),g()}catch(e){console.error("Error during disconnecting Linear",e),window.location.href="/linear-connected?error_type=disconnect_linear"}finally{c(!1)}},j=m?(0,r.jsx)(y.m,{trigger:"Manage",items:[{label:"Manage in Linear",onClick:()=>v()},{label:"Disconnect Account",onClick:()=>w()}],isLoading:u||d}):void 0,N=m&&h?"Connected to: ".concat(h):void 0,k=(null==a?void 0:a.id)&&!f;return(void 0===t&&p&&(t="Failed to load Linear connection status.",k=!0),x)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mx-4",children:(0,r.jsx)("div",{className:"h-px bg-brand-borders"})}),(0,r.jsx)(C,{icon:(0,r.jsx)(o.default,{className:"opacity-60",src:"/assets/images/linear.svg",alt:"Linear",width:24,height:24}),title:"Linear",description:"Spin up Background Agents to work on Linear issues",connectedStatus:N,isConnected:m,isDisabled:k,isLoading:u||d,errorMessage:t,buttonText:m?void 0:"Connect",onClick:m?void 0:v,actionComponent:j})]}):null},T=e=>{let{team:t,source:a,onOpenPrivacyModal:n}=e,{hasAccess:s}=(0,m.v9)(),{isBackgroundAgentsRestricted:o}=(0,x.W)(),{stripeStatus:i,teams:u,viewerRole:h}=(0,c.M)(),p=u.find(e=>e.seats>0),g=p&&(0,d.qc)(p.role),f=i.membershipType===l.V.ENTERPRISE&&!g;return s?(0,r.jsxs)(v.A,{children:[(0,r.jsx)(S,{source:a}),(0,r.jsx)(E,{team:t,isIntegrationsRestricted:o,isFree:i.membershipType===l.V.FREE,isTeamMember:f,viewerRole:h,onOpenPrivacyModal:n}),(0,r.jsx)(A,{team:t,viewerRole:h})]}):null}},34432:(e,t,a)=>{a.d(t,{a:()=>n});var r=a(10689);let n=()=>{let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>(t(!0),()=>t(!1)),[]),e}},37147:(e,t,a)=>{a.d(t,{be:()=>y,u2:()=>g,ue:()=>w});var r=a(9381),n=a(19684),s=a(96486),o=a(56959),i=a(10689),l=a(34441),d=a(92079),c=a(75281);let u=JSON.parse('{"Tj":{"activityBar.background":"#191c22","activityBar.foreground":"#7b88a1","activityBarBadge.background":"#88c0d0","activityBarBadge.foreground":"#1d2128","badge.background":"#88c0d0","badge.foreground":"#1d2128","breadcrumb.activeSelectionForeground":"#d8dee9","breadcrumb.background":"#1e2127","breadcrumb.foreground":"#7b88a199","breadcrumbPicker.background":"#191c22","button.background":"#88c0d0","button.foreground":"#191c22","button.hoverBackground":"#98d5e7","button.secondaryBackground":"#434c5e","button.secondaryForeground":"#d8dee9","button.secondaryHoverBackground":"#4c566a","debugExceptionWidget.background":"#4c566a","debugExceptionWidget.border":"#191c22","debugToolBar.background":"#20242c","diffEditor.insertedTextBackground":"#a3be8c22","diffEditor.removedTextBackground":"#bf616a22","dropdown.background":"#191c22","dropdown.border":"#272c36","dropdown.foreground":"#d8dee9","editor.background":"#1e2127","editor.findMatchBackground":"#88c0d066","editor.findMatchHighlightBackground":"#88c0d033","editor.findRangeHighlightBackground":"#88c0d033","editor.foreground":"#7b88a1","editor.hoverHighlightBackground":"#20242c","editor.inactiveSelectionBackground":"#434c5e77","editor.lineHighlightBackground":"#434c5e33","editor.lineHighlightBorder":"#272930","editor.rangeHighlightBackground":"#434c5e52","editor.selectionBackground":"#434c5e99","editor.selectionHighlightBackground":"#434c5ecc","editor.snippetFinalTabstopHighlightBorder":"#7b88a1","editor.snippetTabstopHighlightBackground":"#7b88a155","editor.wordHighlightBackground":"#81a1c166","editor.wordHighlightStrongBackground":"#81a1c199","editorBracketMatch.background":"#191c2200","editorBracketMatch.border":"#88c0d055","editorCodeLens.foreground":"#4c566a","editorCursor.foreground":"#d8dee9","editorError.border":"#bf616a00","editorError.foreground":"#bf616a","editorGroup.border":"#ffffff0d","editorGroup.dropBackground":"#272c3699","editorGroup.emptyBackground":"#191c22","editorGroupHeader.noTabsBackground":"#191c22","editorGroupHeader.tabsBackground":"#191c22","editorGroupHeader.tabsBorder":"#ffffff0d","editorGutter.addedBackground":"#a3be8c","editorGutter.background":"#1e2127","editorGutter.deletedBackground":"#bf616a","editorGutter.modifiedBackground":"#ebcb8b","editorHoverWidget.background":"#20242c","editorHoverWidget.border":"#272c36","editorIndentGuide.activeBackground":"#4c566a","editorIndentGuide.background":"#434c5eb3","editorInlayHint.background":"#00000000","editorInlayHint.foreground":"#4c566a","editorInlayHint.parameterBackground":"#00000000","editorInlayHint.parameterForeground":"#4c566a","editorInlayHint.typeBackground":"#00000000","editorInlayHint.typeForeground":"#4c566a","editorLineNumber.activeForeground":"#687692","editorLineNumber.foreground":"#4c566a","editorLink.activeForeground":"#88c0d0","editorMarkerNavigation.background":"#5e81acc0","editorMarkerNavigationError.background":"#bf616ac0","editorMarkerNavigationWarning.background":"#ebcb8bc0","editorOverviewRuler.addedForeground":"#a3be8c99","editorOverviewRuler.border":"#00000000","editorOverviewRuler.bracketMatchForeground":"#00000000","editorOverviewRuler.commonContentForeground":"#bf616a","editorOverviewRuler.currentContentForeground":"#bf616a","editorOverviewRuler.deletedForeground":"#bf616a99","editorOverviewRuler.errorForeground":"#bf616a","editorOverviewRuler.findMatchForeground":"#00000000","editorOverviewRuler.incomingContentForeground":"#bf616a","editorOverviewRuler.infoForeground":"#00000000","editorOverviewRuler.modifiedForeground":"#ebcb8b99","editorOverviewRuler.rangeHighlightForeground":"#00000000","editorOverviewRuler.selectionHighlightForeground":"#00000000","editorOverviewRuler.warningForeground":"#ebcb8b","editorOverviewRuler.wordHighlightForeground":"#00000000","editorOverviewRuler.wordHighlightStrongForeground":"#00000000","editorRuler.foreground":"#434c5e","editorSuggestWidget.background":"#191c22","editorSuggestWidget.border":"#272c36","editorSuggestWidget.foreground":"#d8dee9","editorSuggestWidget.highlightForeground":"#88c0d0","editorSuggestWidget.selectedBackground":"#434c5e","editorWarning.border":"#ebcb8b00","editorWarning.foreground":"#ebcb8b","editorWhitespace.foreground":"#4c566ab3","editorWidget.background":"#191c22","editorWidget.resizeBorder":"#88c0d0","errorForeground":"#bf616a","extensionButton.prominentBackground":"#434c5e","extensionButton.prominentForeground":"#d8dee9","extensionButton.prominentHoverBackground":"#4c566a","focusBorder":"#00000000","foreground":"#7b88a1","gitDecoration.addedResourceForeground":"#a3be8c","gitDecoration.deletedResourceForeground":"#bf616a","gitDecoration.ignoredResourceForeground":"#4b5163","gitDecoration.modifiedResourceForeground":"#ebcb8b","gitDecoration.untrackedResourceForeground":"#88c0d0","gitlens.trailingLineForegroundColor":"#6c7d8f99","input.background":"#272c3655","input.border":"#272c36","input.foreground":"#d8dee9","input.placeholderForeground":"#d8dee999","inputOption.activeBorder":"#88c0d0","inputValidation.errorBackground":"#bf616a","inputValidation.errorBorder":"#bf616a","inputValidation.infoBackground":"#81a1c1","inputValidation.infoBorder":"#81a1c1","inputValidation.infoForeground":"#2e3440","inputValidation.warningBackground":"#d08770","inputValidation.warningBorder":"#d08770","list.activeSelectionBackground":"#21242b","list.activeSelectionForeground":"#eceff4","list.deemphasizedForeground":"#7c818e","list.dropBackground":"#88c0d099","list.errorForeground":"#bf616a","list.focusBackground":"#434c5e","list.focusForeground":"#d8dee9","list.highlightForeground":"#88c0d0","list.hoverBackground":"#272c3699","list.hoverForeground":"#eceff4","list.inactiveSelectionBackground":"#21242b","list.inactiveSelectionForeground":"#eceff4","list.invalidItemForeground":"#7c818e","list.warningForeground":"#ebcb8b","menu.background":"#191c22","menu.foreground":"#7b88a1","menu.separatorBackground":"#7b88a1","menubar.selectionBackground":"#7b88a133","merge.border":"#272c3600","merge.currentContentBackground":"#81a1c14d","merge.currentHeaderBackground":"#81a1c166","merge.incomingContentBackground":"#8fbcbb4d","merge.incomingHeaderBackground":"#8fbcbb66","notificationLink.foreground":"#88c0d0","notifications.background":"#191c22","notifications.foreground":"#d8dee9","panel.background":"#191c22","panel.border":"#ffffff0d","panelTitle.activeBorder":"#ffffff00","panelTitle.activeForeground":"#ffffff","panelTitle.inactiveForeground":"#7b88a1","peekView.border":"#4c566a","peekViewEditor.background":"#191c22","peekViewEditor.matchHighlightBackground":"#88c0d0cc","peekViewEditorGutter.background":"#191c22","peekViewResult.background":"#191c22","peekViewResult.fileForeground":"#88c0d0","peekViewResult.lineForeground":"#d8dee966","peekViewResult.matchHighlightBackground":"#88c0d0cc","peekViewResult.selectionBackground":"#434c5e","peekViewResult.selectionForeground":"#d8dee9","peekViewTitle.background":"#272c36","peekViewTitleDescription.foreground":"#d8dee9","peekViewTitleLabel.foreground":"#88c0d0","pickerGroup.border":"#272c3600","pickerGroup.foreground":"#d8dee9","progressBar.background":"#88c0d0","scrollbar.shadow":"#00000000","scrollbarSlider.activeBackground":"#434c5e55","scrollbarSlider.background":"#434c5e55","scrollbarSlider.hoverBackground":"#434c5e55","selection.background":"#88c0d033","sideBar.background":"#191c22","sideBar.border":"#ffffff0d","sideBar.foreground":"#7c818e","sideBarSectionHeader.background":"#191c22","sideBarSectionHeader.foreground":"#4b5163","sideBarTitle.foreground":"#7b88a1","statusBar.background":"#191c22","statusBar.border":"#ffffff0d","statusBar.debuggingBackground":"#434c5e","statusBar.debuggingForeground":"#d8dee9","statusBar.foreground":"#4b5163","statusBar.noFolderBackground":"#191c22","statusBar.noFolderForeground":"#d8dee9","statusBarItem.activeBackground":"#4c566a","statusBarItem.hoverBackground":"#434c5e","statusBarItem.prominentBackground":"#272c36","statusBarItem.prominentHoverBackground":"#434c5e","tab.activeBackground":"#1e2127","tab.activeBorder":"#1e2127","tab.activeBorderTop":"#ffffff00","tab.activeForeground":"#d8dee9","tab.border":"#ffffff0d","tab.hoverBackground":"#88c0d000","tab.inactiveBackground":"#191c22","tab.inactiveForeground":"#4b5163","tab.unfocusedActiveBorder":"#88c0d000","tab.unfocusedActiveForeground":"#d8dee999","tab.unfocusedHoverBackground":"#272c36b3","tab.unfocusedHoverBorder":"#88c0d000","tab.unfocusedInactiveForeground":"#d8dee966","terminal.ansiBlack":"#272c36","terminal.ansiBlue":"#81a1c1","terminal.ansiBrightBlack":"#4c566a","terminal.ansiBrightBlue":"#81a1c1","terminal.ansiBrightCyan":"#8fbcbb","terminal.ansiBrightGreen":"#a3be8c","terminal.ansiBrightMagenta":"#b48ead","terminal.ansiBrightRed":"#bf616a","terminal.ansiBrightWhite":"#eceff4","terminal.ansiBrightYellow":"#ebcb8b","terminal.ansiCyan":"#88c0d0","terminal.ansiGreen":"#a3be8c","terminal.ansiMagenta":"#7d7c9b","terminal.ansiRed":"#bf616a","terminal.ansiWhite":"#e5e9f0","terminal.ansiYellow":"#ebcb8b","terminal.background":"#191c22","terminal.foreground":"#d8dee9","terminal.selectionBackground":"#434c5e55","terminalCursor.background":"#8fbcbb22","terminalCursor.foreground":"#8fbcbb","textLink.activeForeground":"#8fbcbb","textLink.foreground":"#8fbcbb","textPreformat.foreground":"#8fbcbb","textSeparator.foreground":"#8fbcbb","titleBar.activeBackground":"#191c22","titleBar.activeForeground":"#4b5163","titleBar.border":"#ffffff0d","titleBar.inactiveBackground":"#191c22","titleBar.inactiveForeground":"#7b88a199","tree.indentGuidesStroke":"#7b88a155","walkThrough.embeddedEditorBackground":"#191c22","widget.shadow":"#00000066"},"Gb":[{"scope":"emphasis","settings":{"fontStyle":"italic"}},{"scope":"strong","settings":{"fontStyle":"bold"}},{"scope":"comment","settings":{"foreground":"#8597BCA6","fontStyle":"italic"}},{"scope":"constant.character","settings":{"foreground":"#EBCB8B"}},{"scope":"constant.character.escape","settings":{"foreground":"#EBCB8B"}},{"scope":"constant.language","settings":{"foreground":"#81A1C1"}},{"scope":"constant.numeric","settings":{"foreground":"#B48EAD"}},{"scope":"constant.language.boolean.true","settings":{"foreground":"#B48EAD"}},{"scope":"constant.language.boolean.false","settings":{"foreground":"#B48EAD"}},{"scope":"constant.language.undefined","settings":{"foreground":"#7D7C9B"}},{"scope":"constant.language.null","settings":{"foreground":"#7D7C9B"}},{"scope":"constant.regexp","settings":{"foreground":"#EBCB8B"}},{"scope":["entity.name.class","entity.name.type.class"],"settings":{"foreground":"#8FBCBB"}},{"scope":"entity.name.function","settings":{"foreground":"#88C0D0"}},{"scope":"entity.name.tag","settings":{"foreground":"#81A1C1"}},{"scope":"entity.other.attribute-name","settings":{"foreground":"#8FBCBB","fontStyle":"italic"}},{"scope":"entity.other.inherited-class","settings":{"foreground":"#8FBCBB","fontStyle":"bold"}},{"scope":"invalid.deprecated","settings":{"foreground":"#EBCB8B"}},{"scope":"invalid.illegal","settings":{"foreground":"#BF616A"}},{"scope":"keyword","settings":{"foreground":"#81A1C1"}},{"scope":"keyword.operator","settings":{"foreground":"#81A1C1"}},{"scope":"keyword.other.new","settings":{"foreground":"#81A1C1"}},{"scope":"markup.bold","settings":{"fontStyle":"bold"}},{"scope":"markup.changed","settings":{"foreground":"#EBCB8B"}},{"scope":["markup.deleted","punctuation.definition.deleted"],"settings":{"foreground":"#BF616A"}},{"scope":["markup.inserted"],"settings":{"foreground":"#A3BE8C"}},{"scope":"meta.preprocessor","settings":{"foreground":"#5E81AC"}},{"scope":"punctuation","settings":{"foreground":"#ECEFF4"}},{"scope":["punctuation.definition.method-parameters","punctuation.definition.function-parameters","punctuation.definition.parameters"],"settings":{"foreground":"#ECEFF4"}},{"scope":"punctuation.definition.tag","settings":{"foreground":"#81A1C1"}},{"scope":["punctuation.definition.comment","punctuation.end.definition.comment","punctuation.start.definition.comment"],"settings":{"foreground":"#4C566A"}},{"scope":["punctuation.definition.inserted"],"settings":{"foreground":"#A3BE8C"}},{"scope":["punctuation.definition.deleted"],"settings":{"foreground":"#BF616A"}},{"scope":"punctuation.section","settings":{"foreground":"#ECEFF4"}},{"scope":["punctuation.section.embedded.begin","punctuation.section.embedded.end"],"settings":{"foreground":"#81A1C1"}},{"scope":"punctuation.terminator","settings":{"foreground":"#81A1C1"}},{"scope":"punctuation.definition.variable","settings":{"foreground":"#81A1C1"}},{"scope":"storage","settings":{"foreground":"#81A1C1"}},{"scope":"string","settings":{"foreground":"#A3BE8C"}},{"scope":"string.regexp","settings":{"foreground":"#EBCB8B"}},{"scope":"support.class","settings":{"foreground":"#8FBCBB"}},{"scope":"support.constant","settings":{"foreground":"#81A1C1"}},{"scope":"support.function","settings":{"foreground":"#88C0D0"}},{"scope":"support.function.construct","settings":{"foreground":"#81A1C1"}},{"scope":"support.type","settings":{"foreground":"#8FBCBB"}},{"scope":"support.type.exception","settings":{"foreground":"#8FBCBB"}},{"scope":"token.debug-token","settings":{"foreground":"#B48EAD"}},{"scope":"token.error-token","settings":{"foreground":"#BF616A"}},{"scope":"token.info-token","settings":{"foreground":"#88C0D0"}},{"scope":"token.warn-token","settings":{"foreground":"#EBCB8B"}},{"scope":"variable.other","settings":{"foreground":"#D8DEE9"}},{"scope":"variable.language","settings":{"foreground":"#81A1C1"}},{"scope":"variable.parameter","settings":{"foreground":"#D8DEE9"}},{"scope":"punctuation.separator.pointer-access.c","settings":{"foreground":"#81A1C1"}},{"scope":["source.c meta.preprocessor.include","source.c string.quoted.other.lt-gt.include"],"settings":{"foreground":"#8FBCBB"}},{"scope":["source.cpp keyword.control.directive.conditional","source.cpp punctuation.definition.directive","source.c keyword.control.directive.conditional","source.c punctuation.definition.directive"],"settings":{"foreground":"#5E81AC","fontStyle":"bold"}},{"scope":"source.css constant.other.color.rgb-value","settings":{"foreground":"#B48EAD"}},{"scope":"source.css meta.property-value","settings":{"foreground":"#88C0D0"}},{"scope":["source.css keyword.control.at-rule.media","source.css keyword.control.at-rule.media punctuation.definition.keyword"],"settings":{"foreground":"#D08770"}},{"scope":"source.css punctuation.definition.keyword","settings":{"foreground":"#81A1C1"}},{"scope":"source.css support.type.property-name","settings":{"foreground":"#D8DEE9"}},{"scope":"source.diff meta.diff.range.context","settings":{"foreground":"#8FBCBB"}},{"scope":"source.diff meta.diff.header.from-file","settings":{"foreground":"#8FBCBB"}},{"scope":"source.diff punctuation.definition.from-file","settings":{"foreground":"#8FBCBB"}},{"scope":"source.diff punctuation.definition.range","settings":{"foreground":"#8FBCBB"}},{"scope":"source.diff punctuation.definition.separator","settings":{"foreground":"#81A1C1"}},{"scope":"source.go constant.other.placeholder.go","settings":{"foreground":"#EBCB8B"}},{"scope":"source.java comment.block.documentation.javadoc punctuation.definition.entity.html","settings":{"foreground":"#81A1C1"}},{"scope":"source.java constant.other","settings":{"foreground":"#D8DEE9"}},{"scope":"source.java keyword.other.documentation","settings":{"foreground":"#8FBCBB"}},{"scope":"source.java keyword.other.documentation.author.javadoc","settings":{"foreground":"#8FBCBB"}},{"scope":["source.java keyword.other.documentation.directive","source.java keyword.other.documentation.custom"],"settings":{"foreground":"#8FBCBB"}},{"scope":"source.java keyword.other.documentation.see.javadoc","settings":{"foreground":"#8FBCBB"}},{"scope":"source.java meta.method-call meta.method","settings":{"foreground":"#88C0D0"}},{"scope":["source.java meta.tag.template.link.javadoc","source.java string.other.link.title.javadoc"],"settings":{"foreground":"#8FBCBB"}},{"scope":"source.java meta.tag.template.value.javadoc","settings":{"foreground":"#88C0D0"}},{"scope":"source.java punctuation.definition.keyword.javadoc","settings":{"foreground":"#8FBCBB"}},{"scope":["source.java punctuation.definition.tag.begin.javadoc","source.java punctuation.definition.tag.end.javadoc"],"settings":{"foreground":"#4C566A"}},{"scope":"source.java storage.modifier.import","settings":{"foreground":"#8FBCBB"}},{"scope":"source.java storage.modifier.package","settings":{"foreground":"#8FBCBB"}},{"scope":"source.java storage.type","settings":{"foreground":"#8FBCBB"}},{"scope":"source.java storage.type.annotation","settings":{"foreground":"#D08770"}},{"scope":"source.java storage.type.generic","settings":{"foreground":"#8FBCBB"}},{"scope":"source.java storage.type.primitive","settings":{"foreground":"#81A1C1"}},{"scope":["source.js punctuation.decorator","source.js meta.decorator variable.other.readwrite","source.js meta.decorator entity.name.function"],"settings":{"foreground":"#D08770"}},{"scope":"source.js meta.object-literal.key","settings":{"foreground":"#88C0D0"}},{"scope":"source.js storage.type.class.jsdoc","settings":{"foreground":"#8FBCBB"}},{"scope":"source.js string.template punctuation.definition.template-expression","settings":{"foreground":"#5E81AC"}},{"scope":["source.js string.template meta.template.expression support.variable.property","source.js string.template meta.template.expression variable.other.object"],"settings":{"foreground":"#D8DEE9"}},{"scope":"source.js support.type.primitive","settings":{"foreground":"#81A1C1"}},{"scope":"variable.language.this.js","settings":{"foreground":"#B48EAD","fontStyle":"italic"}},{"scope":"meta.tag.js entity.name.tag.js support.class.component.js","settings":{"foreground":"#81A1C1"}},{"scope":"source.js meta.var.expr variable.other.object","settings":{"foreground":"#8FBCBB"}},{"scope":"source.js variable.other.readwrite.alias","settings":{"foreground":"#8FBCBB"}},{"scope":"text.html.basic constant.character.entity.html","settings":{"foreground":"#EBCB8B"}},{"scope":"text.html.basic constant.other.inline-data","settings":{"foreground":"#D08770","fontStyle":"italic"}},{"scope":"text.html.basic meta.tag.sgml.doctype","settings":{"foreground":"#5E81AC"}},{"scope":"text.html.basic punctuation.definition.entity","settings":{"foreground":"#81A1C1"}},{"scope":"source.properties entity.name.section.group-title.ini","settings":{"foreground":"#88C0D0"}},{"scope":"source.properties punctuation.separator.key-value.ini","settings":{"foreground":"#81A1C1"}},{"scope":["text.html.markdown markup.fenced_code.block"],"settings":{"foreground":"#7B88A1"}},{"scope":["text.html.markdown markup.fenced_code.block punctuation.definition"],"settings":{"foreground":"#D8DEE9"}},{"scope":"fenced_code.block.language","settings":{"foreground":"#D8DEE9"}},{"scope":"markup.heading","settings":{"foreground":"#88C0D0"}},{"scope":["text.html.markdown markup.inline.raw","text.html.markdown markup.inline.raw punctuation.definition.raw"],"settings":{"foreground":"#8FBCBB"}},{"scope":"text.html.markdown markup.italic","settings":{"fontStyle":"italic"}},{"scope":"text.html.markdown markup.underline.link","settings":{"fontStyle":"underline"}},{"scope":"text.html.markdown beginning.punctuation.definition.list","settings":{"foreground":"#81A1C1"}},{"scope":"text.html.markdown beginning.punctuation.definition.quote","settings":{"foreground":"#8FBCBB"}},{"scope":"text.html.markdown markup.quote","settings":{"foreground":"#4C566A","fontStyle":"italic"}},{"scope":"text.html.markdown punctuation.definition.heading","settings":{"foreground":"#81A1C1"}},{"scope":["text.html.markdown punctuation.definition.constant","text.html.markdown punctuation.definition.string"],"settings":{"foreground":"#81A1C1"}},{"scope":["text.html.markdown constant.other.reference.link","text.html.markdown string.other.link.description","text.html.markdown string.other.link.title"],"settings":{"foreground":"#88C0D0"}},{"scope":["source.php meta.function-call","source.php meta.function-call.object"],"settings":{"foreground":"#88C0D0"}},{"scope":["source.python entity.name.function.decorator","source.python meta.function.decorator support.type"],"settings":{"foreground":"#D08770"}},{"scope":["source.python meta.function-call","source.python meta.function-call.generic"],"settings":{"foreground":"#88C0D0"}},{"scope":"source.python support.type","settings":{"foreground":"#88C0D0"}},{"scope":["source.python variable.parameter.function.language"],"settings":{"foreground":"#D8DEE9"}},{"scope":["source.python meta.function.parameters variable.parameter.function.language.special.self"],"settings":{"foreground":"#81A1C1"}},{"scope":["source.css.scss punctuation.definition.interpolation.begin.bracket.curly","source.css.scss punctuation.definition.interpolation.end.bracket.curly"],"settings":{"foreground":"#81A1C1"}},{"scope":"source.css.scss variable.interpolation","settings":{"foreground":"#D8DEE9","fontStyle":"italic"}},{"scope":["source.ts punctuation.decorator","source.ts meta.decorator variable.other.readwrite","source.ts meta.decorator entity.name.function","source.tsx punctuation.decorator","source.tsx meta.decorator variable.other.readwrite","source.tsx meta.decorator entity.name.function"],"settings":{"foreground":"#D08770"}},{"scope":["source.ts meta.object-literal.key","source.tsx meta.object-literal.key"],"settings":{"foreground":"#D8DEE9"}},{"scope":["source.ts meta.object-literal.key entity.name.function","source.tsx meta.object-literal.key entity.name.function"],"settings":{"foreground":"#88C0D0"}},{"scope":["source.ts support.class","source.ts support.type","source.ts entity.name.type","source.ts entity.name.class","source.tsx support.class","source.tsx support.type","source.tsx entity.name.type","source.tsx entity.name.class"],"settings":{"foreground":"#8FBCBB"}},{"scope":["source.ts support.constant.math","source.ts support.constant.dom","source.ts support.constant.json","source.tsx support.constant.math","source.tsx support.constant.dom","source.tsx support.constant.json"],"settings":{"foreground":"#8FBCBB"}},{"scope":["source.ts support.variable","source.tsx support.variable"],"settings":{"foreground":"#D8DEE9"}},{"scope":"text.xml entity.name.tag.namespace","settings":{"foreground":"#8FBCBB"}},{"scope":"text.xml keyword.other.doctype","settings":{"foreground":"#5E81AC"}},{"scope":"text.xml meta.tag.preprocessor entity.name.tag","settings":{"foreground":"#5E81AC"}},{"scope":["text.xml string.unquoted.cdata","text.xml string.unquoted.cdata punctuation.definition.string"],"settings":{"foreground":"#D08770","fontStyle":"italic"}},{"scope":"source.yaml entity.name.tag","settings":{"foreground":"#8FBCBB"}}]}'),m=null,h=!1,p=null,g=async()=>{if(!h)return p||(p=(async()=>{try{if(m){h=!0;return}let e=await Promise.all([a.e(7442),a.e(8626),a.e(1562),a.e(633),a.e(6291),a.e(9999)]).then(a.bind(a,86291));m=e,n.wG.config({monaco:e}),e.languages.typescript.typescriptDefaults.setCompilerOptions({target:e.languages.typescript.ScriptTarget.ES2020,allowJs:!0,checkJs:!0,noEmit:!0,noImplicitAny:!0}),e.editor.defineTheme("cursor-high-contrast",{base:"vs-dark",inherit:!0,rules:u.Gb.map(e=>e.scope?(Array.isArray(e.scope)?e.scope:[e.scope]).map(t=>{var a,r;return{token:t,foreground:null==(a=e.settings.foreground)?void 0:a.replace("#",""),background:null==(r=e.settings.background)?void 0:r.replace("#",""),fontStyle:e.settings.fontStyle}}):{}).flat().filter(e=>e.token),colors:{...u.Tj,"editor.foreground":"#D8DEE9","editorLineNumber.foreground":"#556070","editorLineNumber.activeForeground":"#C5CED8","editorCursor.foreground":"#FFFFFF","editor.background":"#00000000","editorGutter.background":"#00000000","editorGroupHeader.tabsBackground":"#00000000","tab.activeBackground":"#00000000","tab.inactiveBackground":"#00000000","diffEditor.insertedTextBackground":"#1f4d2f55","diffEditor.removedTextBackground":"#5a1f294d"}}),n.wG.config({monaco:{...e,editor:{...e.editor}}}),h=!0}catch(e){throw console.error("Failed to configure Monaco:",e),h=!1,p=null,e}})())},x={readOnly:!0,domReadOnly:!0,contextmenu:!1,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:12,lineHeight:18,lineNumbers:l.Fr?"off":"on",glyphMargin:!1,folding:!1,lineDecorationsWidth:14*!l.Fr,lineNumbersMinChars:3*!l.Fr,scrollbar:{verticalScrollbarSize:0,horizontal:"auto",vertical:"hidden",useShadows:!1,alwaysConsumeMouseWheel:!1},alwaysConsumeMouseWheel:!1,wordWrap:"off",automaticLayout:!0,fixedOverflowWidgets:!0,ignoreTrimWhitespace:!1,renderWhitespace:"none",diffCodeLens:!1,diffWordWrap:"off",overviewRulerBorder:!1,overviewRulerLanes:0,hideCursorInOverviewRuler:!0,renderOverviewRuler:!1,enableSplitViewResizing:!1,padding:{top:8,bottom:8},revealHorizontalRightPadding:0,quickSuggestions:!1,parameterHints:{enabled:!1},acceptSuggestionOnCommitCharacter:!1,acceptSuggestionOnEnter:"off",tabCompletion:"off",wordBasedSuggestions:"off",hover:{enabled:!1},links:!1,hideUnchangedRegions:{enabled:!0},useInlineViewWhenSpaceIsLimited:!1},f=()=>{if(!document.getElementById("custom-diff-styles")){let e=document.createElement("style");e.id="custom-diff-styles",e.textContent="\n      /* Added lines background - higher contrast but low glare */\n      .monaco-diff-editor .editor.modified .line-insert,\n      .monaco-diff-editor .editor.modified .char-insert {\n        background-color: #1f3a29 !important;\n      }\n\n      /* Deleted lines background - higher contrast */\n      .monaco-diff-editor .editor.modified .line-delete,\n      .monaco-diff-editor .editor.modified .char-delete {\n        background-color: #3a1f29 !important;\n      }\n\n      /* Unified diff decoration styles (accessible contrast) */\n      .diff-line-added {\n        background-color: #1f3a29 !important;\n        color: #CFE8D0 !important;\n      }\n\n      .diff-line-removed {\n        background-color: #3a1f29 !important;\n        color: #F2C4C8 !important;\n      }\n\n      /* Monaco editor outline removal for specific classes */\n      .monaco-editor .no-user-select,\n      .monaco-editor.mac,\n      .monaco-editor .showUnused,\n      .monaco-editor .showDeprecated,\n      .monaco-editor.vs-dark,\n      .monaco-editor.vs-dark *,\n      .monaco-diff-editor .no-user-select,\n      .monaco-diff-editor.mac,\n      .monaco-diff-editor .showUnused,\n      .monaco-diff-editor .showDeprecated,\n      .monaco-diff-editor.vs-dark,\n      .monaco-diff-editor.vs-dark * {\n        outline: none !important;\n      }\n\n      /* Force transparent backgrounds so parent container color shows */\n      .monaco-editor,\n      .monaco-editor .margin,\n      .monaco-editor .monaco-editor-background,\n      .monaco-editor .scroll-decoration,\n      .monaco-diff-editor .original.monaco-editor,\n      .monaco-diff-editor .modified.monaco-editor,\n      .monaco-diff-editor .original.monaco-editor .margin,\n      .monaco-diff-editor .modified.monaco-editor .margin {\n        background: transparent !important;\n      }\n\n      /* Loading wave animation */\n      .loading-shine {\n        background: linear-gradient(90deg,\n          #1B1D20 0%,\n          #1B1D20 40%,\n          rgba(255, 255, 255, 0.06) 50%,\n          #1B1D20 60%,\n          #1B1D20 100%);\n        background-size: 200% 100%;\n        animation: wave 5s linear infinite;\n        transform: scale(-1, 1);\n      }\n\n      @keyframes wave {\n        0% { background-position: -200% 0; }\n        100% { background-position: 200% 0; }\n      }\n\n      .loading-content {\n        background: #1B1D20;\n        border-radius: 0.5rem;\n        position: relative;\n        overflow: hidden;\n      }\n    ",document.head.appendChild(e)}},b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!m)return;let{enableFind:a=!1}=t;a||["editor.action.deleteLines","editor.action.copyLinesDownAction","editor.action.copyLinesUpAction","editor.action.moveLinesDownAction","editor.action.moveLinesUpAction","editor.action.insertLineAfter","editor.action.insertLineBefore","editor.action.commentLine","editor.action.blockComment","editor.action.formatDocument","editor.action.formatSelection","editor.action.autoFix","editor.action.quickFix","editor.action.rename","editor.action.refactor","editor.action.goToDeclaration","editor.action.goToDefinition","editor.action.goToImplementation","editor.action.goToTypeDefinition","editor.action.referenceSearch.trigger","editor.action.peekDeclaration","editor.action.peekDefinition","editor.action.peekImplementation","editor.action.peekTypeDefinition","editor.action.selectAll","editor.action.expandLineSelection","editor.action.smartSelect.expand","editor.action.smartSelect.shrink","editor.fold","editor.unfold","editor.foldAll","editor.unfoldAll","editor.foldAllBlockComments","editor.foldAllMarkerRegions","editor.action.addCursorsToBottom","editor.action.addCursorsToTop","editor.action.addSelectionToNextFindMatch","editor.action.addSelectionToPreviousFindMatch","editor.action.selectHighlights","editor.action.changeAll","editor.action.quickCommand","editor.action.triggerSuggest","editor.action.triggerParameterHints","editor.action.showHover","editor.action.fontZoomIn","editor.action.fontZoomOut","editor.action.fontZoomReset"].push("actions.find","editor.action.startFindReplaceAction","editor.action.findWithSelection","editor.action.nextMatchFindAction","editor.action.previousMatchFindAction");let r=[{keyMod:m.KeyMod.CtrlCmd,keyCode:m.KeyCode.KeyH},{keyMod:m.KeyMod.CtrlCmd,keyCode:m.KeyCode.KeyG},{keyMod:m.KeyMod.CtrlCmd,keyCode:m.KeyCode.KeyD},{keyMod:m.KeyMod.CtrlCmd,keyCode:m.KeyCode.KeyL},{keyMod:m.KeyMod.CtrlCmd,keyCode:m.KeyCode.KeyZ},{keyMod:m.KeyMod.CtrlCmd,keyCode:m.KeyCode.KeyY},{keyMod:0,keyCode:m.KeyCode.F1},{keyMod:0,keyCode:m.KeyCode.F2},{keyMod:0,keyCode:m.KeyCode.F3},{keyMod:0,keyCode:m.KeyCode.F12},{keyMod:m.KeyMod.Alt,keyCode:m.KeyCode.UpArrow},{keyMod:m.KeyMod.Alt,keyCode:m.KeyCode.DownArrow}];a||r.push({keyMod:m.KeyMod.CtrlCmd,keyCode:m.KeyCode.KeyF}),r.forEach(t=>{let{keyMod:a,keyCode:r}=t;try{e.addCommand(a|r,()=>{})}catch(e){}})};function v(e){let t=0,a=0,r=!1,n=!1,s=!1,o=!1,i=null,l=e.getDomNode();l.addEventListener("touchstart",l=>{let d=l.changedTouches.item(0);if(null==d)return;l.preventDefault=()=>{},t=d.clientX,a=d.clientY;let c=e.getLayoutInfo();r=0>=e.getScrollTop(),n=e.getScrollTop()>=e.getContentHeight()-c.height,s=0>=e.getScrollLeft(),o=e.getScrollLeft()>=e.getContentWidth()-c.width,i=null}),l.addEventListener("touchmove",e=>{let l=e.changedTouches.item(0);if(null!=l){if(null==i){let e=l.clientX-t,d=l.clientY-a;i=Math.abs(e)>Math.abs(d)?e<0&&o||e>0&&s:d<0&&n||d>0&&r}i&&e.stopPropagation()}}),l.addEventListener("touchend",e=>{null!=i&&i&&e.stopPropagation()})}let y=e=>{let{originalText:t,modifiedText:a,fileName:u="",className:m="",compact:h=!1,enableFind:p=!0,viewMode:y="split",onDidMountDiffEditor:w}=e,[j,N]=(0,i.useState)(!h),[k,C]=(0,i.useState)(!1),[S,E]=(0,i.useState)(!1),[A,T]=(0,i.useState)(null),[R,L]=(0,i.useState)(!1),[M,I]=(0,i.useState)(!1),[F,B]=(0,i.useState)(!1),D=(0,i.useRef)(null),O=i.useRef(null),P=i.useRef([]),U=(0,i.useMemo)(()=>(e=>{var t;switch(null==(t=e.split(".").pop())?void 0:t.toLowerCase()){case"js":case"jsx":return"javascript";case"ts":case"tsx":return"typescript";case"py":return"python";case"java":return"java";case"cpp":case"cc":case"cxx":return"cpp";case"c":return"c";case"cs":return"csharp";case"php":return"php";case"rb":return"ruby";case"go":return"go";case"rs":return"rust";case"html":return"html";case"css":return"css";case"scss":return"scss";case"json":return"json";case"md":return"markdown";case"xml":return"xml";case"yaml":case"yml":return"yaml";case"sh":return"shell";default:return"plaintext"}})(u),[u]);(0,i.useEffect)(()=>{C(!0),f(),(async()=>{try{await g(),E(!0)}catch(e){console.error("Failed to initialize Monaco:",e)}})()},[]),(0,i.useEffect)(()=>()=>{if(P.current.forEach(e=>{try{e.dispose()}catch(e){console.warn("Error disposing listener:",e)}}),P.current=[],O.current){try{O.current.dispose()}catch(e){console.warn("Error disposing diff editor:",e)}O.current=null}},[]);let _=(0,i.useMemo)(()=>t.split("\n"),[t]),W=(0,i.useMemo)(()=>a.split("\n"),[a]),z=(0,i.useMemo)(()=>Math.max(0,W.length-_.length),[W,_]),H=(0,i.useMemo)(()=>Math.max(0,_.length-W.length),[_,W]),J=(0,i.useMemo)(()=>Math.min(_.length,W.length),[_,W]),V=(0,i.useMemo)(()=>18*J+16,[J,18]),q=(0,i.useCallback)(async e=>{e.stopPropagation();try{await navigator.clipboard.writeText(u),I(!0),setTimeout(()=>I(!1),1500)}catch(e){console.error("Failed to copy filename:",e)}},[u]);if(!k||!S)return k?(0,r.jsx)("div",{className:"rounded-md rounded-t-none border ".concat(!j?" border-white/10":"border-transparent"," h-[34px] overflow-hidden ").concat(m),children:(0,r.jsx)("div",{className:"loading-shine w-full h-full"})}):(0,r.jsx)("div",{className:"h-[34px] rounded-md border ".concat(j?"border-transparent":" border-white/10"," overflow-hidden"),children:(0,r.jsx)("div",{className:"loading-shine w-full h-full"})});if(t===a)return(0,r.jsx)("div",{className:"flex flex-col gap-0",children:(0,r.jsx)("div",{className:"rounded-lg ".concat(!j?"border border-white/10":"border-transparent"," ").concat(m),children:(0,r.jsx)("div",{className:"flex items-center justify-between py-1 px-2",children:(0,r.jsx)("div",{className:"flex items-center gap-1 min-w-0 flex-1",children:(0,r.jsx)("span",{className:"text-white/30 text-xs flex items-center gap-1 flex-shrink-0",children:"Changes are not committed yet"})})})})});if(h){let e=j?A?"".concat(A,"px"):"".concat(V,"px"):"240px",i={...x,lineNumbers:"off",lineDecorationsWidth:0,lineNumbersMinChars:0,renderSideBySide:!1};return(0,r.jsx)("div",{className:"flex flex-col gap-0",children:(0,r.jsxs)("div",{className:"bg-[#17191d] rounded-lg ".concat(!j?"cursor-pointer":""," border border-gray-500/10 ").concat(m),onClick:()=>{j||N(!0)},onMouseEnter:()=>{l.Fr||B(!0)},onMouseLeave:()=>{l.Fr||B(!1)},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between py-1 px-1 pl-2 ".concat(j?"cursor-pointer":""),onClick:()=>{j&&N(!1)},onMouseEnter:()=>{var e;return null==(e=D.current)?void 0:e.startAnimation()},onMouseLeave:()=>{var e;return null==(e=D.current)?void 0:e.stopAnimation()},children:[(0,r.jsxs)("div",{className:"flex items-center min-w-0 flex-1 gap-1",children:[(0,r.jsx)("div",{className:"text-[11px] text-gray-300 font-medium truncate min-w-0 flex-shrink",children:u}),z>0&&(0,r.jsxs)("span",{className:"text-[#A3BE8C] text-[11px] flex items-center gap-1 flex-shrink-0",children:["+",z]}),H>0&&(0,r.jsxs)("span",{className:"text-[#BF616A] text-[11px] flex items-center gap-1 flex-shrink-0",children:["-",H]}),u&&(0,r.jsx)("button",{onClick:q,className:"flex items-center justify-center hover:bg-white/5 transition-all p-1 rounded text-white/60 hover:text-white/80 ml-1 ".concat(F||M||l.Fr&&j?"opacity-100":"opacity-0"),"aria-label":"Copy file name",children:M?(0,r.jsx)(s.A,{size:12,className:"text-gray-300"}):(0,r.jsx)(o.A,{size:12})})]}),(0,r.jsx)("div",{className:"flex items-center gap-1",children:(0,r.jsx)("button",{className:"flex items-center justify-center hover:bg-white/5 transition-colors p-1 rounded text-white/60","aria-label":"Expand diff",children:j?(0,r.jsx)(d.f,{ref:D,size:16}):(0,r.jsx)(c.p,{ref:D,size:16})})})]}),j&&(0,r.jsx)("div",{className:"rounded-bl-lg rounded-br-lg overflow-hidden ".concat(m),children:(0,r.jsx)(n.zC,{height:e,language:U,original:t,modified:a,theme:"cursor-high-contrast",options:i,onMount:e=>{O.current=e,f();let t=()=>{let t=e.getOriginalEditor(),a=e.getModifiedEditor();t&&a&&T(Math.max(t.getContentHeight(),a.getContentHeight()))};t();let a=e.getOriginalEditor(),r=e.getModifiedEditor(),n=a.onDidContentSizeChange(t),s=r.onDidContentSizeChange(t);P.current.push(n,s),v(a),v(r),b(e,{enableFind:p})}},"diff-editor-compact-".concat(u,"-").concat(t.length,"-").concat(a.length,"-").concat(y))})]})})}let K={...x,renderSideBySide:"split"===y,lineNumbersMinChars:l.Fr?0:"unified"===y?2*Math.max(2,Math.max(_.length,W.length).toString().length)+1:x.lineNumbersMinChars},G=A||V;return(0,r.jsx)("div",{className:"rounded-lg overflow-hidden ".concat(m),style:{display:R?"block":"none"},children:(0,r.jsx)(n.zC,{height:G,language:U,original:t,modified:a,theme:"cursor-high-contrast",options:K,onMount:e=>{O.current=e,f();let t=()=>{let t=e.getOriginalEditor(),a=e.getModifiedEditor();t&&a&&T(Math.max(t.getContentHeight(),a.getContentHeight()))};t();let a=e.getOriginalEditor(),r=e.getModifiedEditor(),n=a.onDidContentSizeChange(t),s=r.onDidContentSizeChange(t);P.current.push(n,s),v(a),v(r),b(e,{enableFind:p}),L(!0),null==w||w(e)}},"diff-editor-".concat(u,"-").concat(t.length,"-").concat(a.length,"-").concat(y))})};i.memo(e=>{let{diffString:t,fileName:a="",chunkIndex:n,compact:s=!1,enableFind:o=!0,includeBottomMargin:l=!0}=e,d=t.split("\n"),{originalLines:c,modifiedLines:u}=(0,i.useMemo)(()=>(e=>{let t=[],a=[],r=[/^diff --git /,/^index [0-9a-f]{7,}/,/^--- /,/^\+\+\+ /,/^@@/,/^\\ No newline at end of file/];return e.forEach(e=>{if(!r.some(t=>t.test(e)))if(e.startsWith("-"))t.push(e.slice(1));else if(e.startsWith("+"))a.push(e.slice(1));else{let r=e.startsWith(" ")?e.slice(1):e;t.push(r),a.push(r)}}),{originalLines:t,modifiedLines:a}})(d),[d]),m=c.join("\n"),h=u.join("\n");return(0,r.jsx)("div",{className:l?"mb-4":"",children:(0,r.jsx)(y,{originalText:m,modifiedText:h,fileName:a,compact:s,enableFind:o})},n)}).displayName="DiffChunk";let w=e=>["package-lock.json","pnpm-lock.yaml","yarn.lock","bun.lockb","Cargo.lock","Pipfile.lock","composer.lock","Gemfile.lock","poetry.lock"].includes(e.split("/").pop()||"")},39802:(e,t,a)=>{a.d(t,{_:()=>n});var r=a(10689);function n(){let[e,t]=(0,r.useState)(!1),[a,n]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{try{var e;let a=await fetch("/api/dashboard/check-user-api-key-access",{method:"POST",headers:{"Content-Type":"application/json"}});if(!a.ok){console.error("Failed to check user API key access"),t(!1);return}let r=await a.json();t(null!=(e=r.hasAccess)&&e)}catch(e){console.error("Error checking user API key access:",e),t(!1)}finally{n(!1)}})()},[]),{hasAccess:e,isLoading:a}}},40897:(e,t,a)=>{a.d(t,{Y:()=>i});var r=a(9381),n=a(10689),s=a(17487),o=a(82429);let i=(0,n.forwardRef)((e,t)=>{let{elementName:a,tokens:i,onChange:l,placeholder:d,readOnly:c=!1,suggestions:u=[],isLoadingSuggestions:m=!1,formatting:h="none",dropdown:p,onPendingChange:g,error:x}=e,[f,b]=(0,n.useState)(""),[v,y]=(0,n.useState)(!1),[w,j]=(0,n.useState)(!1),[N,k]=(0,n.useState)(-1),C=(0,n.useRef)(null),S=(0,n.useRef)(null),E=(0,n.useRef)(null),A=e=>{let t=e.trim();return"lowercase"===h?t.toLowerCase():"uppercase"===h?t.toUpperCase():t};(0,n.useEffect)(()=>{if(S.current&&N>=0&&w){let e=S.current,t=36*N,a=t+36,r=e.scrollTop,n=e.clientHeight;a>r+n?e.scrollTop=a-n:t<r&&(e.scrollTop=t)}},[N,w]),(0,n.useEffect)(()=>()=>{E.current&&clearTimeout(E.current)},[]);let T=u.filter(e=>e.toLowerCase().includes(f.toLowerCase())&&!i.includes(e)),R=e=>{let t=A(e||f.trim());t&&!i.includes(t)&&(l([...i,t]),b(""),null==g||g(!1),j(!1),k(-1))},L=e=>{R(e)};return(0,n.useImperativeHandle)(t,()=>({hasPending:()=>f.trim().length>0,tokenizePending:()=>{if(c)return null;let e=f.trim();return e.length>0?A(e):null},commitPending:()=>{if(c)return null;let e=f.trim();if(e.length>0){let t=A(e);return R(),t}return null},getPendingValue:()=>f,clearPending:()=>{b(""),null==g||g(!1),j(!1),k(-1)}})),(0,r.jsxs)("div",{className:"dashboard-tokenized-input relative"+(x?" dashboard-tokenized-input--error":""),children:[p&&(0,r.jsxs)("div",{className:"dashboard-input-modifier",children:[(0,r.jsx)(o.A,{value:p.value,options:p.options,onChange:p.onChange,buttonClassName:"h-full px-2"}),(0,r.jsx)("div",{className:"dashboard-input-modifier-divider"})]}),(0,r.jsxs)("div",{className:"dashboard-token-cloud",children:[i.map(e=>(0,r.jsxs)("div",{className:"dashboard-token",children:[(0,r.jsx)("span",{className:"truncate",children:e}),!c&&(0,r.jsx)("button",{onClick:()=>{!c&&l(i.filter(t=>t!==e))},className:"text-brand-gray-400 hover:text-white transition-colors p-0 bg-none border-none cursor-pointer","aria-label":"Remove ".concat(e),children:(0,r.jsx)(s.A,{size:10})})]},e)),!c&&(0,r.jsx)("input",{ref:C,type:"text",value:f,onChange:e=>{if(c)return;let t=e.target.value;if(t.includes(",")){var a;let e=t.split(","),r=null!=(a=e.pop())?a:"",n=e.map(e=>A(e)).filter(e=>e.length>0&&!i.includes(e));n.length>0&&l([...i,...n]),t=r}b(t),null==g||g(t.trim().length>0),k(-1),j(t.trim().length>0&&u.length>0)},onKeyDown:e=>{if(!c){if(w&&T.length>0){if("ArrowDown"===e.key)e.preventDefault(),k(e=>e<T.length-1?e+1:0);else if("ArrowUp"===e.key)e.preventDefault(),k(e=>e>0?e-1:T.length-1);else if("Enter"===e.key){e.preventDefault(),N>=0?L(T[N]):R();return}}"Enter"===e.key?(e.preventDefault(),R()):"Escape"===e.key?(b(""),j(!1),k(-1)):"Backspace"===e.key&&""===f&&(e.preventDefault(),i.length>0&&l(i.slice(0,-1)))}},onFocus:()=>{y(!0),f.trim().length>0&&u.length>0&&j(!0)},onBlur:()=>{y(!1),E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{j(!1),k(-1)},200)},placeholder:0===i.length?d||"Add ".concat(a,"..."):"",className:"dashboard-tokenized-input-value",style:{minWidth:i.length>0&&""===f.trim()&&!v?"30px":"60px"}}),c&&0===i.length&&(0,r.jsx)("span",{className:"text-xs text-brand-gray-400 italic",children:"No users in list"})]}),w&&!c&&(0,r.jsx)("div",{ref:S,className:"absolute top-full left-0 right-0 z-50 mt-1 bg-gray-800 border border-brand-borders rounded-md shadow-lg max-h-48 overflow-y-auto",children:m?(0,r.jsx)("div",{className:"flex justify-center items-center py-4",children:(0,r.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-brand-gray-400 border-b-transparent"})}):T.length>0?T.map((e,t)=>(0,r.jsx)("div",{className:"px-3 py-2 text-sm cursor-pointer transition-colors ".concat(t===N?"bg-blue-600 text-white":"text-brand-gray-300 hover:bg-gray-700"),onClick:()=>L(e),onMouseEnter:()=>k(t),children:e},e)):f.trim().length>0?(0,r.jsx)("div",{className:"px-3 py-2 text-sm text-brand-gray-400 italic",children:"No suggestions found"}):null})]})});i.displayName="TokenInput"},42136:(e,t,a)=>{a.d(t,{q:()=>u});var r=a(9381),n=a(12061),s=a(83299),o=a(39802),i=a(24906),l=a(74906),d=a(30548),c=a(51024);let u=e=>{let{onOpenPrivacyModal:t}=e,{hasAccess:a}=(0,s.v9)(),{hasAccess:u}=(0,o._)(),{team:m}=(0,n.M)();return a?(0,r.jsxs)("div",{className:"dashboard-settings-chunk",children:[(0,r.jsx)(l.T,{title:"Integrations"}),(0,r.jsxs)("div",{className:"dashboard-sections",children:[(0,r.jsx)(d.Y,{team:m,source:"INTEGRATIONS",onOpenPrivacyModal:t}),u&&(0,r.jsx)(i.Y,{})]})]}):(0,r.jsxs)("div",{className:"dashboard-settings-chunk",children:[(0,r.jsx)(l.T,{title:"Integrations"}),(0,r.jsx)(c._,{featureName:"Integrations"})]})}},44375:(e,t,a)=>{a.d(t,{R:()=>u});var r=a(9381),n=a(29227),s=a(43693),o=a(95612),i=a(28790),l=a(25289),d=a(8231),c=a(40897);let u=e=>{let{autoRunControls:t,onUpdate:a,onSave:u,isLoading:m,isSaving:h,error:p,saveSuccess:g,className:x}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(l.w,{label:"Auto-Run",children:(0,r.jsxs)(d.A,{trailingCaption:p?(0,r.jsx)("div",{className:"dashboard-text-red-primary",children:p}):"",children:[(0,r.jsx)(o.J,{label:(0,r.jsxs)(r.Fragment,{children:["Auto-Run Mode ",(0,r.jsx)(s.m,{label:"v0.49+"})]}),description:"Allow Agent to run tools like command execution and file writes without asking for confirmation",trailingItems:(0,r.jsx)(n.Switch,{checked:t.enabled,disabled:m||h,onCheckedChange:e=>{a({...t,enabled:e})}})}),t.enabled&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.J,{label:"Allowed Commands",description:(0,r.jsxs)(r.Fragment,{children:["Add patterns to the allow list allow certain commands to run automatically."," ",(0,r.jsx)("strong",{children:"When empty, all commands require manual approval"}),"."]})}),(0,r.jsx)("div",{className:"dashboard-tokenized-input-cell",children:(0,r.jsx)(c.Y,{elementName:"command",tokens:t.allowed,onChange:e=>a({...t,allowed:e}),formatting:"none",placeholder:"Enter command patterns, comma separated (e.g., 'npm', 'git')",readOnly:m||h})}),t.blocked.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.J,{label:"Blocked Commands (Deprecated)",description:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("strong",{children:"Warning:"})," The command blocklist is often bypassable, providing a false sense of security. Consider using the allowlist approach instead for better security."]})}),(0,r.jsx)("div",{className:"dashboard-tokenized-input-cell",children:(0,r.jsx)(c.Y,{elementName:"command",tokens:t.blocked,onChange:e=>a({...t,blocked:e}),formatting:"none",placeholder:"Enter command pattern (e.g., 'rm -rf', 'sudo')",readOnly:m||h})})]}),(0,r.jsx)(o.J,{label:"Delete File Protection",description:"When enabled, prevents the agent from deleting files automatically.",trailingItems:(0,r.jsx)(n.Switch,{checked:t.deleteFileProtection,disabled:m||h,onCheckedChange:e=>{a({...t,deleteFileProtection:e})}})}),(0,r.jsx)(o.J,{label:"MCP Tool Protection",description:"When enabled, prevents the agent from running MCP Tools automatically.",trailingItems:(0,r.jsx)(n.Switch,{checked:t.disableMcpAutoRun,disabled:m||h,onCheckedChange:e=>{a({...t,disableMcpAutoRun:e})}})})]}),(0,r.jsx)("div",{className:"flex justify-end py-4 pr-4",children:(0,r.jsx)(i.j,{onClick:u,disabled:m||h,color:p?"red":"default",children:h?"Saving...":p?"Try Again":!0===g?"Saved ✓":"Save"})})]})})})}},45150:(e,t,a)=>{a.d(t,{s:()=>X});var r=a(9381),n=a(90037),s=a(89888),o=a(13715),i=a(23899),l=a(29227),d=a(37095),c=a(54531),u=a(58351),m=a(10689),h=a(26250),p=a(10645),g=a(71579),x=a(99651),f=a(85677),b=a(24349),v=a(48497),y=a(3278),w=a(54392),j=a(40021),N=a(59303),k=a(12061),C=a(6259),S=a(39802),E=a(82839),A=a(76160),T=a(95612),R=a(28790),L=a(25289),M=a(8231),I=a(64149),F=a(34896);function B(e){let{teamId:t}=e,[a,n]=(0,m.useState)([]),[s,o]=(0,m.useState)(!0),[i,l]=(0,m.useState)(null),[d,u]=(0,m.useState)(!0),h=(0,m.useCallback)(async()=>{l(null);try{let e=await fetch("/api/dashboard/list-team-invite-links",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({team_id:t})});if(!e.ok)throw Error("Failed to load invite links");let a=await e.json();n(a.inviteLinks||[]),o(!1)}catch(e){console.error("Failed to load invite links:",e),l("Failed to load invite links. Please try again."),o(!1)}},[t]);(0,m.useEffect)(()=>{h()},[t,h]);let p=async e=>{try{let t=e.split("=").pop()||"",a=await fetch("/api/dashboard/revoke-team-invite-link",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({invite_code:t})});if(!a.ok){let e=await a.text()+" "+a.statusText;throw console.error("Failed to revoke invite link:",e),Error("Failed to revoke invite link",{cause:e})}await h()}catch(e){console.error("Failed to revoke invite link:",e),l("Failed to revoke invite link. Please try again.")}};return s?(0,r.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,r.jsx)(F.K,{})}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(L.w,{label:"Team Invite Codes",children:(0,r.jsxs)(M.A,{trailingCaption:i&&(0,r.jsx)("div",{className:"text-brand-red-400 text-sm",children:i}),children:[(0,r.jsx)(T.J,{label:"Active Invite Codes",description:"Manage active invite codes for your team. You can revoke any invite code at any time.",trailingItems:(0,r.jsxs)(R.j,{onClick:()=>u(!d),className:"w-fit",children:[d?"Show":"Hide"," Active Codes"]})}),0===a.length?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(I.n,{title:"No Active Invite Links Found",description:"Active links appear here"})}):(0,r.jsx)(r.Fragment,{children:!d&&(0,r.jsx)(r.Fragment,{children:a.map(e=>(0,r.jsx)(T.J,{label:e.inviteLink,description:(0,r.jsxs)(r.Fragment,{children:["Expires:"," ",(0,c.m)(new Date(parseInt(e.validUntil)),{addSuffix:!0})]}),trailingItems:(0,r.jsx)(R.j,{onClick:()=>p(e.inviteLink),color:"red",children:"Revoke"})},e.inviteLink))})})]})})})}var D=a(43693),O=a(64030),P=a(74906),U=a(40897),_=a(44375),W=a(61126);function z(){let{team:e,isBedrockValidating:t,bedrockValidationError:a,bedrockValidationSuccess:n,validateAndSaveBedrockIamRole:s,deleteBedrockIamRole:o}=(0,k.M)(),i=null==e?void 0:e.bedrockIamRole,l=null==e?void 0:e.bedrockExternalId,[d,c]=(0,m.useState)(i||""),[u,h]=(0,m.useState)("us-east-1"),[p,g]=(0,m.useState)("us.anthropic.claude-3-5-sonnet-20241022-v2:0"),[f,b]=(0,m.useState)(!1),[v,y]=(0,m.useState)(null),[w,j]=(0,m.useState)(!1);(0,m.useEffect)(()=>{c(i||""),y(null)},[i]);let N=(0,m.useCallback)(async()=>{if(!d.trim())return void y("Please enter an AWS IAM Role ARN.");y(null);try{await s(d,u,p)}catch(e){console.error("Validation failed in component:",e)}},[d,u,p,s]),C=(0,m.useCallback)(async()=>{if(i&&!w&&window.confirm("Are you sure you want to delete your Bedrock IAM role configuration? This will remove access to AWS Bedrock models.")){j(!0),y(null);try{await o(),c("")}catch(e){console.error("Deletion failed in component:",e)}finally{j(!1)}}},[i,o,w]),S=v||a;return(0,r.jsxs)(L.w,{label:(0,r.jsxs)(r.Fragment,{children:["Bedrock IAM Role",(0,r.jsx)(D.m,{label:"v0.49+"})]}),description:"Use Anthropic Claude models through your AWS Bedrock account",headerTrailingActions:(0,r.jsx)(R.j,{onClick:()=>b(!f),size:"base",children:f?"Hide Instructions":"Show Instructions"}),children:[f&&(0,r.jsx)(M.A,{children:(0,r.jsxs)("div",{className:"dashboard-base dashboard-text-secondary",children:[(0,r.jsxs)("div",{className:"px-4 py-2 pt-4 flex gap-1",children:[(0,r.jsx)("span",{className:"flex h-5 w-5 shrink-0 items-center justify-start dashboard-base dashboard-text-tertiary",children:"1."}),(0,r.jsxs)("div",{className:"flex-1",children:["Navigate to ",(0,r.jsx)("strong",{children:"AWS IAM Console"})," /"," ",(0,r.jsx)("strong",{children:"Roles"})," / ",(0,r.jsx)("strong",{children:"Create Role"})]})]}),(0,r.jsxs)("div",{className:"px-4 py-2 flex gap-1",children:[(0,r.jsx)("span",{className:"flex h-5 w-5 shrink-0 items-center justify-start dashboard-base dashboard-text-tertiary",children:"2."}),(0,r.jsxs)("div",{className:"flex-1",children:["Select ",(0,r.jsx)("strong",{children:'"Another AWS account"'})," as the trusted entity type"]})]}),(0,r.jsxs)("div",{className:"px-4 py-2 flex gap-1",children:[(0,r.jsx)("span",{className:"flex h-5 w-5 shrink-0 items-center justify-start dashboard-base dashboard-text-tertiary",children:"3."}),(0,r.jsxs)("div",{className:"flex-1",children:["Trust our Cursor cross-account ARN:",(0,r.jsx)("span",{className:"px-1.5 font-mono dashboard-base ",children:"arn:aws:iam::289469326074:role/roleAssumer"})]})]}),(0,r.jsxs)("div",{className:"px-4 py-2 flex gap-1",children:[(0,r.jsx)("span",{className:"flex h-5 w-5 shrink-0 items-center justify-start dashboard-base dashboard-text-tertiary",children:"4."}),(0,r.jsx)("div",{className:"flex-1",children:"After validation, you'll receive an External ID that can be added to your trust policy's Condition section for security"})]}),(0,r.jsxs)("div",{className:"px-4 py-2 flex gap-1",children:[(0,r.jsx)("span",{className:"flex h-5 w-5 shrink-0 items-center justify-start dashboard-base dashboard-text-tertiary",children:"5."}),(0,r.jsxs)("div",{className:"flex-1",children:["Attach a policy with the"," ",(0,r.jsx)("strong",{children:'"bedrock:InvokeModelWithResponseStreamCommand"'})," ","permissions"]})]}),(0,r.jsxs)("div",{className:"px-4 py-2 flex gap-1",children:[(0,r.jsx)("span",{className:"flex h-5 w-5 shrink-0 items-center justify-start dashboard-base dashboard-text-tertiary",children:"6."}),(0,r.jsxs)("div",{className:"flex-1",children:["Name your role clearly, for example"," ",(0,r.jsx)("strong",{children:'"CursorBedrockAccess"'}),", then finish creating the role"]})]}),(0,r.jsxs)("div",{className:"px-4 py-2 pb-4 flex gap-1",children:[(0,r.jsx)("span",{className:"flex h-5 w-5 shrink-0 items-center justify-start dashboard-base dashboard-text-tertiary",children:"7."}),(0,r.jsx)("div",{className:"flex-1",children:"Paste the resulting Role ARN in the field below and validate. After validation, add the generated External ID to your role's trust policy"})]})]})}),(0,r.jsxs)(M.A,{trailingCaption:n?(0,r.jsxs)("div",{className:"flex items-center gap-2 text-brand-green-600",children:[(0,r.jsx)(x.A,{size:16}),(0,r.jsx)("span",{className:"dashboard-sm",children:n})]}):S?(0,r.jsx)("div",{className:"dashboard-sm dashboard-text-red-primary",children:S}):i?(0,r.jsxs)("div",{className:"rounded-md bg-brand-dashboard-bg p-2 dashboard-base text-white",children:["Current role:"," ",(0,r.jsx)("span",{className:"font-mono text-xs",children:i})]}):void 0,children:[(0,r.jsx)(T.J,{label:"AWS IAM Role ARN",trailingItems:(0,r.jsx)("input",{id:"bedrock-iam-role",value:d,onChange:e=>{c(e.target.value),y(null)},placeholder:"arn:aws:iam::123456789012:role/YourRoleName",className:"dashboard-cell-input dashboard-cell-input-wide".concat(S?" dashboard-cell-input-error":""),disabled:t||w})}),(0,r.jsx)(T.J,{label:"AWS Region",trailingItems:(0,r.jsx)("input",{id:"bedrock-region",value:u,onChange:e=>h(e.target.value),placeholder:"us-east-1",className:"dashboard-cell-input dashboard-cell-input-wide",disabled:t||w})}),(0,r.jsx)(T.J,{label:"Test Model ID",description:(0,r.jsx)(r.Fragment,{children:"We'll test your IAM role by attempting to invoke this model (ensure it's enabled in Bedrock and included in your IAM policy)."}),trailingItems:(0,r.jsx)("input",{id:"bedrock-test-model",value:p,onChange:e=>g(e.target.value),placeholder:"anthropic.claude-3-sonnet-20240229-v1:0",className:"dashboard-cell-input dashboard-cell-input-wide",disabled:t||w})}),(0,r.jsxs)("div",{className:"flex flex-row justify-end py-4 pr-4 gap-2",children:[i&&(0,r.jsx)(R.j,{onClick:C,disabled:t||w,title:"Delete Bedrock IAM role configuration",color:"red",leadingIcon:(0,r.jsx)(W.A,{size:16}),children:w?"Deleting...":"Delete"}),(0,r.jsx)(R.j,{onClick:N,disabled:t||w,children:t?"Validating...":"Validate & Save"})]})]}),(0,r.jsx)(M.A,{children:(0,r.jsx)(T.J,{label:"External ID",description:(0,r.jsxs)(r.Fragment,{children:["Required for secure cross-account access."," ",l?(0,r.jsx)(r.Fragment,{children:'Add this external ID to your IAM role\'s trust policy under the "Condition" section to prevent the confused deputy problem.'}):(0,r.jsxs)(r.Fragment,{children:["No external ID generated yet. Click"," ",(0,r.jsx)("strong",{children:"Validate & Save"})," above to generate a unique external ID for your IAM role trust policy. You may need to refresh the page to see the external ID."]})]}),trailingItems:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"dashboard-cell-input",children:l}),(0,r.jsx)(R.j,{onClick:()=>navigator.clipboard.writeText(l),title:"Copy to Clipboard",size:"base",children:"Copy"})]}):null})})]})}var H=a(17487),J=a(56735),V=a(82429);let q={disableAll:!1,allowedMcpServers:[]};function K(){var e,t;let{adminSettings:a,updateAdminSettings:n,isSavingAdminSettings:s,isAdminSettingsLoading:o,adminSettingsError:i,adminSettingsSaveSuccess:c}=(0,k.M)(),[u,h]=(0,m.useState)(null!=(e=null==a?void 0:a.allowedMcpConfiguration)?e:q);(0,m.useEffect)(()=>{var e;h(null!=(e=null==a?void 0:a.allowedMcpConfiguration)?e:q)},[a]);let p=(0,m.useCallback)(async()=>{if(!a)return;let e={...a,allowedMcpConfiguration:u};await n(e)},[a,u,n]);return!a&&o?(0,r.jsx)("div",{className:"text-sm text-brand-gray-600",children:"Loading MCP Admin Panel settings..."}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(L.w,{label:(0,r.jsxs)(r.Fragment,{children:["MCP Configuration ",(0,r.jsx)(D.m,{label:"v0.51+"})]}),description:"Control the MCP servers available to your team",headerTrailingActions:(0,r.jsx)(R.j,{onClick:()=>{let e={command:""};h(t=>({...t,allowedMcpServers:[...t.allowedMcpServers,e]}))},disabled:u.disableAll,children:"Add Server/Command"}),children:(0,r.jsxs)(M.A,{trailingCaption:i&&!c&&(0,r.jsx)("div",{className:"dashboard-text-red-primary",children:i}),children:[(0,r.jsx)(T.J,{label:"Disable All MCP Commands Globally",trailingItems:(0,r.jsx)(l.Switch,{checked:null!=(t=u.disableAll)&&t,onCheckedChange:e=>h(t=>({...t,disableAll:e})),disabled:o||s})}),!u.disableAll&&u.allowedMcpServers.length>0&&(0,r.jsx)(r.Fragment,{children:u.allowedMcpServers.map((e,t)=>{var a,n;let s=void 0!==e.command;return(0,r.jsx)(T.J,{label:(0,r.jsxs)(r.Fragment,{children:["Server/Command ",t+1]}),trailingItems:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:(0,d.cn)("dashboard-input-with-modifier dashboard-input-with-modifier-fixed",u.disableAll&&"opacity-50"),children:[(0,r.jsxs)("div",{className:"dashboard-input-modifier dashboard-input-modifier-compact",children:[(0,r.jsx)(V.A,{value:s?"command":"url",options:[{value:"command",label:"Command"},{value:"url",label:"URL"}],onChange:e=>{"command"===e!==s&&h(e=>({...e,allowedMcpServers:e.allowedMcpServers.map((e,a)=>a===t?void 0!==e.command?{command:void 0,serverUrl:e.command||""}:{serverUrl:void 0,command:e.serverUrl||""}:e)}))},buttonClassName:"h-full px-2 dashboard-text-button-compact"}),(0,r.jsx)("div",{className:"dashboard-input-modifier-divider"})]}),(0,r.jsx)("input",{id:"mcp-".concat(s?"command":"url","-").concat(t),type:"text",value:s?null!=(a=e.command)?a:"":null!=(n=e.serverUrl)?n:"",onChange:e=>{var a;return a=e.target.value,void h(e=>({...e,allowedMcpServers:e.allowedMcpServers.map((e,r)=>r===t?void 0!==e.command?{...e,command:a,serverUrl:void 0}:{...e,serverUrl:a,command:void 0}:e)}))},placeholder:s?"“/usr/local/bin/my-mcp-tool“...":"“http://localhost:8080/mcp_endpoint“...",className:"dashboard-input-with-modifier-value",disabled:u.disableAll})]}),(0,r.jsx)(J.I,{"aria-label":"Remove",onClick:()=>{h(e=>({...e,allowedMcpServers:e.allowedMcpServers.filter((e,a)=>a!==t)}))},icon:(0,r.jsx)(H.A,{size:14})})]})},t)})}),(0,r.jsx)("div",{className:"flex justify-end py-4 pr-4",children:(0,r.jsx)(R.j,{onClick:p,disabled:s||o,children:s?"Saving...":!0===c?"Saved ✓":"Save"})})]})})})}var G=a(6135);let Y=e=>{let{teamId:t,isAdmin:a}=e,[n,s]=(0,m.useState)([]),[o,i]=(0,m.useState)([]),[l,d]=(0,m.useState)(!1),[c,u]=(0,m.useState)({}),[h,p]=(0,m.useState)({}),[g,x]=(0,m.useState)(null),[f,b]=(0,m.useState)(!0),[v,y]=(0,m.useState)(null),[w,j]=(0,m.useState)(!1),[N,k]=(0,m.useState)(null),[C,S]=(0,m.useState)(null),[E,I]=(0,m.useState)(!1),B=(0,m.useRef)(null),D=(0,m.useRef)({}),O=(0,m.useCallback)(async()=>{try{let e=await fetch("/api/dashboard/get-team-repos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:t})});if(!e.ok)throw Error("Failed to fetch repos");let a=await e.json();console.log("data",a),s(a.repos||[])}catch(e){console.error("Error fetching repos:",e)}finally{b(!1)}},[t]);(0,m.useEffect)(()=>{let e={};for(let r of n){var t,a;e[r.id]=null!=(a=null==(t=r.patterns)?void 0:t.map(e=>e.pattern))?a:[]}u(e)},[n]);let P=async function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.map(e=>e.trim()).filter(Boolean);if(0===r.length)return{added:[],failed:[]};j(!0),y(null);let n=[],s=[];try{for(let e of r)try{let r=await fetch("/api/dashboard/create-team-repo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:t,repoUrl:e})}),i=await r.json();if(!r.ok){var o,l,d,c,u;let e=(null==i||null==(c=i.error)||null==(d=c.details)||null==(l=d[0])||null==(o=l.details)?void 0:o.detail)||(null==i||null==(u=i.error)?void 0:u.message);throw Error(e||"Failed to add repository")}n.push(e),a&&i.repoId&&((await fetch("/api/dashboard/add-repo-pattern",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:t,repoId:i.repoId,pattern:"**"})})).ok||s.push({url:e,message:"Failed to apply block all ('**')"}))}catch(a){let t=a instanceof Error?a.message:String(a);s.push({url:e,message:t})}if(n.length>0){await O();let e=new Set(n.map(e=>e.trim()));i(t=>t.filter(t=>!e.has(t.trim()))),k(!0),setTimeout(()=>k(null),2e3)}else k(!1);if(s.length>0){let e=s.map(e=>e.url).join(", ");y({type:"repo",message:"Failed to add: ".concat(e)})}}finally{j(!1)}return{added:n,failed:s}},_=async e=>{try{if(!(await fetch("/api/dashboard/delete-team-repo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:t,repoId:e})})).ok)throw Error("Failed to remove repo");await O(),g===e&&x(null),S(null)}catch(e){console.error("Error removing repo:",e)}},W=async(e,a)=>{var r,s,o,i,l,d,u;let m=n.find(t=>t.id===e);if(!m)return!1;let h=new Set((null!=(r=null!=a?a:c[e])?r:[]).map(e=>e.trim()).filter(Boolean));h.has("**")&&(h=new Set(["**"]));let p=new Set((null!=(s=m.patterns)?s:[]).map(e=>e.pattern)),g=[...h].filter(e=>!p.has(e)),x=[...p].filter(e=>!h.has(e));if(0===g.length&&0===x.length)return!0;j(!0),y(null);try{for(let a of x){let r=m.patterns.find(e=>e.pattern===a);if(r&&!(await fetch("/api/dashboard/remove-repo-pattern",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:t,repoId:e,patternId:r.id})})).ok)throw Error("Failed to remove pattern")}for(let a of g){let r=await fetch("/api/dashboard/add-repo-pattern",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:t,repoId:e,pattern:a})}),n=await r.json();if(!r.ok){let e=(null==n||null==(d=n.error)||null==(l=d.details)||null==(i=l[0])||null==(o=i.details)?void 0:o.detail)||(null==n||null==(u=n.error)?void 0:u.message)||"Failed to add pattern";throw Error(e)}}await O(),k(!0),setTimeout(()=>k(null),2e3)}catch(e){return console.error("Error saving patterns:",e),k(!1),y({type:"pattern",message:e instanceof Error?e.message:"Failed to save patterns"}),!1}finally{j(!1)}return!0};return((0,m.useEffect)(()=>{O()},[t,O]),a)?f?(0,r.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,r.jsx)(F.K,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(L.w,{label:"Repository Blocklist",description:"As of v0.50, we do not scan for git repository roots in these directories: node_modules, .turbo, .next, .cache, .pnpm, .yarn, dist, build, out, target, .vscode, .idea, venv, __pycache__, logs, tmp, temp. If a repository is blocked and contains these directories, the directories will still be blocked as part of the repository.",children:[(0,r.jsxs)(M.A,{trailingCaption:(null==v?void 0:v.type)==="repo"&&(0,r.jsx)("div",{className:"dashboard-text-red-primary",children:v.message}),children:[(0,r.jsx)(T.J,{label:"Block Repositories",description:"Add repositories and use patterns (e.g., secrets/** or **/*.env) to prevent files or directories from being indexed or used as context for your team. If files or directories are renamed or moved by a developer, Cursor cannot guarantee that they will be blocked."}),(0,r.jsxs)("div",{className:"dashboard-tokenized-input-cell",children:[(0,r.jsx)(U.Y,{ref:B,elementName:"repository URL",tokens:o,onChange:e=>{i(e),y(null)},placeholder:"Repository URLs, comma separated...",onPendingChange:d,error:(null==v?void 0:v.type)==="repo"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(R.j,{onClick:async()=>{var e,t,a;let r=(null!=(t=null==(e=B.current)?void 0:e.getPendingValue())?t:"").trim(),n=Array.from(new Set((r?[...o,r]:o).map(e=>e.trim()))).filter(Boolean),{added:s}=await P(n,!1);r&&s.includes(r)&&(null==(a=B.current)||a.clearPending())},disabled:w||0===o.length&&!l,size:"medium",children:w?"Adding...":!0===N?"Added Repositories ✓":"Add Repositories"}),(0,r.jsx)(R.j,{onClick:async()=>{var e,t,a;let r=(null!=(t=null==(e=B.current)?void 0:e.getPendingValue())?t:"").trim(),n=Array.from(new Set((r?[...o,r]:o).map(e=>e.trim()))).filter(Boolean),{added:s}=await P(n,!0);r&&s.includes(r)&&(null==(a=B.current)||a.clearPending())},disabled:w||0===o.length&&!l,size:"medium",children:"Add Repositories & Block All Files"})]})]})]}),(0,r.jsx)(M.A,{children:n.map(e=>{var t,a;return(0,r.jsxs)(m.Fragment,{children:[(0,r.jsx)(T.J,{label:(e=>{try{if(e.startsWith("git@")){let t=e.match(/git@[^:]+:([^/]+)\/([^.]+)/);if(t)return"".concat(t[1],"/").concat(t[2])}let t=new URL(e).pathname.split("/").filter(Boolean);if(t.length>=2)return"".concat(t[0],"/").concat(t[1])}catch(e){}return e})(e.url),description:(0,r.jsxs)(r.Fragment,{children:[e.url," \xb7 ",(null==(t=e.patterns)?void 0:t.length)>0?(0,r.jsx)(r.Fragment,{children:e.patterns.some(e=>"**"===e.pattern)?"All files blocked":"".concat(e.patterns.length," pattern").concat(1!==e.patterns.length?"s":"")}):"0 blocked files or directories"]}),trailingItems:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(J.I,{"aria-label":"Remove repository",icon:(0,r.jsx)(G.A,{className:"h-4 w-4"}),onClick:t=>{t.stopPropagation(),S({repoId:e.id,name:e.url})}})})}),(0,r.jsx)("div",{className:"dashboard-tokenized-input-cell",children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.Y,{ref:t=>{D.current[e.id]=t},elementName:"glob pattern",tokens:null!=(a=c[e.id])?a:[],onChange:t=>{u(a=>({...a,[e.id]:t})),y(null)},placeholder:"Glob patterns, comma separated, to exclude files or directories from indexing...",formatting:"none",onPendingChange:t=>p(a=>({...a,[e.id]:t})),error:(null==v?void 0:v.type)==="pattern"}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)(R.j,{onClick:async t=>{var a,r,n,s;t.stopPropagation();let o=(null!=(r=null==(a=D.current[e.id])?void 0:a.getPendingValue())?r:"").trim(),i=null!=(n=c[e.id])?n:[],l=Array.from(new Set(o?[...i,o]:i)).filter(Boolean);await W(e.id,l)&&o&&(null==(s=D.current[e.id])||s.clearPending())},disabled:w||!((e=>{var t,a;let r=null!=(t=c[e.id])?t:[],n=(null!=(a=e.patterns)?a:[]).map(e=>e.pattern);if(r.length!==n.length)return!0;let s=new Set(n);for(let e of r)if(!s.has(e))return!0;return!1})(e)||h[e.id]),size:"medium",children:w?"Saving...":!0===N?"Saved ✓":"Save"})}),(null==v?void 0:v.type)==="pattern"&&(0,r.jsx)("div",{className:"text-brand-red-400 text-sm",children:v.message})]})})]},e.id)})})]}),(0,r.jsx)(A.Rw,{show:null!==C,onClose:()=>S(null),onConfirm:()=>{C&&_(C.repoId)},title:"Remove Repository",confirmText:"Remove",children:(0,r.jsxs)("p",{children:["Are you sure you want to remove this repository? This will also remove all associated patterns for all users on your team.",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:null==C?void 0:C.name})]})})]}):null},$=()=>{let{sessions:e,isSessionsLoading:t,sessionsError:a,revokingSessionId:n,refreshSessions:s,revokeSession:o}=(0,k.M)(),[i,l]=(0,m.useState)(!1),d=i?e:e.slice(0,5);return(0,r.jsx)(L.w,{label:"Active Sessions",children:(0,r.jsx)(M.A,{hideOverflow:!0,trailingCaption:e.length>0&&"Session revocation may take up to 10 minutes to complete",children:t?(0,r.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,r.jsx)(F.K,{})}):a?(0,r.jsx)(I.n,{title:"Error Loading Sessions",description:a||"Something went wrong while loading active sessions",action:{label:"Try Again",onClick:s}}):(0,r.jsx)(r.Fragment,{children:0===e.length?(0,r.jsx)(I.n,{title:"No Active Sessions Found",description:"Active Web and Desktop sessions will appear here",className:"p-6",action:{label:"Refresh",onClick:s}}):(0,r.jsxs)(r.Fragment,{children:[d.map(e=>{let t=e.createdAt?"Created ".concat((0,c.m)((0,u.H)(e.createdAt))," ago"):"Creation date unknown",a=n===e.sessionId;return(0,r.jsx)(T.J,{leadingIcon:(0,r.jsx)("div",{className:"dashboard-text-tertiary",children:"SESSION_TYPE_WEB"===e.type?(0,r.jsx)("div",{className:"h-5 flex items-center justify-center dashboard-text-tertiary",children:(0,r.jsx)(h.A,{size:16})}):(0,r.jsx)("div",{className:"h-5 flex items-center justify-center dashboard-text-tertiary",children:(0,r.jsx)(p.A,{size:16})})}),label:"SESSION_TYPE_WEB"===e.type?"Web":"Desktop App",description:t,trailingItems:(0,r.jsx)(R.j,{onClick:()=>o(e.sessionId,e.type),disabled:a,children:a?"Revoking...":"Revoke"})},e.sessionId)}),!i&&e.length>5&&(0,r.jsx)(T.J,{onClick:()=>l(!0),leadingIcon:(0,r.jsx)("div",{className:"h-5 flex items-center justify-center dashboard-text-tertiary",children:(0,r.jsx)(g.A,{size:16})}),label:"See ".concat(e.length-5," more")},"see-more-sessions")]})})})})},Z=()=>{let{domainVerificationLink:e,ssoSetupLink:t,ssoStatus:a,isFetchingSSOConfig:n,ssoConfigError:s}=(0,k.M)(),o=e=>{e&&window.open(e,"_blank")};return n?(0,r.jsx)("p",{className:"text-sm",children:"Loading SSO status..."}):s?(0,r.jsxs)("p",{className:"text-sm text-brand-red-400",children:["Error loading SSO status: ",s]}):(0,r.jsx)(L.w,{label:"Single Sign-On (SSO)",description:a?(0,r.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,r.jsx)(x.A,{className:"size-4 text-brand-green-400"}),a]}):null,children:(0,r.jsxs)(M.A,{trailingCaption:a?null:"To setup SSO, please verify your domain and connect your SSO provider. Once your SSO connection is active, your users will be required to sign in with SSO.",children:[(0,r.jsx)(T.J,{label:"Domain Verification Settings",trailingItems:(0,r.jsx)(R.j,{disabled:!e,onClick:()=>o(e),trailingIcon:(0,r.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 8 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M1.62891 7.27734C0.8125 7.27734 0.402344 6.875 0.402344 6.07031V1.29688C0.402344 0.492188 0.8125 0.0859375 1.62891 0.0859375H6.36719C7.1875 0.0859375 7.59375 0.492188 7.59375 1.29688V6.07031C7.59375 6.875 7.1875 7.27734 6.36719 7.27734H1.62891ZM1.63672 6.64844H6.35938C6.74609 6.64844 6.96484 6.44141 6.96484 6.03516V1.33203C6.96484 0.925781 6.74609 0.714844 6.35938 0.714844H1.63672C1.24609 0.714844 1.03125 0.925781 1.03125 1.33203V6.03516C1.03125 6.44141 1.24609 6.64844 1.63672 6.64844ZM5.22266 4.64844C5.05078 4.64844 4.9375 4.52734 4.9375 4.34375V3.66797L4.99609 3.05859L4.43359 3.66016L2.99609 5.09766C2.94141 5.15234 2.86719 5.1875 2.77344 5.1875C2.60156 5.1875 2.48828 5.07422 2.48828 4.89844C2.48828 4.82031 2.52344 4.74219 2.57812 4.6875L4.01953 3.24609L4.62891 2.67969L4.05078 2.74219H3.33984C3.15234 2.74219 3.03125 2.62891 3.03125 2.45703C3.03125 2.28516 3.14844 2.17188 3.33203 2.17188H5.18359C5.38281 2.17188 5.51172 2.26172 5.51172 2.49219V4.33594C5.51172 4.51562 5.39453 4.64844 5.22266 4.64844Z",fill:"#CCCCCC"})}),children:"Configure"})}),(0,r.jsx)(T.J,{label:"SSO-Provider Connection Settings",trailingItems:(0,r.jsx)(R.j,{disabled:!t,onClick:()=>o(t),trailingIcon:(0,r.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 8 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M1.62891 7.27734C0.8125 7.27734 0.402344 6.875 0.402344 6.07031V1.29688C0.402344 0.492188 0.8125 0.0859375 1.62891 0.0859375H6.36719C7.1875 0.0859375 7.59375 0.492188 7.59375 1.29688V6.07031C7.59375 6.875 7.1875 7.27734 6.36719 7.27734H1.62891ZM1.63672 6.64844H6.35938C6.74609 6.64844 6.96484 6.44141 6.96484 6.03516V1.33203C6.96484 0.925781 6.74609 0.714844 6.35938 0.714844H1.63672C1.24609 0.714844 1.03125 0.925781 1.03125 1.33203V6.03516C1.03125 6.44141 1.24609 6.64844 1.63672 6.64844ZM5.22266 4.64844C5.05078 4.64844 4.9375 4.52734 4.9375 4.34375V3.66797L4.99609 3.05859L4.43359 3.66016L2.99609 5.09766C2.94141 5.15234 2.86719 5.1875 2.77344 5.1875C2.60156 5.1875 2.48828 5.07422 2.48828 4.89844C2.48828 4.82031 2.52344 4.74219 2.57812 4.6875L4.01953 3.24609L4.62891 2.67969L4.05078 2.74219H3.33984C3.15234 2.74219 3.03125 2.62891 3.03125 2.45703C3.03125 2.28516 3.14844 2.17188 3.33203 2.17188H5.18359C5.38281 2.17188 5.51172 2.26172 5.51172 2.49219V4.33594C5.51172 4.51562 5.39453 4.64844 5.22266 4.64844Z",fill:"#CCCCCC"})}),children:"Configure"})})]})})},Q=()=>{let[e,t]=(0,m.useState)(null),[a,n]=(0,m.useState)(!1),[l,c]=(0,m.useState)(!1),u=async()=>{n(!0);try{let e=await fetch("/api/dashboard/create-team-free-trial-code",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to generate trial code");let a=await e.json();t("https://cursor.com/team/free-trial?code=".concat(a.code))}catch(e){console.error("Error generating trial code:",e)}finally{n(!1)}};return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)(s.o5,{className:"text-sm",children:"Generate a free trial code that can be used to create a new team with a trial period."}),e?(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(o.p,{type:"text",value:e,readOnly:!0,className:"!h-9 flex-1 font-mono"}),(0,r.jsx)(i.Button,{onClick:()=>{e&&(navigator.clipboard.writeText(e),c(!0),setTimeout(()=>c(!1),2e3))},size:"sm",variant:"secondary",className:"min-w-[80px]",children:(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[l?(0,r.jsx)(x.A,{className:"h-3 w-3"}):(0,r.jsx)(f.A,{className:"h-3 w-3"}),l?"Copied":"Copy"]})})]}),(0,r.jsx)(i.Button,{onClick:u,size:"sm",variant:"secondary",disabled:a,className:"w-fit",children:(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)(b.A,{className:(0,d.cn)("h-3 w-3",a&&"animate-spin")}),"Generate New Code"]})})]}):(0,r.jsx)(i.Button,{onClick:u,size:"sm",disabled:a,className:"w-fit",children:(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[a?(0,r.jsx)(b.A,{className:"h-3 w-3 animate-spin"}):(0,r.jsx)(v.A,{className:"h-3 w-3"}),a?"Generating...":"Generate Code"]})})]})},X=e=>{var t,a,s,o,i;let{shouldOpenPrivacy:c=!1,onPrivacyModalOpened:u}=e,{team:h,viewerRole:p,hardLimit:g,hardLimitPerUser:x,usageBasedPremiumRequests:f,adminOnlyUsagePricing:b,isUsageDataLoading:I,isLoading:W,isSavingUsageSettings:H,usageSettingsError:J,createCheckoutUrl:V,updateHardLimit:q,updateAdminOnlyUsagePricing:G,updateUsageBasedPremiumRequests:X,adminSettings:ee,isAdminSettingsLoading:et,isSavingAdminSettings:ea,adminSettingsError:er,adminSettingsSaveSuccess:en,updateAdminSettings:es,stripeStatus:eo,isFetchingSSOConfig:ei,apiKeys:el,isCreatingApiKey:ed,isDeletingApiKey:ec,createApiKey:eu,deleteApiKey:em,optOutNewPricing:eh,hasNewPricing:ep,isOptedOut:eg,userApiKeys:ex,isUserApiKeysLoading:ef,isCreatingUserApiKey:eb,isDeletingUserApiKey:ev,createUserApiKey:ey,deleteUserApiKey:ew}=(0,k.M)(),ej=(0,C.t)(),{hasAccess:eN}=(0,S._)(),[ek,eC]=(0,m.useState)(null),eS=(0,m.useRef)(null),[eE,eA]=(0,m.useState)(!1),[eT,eR]=(0,m.useState)(null),[eL,eM]=(0,m.useState)(!1),[eI,eF]=(0,m.useState)(null),[eB,eD]=(0,m.useState)(!0),[eO,eP]=(0,m.useState)(!0),[eU,e_]=(0,m.useState)(!0),[eW,ez]=(0,m.useState)(!0),[eH,eJ]=(0,m.useState)(!0),[eV,eq]=(0,m.useState)(!0),[eK,eG]=(0,m.useState)(!0),[eY,e$]=(0,m.useState)(!0),[eZ,eQ]=(0,m.useState)(!0),[eX,e0]=(0,m.useState)(!0),[e1,e2]=(0,m.useState)(!0),[e4,e3]=(0,m.useState)(!1),[e8,e5]=(0,m.useState)(!0),[e6,e9]=(0,m.useState)(!1),[e7,te]=(0,m.useState)(!1),[tt,ta]=(0,m.useState)(!0),[tr,tn]=(0,m.useState)(!1),[ts,to]=(0,m.useState)(!1),[ti,tl]=(0,m.useState)(!1),[td,tc]=(0,m.useState)(null),[tu,tm]=(0,m.useState)(!1),th=(0,m.useCallback)(()=>{null==u||u()},[u]);(0,m.useEffect)(()=>{ee&&!et&&eC(ee)},[ee,et]);let tp=(0,m.useCallback)(async()=>{if(ek)try{await es(ek)}catch(e){console.error("Failed to save admin settings from component:",e)}},[ek,es]),tg=async()=>{if(!e7){te(!0);try{let e=await V({tier:"pro"});window.location.href=e}catch(e){console.error("[Upgrade] Error creating checkout URL:",e),te(!1)}}},tx=async()=>{eR(null);try{let r=await fetch("/api/dashboard/delete-account",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(new n.gqj().toJson())});if(!r.ok){var e,t,a;throw Error(null!=(a=null==(t=await r.json())||null==(e=t.error)?void 0:e.message)?a:"HTTP error ".concat(r.status))}window.location.href="/api/auth/logout"}catch(e){console.error("Error deleting account:",e),eR("".concat(e))}},tf=async()=>{if(null==h?void 0:h.id){tc(null),tm(!0);try{let m=await fetch("/api/dashboard/leave-team",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:h.id})});if(!m.ok){let h="HTTP ".concat(m.status);try{var e,t,a,r,n,s,o,i,l,d,c,u;let p=await m.json();h=null!=(u=null!=(c=null!=(d=null==p||null==(r=p.error)||null==(a=r.details)||null==(t=a[0])||null==(e=t.details)?void 0:e.detail)?d:null==p||null==(i=p.error)||null==(o=i.details)||null==(s=o[0])||null==(n=s.details)?void 0:n.title)?c:null==p||null==(l=p.error)?void 0:l.message)?u:h}catch(e){}throw Error(h)}tl(!1),window.location.reload()}catch(e){console.error("leave-team failed",e),e instanceof Error?tc(e.message):tc(String(e))}finally{tm(!1)}}},tb=(e=>e===n.acM.OWNER||e===n.acM.FREE_OWNER)(p),tv=W||I||!eo||et&&null!==h||ei;return(0,m.useEffect)(()=>{(null==h?void 0:h.id)&&(async()=>{try{if(!(await fetch("/api/dashboard/get-team-repos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:null==h?void 0:h.id})})).ok)throw Error("Failed to fetch repos");e3(!0)}catch(e){e3(!1)}})()},[h]),(0,m.useEffect)(()=>{if(!(null==h?void 0:h.id))return;let e=!1;return(async()=>{to(!0);try{let t=await fetch("/api/dashboard/get-region",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:h.id})});if(!t.ok)throw Error("HTTP ".concat(t.status));let a=await t.json();e||tn(!!(null==a?void 0:a.isBlocked))}catch(t){e||tn(!1),console.error("failed to check region block",t)}finally{e||to(!1)}})(),()=>{e=!0}},[h]),(0,r.jsxs)("div",{className:"dashboard-settings-chunks pb-6",children:[(0,r.jsxs)("div",{className:"dashboard-settings-chunk",children:[(0,r.jsx)(P.T,{title:h?"General":"Settings"}),(0,r.jsxs)("div",{className:"dashboard-sections",children:[!ej&&(0,r.jsx)(L.w,{label:"Usage-Based Pricing",children:tv?(0,r.jsx)(M.A,{children:(0,r.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,r.jsx)(F.K,{})})}):eo.membershipType===w.V.FREE||eo.membershipType===w.V.FREE_TRIAL?(0,r.jsx)(M.A,{children:(0,r.jsx)(T.J,{label:"Usage-Based Pricing",description:"Enable usage-based pricing to exceed model rate limits by paying per request. Requires a Pro or Enterprise plan.",trailingItems:(0,r.jsx)(O.B,{onClick:tg,disabled:e7||"trialing"===eo.subscriptionStatus,children:e7?"Processing...":"trialing"===eo.subscriptionStatus?"Not available during trial":"Upgrade to Pro"})})}):(0,r.jsx)(N.t,{useDashboardFallback:!0})}),(0,r.jsx)(j.X,{team:h,viewerRole:p,shouldOpenPrivacy:c,onModalSuccess:th}),(0,r.jsx)($,{}),!h&&(0,r.jsx)(L.w,{label:"More",children:(0,r.jsxs)(M.A,{children:[eg&&(0,r.jsx)(T.J,{label:"Pricing",trailingItems:(0,r.jsx)(R.j,{onClick:async()=>{try{await eh(!0),window.location.reload()}catch(e){console.error("Failed to opt in:",e),eF("Failed to opt in to new pricing. Please try again.")}},children:"Opt In to New Pricing"})}),(0,r.jsx)(T.J,{label:"Delete Account",trailingItems:(0,r.jsx)(R.j,{color:"red",onClick:()=>eA(!0),children:"Delete"})}),(0,r.jsxs)(A.Rw,{show:eE,onClose:()=>{eA(!1),eR(null)},onConfirm:tx,confirmText:"Delete",title:"Delete Account",children:[(0,r.jsx)("p",{className:"mb-4 text-brand-gray-300",children:"Are you sure you want to delete your account? This action is irreversible."}),eT&&(0,r.jsx)("div",{className:"mb-4 rounded-lg bg-red-100 p-2 text-sm text-red-700 dark:bg-red-900/30 dark:text-red-300",children:eT})]}),(0,r.jsxs)(A.Rw,{show:eL,onClose:()=>{eM(!1),eF(null)},onConfirm:async()=>{try{await eh(),eM(!1)}catch(e){console.error("Failed to opt out:",e),eF("Failed to opt out of new pricing. Please try again.")}},confirmText:"Opt Out",title:"Opt Out of New Pricing",children:[(0,r.jsx)("p",{className:"mb-4 text-brand-gray-300",children:"Are you sure you want to opt out of the new pricing structure? You will be moved back to the legacy pricing model."}),eI&&(0,r.jsx)("div",{className:"mb-4 rounded-lg bg-red-100 p-2 text-sm text-red-700 dark:bg-red-900/30 dark:text-red-300",children:eI})]})]})})]})]}),h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"dashboard-settings-chunk",children:[(0,r.jsx)(P.T,{title:"Chat"}),(0,r.jsxs)("div",{className:"dashboard-sections",children:[tb&&ek&&(0,r.jsx)(L.w,{label:"File Handling",children:(0,r.jsxs)(M.A,{trailingCaption:er?(0,r.jsx)("div",{className:"dashboard-text-red-primary",children:er}):"",children:[(0,r.jsx)(T.J,{label:(0,r.jsxs)(r.Fragment,{children:["Heirarchical Cursor Ignore"," ",(0,r.jsx)(D.m,{label:"v0.50+"})]}),description:"When enabled, Cursor will search all the way up the file tree for .cursorignore files. By default, Cursor will only look in the current workspace.",trailingItems:(0,r.jsx)(l.Switch,{checked:null!=(a=null==ek||null==(t=ek.cursorIgnoreControls)?void 0:t.hierarchicalEnabled)&&a,onCheckedChange:e=>{ek&&eC({...ek,cursorIgnoreControls:{...ek.cursorIgnoreControls,hierarchicalEnabled:e}})},disabled:et||ea})}),(0,r.jsx)(T.J,{label:(0,r.jsxs)(r.Fragment,{children:[".cursor Directory Protection"," ",(0,r.jsx)(D.m,{label:"v0.51+"})]}),description:"When enabled, Cursor will prevent the edit tool from making changes to files within the .cursor directory in a user's workspace.",trailingItems:(0,r.jsx)(l.Switch,{checked:null!=(s=null==ek?void 0:ek.dotCursorProtection)&&s,onCheckedChange:e=>{ek&&eC({...ek,dotCursorProtection:e})},disabled:et||ea})}),(0,r.jsx)("div",{className:"flex justify-end py-4 pr-4",children:(0,r.jsx)(R.j,{onClick:tp,disabled:et||ea,color:er?"red":"default",children:ea?"Saving...":er?"Try Again":!0===en?"Saved ✓":"Save"})})]})}),tb&&h&&ek&&(0,r.jsx)(_.R,{autoRunControls:ek.autoRunControls,onUpdate:e=>{eC({...ek,autoRunControls:e})},onSave:tp,isLoading:et,isSaving:ea,error:er,saveSuccess:null!=en?en:void 0}),tb&&h&&ek&&(0,r.jsx)(L.w,{label:"Model Access",children:(0,r.jsxs)(M.A,{trailingCaption:"Cursor hosted models will still process requests behind the scenes regardless of the access control settings.",children:[(0,r.jsx)(T.J,{label:"Restrict Model Access",description:"Control which AI models your team can use. Models will be matched if the filter appears anywhere in the model name.",trailingItems:(0,r.jsx)(l.Switch,{checked:"none"!==ek.accessControlMode,onCheckedChange:e=>{if(ek)if(e){var t;let e=ek.allowedModels&&ek.allowedModels.length>0?ek.allowedModels:null!=(t=ek.blockedModels)?t:[];eC({...ek,accessControlMode:"allowlist",allowedModels:e,blockedModels:void 0})}else eC({...ek,accessControlMode:"none"})},disabled:et||ea})}),"none"!==ek.accessControlMode&&(0,r.jsx)("div",{className:"dashboard-tokenized-input-cell",children:(0,r.jsx)(U.Y,{ref:eS,elementName:"Model name filter",tokens:"allowlist"===ek.accessControlMode?null!=(o=ek.allowedModels)?o:[]:null!=(i=ek.blockedModels)?i:[],onChange:e=>{ek&&("allowlist"===ek.accessControlMode?eC({...ek,allowedModels:e,blockedModels:void 0}):"blocklist"===ek.accessControlMode&&eC({...ek,blockedModels:e,allowedModels:void 0}))},placeholder:"Model names, comma separated...",className:"w-full",dropdown:{value:"blocklist"===ek.accessControlMode?"blocklist":"allowlist",options:[{value:"allowlist",label:"Only..."},{value:"blocklist",label:"Every Model But..."}],onChange:e=>{var t,a;if(ek)if("blocklist"===e){let e=null!=(t=ek.allowedModels)?t:[];eC({...ek,accessControlMode:"blocklist",blockedModels:e,allowedModels:void 0})}else{let e=null!=(a=ek.blockedModels)?a:[];eC({...ek,accessControlMode:"allowlist",allowedModels:e,blockedModels:void 0})}}}})}),(0,r.jsx)("div",{className:"flex justify-end pt-1 pb-4 pr-4",children:(0,r.jsx)(R.j,{onClick:async()=>{var e,t,a,r,n;if(!ek)return;let s=(null!=(t=null==(e=eS.current)?void 0:e.getPendingValue())?t:"").trim(),o={...ek};if("none"!==o.accessControlMode){let e="allowlist"===o.accessControlMode?null!=(a=o.allowedModels)?a:[]:null!=(r=o.blockedModels)?r:[],t=Array.from(new Set((s?[...e,s]:e).map(e=>e.trim()).filter(Boolean)));"allowlist"===o.accessControlMode?o={...o,allowedModels:t,blockedModels:void 0}:"blocklist"===o.accessControlMode&&(o={...o,blockedModels:t,allowedModels:void 0})}eC(o);try{await es(o),s&&(null==(n=eS.current)||n.clearPending())}catch(e){console.error("Failed to save admin settings from component:",e)}},disabled:et||ea,color:er?"red":"default",children:ea?"Saving...":er?"Try Again":!0===en?"Saved ✓":"Save"})})]})})]})]}),(0,r.jsxs)("div",{className:"dashboard-settings-chunk",children:[(0,r.jsx)(P.T,{title:"Security & Identity"}),(0,r.jsxs)("div",{className:"dashboard-sections",children:[tb&&h&&(0,r.jsx)(Z,{}),h&&tb&&(0,r.jsx)(B,{teamId:h.id}),e4&&tb&&(0,r.jsx)(Y,{teamId:h.id,isAdmin:tb}),tb&&h&&ek&&(0,r.jsx)(K,{})]})]}),(0,r.jsxs)("div",{className:"dashboard-settings-chunk",children:[(0,r.jsx)(P.T,{title:"Advanced"}),(0,r.jsxs)("div",{className:"dashboard-sections",children:[h&&tb&&(0,r.jsx)(E.z,{apiKeys:el,isLoading:!1,isCreating:ed,isDeleting:ec,onCreateKey:async e=>{let t=await eu(e);return t&&e9(!1),t},onDeleteKey:em,keyType:"API Key",showInlineCreation:e6,onShowInlineCreation:()=>e9(!0),onHideInlineCreation:()=>e9(!1),emptyStateAction:{label:"New API Key",onClick:()=>e9(!0),icon:(0,r.jsx)(v.A,{className:"size-3"})}}),tb&&(0,r.jsx)(z,{}),h&&tr&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.A,{children:(0,r.jsx)(T.J,{label:"Leave Team",trailingItems:(0,r.jsx)(R.j,{color:"red",disabled:tu,onClick:()=>tl(!0),children:tu?"Leaving...":"Leave Team"})})}),(0,r.jsxs)(A.Rw,{show:ti,onClose:()=>{tl(!1),tc(null)},onConfirm:tf,confirmText:"Leave",title:"Leave Team",children:[(0,r.jsx)("p",{className:"mb-4 text-brand-gray-300",children:"Your team will be issued a pro-rated refund for the remaining time of your subscription."}),td&&(0,r.jsx)("div",{className:"mb-4 rounded-lg bg-red-100 p-2 text-sm text-red-700 dark:bg-red-900/30 dark:text-red-300",children:td})]})]})]})]})]}),h&&1===h.id&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"dashboard-settings-chunk",children:[(0,r.jsx)(P.T,{title:"Cursor Internal"}),(0,r.jsx)("div",{className:"dashboard-sections",children:(0,r.jsxs)("div",{className:"bg-brand-dashboard-card px-6 py-6 rounded-xl w-full",children:[(0,r.jsxs)("div",{className:"flex cursor-pointer items-center justify-between",onClick:()=>ta(!tt),children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Free Trial Code Generator"}),(0,r.jsx)(y.A,{className:(0,d.cn)("size-5",tt&&"rotate-180")})]}),!tt&&(0,r.jsx)(Q,{})]})})]})})]})}},47529:(e,t,a)=>{a.r(t),a.d(t,{DownloadContext:()=>i,DownloadContextProvider:()=>d,default:()=>u,getPlatformNiceName:()=>o,useDownload:()=>c});var r=a(9381),n=a(10689);let s=JSON.parse('{"stable":{"darwin":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/e4fc23c60ef62209e553b27d9f73262d5067f128/darwin/x64/Cursor-darwin-x64.dmg","darwin-arm64":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/e4fc23c60ef62209e553b27d9f73262d5067f128/darwin/arm64/Cursor-darwin-arm64.dmg","darwin-universal":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/e4fc23c60ef62209e553b27d9f73262d5067f128/darwin/universal/Cursor-darwin-universal.dmg","win32-x64":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/e4fc23c60ef62209e553b27d9f73262d5067f128/win32/x64/user-setup/CursorUserSetup-x64-0.45.17.exe","win32-arm64":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/e4fc23c60ef62209e553b27d9f73262d5067f128/win32/arm64/user-setup/CursorUserSetup-arm64-0.45.17.exe","win32-x64-user":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/e4fc23c60ef62209e553b27d9f73262d5067f128/win32/x64/user-setup/CursorUserSetup-x64-0.45.17.exe","win32-arm64-user":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/e4fc23c60ef62209e553b27d9f73262d5067f128/win32/arm64/user-setup/CursorUserSetup-arm64-0.45.17.exe","linux-x64":"https://downloader.cursor.sh/linux/appImage/x64","linux-arm64":"https://downloader.cursor.sh/linux/appImage/arm64"},"latest":{"darwin":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/be4f0962469499f009005e66867c8402202ff0b7/darwin/x64/Cursor-darwin-x64.dmg","darwin-arm64":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/be4f0962469499f009005e66867c8402202ff0b7/darwin/arm64/Cursor-darwin-arm64.dmg","darwin-universal":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/be4f0962469499f009005e66867c8402202ff0b7/darwin/universal/Cursor-darwin-universal.dmg","win32-x64":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/be4f0962469499f009005e66867c8402202ff0b7/win32/x64/user-setup/CursorUserSetup-x64-0.46.8.exe","win32-arm64":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/be4f0962469499f009005e66867c8402202ff0b7/win32/arm64/user-setup/CursorUserSetup-arm64-0.46.8.exe","win32-x64-user":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/be4f0962469499f009005e66867c8402202ff0b7/win32/x64/user-setup/CursorUserSetup-x64-0.46.8.exe","win32-arm64-user":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/be4f0962469499f009005e66867c8402202ff0b7/win32/arm64/user-setup/CursorUserSetup-arm64-0.46.8.exe","linux-x64":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/client/linux/x64/appimage/Cursor-0.46.9-3395357a4ee2975d5d03595e7607ee84e3db0f2c.deb.glibc2.25-x86_64.AppImage","linux-arm64":"https://anysphere-binaries.s3.us-east-1.amazonaws.com/production/b6fb41b5f36bda05cab7109606e7404a65d1ff32/linux/arm64/Cursor-0.47.9-aarch64.AppImage"}}');function o(e){switch(e){case"darwin":return"macOS";case"win32":return"Windows";case"linux":return"Linux";default:return e}}let i=(0,n.createContext)({downloadCursor:()=>{},platform:"darwin",isDownloading:!1,isFetching:!1}),l=()=>{let e=window.navigator.userAgent;return -1!==e.indexOf("Mac")?"darwin":-1!==e.indexOf("Windows")?"win32":-1!==e.indexOf("Linux")?"linux":"darwin"},d=e=>{let{children:t}=e,[a,o]=(0,n.useState)(!0),[d,c]=(0,n.useState)(!1),[u,m]=(0,n.useState)("darwin");(0,n.useEffect)(()=>{m(l()),o(!1)},[]);let h=(0,n.useCallback)(async(e,t,a,r,n,o)=>{c(!0),a=null!=a?a:"stable";try{let i=await (async()=>{let a="x64";if(navigator.userAgentData)try{let e=await navigator.userAgentData.getHighEntropyValues(["architecture","platformVersion"]);"arm"===e.architecture||"aarch64"===e.architecture||"armv8"===e.architecture?a="arm64":("x86"===e.architecture||"x86_64"===e.architecture||"amd64"===e.architecture)&&(a="x64")}catch(e){console.warn("Could not get high entropy values from userAgentData:",e),(/arm64|aarch64/i.test(navigator.userAgent)||/arm64|aarch64/i.test(navigator.platform))&&(a="arm64")}else(/arm64|aarch64/i.test(navigator.userAgent)||/arm64|aarch64/i.test(navigator.platform))&&(a="arm64");let n=e||l(),s=null!=t?t:a;switch(n){case"darwin":if("arm64"===t)return"darwin-arm64";if("x64"===t)return"darwin";return"darwin-universal";case"win32":return"win32-".concat(s).concat(r?"":"-user");case"linux":return"linux-".concat(s)}})(),d=function(e,t){let a=s[t][e];if(!a)throw Error("No backup URL found for platform ".concat(e," and release track ").concat(t));return a}(i,a);try{let e=await fetch("/api/download?platform=".concat(i,"&releaseTrack=").concat(a)+(n?"&appName=".concat(n):""));if(e.ok){let t=await e.json();if("deb"===o&&t.debUrl)d=t.debUrl;else if(t.downloadUrl)d=t.downloadUrl;else throw Error("No download URL received")}}catch(e){console.error("Failed to fetch download link:",e)}let c=document.createElement("a");c.href=d,document.body.appendChild(c),c.click(),document.body.removeChild(c)}catch(e){console.error("Failed to download Cursor:",e)}finally{c(!1)}},[]);return(0,r.jsx)(i.Provider,{value:{downloadCursor:h,platform:u,isDownloading:d,isFetching:a},children:t})},c=()=>{let e=n.useContext(i);if(void 0===e)throw Error("useDownload must be used within a DownloadContextProvider");return{downloadCursor:e.downloadCursor,platform:e.platform,isDownloading:e.isDownloading,isFetching:e.isFetching}},u=d},51797:(e,t,a)=>{a.d(t,{X:()=>o});var r=a(9381),n=a(37095),s=a(64149);let o=e=>{let{className:t,title:a,description:o,action:i,icon:l}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col items-center justify-center py-8 bg-brand-dashboard-card rounded-lg w-full",t),children:(0,r.jsx)(s.n,{title:a,description:o,action:i,icon:l})})}},52151:(e,t,a)=>{a.d(t,{T:()=>s});var r=a(9381),n=a(10689);let s=e=>{var t,a;let{users:s,selectedUser:o,onUserSelect:i}=e,[l,d]=(0,n.useState)(""),[c,u]=(0,n.useState)([]),m=(e,t)=>e.toLowerCase().indexOf(t.toLowerCase()),h=(e,t)=>{let a=m(e.name,t),r=m(e.email,t);return -1===a&&-1===r?-1:-1===a?r:-1===r?a:Math.min(a,r)};(0,n.useEffect)(()=>{if(!l.trim())return void u([]);u([...s].filter(e=>{let t=l.toLowerCase();return e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)}).sort((e,t)=>h(e,l)-h(t,l)))},[l,s]);let p=null==(t=s.find(e=>e.id===o))?void 0:t.name,g=null==(a=s.find(e=>e.id===o))?void 0:a.email;return(0,r.jsx)("div",{className:"min-w-[300px]",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",id:"user-search",value:l,onChange:e=>d(e.target.value),placeholder:o?"".concat(p," (").concat(g,")"):"Search email, name...",className:"dashboard-input w-full",onFocus:()=>{o&&d("")},onBlur:()=>{setTimeout(()=>{!l&&o&&d("")},150)}}),o&&(0,r.jsx)("button",{onClick:()=>{i(void 0),d(""),u([])},className:"absolute inset-y-0 right-0 flex items-center pr-3","aria-label":"Clear selected user",children:(0,r.jsx)("svg",{className:"dark:text-brand-gray-500 h-5 w-5 text-brand-gray-400 hover:text-brand-gray-600 dark:hover:text-brand-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(l||c.length>0)&&(0,r.jsx)("div",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border border-brand-neutrals-100 bg-[#222222] shadow-lg dark:border-brand-neutrals-800",children:(0,r.jsxs)("div",{className:"py-1",children:[(0,r.jsx)("div",{className:"cursor-pointer px-3 py-2 text-brand-foreground hover:bg-brand-background dark:hover:bg-brand-background",onClick:()=>{i(void 0),d(""),u([])},children:"All Users"}),c.map(e=>(0,r.jsxs)("div",{className:"cursor-pointer px-3 py-2",onClick:()=>{i(e.id),d(""),u([])},children:[(0,r.jsx)("div",{className:"text-brand-foreground",children:e.name}),(0,r.jsx)("div",{className:"text-sm text-brand-gray-600 dark:text-brand-gray-400",children:e.email})]},e.id))]})})]})})}},54153:(e,t,a)=>{a.r(t),a.d(t,{Label:()=>d});var r=a(9381),n=a(29248),s=a(97098),o=a(10689),i=a(37095);let l=(0,s.F)("text-sm/[1.25rem] -tracking-1 peer-disabled:cursor-not-allowed md:text-base/[1.5rem] md:tracking-0"),d=o.forwardRef((e,t)=>{let{className:a,children:s,htmlFor:o,...d}=e;return(0,r.jsx)(n.b,{ref:t,className:(0,i.cn)(l(),a),htmlFor:o,...d,children:s})});d.displayName=n.b.displayName},56735:(e,t,a)=>{a.d(t,{I:()=>n});var r=a(9381);a(35371);let n=e=>{let{icon:t,className:a="",...n}=e;return(0,r.jsx)("button",{className:"dashboard-icon-button ".concat(a),...n,children:t})}},59303:(e,t,a)=>{a.d(t,{t:()=>m});var r=a(9381),n=a(90037),s=a(29227),o=a(37095),i=a(10689),l=a(12061),d=a(95612),c=a(28790),u=a(8231);function m(e){let t,{teams:a,hardLimit:m,hardLimitPerUser:h,usageBasedPremiumRequests:p,adminOnlyUsagePricing:g,updateHardLimit:x,updateUsageBasedPremiumRequests:f,updateAdminOnlyUsagePricing:b,isSavingUsageSettings:v,usageSettingsError:y,showPremiumModelsToggle:w=!0,showAdminOnlyToggle:j=!0,showPermissionMessage:N=!0,canEditUsage:k,showTeamLevelLimits:C=!0,useDashboardFallback:S=!1}=e,E=(0,l.M)(),A=null!=a?a:E.teams,T=null!=m?m:S?E.hardLimit:"no-usage-based",R=null!=h?h:S?E.hardLimitPerUser:"no-limit",L=null!=p?p:!!S&&E.usageBasedPremiumRequests,M=null!=g?g:!!S&&E.adminOnlyUsagePricing,I=null!=x?x:E.updateHardLimit,F=null!=f?f:E.updateUsageBasedPremiumRequests,B=null!=b?b:E.updateAdminOnlyUsagePricing,D=null!=v?v:E.isSavingUsageSettings,O=null!=y?y:E.usageSettingsError,P=null==A?void 0:A.find(e=>e.seats>0),U=P&&((t=P.role)===n.acM.OWNER||t===n.acM.FREE_OWNER),_=null!=k?k:!M||U,W="no-usage-based"!==T&&null!=T||"no-limit"!==R&&null!=R,[z,H]=(0,i.useState)(T&&"no-usage-based"!==T?"$".concat(T):"$50"),[J,V]=(0,i.useState)("no-limit"!==R&&null!=R?"$".concat(R):C?"":"$10"),[q,K]=(0,i.useState)(null),[G,Y]=(0,i.useState)("no-limit"!==R&&null!=R);(0,i.useEffect)(()=>{H(T&&"no-usage-based"!==T?"$".concat(T):"$50")},[T]),(0,i.useEffect)(()=>{V("no-limit"!==R&&null!=R?"$".concat(R):C?"":"$10"),Y("no-limit"!==R&&null!=R)},[R,C]);let $=(0,i.useCallback)(async e=>{if(I){K(null);try{if(e)if(C)await I(50,"no-limit");else{let e=null!=T&&"no-usage-based"!==T?T:"no-usage-based";await I(e,10)}else await I("no-usage-based","no-limit")}catch(e){console.error("Failed to toggle hard limit:",e)}}},[I,C,T]),Z=(0,i.useCallback)(async e=>{if(F){K(null);try{await F(e)}catch(e){console.error("Failed to toggle premium requests:",e)}}},[F]),Q=(0,i.useCallback)(async e=>{if(B){K(null);try{await B(e)}catch(e){console.error("Failed to toggle admin only:",e)}}},[B]),X=(0,i.useCallback)(e=>{Y(e),K(null),e?""===J&&V("$10"):V("")},[J]),ee=(0,i.useCallback)(async()=>{let e,t;if(I){if(K(null),C){let t=z.startsWith("$")?z.substring(1):z,a=parseInt(t);e=""===t||isNaN(a)||a<=0?"no-usage-based":a}else e=null!=T&&"no-usage-based"!==T?T:"no-usage-based";if(G){if(""===J||isNaN(t=parseInt(J.startsWith("$")?J.substring(1):J))||t<0)return void K("Please enter a valid non-negative number for per-user limit.")}else t="no-limit";try{await I(e,t)}catch(e){console.error("Failed to save limits:",e)}}},[z,J,I,C,T,G]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(u.A,{trailingCaption:O||q||N&&!_?(0,r.jsxs)(r.Fragment,{children:[(O||q)&&(0,r.jsx)("div",{className:"dashboard-text-red-primary",children:O||q}),N&&!_&&"Only team admins can modify usage-based pricing settings"]}):null,children:[j&&U&&(0,r.jsx)(d.J,{label:"Only Allow Admins to Edit Usage-Based Settings",trailingItems:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[D&&(0,r.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-brand-gray-300 border-t-transparent"}),(0,r.jsx)(s.Switch,{checked:null!=M&&M,disabled:D,onCheckedChange:Q})]})}),(0,r.jsx)(d.J,{label:"Usage-Based Pricing",description:"Enable usage-based pricing to pay for extra requests beyond your plan's included usage",trailingItems:_?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[D&&(0,r.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-brand-gray-300 border-t-transparent"}),(0,r.jsx)(s.Switch,{checked:W,disabled:D,onCheckedChange:$})]}):(0,r.jsx)("span",{className:"font-mono text-sm",children:W?"Enabled":"Disabled"})}),w&&W&&!1===L&&(0,r.jsx)(d.J,{label:"Allow usage-based pricing for premium models",trailingItems:_?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[D&&(0,r.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-brand-gray-300 border-t-transparent"}),(0,r.jsx)(s.Switch,{checked:L,disabled:D,onCheckedChange:Z})]}):(0,r.jsx)("span",{className:"font-mono text-sm",children:L?"Enabled":"Disabled"})}),W&&(0,r.jsxs)(r.Fragment,{children:[C&&(0,r.jsx)(d.J,{label:(null==P?void 0:P.id)?"Set Monthly Team Spend Limit":"Set Monthly Spend Limit",trailingItemsCaption:"Required",trailingItems:(0,r.jsx)("div",{className:"flex items-center gap-2",children:_?(0,r.jsx)("label",{className:"relative inline-flex cursor-pointer items-center",children:(0,r.jsx)("input",{type:"text",autoComplete:"off",className:(0,o.cn)("dashboard-cell-input-compact",(O||q)&&"dashboard-cell-input-compact-error"),value:z,placeholder:"$50",disabled:D,onChange:e=>{H(e.target.value),K(null)},onKeyDown:e=>{"Enter"===e.key&&ee()}})}):(0,r.jsx)("span",{className:"font-mono text-sm",children:z||"$0"})})}),(null==P?void 0:P.id)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.J,{label:"Set Monthly Per-User Spend Limit",trailingItemsCaption:"Optional",trailingItems:(0,r.jsx)("div",{className:"flex items-center gap-2",children:_?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Switch,{checked:G,disabled:D,onCheckedChange:X}),(0,r.jsx)("input",{type:"text",autoComplete:"off",className:(0,o.cn)("dashboard-cell-input-compact",(O||q)&&"dashboard-cell-input-compact-error"),value:J,placeholder:"Not set",disabled:!G||D,onChange:e=>{V(e.target.value),K(null)},onKeyDown:e=>{"Enter"===e.key&&ee()}})]}):(0,r.jsx)("span",{className:"font-mono text-sm",children:G?J||"$0":"Not set"})})}),"1"===String(P.id)&&(0,r.jsx)("div",{className:"mt-2 bg-red-900/20 border border-red-500/50 rounded-md p-3 text-red-400",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-red-400 font-bold text-lg",children:"⚠️"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"font-semibold text-red-300 mb-1",children:"WARNING: CHANGING THIS IS BLOCKED FOR DEVS NEW PRICING TESTING"}),(0,r.jsx)("div",{className:"text-sm text-red-400",children:"If you need to change this, post in #pricing and tag Jediah."})]})]})})]}),_&&(0,r.jsx)("div",{className:"flex justify-end py-4 pr-4",children:(0,r.jsx)(c.j,{onClick:ee,disabled:D||!!q,color:O||q?"red":"default",children:D?"Saving...":O||q?"Try Again":"Save Limits"})})]})]})})}},64149:(e,t,a)=>{a.d(t,{n:()=>n});var r=a(9381);a(35371);let n=e=>{let{className:t,title:a,description:n,action:s,icon:o}=e;return(0,r.jsx)("div",{className:"dashboard-empty-state-wrapper ".concat(t||""),children:(0,r.jsxs)("div",{className:"dashboard-empty-state-content",children:[o&&(0,r.jsx)("div",{className:"dashboard-empty-state-icon",children:o}),(0,r.jsxs)("div",{className:"dashboard-empty-state-text",children:[(0,r.jsx)("h3",{className:"dashboard-empty-state-title",children:a}),(0,r.jsx)("p",{className:"dashboard-empty-state-description",children:n})]}),s&&(0,r.jsx)("div",{className:"dashboard-empty-state-actions",children:s.href&&!s.disabled?(0,r.jsxs)("a",{href:s.href,className:"dashboard-empty-state-button ".concat(s.disabled?"disabled":""),children:[s.icon,s.label]}):(0,r.jsxs)("button",{onClick:s.disabled?void 0:s.onClick,className:"dashboard-empty-state-button ".concat(s.disabled?"disabled":""),disabled:s.disabled,children:[s.icon,s.label]})})]})})}},67369:(e,t,a)=>{a.d(t,{X:()=>o});var r=a(9381),n=a(24977),s=a(89888);let o=()=>(0,r.jsxs)(n.Z,{className:"p-8 flex flex-col items-center text-center gap-3 bg-brand-dashboard-card dark:bg-brand-dashboard-card border-0",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(s.o5,{as:"h2",variant:"p1",className:"text-sm font-medium",children:"Invite Team Members"}),(0,r.jsx)(s.o5,{variant:"p1",className:"max-w-md text-brand-gray-300 text-sm",children:"Accelerate your team with admin controls, analytics, and enterprise-grade security"})]}),(0,r.jsx)("button",{className:"flex items-center gap-1.5 rounded-md border border-brand-borders px-3 py-1.5 text-xs text-white transition duration-150 ease hover:bg-white/[0.04] mx-auto",onClick:()=>{window.location.href="/team/new-team"},children:"Invite Your Team"})]})},68551:(e,t,a)=>{a.d(t,{$d:()=>x,C4:()=>g,IB:()=>o,JJ:()=>s,Jg:()=>k,Ju:()=>p,Le:()=>w,P5:()=>f,Q1:()=>S,XG:()=>h,bo:()=>j,d9:()=>b,f6:()=>m,g3:()=>l,jC:()=>i,kB:()=>N,ow:()=>E,s9:()=>v,xH:()=>C,xh:()=>y,zB:()=>n});var r=a(25194);async function n(e){var t;let a=await fetch("/api/background-composer/get-detailed-composer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e,n:1,includeDiff:!0,includeTeamWide:!0})});return(null==(t=new r.VF().fromJson(await a.json(),{ignoreUnknownFields:!0}).composers)?void 0:t[0])||null}function s(e,t){return o(e)-o(t)}function o(e){let t=e.updatedAtMs;return t&&"number"==typeof t&&t>0?t:e.createdAtMs||0}async function i(e){var t;if(!(null==e||null==(t=e.composer)?void 0:t.bcId))return{error:"No composer ID provided"};try{let t=await fetch("/api/background-composer/open-pr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e.composer.bcId})}),a=await t.json();if(a.prUrl&&!a.error)return{prUrl:a.prUrl};return{error:"Error creating PR: No changes pushed to branch yet"}}catch(e){return console.error("Failed to create PR:",e),{error:"Failed to create PR: ".concat(e instanceof Error?e.message:JSON.stringify(e))}}}function l(e){window.open(e,"_blank","noopener,noreferrer")}let d={SELECTED_REPO:"background-composer-selected-repo",SELECTED_BRANCH:"background-composer-selected-branch",SELECTED_MODEL:"background-composer-selected-model",SELECTED_MODELS:"background-composer-selected-models",LAUNCHED_GPT5:"background-composer-launched-gpt5",PR_URL_PREFIX:"background-composer-pr-url-",PR_MERGE_STATUS_PREFIX:"background-composer-pr-merge-status-"},c=(e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(e){console.warn("Failed to save to localStorage:",e)}},u=e=>{try{let t=localStorage.getItem(e);return null!==t?JSON.parse(t):null}catch(e){return console.warn("Failed to load from localStorage:",e),null}},m=()=>{let e=u(d.SELECTED_REPO);return null!==e?e:void 0},h=()=>{let e=u(d.SELECTED_BRANCH);return null!==e?e:void 0},p=()=>{let e=u(d.LAUNCHED_GPT5),t=u(d.SELECTED_MODELS);if(Array.isArray(t)&&t.length>0){let a=t.map(e=>"claude-4-sonnet-thinking"===e?"claude-4-sonnet":"claude-4-opus-thinking"===e?"claude-4-opus":e).filter((e,t,a)=>a.indexOf(e)===t);if(!e){let e=["gpt-5"];return c(d.SELECTED_MODELS,e),c(d.SELECTED_MODEL,e[0]),c(d.LAUNCHED_GPT5,!0),e}return t.some(e=>"claude-4-sonnet-thinking"===e||"claude-4-opus-thinking"===e)&&(c(d.SELECTED_MODELS,a),c(d.SELECTED_MODEL,a[0])),a}let a=u(d.SELECTED_MODEL);if(a){if(!e){let e="gpt-5";return c(d.SELECTED_MODELS,[e]),c(d.SELECTED_MODEL,e),c(d.LAUNCHED_GPT5,!0),[e]}if("claude-4-sonnet-thinking"===a){let e="claude-4-sonnet";return c(d.SELECTED_MODELS,[e]),c(d.SELECTED_MODEL,e),[e]}if("claude-4-opus-thinking"===a){let e="claude-4-opus";return c(d.SELECTED_MODELS,[e]),c(d.SELECTED_MODEL,e),[e]}return[a]}return e||c(d.LAUNCHED_GPT5,!0),["gpt-5"]},g=()=>{try{localStorage.removeItem(d.SELECTED_BRANCH)}catch(e){console.warn("Failed to clear cached branch:",e)}},x=e=>{c(d.SELECTED_REPO,e)},f=e=>{c(d.SELECTED_BRANCH,e)},b=e=>{try{if(0===e.length){localStorage.removeItem(d.SELECTED_MODELS),localStorage.removeItem(d.SELECTED_MODEL);return}let t=e.map(e=>"claude-4-sonnet-thinking"===e?"claude-4-sonnet":"claude-4-opus-thinking"===e?"claude-4-opus":e).filter((e,t,a)=>a.indexOf(e)===t);c(d.SELECTED_MODELS,t),c(d.SELECTED_MODEL,t[0])}catch(e){console.warn("Failed to cache selected models:",e)}},v=(e,t)=>{if(!t)return void y(e);c("".concat(d.PR_URL_PREFIX).concat(e),t)},y=e=>{try{localStorage.removeItem("".concat(d.PR_URL_PREFIX).concat(e))}catch(e){console.warn("Failed to clear cached PR URL:",e)}},w=e=>{let t=u("".concat(d.PR_MERGE_STATUS_PREFIX).concat(encodeURIComponent(e)));if(t)return t},j=(e,t)=>{let a="".concat(d.PR_MERGE_STATUS_PREFIX).concat(encodeURIComponent(e));if(!t)return void N(e);c(a,t.toJson())},N=e=>{let t="".concat(d.PR_MERGE_STATUS_PREFIX).concat(encodeURIComponent(e));try{localStorage.removeItem(t)}catch(e){console.warn("Failed to clear cached PR merge status:",e)}},k=async e=>{let t=w(e);if(t)return t;try{let t=await fetch("/api/background-composer/get-pull-request-merge-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prUrl:e})});if(!t.ok)throw Error("Failed to fetch PR merge status: ".concat(t.statusText));let a=new r.Kj().fromJson(await t.json());return j(e,a),a}catch(e){return console.error("Error fetching PR merge status:",e),null}},C=(e,t)=>{var a,r;if(null==e||null==(a=e.diffSinceStart)?void 0:a.diffs){let t=0,a=0;if(e.diffSinceStart.diffs.forEach(e=>{e.chunks.forEach(e=>{t+=e.newLines,a+=e.oldLines})}),t>0||a>0)return{totalAdded:t,totalRemoved:a}}if(null==t||null==(r=t.diff)?void 0:r.diffs){let e=0,a=0;if(t.diff.diffs.forEach(t=>{void 0!==t.added&&void 0!==t.removed?(e+=t.added,a+=t.removed):t.chunks.forEach(t=>{e+=t.newLines,a+=t.oldLines})}),t.submoduleDiffs&&t.submoduleDiffs.forEach(t=>{var r;(null==(r=t.diff)?void 0:r.diffs)&&t.diff.diffs.forEach(t=>{void 0!==t.added&&void 0!==t.removed?(e+=t.added,a+=t.removed):t.chunks.forEach(t=>{e+=t.newLines,a+=t.oldLines})})}),e>0||a>0)return{totalAdded:e,totalRemoved:a}}return null},S=e=>{let t="cursor://anysphere.cursor-deeplink/background-agent?bcId=".concat(encodeURIComponent(e));try{window.location.href=t}catch(e){console.error("Failed to open in Cursor:",e),alert("Please make sure Cursor is installed to use this feature.")}},E=e=>{let t="/workspace/";return e.startsWith(t)?e.slice(t.length):e}},74906:(e,t,a)=>{a.d(t,{T:()=>o});var r=a(9381),n=a(84308);a(35371);var s=a(43693);function o(e){return(0,r.jsxs)("div",{className:"dashboard-tab-header",style:e.noHorizontalPadding?{paddingLeft:0,paddingRight:0}:void 0,children:[e.onBack&&(0,r.jsxs)("button",{className:"dashboard-text-button",onClick:e.onBack,children:[(0,r.jsx)(n.A,{className:"h-4 w-4"})," Back"]}),(0,r.jsxs)("div",{className:"dashboard-tab-header-content",children:[(0,r.jsxs)("div",{className:"dashboard-xl semibold dashboard-tab-header-title",children:[e.title,e.badgeLabel&&(0,r.jsx)(s.m,{label:e.badgeLabel})]}),e.description&&(0,r.jsx)("div",{className:"dashboard-base dashboard-tab-header-description",children:e.description})]})]})}},75281:(e,t,a)=>{a.d(t,{p:()=>d});var r=a(9381),n=a(37095),s=a(42768),o=a(41396),i=a(10689);let l={type:"spring",stiffness:250,damping:25},d=(0,i.forwardRef)((e,t)=>{let{onMouseEnter:a,onMouseLeave:d,className:c,size:u=28,...m}=e,h=(0,s.s)(),p=(0,i.useRef)(!1);(0,i.useImperativeHandle)(t,()=>(p.current=!0,{startAnimation:()=>h.start("animate"),stopAnimation:()=>h.start("normal")}));let g=(0,i.useCallback)(e=>{p.current?null==a||a(e):h.start("animate")},[h,a]),x=(0,i.useCallback)(e=>{p.current?null==d||d(e):h.start("normal")},[h,d]);return(0,r.jsx)("div",{className:(0,n.cn)(c),onMouseEnter:g,onMouseLeave:x,...m,children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:u,height:u,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)(o.P.path,{variants:{normal:{y:0},animate:{y:2}},transition:l,animate:h,initial:"normal",d:"m7 15 5 5 5-5"}),(0,r.jsx)(o.P.path,{variants:{normal:{y:0},animate:{y:-2}},transition:l,animate:h,initial:"normal",d:"m7 9 5-5 5 5"})]})})});d.displayName="ChevronsUpDownIcon"},80895:(e,t,a)=>{a.d(t,{Yq:()=>p,UQ:()=>x,_F:()=>g});var r=a(9381);a(44064);var n=a(25194),s=a(4352),o=a(10689),i=a(68551);let l="Sorry for the interruption. Please continue.";async function d(e){try{let t=await fetch("/api/auth/getBackgroundComposerConversation",{method:"POST",body:JSON.stringify({bcId:e}),headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();return n.rV.fromJson(a).conversation.filter(e=>e.type!==s.Jc.HUMAN||e.text!==l)}catch(e){throw console.error("Failed to fetch conversation:",e),e}}var c=a(37147);let u="bc_diff_last_refetch",m=(e,t)=>{try{localStorage.setItem("".concat(u,"_").concat(e),t.toString())}catch(e){}},h=e=>{var t,a;if(!e)return!1;let r=(null==(t=e.message)?void 0:t.toLowerCase())||"",n=(null==(a=e.name)?void 0:a.toLowerCase())||"",s=e.code||"",o=e.type||"";return"typeerror"===n||r.includes("network error")||r.includes("network_io_suspended")||r.includes("failed to fetch")||r.includes("connection")||"NETWORK_ERR"===s||"network"===o},p=(0,o.createContext)(void 0),g=()=>{let e=(0,o.useContext)(p);if(void 0===e)throw Error("useAgents must be used within an AgentsProvider");return e},x=e=>{let{children:t}=e,[a,l]=(0,o.useState)([]),g=(0,o.useRef)([]);(0,o.useEffect)(()=>{g.current=a},[a]);let[x,f]=(0,o.useState)(new Map),[b,v]=(0,o.useState)(new Map),[y,w]=(0,o.useState)(new Map),[j,N]=(0,o.useState)(new Map),[k,C]=(0,o.useState)(new Map),[S,E]=(0,o.useState)(!0),[A,T]=(0,o.useState)(new Map),[R,L]=(0,o.useState)(!1),[M,I]=(0,o.useState)(!1),[F,B]=(0,o.useState)(!1),[D,O]=(0,o.useState)(!1),[P,U]=(0,o.useState)(!1),[_,W]=(0,o.useState)(new Set),[z,H]=(0,o.useState)(null),J=(0,o.useRef)(!1),[V,q]=(0,o.useState)("unified"),[K,G]=(0,o.useState)(null);(0,o.useEffect)(()=>{{let e=()=>{let e=new URL(window.location.href);return e.searchParams.get("selectedBcId")||e.searchParams.get("id")||null};G(e());let t=()=>{G(e())};return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)}},[]);let Y=(0,o.useMemo)(()=>null===z?null:z||K,[z,K]),$=(0,o.useCallback)(e=>{null===e&&(J.current=!0),H(e);{let t=new URL(window.location.href);e?t.searchParams.set("selectedBcId",e):t.searchParams.delete("selectedBcId"),window.history.replaceState({},"",t.toString())}null===e&&setTimeout(()=>{J.current=!1},100)},[]);(0,o.useEffect)(()=>{!K||z||J.current||H(K)},[K,z]),(0,o.useEffect)(()=>{try{let e=localStorage.getItem("background-composer-diff-view-mode");("split"===e||"unified"===e)&&q(e)}catch(e){console.warn("Failed to read diff view mode from localStorage:",e)}},[]);let Z=(0,o.useCallback)(e=>{q(e);try{localStorage.setItem("background-composer-diff-view-mode",e)}catch(e){console.warn("Failed to save diff view mode to localStorage:",e)}},[]);(0,o.useEffect)(()=>{L(!0)},[]),(0,o.useEffect)(()=>{el.current=y},[y]),(0,o.useEffect)(()=>{ed.current=j},[j]);let Q=(0,o.useRef)(new Map);(0,o.useEffect)(()=>{Q.current=x},[x]),(0,o.useEffect)(()=>{R&&(0,c.u2)()},[R]);let X=(0,o.useRef)(new Set),ee=(0,o.useRef)(new Set),et=(0,o.useRef)(new Set),ea=(0,o.useRef)(new Map),er=(0,o.useRef)(new Map),en=(0,o.useRef)(new Map),es=(0,o.useRef)(new Map),eo=(0,o.useRef)(new Map),ei=(0,o.useRef)(new Set),el=(0,o.useRef)(new Map),ed=(0,o.useRef)(new Map),ec=(0,o.useRef)(new Map),eu=(0,o.useRef)(new Set),em=(0,o.useRef)(new Map),eh=(0,o.useRef)(new Map),ep=(0,o.useRef)(new Map),eg=(0,o.useCallback)(e=>{var t,a,r,n,s,o,i,l,d,c,u,m,h;if(void 0!==e.buildStarted)return"[Build] Started: ".concat(e.buildStarted);if(void 0!==e.buildStatusMessage)return"[Build] Status: ".concat(e.buildStatusMessage);if(void 0!==e.buildStepStarted){let t=e.buildStepStarted;return"[Build] Step ".concat(t.step,"/").concat(t.totalSteps,": ").concat(t.command)}if(void 0!==e.buildStatusLine)return e.buildStatusLine.content;if(void 0!==e.error)return"[Error] ".concat(e.error.errorMessage);else if(void 0!==e.creationCompleted)return"[Status] Creation completed";else if(void 0!==e.startupCompleted)return"[Status] Startup completed\n[Status] Starting Cursor...";else if(void 0!==e.prepareStdout||void 0!==e.installStdout||void 0!==e.startStdout||void 0!==e.prepareStderr||void 0!==e.installStderr||void 0!==e.startStderr)return e.prepareStdout||e.installStdout||e.startStdout||e.prepareStderr||e.installStderr||e.startStderr;else if(void 0!==e.extensionInstallStdout||void 0!==e.extensionStartStdout)return(e.extensionInstallStdout||e.extensionStartStdout).output;else if(void 0!==e.prepareExitCode||void 0!==e.installExitCode||void 0!==e.startExitCode){let r=Number(null!=(a=null!=(t=e.prepareExitCode)?t:e.installExitCode)?a:e.startExitCode);if(isNaN(r))return"[Exit] Completed (code: unknown)";let n=0===r?"Success":"Failed";return"[Exit] ".concat(n," (code: ").concat(r,")")}else if(void 0!==e.extensionInstallExitCode||void 0!==e.extensionStartExitCode){let t=Number(null!=(r=e.extensionInstallExitCode)?r:e.extensionStartExitCode);if(isNaN(t))return"[Exit] Completed (code: unknown)";let a=0===t?"Success":"Failed";return"[Exit] ".concat(a," (code: ").concat(t,")")}else if(void 0!==e.debugEvent)return"[Debug] ".concat(e.debugEvent);else if(void 0!==e.imagePullStarted){let{imageName:t,pullId:a}=e.imagePullStarted;return"[Docker] Pulling image: ".concat(t," (ID: ").concat(a,")")}else if(void 0!==e.imagePullLayerUpdate){let t=e.imagePullLayerUpdate,a=t.layerId?t.layerId.substring(0,12):"unknown";if(null==(n=t.status)?void 0:n.downloading){let e=t.status.downloading,r=Number(e.current),n=Number(e.total),s=!(n>0)||isNaN(r)||isNaN(n)?0:Math.round(r/n*100);return"[Docker] Layer ".concat(a,": downloading ").concat(s,"%")}if(null==(s=t.status)?void 0:s.extracting){let e=t.status.extracting,r=Number(e.current),n=Number(e.total),s=!(n>0)||isNaN(r)||isNaN(n)?0:Math.round(r/n*100);return"[Docker] Layer ".concat(a,": extracting ").concat(s,"%")}if(null==(o=t.status)?void 0:o.pullingFsLayer)return"[Docker] Layer ".concat(a,": Pulling FS layer");else if(null==(i=t.status)?void 0:i.waiting)return"[Docker] Layer ".concat(a,": Waiting");else if(null==(l=t.status)?void 0:l.verifyingChecksum)return"[Docker] Layer ".concat(a,": Verifying checksum");else if(null==(d=t.status)?void 0:d.downloadComplete)return"[Docker] Layer ".concat(a,": Download complete");else if(null==(c=t.status)?void 0:c.pullComplete)return"[Docker] Layer ".concat(a,": Pull complete");else if(null==(u=t.status)?void 0:u.other)return"[Docker] Layer ".concat(a,": ").concat(t.status.other)}else if(void 0!==e.imagePullStatusUpdate){let t=e.imagePullStatusUpdate;return"[Docker] Image pull status: ".concat(t.status)}else if(void 0!==e.imagePullCompleted){let{imageName:t}=e.imagePullCompleted;return"[Docker] Pull completed for image: ".concat(t)}else if(void 0!==e.blockedRepoState){let t=null!=(h=null==(m=e.blockedRepoState)?void 0:m.podId)?h:"another";return"[Status] Blocked on Background Agent (".concat(t,")")}else if(void 0!==e.acquiredRepoState)return"[Status] Acquired repo state – continuing startup";else if(void 0!==e.internalBuildMessage)return null===e.internalBuildMessage||void 0===e.internalBuildMessage?"[Build] (empty message)":void 0!==e.internalBuildMessage.content?"[Build] ".concat(e.internalBuildMessage.content):"string"==typeof e.internalBuildMessage?"[Build] ".concat(e.internalBuildMessage):"[Build] ".concat(JSON.stringify(e.internalBuildMessage));else if(void 0!==e.cloneStarted)return"[Status] Cloning repository…";else if(void 0!==e.cloneCompleted)return"[Status] Repository cloned";else if(void 0!==e.checkoutStarted)return"[Status] Checking out repository…";else if(void 0!==e.checkoutCompleted)return"[Status] Repository checked out";else if(void 0!==e.snapshotStarted)return"[Status] Creating snapshot…";else if(void 0!==e.snapshotCompleted)return"[Status] Snapshot created"},[]),ex=(0,o.useCallback)((e,t,a)=>{N(r=>{if(w(n=>{let s=void 0!==a?a:n.get(e)||[],o=void 0!==t?new Map(r).set(e,t):r,i=new Map(n),l=n.get(e)||[],d=void 0!==a?a.filter(e=>!e.isTemporary):s.filter(e=>!e.isTemporary),c=l.filter(e=>!e.isTemporary);return c.length>0&&d.length<c.length?(console.log("[updateMergedConversation] Skipping update for ".concat(e," - new streaming data has fewer messages (").concat(d.length," < ").concat(c.length,")")),n):(i.set(e,d),void 0!==t&&o!==r&&setTimeout(()=>N(o),0),i)}),void 0!==t){let a=r.get(e)||[];return a.length>0&&t.length<a.length?(console.log("[updateMergedConversation] Skipping legacy update for ".concat(e," - new data has fewer messages (").concat(t.length," < ").concat(a.length,")")),r):new Map(r).set(e,t)}return r})},[]),ef=(0,o.useCallback)(e=>{if(!e||0===e.length)return!1;let t=0,a=0;for(let r of e)if(!r.isTemporary&&(r.type===s.Jc.HUMAN?t+=1:r.type===s.Jc.AI&&(a+=1),t>1||a>1))return!0;return!1},[]),eb=(0,o.useCallback)(e=>{let t=x.get(e),a=null==t?void 0:t.status,r=j.get(e),s=y.get(e)||[];return a===n.R6.RUNNING?s:a===n.R6.FINISHED?r&&0!==r.length?0===s.length?r:s.length>r.length||s.some(e=>e.isTemporary)?s:r:s:s},[y,j,x]),ev=(0,o.useMemo)(()=>[...a].sort(i.JJ),[a]),ey=(0,o.useCallback)(async e=>{let t=Q.current.get(e)||null;if(t)return t;if(X.current.has(e))for(let t=0;t<50;t++){await new Promise(e=>setTimeout(e,100));let t=Q.current.get(e)||null;if(t)return t}X.current.add(e);try{let t=await (0,i.zB)(e);if(t&&(f(a=>{let r=new Map(a);return r.set(e,t),r}),ep.current.set(e,Date.now()),t.composer)){let e=t.composer;l(t=>{let a=t.findIndex(t=>t.bcId===e.bcId);if(-1===a)return[...t,e];{let r=[...t];return r[a]=e,r}})}return t}catch(t){return console.error("Failed to fetch detailed composer for ".concat(e,":"),t),null}finally{X.current.delete(e)}},[]),ew=(0,o.useCallback)(async e=>{let t=null;if(v(a=>(t=a.get(e)||null,a)),t)return t;if(ee.current.has(e))return null;ee.current.add(e);try{let t=null;for(let a=0;a<=1;a++)try{let t=await fetch("/api/background-composer/get-diff-details",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e})}),a=await t.json(),r=new n.WG().fromJson(a);return v(t=>{let a=new Map(t);return a.set(e,r),a}),m(e,Date.now()),r}catch(r){t=r,a<1&&(console.warn("Failed to fetch detailed diff for ".concat(e," (attempt ").concat(a+1,"/").concat(2,"), retrying..."),r),await new Promise(e=>setTimeout(e,1e3)))}return console.error("Failed to fetch detailed diff for ".concat(e," after ").concat(2," attempts:"),t),v(t=>{let a=new Map(t);return a.set(e,null),a}),null}finally{ee.current.delete(e)}},[]),ej=(0,o.useCallback)(e=>{if(eh.current.has(e))return;let t=async()=>{try{let t=g.current.find(t=>t.bcId===e);if(!t){let t=eh.current.get(e);t&&(clearInterval(t),eh.current.delete(e));return}if(t.status!==n.R6.RUNNING&&t.status!==n.R6.CREATING&&t.status!==n.R6.UNSPECIFIED){console.log("[Periodic Diff Refetch] Agent ".concat(e," is not running, stopping periodic refetch"));let t=eh.current.get(e);t&&(clearInterval(t),eh.current.delete(e));return}(e=>{let t=(e=>{try{let t=localStorage.getItem("".concat(u,"_").concat(e));return t?parseInt(t,10):null}catch(e){return null}})(e);return!t||Date.now()-t>=1e4})(e)&&(console.log("[Periodic Diff Refetch] Refetching diff for ".concat(e)),await ew(e))}catch(t){console.error("[Periodic Diff Refetch] Error refetching diff for ".concat(e,":"),t)}};t();let a=setInterval(t,1e4);eh.current.set(e,a)},[ew]),eN=(0,o.useCallback)(async()=>{try{let e=await fetch("/api/background-composer/list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({n:100,include_status:!0})}),t=new n.Lg().fromJson(await e.json()),a=t.composers.sort(i.JJ);if(l(e=>{let r=new Set(a.map(e=>e.bcId)),s=e.filter(e=>et.current.has(e.bcId)?!r.has(e.bcId)||(et.current.delete(e.bcId),!1):!r.has(e.bcId));return[...a.map(a=>{let r=e.find(e=>e.bcId===a.bcId);if(!r)return a;let s=t.didLoadStatus&&a.status!==n.R6.UNSPECIFIED?a.status:r.status;r.status&&s&&r.status!==n.R6.FINISHED&&s===n.R6.FINISHED&&eu.current.add(a.bcId);let o=r.isArchived||!1,i=a.isArchived||!1;return!o&&i&&Y===a.bcId&&$(null),new n.hF({...r,...a,status:s})}),...s]}),eu.current.size>0){console.log("[AgentsContext] Refetching ".concat(eu.current.size," finished background composer(s):"),{bcIds:Array.from(eu.current.values()),timestamp:new Date().toISOString(),totalComposers:a.length});let e=Array.from(eu.current.values());eu.current.clear(),e.forEach(async e=>{await ey(e);let t=a.find(t=>t.bcId===e);if(null==t?void 0:t.createdAtMs){await ew(e);let t=eh.current.get(e);t&&(clearInterval(t),eh.current.delete(e))}})}}catch(e){console.error("Failed to fetch background composers:",e)}finally{E(!1)}},[ey,ew]);(0,o.useEffect)(()=>{if(0===ev.length){f(e=>e.size>0?new Map:e),X.current.clear();return}(async()=>{let e=Q.current,t=ev.filter(t=>!X.current.has(t.bcId)&&(!e.get(t.bcId)||(t.updatedAtMs||t.createdAtMs||0)>(ep.current.get(t.bcId)||0)));0!==t.length&&(t.forEach(e=>{X.current.add(e.bcId)}),t.forEach(async e=>{try{var t;let a=await fetch("/api/background-composer/get-detailed-composer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e.bcId,n:1,includeDiff:!0,includeTeamWide:!0})}),r=null==(t=new n.VF().fromJson(await a.json(),{ignoreUnknownFields:!0}).composers)?void 0:t[0];r&&(f(t=>{let a=new Map(t);return a.set(e.bcId,r),a}),ep.current.set(e.bcId,Date.now()))}catch(t){console.error("Failed to fetch detailed composer for ".concat(e.bcId,":"),t)}finally{X.current.delete(e.bcId)}}))})()},[ev]);let ek=async()=>{await eN()};(0,o.useEffect)(()=>{eN();let e=setInterval(eN,1e4);return()=>clearInterval(e)},[eN]),(0,o.useEffect)(()=>()=>{en.current.forEach(e=>{clearInterval(e)}),en.current.clear(),eo.current.clear(),es.current.forEach(e=>{e.abort()}),es.current.clear(),ei.current.clear(),ea.current.forEach(e=>{clearInterval(e)}),ea.current.clear(),eh.current.forEach(e=>{clearInterval(e)}),eh.current.clear(),ec.current.forEach(e=>{e.abort()}),ec.current.clear()},[]);let eC=(0,o.useCallback)(()=>{en.current.forEach(e=>{clearInterval(e)}),en.current.clear(),eo.current.clear(),es.current.forEach(e=>{e.abort()}),es.current.clear(),ei.current.clear(),ec.current.forEach(e=>{e.abort()}),ec.current.clear(),eh.current.forEach(e=>{clearInterval(e)}),eh.current.clear()},[]),eS=(0,o.useCallback)(e=>{let t=ec.current.get(e);t&&(t.abort(),ec.current.delete(e))},[]),eE=(0,o.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;eS(e);let a=new AbortController;ec.current.set(e,a),(async()=>{try{let t=await fetch("/api/background-composer/attach-background-composer-logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e}),signal:a.signal});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));if(!t.body)throw Error("Response body is null");let o=t.body.getReader(),i=new TextDecoder,l="";try{for(;;){let{done:t,value:a}=await o.read();if(t)break;let d=i.decode(a,{stream:!0}),c=(l+=d).split("\n");for(let t of(l=c.pop()||"",c))if(t.trim())try{var r,n,s;let a,o=JSON.parse(t);if(console.log("[startLogStreaming] logEntry",o),o.error&&console.error("Error streaming logs for bcId ".concat(e,":"),o.error),null==(r=o.data)?void 0:r.updatedStatus){let t=o.data.updatedStatus;if("running"===t||"RUNNING"===t){console.log("[startLogStreaming] Streaming disabled; NOT starting conversation stream for ".concat(e));continue}}if(null==(s=o.data)||null==(n=s.event)?void 0:n.event){let e=o.data.event.event;a=eg(e)}if(o.data||o.error){let t={timestamp:o.timestamp,chunkIndex:o.chunkIndex,data:o.data||{error:o.error},fullEntry:o,interpretedMessage:a};C(a=>{let r=new Map(a),n=r.get(e)||[];return r.set(e,[...n,t]),r})}}catch(e){}}}finally{o.releaseLock()}}catch(r){if(r instanceof Error&&"AbortError"===r.name)console.log("[startLogStreaming] Log stream aborted for ".concat(e));else if(console.error("Error streaming logs for bcId ".concat(e,":"),r),h(r)&&t<10){let r=Math.min(1e3*Math.pow(2,t),3e4);console.log("[startLogStreaming] Network error for ".concat(e,", retrying in ").concat(r,"ms (attempt ").concat(t+1,"/10)")),ec.current.delete(e),setTimeout(()=>{a.signal.aborted||eE(e,t+1)},r);return}}finally{ec.current.delete(e)}})()},[eS,ex]),eA=(0,o.useCallback)((e,t,a)=>{{let t=en.current.get(e);t&&(clearTimeout(t),en.current.delete(e)),ei.current.delete(e)}let r=es.current.get(e);r&&(r.abort(),es.current.delete(e)),T(t=>{if(!t.has(e)){let a=new Map(t);return a.set(e,!0),a}return t});let o=em.current.get(e),i=a||o;if(i){if(i.promptText){let t=new s.hS({type:s.Jc.HUMAN,text:i.promptText,attachedCodeChunks:[],images:i.images||[]});t.isDone=!0,t.isTemporary=!0,w(a=>{let r=new Map(a);return 0===(r.get(e)||[]).length&&r.set(e,[t]),r})}i.modelDetails&&f(t=>{let a=t.get(e);if(a){let r=new Map(t),s=new n.vQ({...a,modelDetails:i.modelDetails});return r.set(e,s),r}return t}),o&&!a&&em.current.delete(e)}t!==n.R6.FINISHED&&eE(e),(t===n.R6.RUNNING||t===n.R6.CREATING||t===n.R6.UNSPECIFIED)&&ej(e);let l=()=>{{console.log("[startConversationFetching] Streaming disabled, using polling for ".concat(e));let t=t=>{let a=setTimeout(r,t);en.current.set(e,a)},a=()=>{let t=en.current.get(e);t&&(clearTimeout(t),en.current.delete(e))},r=async()=>{try{let r=g.current.find(t=>t.bcId===e),s=null==r?void 0:r.status;if(s!==n.R6.RUNNING&&s!==n.R6.CREATING&&s!==n.R6.UNSPECIFIED){console.log("[startConversationFetching] Composer ".concat(e," is in ").concat(s," state, stopping polling")),a();return}let o=await d(e);w(t=>{let a=new Map(t),r=t.get(e);return r&&r.length>0&&o.length<r.length?(console.log("[startConversationFetching] Skipping update for ".concat(e," - new conversation has fewer messages (").concat(o.length," < ").concat(r.length,")")),t):(a.set(e,o),a)}),N(t=>{let a=new Map(t),r=t.get(e);return r&&r.length>0&&o.length<r.length?t:(a.set(e,o),a)}),T(t=>{let a=new Map(t);return a.set(e,!1),a}),ef(o)&&(console.log("[startConversationFetching] Conversation beyond minimal for ".concat(e," from polling, stopping log streaming")),eS(e));let i=s===n.R6.RUNNING?900:1500;t(i)}catch(r){if(console.error("[startConversationFetching] Polling error for ".concat(e,":"),r),!ei.current.has(e))return void a();t(1500)}};r(),T(t=>{let a=new Map(t);return a.set(e,!1),a});return}},c=async function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{var r;if(console.log("[startConversationFetching] Attempting to fetch existing conversation for ".concat(e," (attempt ").concat(a+1,")")),t===n.R6.FINISHED&&(!ed.current.get(e)||(null==(r=ed.current.get(e))?void 0:r.length)===0)){let a=await d(e);ef(a)?(console.log("[startConversationFetching] Conversation beyond minimal for ".concat(e," (").concat(a.length," messages)")),t===n.R6.FINISHED?(console.log("[startConversationFetching] Composer ".concat(e," is finished, stopping log streaming")),eS(e)):console.log("[startConversationFetching] Composer ".concat(e," is not finished, keeping log streaming"))):console.log("[startConversationFetching] No real conversation data for ".concat(e,", keeping log streaming")),w(t=>{let r=new Map(t),n=t.get(e)||[];return n.some(e=>e.isTemporary)&&0===a.length?t:n.length>0&&a.length<n.length?(console.log("[startConversationFetching] Skipping update for ".concat(e," - new conversation has fewer messages (").concat(a.length," < ").concat(n.length,")")),t):(r.set(e,a),r)}),ex(e,a,void 0),T(t=>{let a=new Map(t);return a.set(e,!1),a})}console.log("[startConversationFetching] Starting streaming updates for ".concat(e)),l()}catch(t){if(console.error("Failed to fetch existing conversation:",t),h(t)&&a<5){let t=Math.min(1e3*Math.pow(2,a),15e3);console.log("[startConversationFetching] Network error fetching conversation for ".concat(e,", retrying in ").concat(t,"ms (attempt ").concat(a+1,"/5)")),setTimeout(()=>{ei.current.has(e)&&c(a+1)},t);return}console.log("[startConversationFetching] Falling back to log streaming and conversation streaming for ".concat(e)),ec.current.has(e)||(console.log("[startConversationFetching] Conversation fetch failed for ".concat(e,", ensuring log streaming is started")),eE(e)),T(t=>{let a=new Map(t);return a.set(e,!1),a}),l()}};c()},[eC,eS,eE,ex,ej]),eT=(0,o.useCallback)(async e=>{v(t=>{if(t.has(e)&&null===t.get(e)){let a=new Map(t);return a.delete(e),a}return t}),await ew(e)},[ew]),eR=(0,o.useCallback)(async e=>{let t=!1;v(a=>(t=a.has(e)&&null!==a.get(e),a)),t||ee.current.has(e)||await ew(e)},[ew]),eL=(0,o.useCallback)(e=>{if(ea.current.has(e))return;v(t=>(t.has(e)||ew(e),t));let t=async()=>{try{let t=await fetch("/api/background-composer/get-changes-hash",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bcId:e})}),a=await t.json(),r=new n.Fw().fromJson(a).hash;await ew(e),r&&er.current.set(e,r)}catch(t){console.error("[ian] Error checking hash for ".concat(e,":"),t)}};t();let a=setInterval(t,5e3);ea.current.set(e,a)},[ew]),eM=(0,o.useCallback)(e=>{let t=ea.current.get(e);t&&(clearInterval(t),ea.current.delete(e))},[]),eI=(0,o.useCallback)((e,t)=>{et.current.add(e.bcId),t&&em.current.set(e.bcId,t);let a=new n.vQ({composer:e,status:e.status,unread:e.isUnread,modelDetails:null==t?void 0:t.modelDetails,prompt:t?new n.$S({text:t.promptText}):void 0});l(t=>[...t,e]),f(t=>{let r=new Map(t);return r.set(e.bcId,a),r})},[]),eF=(0,o.useCallback)(e=>{et.current.delete(e),em.current.delete(e),l(t=>t.filter(t=>t.bcId!==e)),f(t=>{let a=new Map(t);return a.delete(e),a})},[]),eB=(0,o.useCallback)(e=>et.current.has(e),[]),eD=(0,o.useCallback)((e,t)=>{l(a=>a.map(a=>a.bcId===e?new n.hF({...a,status:t}):a))},[]),eO=(0,o.useCallback)(async e=>{console.log("[handleComposerDeletion] Starting cleanup for composer ".concat(e)),et.current.delete(e),em.current.delete(e),l(t=>{let a=t.filter(t=>t.bcId!==e);return console.log("[handleComposerDeletion] Removed composer from internal list, remaining: ".concat(a.length)),a});let t=en.current.get(e);t&&(clearInterval(t),en.current.delete(e),console.log("[handleComposerDeletion] Stopped conversation interval for ".concat(e))),eo.current.delete(e);let a=es.current.get(e);a&&(a.abort(),es.current.delete(e),console.log("[handleComposerDeletion] Stopped conversation streaming for ".concat(e))),ei.current.delete(e);let r=ec.current.get(e);r&&(r.abort(),ec.current.delete(e),console.log("[handleComposerDeletion] Stopped log streaming for ".concat(e)));let n=eh.current.get(e);n&&(clearInterval(n),eh.current.delete(e),console.log("[handleComposerDeletion] Stopped diff refetch for ".concat(e)));let s=ea.current.get(e);s&&(clearInterval(s),ea.current.delete(e),console.log("[handleComposerDeletion] Stopped hash checking for ".concat(e))),X.current.delete(e),ee.current.delete(e),eu.current.delete(e),er.current.delete(e),T(t=>{let a=new Map(t);return a.delete(e),a}),w(t=>{let a=new Map(t);return a.delete(e),a}),N(t=>{let a=new Map(t);return a.delete(e),a}),C(t=>{let a=new Map(t);return a.delete(e),a}),f(t=>{let a=new Map(t);return a.delete(e),a}),v(t=>{let a=new Map(t);return a.delete(e),a}),console.log("[handleComposerDeletion] Refreshing background composers list"),await eN(),console.log("[handleComposerDeletion] Cleanup completed for composer ".concat(e))},[eN]),eP=(0,o.useCallback)((e,t)=>{w(a=>{let r=new Map(a),n=r.get(e)||[],s={...t,isTemporary:!0};return r.set(e,[...n,s]),r})},[]),eU=(0,o.useCallback)((e,t)=>{w(a=>{let r=new Map(a),n=(r.get(e)||[]).filter(e=>!(e.isTemporary&&e.text===t));return r.set(e,n),r})},[]),e_=(0,o.useCallback)((e,t)=>{l(a=>a.map(a=>a.bcId===e?new n.hF({...a,prUrl:t}):a)),f(a=>{let r=a.get(e);if(r){let s=new Map(a),o=new n.vQ({...r,composer:new n.hF({...r.composer,prUrl:t})});return s.set(e,o),s}return a}),(0,i.s9)(e,t)},[]);return(0,r.jsx)(p.Provider,{value:{backgroundComposers:ev,detailedComposers:x,detailedDiffs:b,conversations:y,legacyConversations:j,getConversationForAgent:eb,logs:k,isLoading:S,isConversationFirstLoading:A,refetchBackgroundComposers:ek,fetchDetailedComposer:ey,startConversationFetching:eA,stopConversationFetching:eC,stopLogStreaming:eS,refreshDetailedDiff:eT,ensureDiffLoaded:eR,startHashChecking:eL,stopHashChecking:eM,showUsagePricingModal:M,setShowUsagePricingModal:I,showUpgradePaidModal:F,setShowUpgradePaidModal:B,showPrivacyModeModal:D,setShowPrivacyModeModal:O,showAutoModelModal:P,setShowAutoModelModal:U,addOptimisticBackgroundComposer:eI,removeOptimisticBackgroundComposer:eF,isOptimisticComposer:eB,updateComposerStatusOptimistically:eD,diffViewMode:V,setDiffViewMode:Z,filesBeingReverted:_,setFilesBeingReverted:W,handleComposerDeletion:eO,addOptimisticMessage:eP,removeOptimisticMessage:eU,updateComposerPrUrl:e_,selectedComposerId:Y,setSelectedComposerId:$},children:t})}},82429:(e,t,a)=>{a.d(t,{A:()=>l});var r=a(9381),n=a(10689),s=a(20503),o=a(99651);let i=e=>{let{options:t,value:a,onSelect:n,style:s,className:i="",minWidth:l}=e;return(0,r.jsx)("div",{className:"dashboard-menu ".concat(i),style:{...s,minWidth:l?"".concat(l,"px"):void 0},children:(0,r.jsx)("div",{className:"dashboard-menu-section",children:t.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>n(e.value),className:"dashboard-menu-cell dashboard-base ".concat(e.value===a?"dashboard-text-primary":"dashboard-text-secondary"),children:[(0,r.jsx)("span",{children:e.label}),e.value===a&&(0,r.jsx)(o.A,{size:12,className:"ml-2"})]},e.value))})})},l=e=>{var t;let{value:a,options:o,onChange:l,className:d="",buttonClassName:c=""}=e,u=function(){let[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)({top:0,left:0}),s=(0,n.useRef)(null),o=(0,n.useRef)(null),i=()=>{if(s.current){let e=s.current.getBoundingClientRect();r({top:e.bottom+4,left:e.left})}};(0,n.useEffect)(()=>{let a=e=>{let a=e.target;o.current&&!o.current.contains(a)&&s.current&&!s.current.contains(a)&&t(!1)};if(e)return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[e]),(0,n.useEffect)(()=>{e&&i()},[e]);let l=()=>{i(),t(!0)},d=()=>t(!1);return{isOpen:e,position:a,triggerRef:s,menuRef:o,open:l,close:d,toggle:()=>e?d():l(),setIsOpen:t}}(),m=o.find(e=>e.value===a);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{ref:u.triggerRef,type:"button",onClick:u.toggle,className:"dashboard-text-button ".concat(c),children:[null==m?void 0:m.label,(0,r.jsx)(s.A,{size:12})]}),u.isOpen&&(0,r.jsx)("div",{ref:u.menuRef,className:"dashboard-dropdown-container",children:(0,r.jsx)(i,{options:o,value:a,onSelect:e=>{l(e),u.close()},style:{top:u.position.top,left:u.position.left},minWidth:null==(t=u.triggerRef.current)?void 0:t.offsetWidth})})]})}},82839:(e,t,a)=>{a.d(t,{z:()=>j});var r=a(9381),n=a(89888),s=a(13715),o=a(23899),i=a(37095),l=a(49782),d=a(96486),c=a(92584),u=a(13804),m=a(10689);let h=e=>{let{open:t,setIsOpen:a,children:n}=e,[s,o]=(0,m.useState)(!1);return(0,m.useEffect)(()=>{if(t){let e=e=>e.preventDefault();return window.addEventListener("scroll",e),document.body.style.overflow="hidden",document.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e),document.body.style.overflow="auto",document.removeEventListener("scroll",e)}}if(!t){o(!0);let e=setTimeout(()=>{o(!1)},1e3);return()=>clearTimeout(e)}},[t]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"absolute",background:"rgba(0, 0, 0, 0.4)",zIndex:1e7,display:t?"flex":"none",alignItems:"center",justifyContent:"center",overflow:"hidden",bottom:"-300vh",left:0,right:0,top:"-300vh"},onScroll:e=>e.preventDefault(),onClick:()=>{console.log("click"),a(!1)}}),(!s||t)&&(0,r.jsx)("div",{style:{position:"fixed",zIndex:0x3b9aca01,top:"min(240px, 30%)",left:"50%",transform:"translate(-50%, 0%)",display:t?"flex":"none",alignItems:"center",justifyContent:"center",width:"fit-content",maxWidth:"90vw"},children:n})]})})};var p=a(64149),g=a(56735),x=a(28790),f=a(25289),b=a(8231),v=a(34896);let y=e=>{let{newApiKey:t,setShowApiKeyModal:a,keyType:u="API Key"}=e,[h,p]=(0,m.useState)(!1);return(0,r.jsxs)("div",{className:(0,i.cn)("relative flex w-[500px] flex-col gap-4 px-4 py-5","rounded-2xl border border-brand-neutrals-100 bg-brand-white text-brand-foreground dark:border-brand-neutrals-800 dark:bg-brand-medium-black dark:shadow-none","shadow-[0px_51px_20px_rgba(186,186,186,0.01),0px_29px_17px_rgba(186,186,186,0.05),0px_13px_13px_rgba(186,186,186,0.09),0px_3px_7px_rgba(186,186,186,0.1)]"),children:[(0,r.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,r.jsxs)(n.DZ,{variant:"subheading-2",children:[u," Created"]}),(0,r.jsx)(g.I,{"aria-label":"Close",onClick:()=>a(!1),icon:(0,r.jsx)(l.A,{className:"size-4"})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 w-full",children:[(0,r.jsxs)(n.o5,{className:"text-sm",children:["Your new ",u," has been created. Copy this key now as it won't be shown again."]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(s.p,{type:"text",value:t||"",readOnly:!0,className:"!h-9 flex-1 font-mono"}),(0,r.jsx)(o.Button,{variant:"secondary",size:"sm",className:"cursor-pointer",onClick:()=>{t&&(navigator.clipboard.writeText(t),p(!0),setTimeout(()=>p(!1),5e3))},children:(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[h?(0,r.jsx)(d.A,{className:"h-3 w-3"}):(0,r.jsx)(c.A,{className:"h-3 w-3"}),h?"Copied!":"Copy"]})})]}),(0,r.jsx)(n.o5,{className:"text-xs text-brand-gray-300",children:"For security reasons, this key is only displayed once and cannot be retrieved later. If you lose it, you'll need to create a new one."}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(o.Button,{onClick:()=>a(!1),size:"sm",className:"cursor-pointer",children:"Done"})})]})]})},w=e=>{let{keyName:t,onConfirm:a,onCancel:s,isDeleting:d,keyType:c="API Key"}=e;return(0,r.jsxs)("div",{className:(0,i.cn)("relative flex w-[500px] flex-col gap-4 px-4 py-5","rounded-2xl border border-brand-neutrals-100 bg-brand-white text-brand-foreground dark:border-brand-neutrals-800 dark:bg-brand-medium-black dark:shadow-none","shadow-[0px_51px_20px_rgba(186,186,186,0.01),0px_29px_17px_rgba(186,186,186,0.05),0px_13px_13px_rgba(186,186,186,0.09),0px_3px_7px_rgba(186,186,186,0.1)]"),children:[(0,r.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,r.jsxs)(n.DZ,{variant:"subheading-2",children:["Delete ",c]}),(0,r.jsx)(g.I,{"aria-label":"Close",onClick:s,icon:(0,r.jsx)(l.A,{className:"size-4"})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)(n.o5,{className:"text-sm",children:["Are you sure you want to delete the ",c,' "',t,'"? Any existing integrations using this key will no longer work.',(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("b",{children:"This action cannot be undone."})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(o.Button,{variant:"secondary",size:"sm",className:"cursor-pointer",onClick:s,disabled:d,children:"Cancel"}),(0,r.jsxs)(o.Button,{size:"sm",className:"cursor-pointer",onClick:a,disabled:d,children:[d&&(0,r.jsx)(v.K,{className:"mr-2"}),d?"Deleting...":"Delete"]})]})]})]})},j=e=>{let{apiKeys:t,isLoading:a,isCreating:s,isDeleting:o,onCreateKey:d,onDeleteKey:c,keyType:j="API Key",className:N,onShowInlineCreation:k,onHideInlineCreation:C,showInlineCreation:S,emptyStateAction:E}=e,[A,T]=(0,m.useState)(!1),[R,L]=(0,m.useState)(null),[M,I]=(0,m.useState)(null),[F,B]=(0,m.useState)(!1),[D,O]=(0,m.useState)(""),P=(0,m.useRef)(null),U=null!=S?S:F,_=(0,m.useCallback)(()=>{k?k():B(!0)},[k]),W=(0,m.useCallback)(()=>{void 0!==S?(O(""),C&&C()):(B(!1),O(""))},[S,C]),z=(0,m.useCallback)(async e=>{let t=await d(e);t&&t.apiKey&&(L(t.apiKey),T(!0),W())},[d,W]),H=(0,m.useCallback)(async()=>{M&&await c(M.id)&&I(null)},[M,c]);return(m.useEffect(()=>{U&&P.current&&P.current.focus()},[U]),a)?(0,r.jsx)("div",{className:(0,i.cn)("flex items-center justify-center py-8",N),children:(0,r.jsx)(v.K,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.w,{label:"User API Keys",description:"".concat(j,"s provide secure, programmatic access to your Cursor account, including the headless version of the Cursor Agent CLI. Treat them like passwords: keep them secure and never share them publicly."),children:(0,r.jsx)(b.A,{children:(0,r.jsx)("div",{className:"flex self-stretch flex-col gap-4",children:t.length>0||U?(0,r.jsxs)("div",{className:"flex flex-col w-full",children:[(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4 px-4 py-2 text-sm text-left",children:[(0,r.jsx)("div",{className:"font-medium dashboard-sm dashboard-text-secondary",children:"Name"}),(0,r.jsx)("div",{className:"font-medium dashboard-sm dashboard-text-secondary",children:"Token"}),(0,r.jsx)("div",{className:"font-medium dashboard-sm dashboard-text-secondary",children:"Created"}),(0,r.jsx)("div",{className:"flex justify-end",children:t.length>0&&(0,r.jsx)(r.Fragment,{children:s||U?(0,r.jsx)("div",{className:"dashboard-header-button-spacer","aria-hidden":"true"}):(0,r.jsxs)(x.j,{onClick:_,children:["New ",j]})})})]}),U&&(0,r.jsxs)("div",{className:(0,i.cn)("grid grid-cols-4 items-center gap-4 px-4 py-3",t.length>0&&"border-b border-brand-borders"),children:[(0,r.jsx)("div",{children:(0,r.jsx)("input",{ref:P,type:"text",value:D,onChange:e=>O(e.target.value),placeholder:"Enter ".concat(j," Name..."),className:"w-full text-sm bg-transparent border-none outline-none text-brand-foreground placeholder-dashboard-text-tertiary",disabled:s,onKeyDown:async e=>{"Enter"===e.key&&D.trim()&&!s&&await z(D.trim())}})}),(0,r.jsx)(n.o5,{className:"text-sm dashboard-text-quaternary",children:"Will be generated"}),(0,r.jsx)(n.o5,{className:"text-sm dashboard-text-quaternary",children:"N/A"}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(x.j,{className:"cursor-pointer",onClick:async()=>{D.trim()&&await z(D.trim())},disabled:!D.trim()||s,leadingIcon:s?(0,r.jsx)(u.A,{className:"h-4 w-4 animate-spin"}):void 0,children:s?"Saving...":"Save"}),(0,r.jsx)(g.I,{"aria-label":"Cancel",onClick:W,disabled:s,icon:(0,r.jsx)(l.A,{className:"size-4"})})]})]}),t.sort((e,t)=>{let a=(e.createdAt,Number(e.createdAt));return t.createdAt,Number(t.createdAt)-a}).map((e,t,a)=>(0,r.jsxs)("div",{className:(0,i.cn)("grid grid-cols-4 items-center gap-4 border-b border-brand-borders px-4 py-3 dashboard-cell-clickable","dashboard-list-row"),children:[(0,r.jsx)(n.o5,{className:"text-sm font-medium truncate",children:e.name}),(0,r.jsx)(n.o5,{className:"font-mono text-sm truncate",children:e.maskedKey}),(0,r.jsx)(n.o5,{className:"text-sm whitespace-nowrap",children:new Date((e.createdAt,Number(e.createdAt))).toLocaleDateString()}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(g.I,{"aria-label":"Delete",onClick:()=>I({id:e.id,name:e.name}),disabled:o,icon:(0,r.jsx)(l.A,{className:"size-4"})})})]},e.id))]}):(0,r.jsx)("div",{className:"flex w-full items-center justify-center p-6",children:(0,r.jsx)(p.n,{title:"No API Keys Yet",description:"No API Keys have been created yet",action:E})})})})}),(0,r.jsx)(h,{open:A,setIsOpen:T,children:(0,r.jsx)(y,{newApiKey:R,setShowApiKeyModal:T,keyType:j})}),(0,r.jsx)(h,{open:!!M,setIsOpen:e=>!e&&I(null),children:(0,r.jsx)(w,{keyName:(null==M?void 0:M.name)||"",onConfirm:H,onCancel:()=>I(null),isDeleting:o,keyType:j})})]})}},82879:(e,t,a)=>{a.d(t,{Q:()=>i});var r=a(9381),n=a(10689),s=a(37095),o=a(13715);let i=e=>{let{value:t,onChange:a,min:i=0,max:l=1e3,step:d=1,disabled:c,id:u,name:m,ariaLabel:h,className:p,inputClassName:g,decrementFloor:x,emptyBehavior:f="min",enableWheel:b=!0,keyStepMultipliers:v,holdStepDelayMs:y=400,holdStepIntervalMs:w=75}=e,j=n.useCallback(e=>Math.max(i,Math.min(l,e)),[i,l]),N=null!=x?x:i,[k,C]=n.useState(null),S=null!==k?k:String(t),E=n.useCallback(()=>{null!==k&&(a(""===k?"zero"===f?0:i:j(parseInt(k,10))),C(null))},[k,f,i,j,a]),A=n.useRef(null),T=n.useRef(null),R=()=>{A.current&&(window.clearTimeout(A.current),A.current=null),T.current&&(window.clearInterval(T.current),T.current=null)};n.useEffect(()=>R,[]);let L=e=>{if(c)return;let r=()=>{let r=(null!==k&&""!==k?parseInt(k,10):t)+e*d;a(j(e<0?Math.max(N,r):r)),C(null)};r(),A.current=window.setTimeout(()=>{T.current=window.setInterval(r,w)},y)},M=c||t<=N,I=c||t>=l;return(0,r.jsxs)("div",{className:(0,s.cn)("inline-flex items-center rounded-md border border-brand-neutrals-800/50 bg-black/20",p),children:[(0,r.jsx)("button",{type:"button","aria-label":"Decrease",disabled:M,onMouseDown:()=>L(-1),onMouseUp:R,onMouseLeave:R,onTouchStart:()=>L(-1),onTouchEnd:R,className:"h-9 w-9 select-none text-lg leading-none disabled:opacity-50",children:"−"}),(0,r.jsx)(o.p,{id:u,name:m,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:S,onChange:e=>{let t=e.target.value.replace(/[^0-9]/g,"");if(C(t),""!==t){let e=parseInt(t,10),r=e>l?l:e;r!==e&&C(String(r)),a(j(r))}},onFocus:e=>{C(String(t)),requestAnimationFrame(()=>e.currentTarget.select())},onBlur:()=>E(),onKeyDown:e=>{if(!c){if("Enter"===e.key){e.preventDefault(),E();return}if("Escape"===e.key){e.preventDefault(),C(null);return}if("ArrowUp"===e.key||"ArrowDown"===e.key){e.preventDefault();let r=(e=>{var t,a,r,n;let s={shift:10,alt:5,meta:100,ctrl:100},o={shift:null!=(t=null==v?void 0:v.shift)?t:s.shift,alt:null!=(a=null==v?void 0:v.alt)?a:s.alt,meta:null!=(r=null==v?void 0:v.meta)?r:s.meta,ctrl:null!=(n=null==v?void 0:v.ctrl)?n:s.ctrl},i=1;return e.shiftKey&&(i=o.shift),e.altKey&&(i=o.alt),e.metaKey&&(i=o.meta),e.ctrlKey&&(i=o.ctrl),i})(e),n=("ArrowUp"===e.key?1:-1)*d*r,s=(null!==k&&""!==k?parseInt(k,10):t)+n;a(j(n<0?Math.max(N,s):s)),C(null)}}},onWheel:e=>{if(!b||c||document.activeElement!==e.currentTarget)return;e.preventDefault();let r=(e.deltaY<0?1:-1)*d,n=(null!==k&&""!==k?parseInt(k,10):t)+r;a(j(r<0?Math.max(N,n):n)),C(null)},className:(0,s.cn)("min-w-[2rem] max-w-[8rem] w-fit border-0 bg-transparent text-center focus-visible:ring-0",g),disabled:c,"aria-label":h}),(0,r.jsx)("button",{type:"button","aria-label":"Increase",disabled:I,onMouseDown:()=>L(1),onMouseUp:R,onMouseLeave:R,onTouchStart:()=>L(1),onTouchEnd:R,className:"h-9 w-9 select-none text-lg leading-none disabled:opacity-50",children:"+"})]})};i.displayName="NumberInput"},83209:(e,t,a)=>{a.d(t,{g:()=>m});var r=a(9381),n=a(93973),s=a(80085),o=a.n(s),i=a(10689),l=a(45748),d=a(4341),c=a(34432),u=a(11097);let m=(0,i.memo)(e=>{let{onClick:t,hideText:a=!1,disableClick:s=!1,href:m="/",size:h=32}=e,[p,g]=(0,i.useState)(!1),x=(0,l.A)("(pointer: fine)",!1),f=(0,i.useRef)(null),b=(0,i.useRef)(null),v=(0,c.a)(),y=(0,i.useMemo)(()=>(0,r.jsx)(n.default,{ref:b,src:u.A,alt:"",width:h,height:h,priority:!0,unoptimized:!0,className:"absolute transition-opacity duration-500"}),[]),w=(0,i.useMemo)(()=>(0,r.jsx)(d.gu,{className:"h-[13px] text-brand-foreground lg:h-[17px] text-white"}),[]);return(0,i.useEffect)(()=>{let e=f.current;if(e){let t=()=>{var t,a;p?(null==(a=b.current)||a.classList.add("opacity-0"),e.currentTime=0,e.play()):(e.pause(),null==(t=b.current)||t.classList.remove("opacity-0"))};return e.addEventListener("ended",t),()=>e.removeEventListener("ended",t)}},[p]),(0,r.jsxs)(o(),{prefetch:!1,href:m,"aria-label":"Homepage",className:"relative flex w-fit items-center gap-0.5 overflow-hidden lg:px-3 ".concat(s?"pointer-events-none":""),onMouseEnter:()=>{if(x){var e,t;(null==(e=f.current)?void 0:e.paused)&&(g(!0),null==(t=b.current)||t.classList.add("opacity-0"),f.current&&(f.current.playbackRate=2,f.current.paused&&(f.current.currentTime=0,f.current.play())))}},onMouseLeave:()=>{g(!1)},onClick:t,children:[(0,r.jsxs)("div",{className:"pointer-events-none relative -ml-0.5 size-6 lg:-ml-1 lg:mr-px lg:size-8",children:[y,v?(0,r.jsx)("video",{ref:f,width:h,height:h,muted:!0,playsInline:!0,preload:"auto","aria-label":"Cursor video logo animation",style:{mixBlendMode:"screen"},src:"/cursor-website-proxy/assets/videos/logo/logo-black.mp4",poster:u.A.src}):null]}),!a&&w]})});m.displayName="Logo"},83299:(e,t,a)=>{a.d(t,{MG:()=>x,Ro:()=>f,lB:()=>m,v9:()=>h,wO:()=>b,yB:()=>p,zN:()=>v});var r=a(90037),n=a(10689),s=a(47531),o=a(6665),i=a(67448),l=a(54392),d=a(12061),c=a(73147),u=a(91393);let m=()=>{var e,t;let{team:a,stripeStatus:m}=(0,d.M)(),{isTeamAdmin:p,isPersonalUser:g}=h(),x=(0,s.jE)(),{data:f,isLoading:b,error:v}=(0,o.I)({queryKey:["spendLimit",null==a?void 0:a.id],queryFn:()=>c.o.getServiceAccountSpendLimit(null==a?void 0:a.id),staleTime:3e5}),[y,w]=(0,n.useState)((null==f?void 0:f.spendLimitCents)!==void 0?(0,u.vv)(f.spendLimitCents):"");(0,n.useEffect)(()=>{(null==f?void 0:f.spendLimitCents)!==void 0&&w((0,u.vv)(f.spendLimitCents))},[null==f?void 0:f.spendLimitCents]);let j=(0,i.n)({mutationFn:async e=>{await c.o.setServiceAccountSpendLimit(null==a?void 0:a.id,e)},onMutate:async e=>{await x.cancelQueries({queryKey:["spendLimit",null==a?void 0:a.id]});let t=x.getQueryData(["spendLimit",null==a?void 0:a.id]);return t&&x.setQueryData(["spendLimit",null==a?void 0:a.id],new r.bJx({...t,spendLimitCents:e})),{previous:t}},onError:(e,t,r)=>{(null==r?void 0:r.previous)&&x.setQueryData(["spendLimit",null==a?void 0:a.id],r.previous),x.invalidateQueries({queryKey:["spendLimit",null==a?void 0:a.id]})}}),N=async()=>{let e=(0,u.h4)(y);await j.mutateAsync(e)},k=(null==f?void 0:f.currentSpendCents)?(0,u.vv)(f.currentSpendCents):"$0.00",C=(null==f?void 0:f.freeTrialExpiresAt)?new Date(Number(f.freeTrialExpiresAt)):null,S=(0,n.useMemo)(()=>!!p||!!g&&(m.membershipType===l.V.PRO||m.membershipType===l.V.PRO_PLUS||m.membershipType===l.V.ULTRA),[p,g,m.membershipType]);return{spendData:null!=f?f:null,tempLimit:y,setTempLimit:w,currentSpend:k,isSaving:j.isPending,isLoading:b,error:null!=(e=null==v?void 0:v.message)?e:null,saveLimit:N,isInFreeTrial:null==(t=null==f?void 0:f.isInFreeTrial)||t,freeTrialExpiryDate:C,canEditSpendLimit:S}},h=()=>{let{teams:e}=(0,d.M)(),t=e.find(e=>e.seats>0),a=t&&(t.role===r.acM.OWNER||t.role===r.acM.FREE_OWNER),n=t&&t.role===r.acM.MEMBER,s=0===e.length||!t;return{isTeamAdmin:a,isTeamNonAdminUser:n,isPersonalUser:s,hasAccess:a||n||s}},p=()=>{var e;let t=(0,s.jE)(),{data:a,isLoading:n,error:l}=(0,o.I)({queryKey:["bugBotUserSettings"],queryFn:()=>c.o.getBugbotUserSettings(),staleTime:3e5}),d=(0,i.n)({mutationFn:async e=>{await c.o.updateBugbotUserSettings(e.manualTriggerOnly,e.runOnlyOnce,e.suppressNoBugsComments,e.enableDraft)},onSuccess:(e,a)=>{t.setQueryData(["bugBotUserSettings"],a)}}),u=async(e,t)=>{if(!a)return;let n=new r.DLm({...a,[e]:t});await d.mutateAsync(n)};return{rules:null!=a?a:null,isLoading:n,error:null!=(e=null==l?void 0:l.message)?e:null,updateRule:u,refetch:()=>t.invalidateQueries({queryKey:["bugBotUserSettings"]})}},g=e=>["teamBugbotSettings",e],x=e=>{let t=(0,s.jE)();return(0,i.n)({mutationKey:["updateTeamBugbotSettings",e],mutationFn:async a=>{var n,s,o,i,l,d,u,m,h;if(void 0===e)throw Error("teamId is required to update settings");let p=null!=(n=t.getQueryData(g(e)))?n:new r.Lg7;await c.o.updateTeamBugbotSettings(e,null!=(o=null!=(s=a.bugbotLicensesHardLimit)?s:p.bugbotLicensesHardLimit)?o:0,null!=(l=null!=(i=a.bugbotPlanEnabled)?i:p.bugbotPlanEnabled)&&l,null!=(u=null!=(d=a.allowlist)?d:p.allowlist)?u:[],null!=(h=null!=(m=a.allowlistConfig)?m:p.allowlistConfig)?h:r.k1w.UNSPECIFIED)},onMutate:async a=>{if(void 0===e)return{};await t.cancelQueries({queryKey:g(e)});let n=t.getQueryData(g(e));return t.setQueryData(g(e),e=>{var t,n,s,o;let i=null!=e?e:new r.Lg7;return new r.Lg7({bugbotLicensesHardLimit:null!=(t=a.bugbotLicensesHardLimit)?t:i.bugbotLicensesHardLimit,bugbotPlanEnabled:null!=(n=a.bugbotPlanEnabled)?n:i.bugbotPlanEnabled,bugbotLicenseCount:i.bugbotLicenseCount,allowlist:null!=(s=a.allowlist)?s:i.allowlist,allowlistConfig:null!=(o=a.allowlistConfig)?o:i.allowlistConfig,licenseUsage:i.licenseUsage})}),{previous:null!=n?n:null}},onError:(a,r,n)=>{void 0!==e&&((null==n?void 0:n.previous)&&t.setQueryData(g(e),n.previous),t.invalidateQueries({queryKey:g(e)}))}})},f=()=>{var e,t,a,r,s,i;let[l,d]=(0,n.useState)(()=>{let e=new Date;e.setHours(23,59,59,999);let t=new Date(e);return t.setDate(e.getDate()-29),t.setHours(0,0,0,0),{from:t,to:e}}),[u,m]=(0,n.useState)("day"),[h,p]=(0,n.useState)(),[g,x]=(0,n.useState)(),[f,b]=(0,n.useState)(),[v,y]=(0,n.useState)(1),w=(0,n.useMemo)(()=>{var e,t,a,r,n,s,o,i;return{startIso:null!=(n=null==l||null==(e=l.from)?void 0:e.toISOString())?n:null,endIso:null!=(s=null==l||null==(t=l.to)?void 0:t.toISOString())?s:null,startTimestamp:null!=(o=null==l||null==(a=l.from)?void 0:a.getTime().toString())?o:void 0,endTimestamp:null!=(i=null==l||null==(r=l.to)?void 0:r.getTime().toString())?i:void 0,dateGrouping:u,prRepositoryFilter:null!=g?g:null,prStatusFilter:null!=h?h:null,prUserNodeIdFilter:null!=f?f:null,minBugsFound:v}},[null==l?void 0:l.from,null==l?void 0:l.to,u,g,h,f,v]),j=(0,o.I)({queryKey:["bugbotAnalyticsV2",w.dateGrouping,w.startIso,w.endIso],queryFn:()=>{var e,t;return c.o.getBugbotAnalyticsV2(null!=(e=w.startIso)?e:void 0,null!=(t=w.endIso)?t:void 0,w.dateGrouping)},refetchOnMount:!1,staleTime:12e4}),[N,k]=(0,n.useState)(!1),[C,S]=(0,n.useState)(null),E=(0,o.I)({queryKey:["bugbotPRAnalytics",w.prRepositoryFilter,w.prStatusFilter,w.prUserNodeIdFilter,w.startTimestamp,w.endTimestamp,w.minBugsFound],queryFn:async()=>{var e,t,a;return await c.o.getBugBotPRAnalytics(null!=(e=w.prRepositoryFilter)?e:void 0,null!=(t=w.prStatusFilter)?t:void 0,null!=(a=w.prUserNodeIdFilter)?a:void 0,w.startTimestamp,w.endTimestamp,w.minBugsFound,100)},refetchOnMount:!1,staleTime:12e4,placeholderData:void 0});(0,n.useEffect)(()=>{if(E.data&&!N){let e=setTimeout(async()=>{try{var e,t,a;let r=await c.o.getBugBotPRAnalytics(null!=(e=w.prRepositoryFilter)?e:void 0,null!=(t=w.prStatusFilter)?t:void 0,null!=(a=w.prUserNodeIdFilter)?a:void 0,w.startTimestamp,w.endTimestamp,w.minBugsFound,1e5);S(r),k(!0)}catch(e){console.error("Failed to load full dataset:",e)}},100);return()=>clearTimeout(e)}},[E.data,N,w.prRepositoryFilter,w.prStatusFilter,w.prUserNodeIdFilter,w.startTimestamp,w.endTimestamp,w.minBugsFound]),(0,n.useEffect)(()=>{k(!1),S(null)},[w.prRepositoryFilter,w.prStatusFilter,w.prUserNodeIdFilter,w.startTimestamp,w.endTimestamp,w.minBugsFound]);let A=(0,n.useCallback)(d,[]),T=(0,n.useCallback)(m,[]),R=(0,n.useCallback)(p,[]),L=(0,n.useCallback)(x,[]),M=(0,n.useCallback)(b,[]),I=(0,n.useCallback)(y,[]);return{analyticsV2:null!=(a=j.data)?a:null,isLoading:j.isLoading,error:null!=(s=null!=(r=null==(e=j.error)?void 0:e.message)?r:null==(t=E.error)?void 0:t.message)?s:null,refetch:j.refetch,dateRange:l,setDateRange:A,dateGrouping:u,setDateGrouping:T,isLoadingPRAnalytics:E.isLoading||E.isFetching,bugBotPRAnalytics:E.isFetching?null:null!=(i=E.data)?i:null,fullDataset:E.isFetching?null:C,hasFullDataset:!E.isFetching&&N,prStatusFilter:h,setPrStatusFilter:R,prRepositoryFilter:g,setPrRepositoryFilter:L,prUserNodeIdFilter:f,setPrUserNodeIdFilter:M,minBugsFound:v,setMinBugsFound:I}},b=function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],a=(0,s.jE)(),{data:r,isLoading:n,error:i}=(0,o.I)({queryKey:["bugBotProUserSettings"],enabled:t,queryFn:()=>c.o.getBugBotProUserSettings(),staleTime:3e5});return{proSettings:null!=r?r:null,isLoading:n,error:null!=(e=null==i?void 0:i.message)?e:null,refetch:()=>a.invalidateQueries({queryKey:["bugBotProUserSettings"]})}},v=(e,t)=>{var a,r,n,s,i;let l="team-admin"===e||"team-non-admin"===e,d="paid-personal"===e,{teamSettings:u,isLoading:m,error:h,refetch:p}=(e=>{let t=(0,o.I)({queryKey:g(e),enabled:void 0!==e,queryFn:async()=>e?await c.o.getTeamBugbotSettings(e):null});return{teamSettings:t.data,isLoading:t.isLoading,error:t.error instanceof Error?t.error.message:null,refetch:t.refetch}})(l?t:void 0),{proSettings:x,isLoading:f,error:v,refetch:y}=b(d),w=d?null!=(a=null==x?void 0:x.enabled)&&a:null!=(r=null==u?void 0:u.bugbotPlanEnabled)&&r;return{hasBugbot:w,bugbotWasEnabledInThisBillingCycle:d?null!=(n=null==x?void 0:x.bugbotWasEnabledInThisBillingCycle)&&n:null!=(s=null==u?void 0:u.bugbotWasEnabledInThisBillingCycle)&&s,licenses:null!=(i=null==u?void 0:u.bugbotLicenseCount)?i:0,isLoading:l?m:f,error:l?h:v,teamSettings:l?u:null,proSettings:d?x:null,refetch:d?y:p}}},84684:(e,t,a)=>{a.d(t,{B:()=>X});var r=a(9381),n=a(90037),s=a(10689),o=a(54392),i=a(12061),l=a(83299),d=a(41300),c=a(39802),u=a(80586),m=a(24906),h=function(e){return e.TEAM_SETTINGS="team-settings",e.MY_SETTINGS="my-settings",e}({});let p=e=>{let{activeTab:t,onTabChange:a}=e;return(0,r.jsx)("div",{className:"dashboard-segmented-control",children:[{id:"team-settings",label:"Team Settings"},{id:"my-settings",label:"My Settings"}].map(e=>(0,r.jsx)("button",{onClick:()=>a(e.id),className:"dashboard-segmented-control-option ".concat(t===e.id?"dashboard-segmented-control-option-active":"dashboard-segmented-control-option-inactive"),children:e.label},e.id))})};var g=a(25289),x=a(74906),f=a(29227),b=a(93468),v=a(20503),y=a(17487);let w=()=>{let{team:e,teams:t,users:a,adminSettings:o,refreshAdminSettings:l,updateAdminSettings:d,isAdminSettingsLoading:c,isSavingAdminSettings:u}=(0,i.M)(),m=t.find(e=>e.seats>0),h=m&&(m.role===n.acM.OWNER||m.role===n.acM.FREE_OWNER),[p,g]=(0,s.useState)({allowlist:[],allowlistConfig:n.k1w.UNSPECIFIED,teamFollowupEnabled:!1}),[x,f]=(0,s.useState)(!1),[b,w]=(0,s.useState)(""),[j,N]=(0,s.useState)(!1),[k,C]=(0,s.useState)(null),[S,E]=(0,s.useState)(-1),A=(0,s.useRef)(null),T=(0,s.useRef)(null),R=(0,s.useRef)(null),L=(0,s.useRef)([]),M=(0,s.useRef)(!1);(0,s.useEffect)(()=>{let e=e=>{A.current&&!A.current.contains(e.target)&&f(!1),T.current&&!T.current.contains(e.target)&&(N(!1),E(-1),M.current=!1)};return document.addEventListener("mouseup",e),()=>document.removeEventListener("mouseup",e)},[]),(0,s.useEffect)(()=>{if(!o||!h)return;let e=o.backgroundAgentSettings;e&&g({allowlist:e.allowlist||[],allowlistConfig:e.allowlistConfig||n.k1w.UNSPECIFIED,teamFollowupEnabled:e.teamFollowupEnabled||!1})},[o,h]),(0,s.useEffect)(()=>{S>=0&&L.current[S]&&L.current[S].scrollIntoView({block:"nearest",behavior:"smooth"})},[S]);let I=a.filter(e=>{if(p.allowlist.includes(e.id))return!1;if(!b)return!0;let t=b.toLowerCase();return e.email.toLowerCase().includes(t)||e.name.toLowerCase().includes(t)});(0,s.useEffect)(()=>{L.current=[]},[I]);let F=async t=>{if((null==e?void 0:e.id)&&h&&o){C(null);try{await d({...o,backgroundAgentSettings:{allowlist:t.allowlist,allowlistConfig:t.allowlistConfig,teamFollowupEnabled:t.teamFollowupEnabled}}),await l()}catch(e){console.error("Failed to save background agent settings:",e),C(e instanceof Error?e.message:"Failed to save settings")}}},B=async e=>{let t={...p,allowlistConfig:e};g(t),f(!1),await F(t)},D=async e=>{let t={...p,allowlist:[...p.allowlist,e]};g(t),E(-1),await F(t)},O=async e=>{let t={...p,allowlist:p.allowlist.filter(t=>t!==e)};g(t),await F(t)},P=p.allowlistConfig===n.k1w.ALLOWLIST||p.allowlistConfig===n.k1w.BLOCKLIST,U=[{value:n.k1w.UNSPECIFIED,label:"None"},{value:n.k1w.ALLOWLIST,label:"Allowlist"},{value:n.k1w.BLOCKLIST,label:"Blocklist"}];return h&&(null==e?void 0:e.id)&&o?(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)("div",{className:"bg-brand-dashboard-card rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 px-3 py-4 ".concat(P?"border-b border-brand-borders":""),children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"text-sm text-white",children:"User restrictions"}),(0,r.jsx)("div",{className:"text-xs text-brand-gray-400 leading-tight",children:(e=>{switch(e){case n.k1w.UNSPECIFIED:return"All team members can use background agents";case n.k1w.ALLOWLIST:return"Only specified users can create and use background agents";case n.k1w.BLOCKLIST:return"Only specified users cannot create and use background agents";default:return"All team members can use background agents"}})(p.allowlistConfig)})]}),(0,r.jsxs)("div",{className:"relative",ref:A,children:[(0,r.jsx)("button",{onClick:()=>f(!x),className:"appearance-none bg-brand-dashboard-bg border border-brand-borders rounded px-3 py-2 pr-8 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500 min-w-[120px] text-left hover:bg-brand-dashboard-bg/80 transition-colors",disabled:u,children:(e=>{switch(e){case n.k1w.UNSPECIFIED:return"None";case n.k1w.ALLOWLIST:return"Allowlist";case n.k1w.BLOCKLIST:return"Blocklist";default:return"None"}})(p.allowlistConfig)}),(0,r.jsx)(v.A,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-brand-gray-400 pointer-events-none transition-transform ".concat(x?"rotate-180":"")}),x&&(0,r.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-gray-900 border border-brand-borders rounded shadow-lg z-10",children:U.map(e=>(0,r.jsx)("button",{onClick:()=>B(e.value),className:"w-full px-3 py-2 text-sm text-left hover:bg-brand-dashboard-card transition-colors first:rounded-t last:rounded-b ".concat(p.allowlistConfig===e.value?"text-white bg-brand-dashboard-card":"text-brand-gray-300"),children:e.label},e.value))})]})]}),P&&(0,r.jsxs)("div",{className:"px-3 py-4",children:[(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsx)("div",{className:"text-sm text-white mb-1",children:p.allowlistConfig===n.k1w.ALLOWLIST?"Allowed users":"Blocked users"})}),(0,r.jsxs)("div",{className:"relative mb-3",ref:T,children:[(0,r.jsx)("input",{ref:R,type:"text",value:b,onChange:e=>{w(e.target.value),N(!0),E(-1)},onFocus:()=>{N(!0),E(-1)},onBlur:()=>{M.current&&setTimeout(()=>{var e;null==(e=R.current)||e.focus()},0)},onKeyDown:e=>{if(j&&0!==I.length)switch(e.key){case"ArrowDown":e.preventDefault(),E(e=>e<I.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),E(e=>e>0?e-1:I.length-1);break;case"Enter":e.preventDefault(),S>=0&&S<I.length&&!u&&D(I[S].id);break;case"Escape":e.preventDefault(),N(!1),E(-1),M.current=!1}},placeholder:"Search or click to see all users",className:"w-full px-3 py-2 text-sm bg-brand-dashboard-bg border border-brand-borders rounded text-white placeholder-brand-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"}),j&&I.length>0&&(0,r.jsx)("div",{className:"absolute z-10 mt-1 w-full max-h-60 overflow-auto rounded-md border border-brand-borders bg-gray-900 shadow-lg",onMouseEnter:()=>{M.current=!0},onMouseLeave:()=>{M.current=!1},children:(0,r.jsx)("div",{className:"py-1",children:I.map((e,t)=>(0,r.jsxs)("div",{ref:e=>{e&&(L.current[t]=e)},className:"px-3 py-2 transition-colors ".concat(t===S?"bg-brand-dashboard-card":"hover:bg-brand-dashboard-card"," ").concat(u?"opacity-50 cursor-not-allowed":"cursor-pointer"),onClick:()=>{u||D(e.id)},onMouseEnter:()=>E(t),children:[(0,r.jsx)("div",{className:"text-sm text-white",children:e.name}),(0,r.jsx)("div",{className:"text-xs text-brand-gray-400",children:e.email})]},e.id))})})]}),p.allowlist.length>0?(0,r.jsx)("div",{className:"max-h-60 overflow-auto rounded-md border border-brand-borders bg-brand-dashboard-bg/50 p-2",children:(0,r.jsx)("div",{className:"space-y-2",children:p.allowlist.map(e=>{let t=a.find(t=>t.id===e);return(0,r.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 bg-brand-dashboard-bg rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-white",children:(null==t?void 0:t.name)||(null==t?void 0:t.email)}),t&&(null==t?void 0:t.name)&&(0,r.jsx)("div",{className:"text-xs text-brand-gray-400",children:t.email})]}),(0,r.jsx)("button",{onClick:()=>O(e),className:"p-1 hover:bg-gray-800 rounded transition-colors",disabled:u,children:(0,r.jsx)(y.A,{className:"h-4 w-4 text-brand-gray-400 hover:text-white"})})]},e)})})}):(0,r.jsxs)("div",{className:"text-xs text-brand-gray-500 italic",children:["No users"," ",p.allowlistConfig===n.k1w.ALLOWLIST?"selected":"blocked"," ","yet"]})]})]}),k&&(0,r.jsx)("p",{className:"text-xs text-brand-red-400 mt-2",children:k})]}):null};var j=a(95612),N=a(8231),k=a(60226),C=a(80325),S=a(10195),E=a(64030),A=a(91302);let T=e=>{let{value:t,options:a,onChange:n,disabled:o=!1,isLoading:i=!1,variant:l="dashboard",placeholder:d,onOpenChange:c}=e,[u,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(i){let e=setTimeout(()=>{m(!0)},300);return()=>clearTimeout(e)}m(!1)},[i]);let h=a.includes("")?a:["",...a],p=(0,s.useMemo)(()=>h.map(e=>({label:(e=>""===e?"Auto":e)(e),onClick:()=>n(e),className:"standalone"===l?"w-full text-left transition-colors first:rounded-t last:rounded-b px-2 py-1 text-xs whitespace-normal break-words ".concat(t===e?"text-black dark:text-white bg-brand-neutrals-100 dark:bg-brand-neutrals-800":"text-brand-gray-600 dark:text-brand-gray-300 hover:bg-brand-neutrals-50 dark:hover:bg-brand-neutrals-800"):"w-full text-left transition-colors first:rounded-t last:rounded-b px-3 py-2 text-sm hover:bg-brand-dashboard-card whitespace-normal break-words ".concat(t===e?"text-white bg-brand-dashboard-card":"text-brand-gray-300")})),[h,t,l,n]),g=t||(null!=d?d:"Auto"),x=u?(0,r.jsxs)("div",{className:"relative flex items-center",children:[(0,r.jsx)("span",{className:"block truncate invisible",children:g}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-3 h-3 border border-brand-gray-300 border-t-transparent rounded-full animate-spin"})})]}):g,f="standalone"===l?"focus:ring-2 focus:ring-blue-500 bg-transparent border-brand-neutrals-200 dark:border-brand-neutrals-700 hover:bg-brand-neutrals-50 dark:hover:bg-brand-neutrals-800 text-black dark:text-white":"focus:ring-2 focus:ring-blue-500 bg-brand-dashboard-bg hover:bg-brand-dashboard-bg/80",b="standalone"===l?"min-w-[280px] w-max bg-white border-brand-neutrals-200 dark:bg-gray-900 dark:border-brand-neutrals-700":"min-w-[280px] w-max max-w-xs bg-gray-900 border-brand-borders";return(0,r.jsx)(A.m,{items:p,trigger:x,isLoading:u,disabled:o||i,buttonClassName:f,menuClassName:b,onOpenChange:c})},R=e=>{let{defaultModel:t,defaultRepo:a,defaultBranch:n,modelOptions:o,isDisabled:l=!1,variant:d="dashboard",onModelChange:c,onRepoChange:u,onBranchChange:m,isUserSettings:h=!1}=e,[p,g]=(0,s.useState)(null),[x,f]=(0,s.useState)(!1),[b,v]=(0,s.useState)(!1),[y,w]=(0,s.useState)(!1),[A,R]=(0,s.useState)(null),{team:L}=(0,i.M)(),{selectedRepository:M,handleRepoSelect:I,isSaving:F,saveError:B,githubConnected:D}=(0,k.Q)({currentRepo:a,onRepoChange:u,disabled:l}),O=null!==p?p:n,P=async e=>{if(R(null),e!==t&&!l){v(!0),R(null);try{await c(e)}catch(e){R(e instanceof Error?e.message:"Failed to save")}finally{v(!1)}}},U=async()=>{if(f(!1),null===p||p===n||l)g(null);else{w(!0),R(null);try{await m(p),g(null)}catch(e){R(e instanceof Error?e.message:"Failed to save"),g(null)}finally{w(!1)}}};return(0,r.jsxs)(N.A,{trailingCaption:(A||B)&&(0,r.jsx)("p",{className:"standalone"===d?"text-xs text-red-500":"text-xs text-brand-red-400",children:A||B}),children:[(0,r.jsx)(j.J,{label:"Default Model",description:"Used when no model is specified",trailingItems:(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(T,{value:t,options:o,onChange:P,disabled:l||b,isLoading:b,variant:d,placeholder:h&&(null==L?void 0:L.id)?"Using team model":void 0})})}),(0,r.jsx)(j.J,{label:"Default Repository",description:"Used when no repository is specified",trailingItems:(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("div",{className:"flex items-center",children:D?(0,r.jsx)(S.A,{selectedRepo:M,onRepoSelect:I,hideIcon:!0,largeFonts:!0}):(0,r.jsx)(E.B,{onClick:()=>{window.open("/api/auth/connect-github?from=website&source=".concat(h?"USER_SETTINGS":"TEAM_SETTINGS"),"_blank")},size:"base",trailingIcon:(0,r.jsx)(C.A,{className:"h-3 w-3 mb-0.5 text-[#191C22]}"}),children:"Connect GitHub"})})})}),(0,r.jsx)(j.J,{label:"Base Branch",description:(0,r.jsx)(r.Fragment,{children:"When empty, Background Agent will use a repository’s default branch (recommended)"}),trailingItems:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",value:O,onChange:e=>{g(e.target.value),R(null)},onFocus:()=>{f(!0),g(n)},onBlur:U,placeholder:"Branch name...",disabled:l||y,className:"dashboard-cell-input"}),y&&(0,r.jsx)("div",{className:"absolute top-1/2 transform -translate-y-1/2 ".concat("right-1"),children:(0,r.jsx)("div",{className:"w-3 h-3 border border-brand-gray-300 border-t-transparent rounded-full animate-spin"})})]})})]})},L=e=>{let{isTeamAdmin:t=!1,variant:a="dashboard"}=e,{defaultRepo:n,defaultBranch:o,defaultModel:l,shareSummary:d,shareSummaryInExternalChannel:c,modelOptions:u,isLoading:m,error:h,updateDefaultRepo:p,updateDefaultBranch:x,updateDefaultModel:v,updateShareSummary:y,updateShareSummaryInExternalChannel:k}=(0,b._U)(),{adminSettings:C,updateAdminSettings:S,isSavingAdminSettings:E,teams:A}=(0,i.M)(),[T,L]=(0,s.useState)(l),[M,I]=(0,s.useState)(d),[F,B]=(0,s.useState)(c),[D,O]=(0,s.useState)(!1),[P,U]=(0,s.useState)(!1),[_,W]=(0,s.useState)(!1),[z,H]=(0,s.useState)(!1),[J,V]=(0,s.useState)(null),q=A.find(e=>e.seats>0);(0,s.useEffect)(()=>{L(l)},[l]),(0,s.useEffect)(()=>{I(d)},[d]),(0,s.useEffect)(()=>{B(c)},[c]),(0,s.useEffect)(()=>{var e;(null==C||null==(e=C.backgroundAgentSettings)?void 0:e.teamFollowupEnabled)!==void 0&&H(C.backgroundAgentSettings.teamFollowupEnabled)},[C]);let K=async e=>{if(I(e),e||B(!1),V(null),t){O(!0),V(null);try{await y(e),!e&&c&&await k(!1)}catch(e){V(e instanceof Error?e.message:"Failed to save"),I(d),d||B(c)}finally{O(!1)}}},G=async e=>{if(B(e),V(null),t){U(!0),V(null);try{await k(e)}catch(e){V(e instanceof Error?e.message:"Failed to save"),B(c)}finally{U(!1)}}},Y=async e=>{if(H(e),V(null),t&&C){var a,r,n;W(!0),V(null);try{await S({...C,backgroundAgentSettings:{allowlist:(null==(a=C.backgroundAgentSettings)?void 0:a.allowlist)||[],allowlistConfig:(null==(r=C.backgroundAgentSettings)?void 0:r.allowlistConfig)||0,...C.backgroundAgentSettings,teamFollowupEnabled:e}})}catch(e){V(e instanceof Error?e.message:"Failed to save"),H((null==(n=C.backgroundAgentSettings)?void 0:n.teamFollowupEnabled)||!1)}finally{W(!1)}}};return m?"standalone"===a?(0,r.jsx)("div",{className:"mt-6 p-4 border border-brand-neutrals-100 dark:border-brand-neutrals-800 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-brand-gray-600",children:"Loading Slack settings..."})}):(0,r.jsx)(r.Fragment,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.w,{label:"Defaults",children:(0,r.jsx)(R,{defaultModel:l,defaultRepo:n,defaultBranch:o,modelOptions:u,isDisabled:!t,variant:a,onModelChange:v,onRepoChange:p,onBranchChange:x,className:"w-full"})}),(0,r.jsxs)(g.w,{label:"Security",children:[(0,r.jsx)(w,{}),(0,r.jsxs)(N.A,{children:[q&&"1"===String(q.id)&&(0,r.jsx)(j.J,{label:"Team Followups",description:"Anyone in your team can create a follow-up on your team's background agents",trailingItems:(0,r.jsx)(f.Switch,{checked:z,onCheckedChange:Y,disabled:!t||_||!C})}),(0,r.jsx)(j.J,{label:"Display Agent Summary",description:"Display agent summaries and diff images. May contain file paths or code snippets",trailingItems:(0,r.jsx)(f.Switch,{checked:M,onCheckedChange:K,disabled:!t||D})}),M&&(0,r.jsx)(j.J,{label:"Display Agent Summary in External Channels",description:"Also display in external channels",trailingItems:(0,r.jsx)(f.Switch,{checked:F,onCheckedChange:G,disabled:!t||P||!M})})]})]}),h&&(0,r.jsx)("p",{className:"standalone"===a?"text-xs text-red-500 mt-2":"text-xs text-brand-red-400 mt-2",children:h}),J&&(0,r.jsx)("p",{className:"standalone"===a?"text-xs text-red-500 mt-2":"text-xs text-brand-red-400 mt-2",children:J}),!t&&(0,r.jsx)("p",{className:"standalone"===a?"text-xs text-brand-gray-600 mt-2":"text-xs text-brand-gray-300 mt-2",children:"Only team administrators can modify Slack settings"})]})};var M=a(93973);a(35371);let I=e=>{let{leadingIcon:t,trailingIcon:a,children:n,className:s="",disabled:o,size:i="base",...l}=e;return(0,r.jsxs)("button",{className:"dashboard-secondary-button ".concat("medium"===i?"dashboard-secondary-button-medium":""," ").concat(s),disabled:o,...l,children:[t&&(0,r.jsx)("span",{className:"dashboard-secondary-button-icon",children:t}),n&&(0,r.jsx)("span",{className:"dashboard-secondary-button-text",children:n}),a&&(0,r.jsx)("span",{className:"dashboard-secondary-button-icon",children:a})]})},F=e=>{let{isTeamAdmin:t=!1}=e,{defaultRepo:a,defaultBranch:n,defaultModel:s,modelOptions:o,error:i,hasSlackAuth:l,updateDefaultRepo:d,updateDefaultBranch:c,updateDefaultModel:u,unlinkSlackAccess:m}=(0,b.m7)(),{isEnabled:h}=(0,b.XJ)();if(!h)return(0,r.jsx)(r.Fragment,{});let p=["",...o],x=async()=>{if(confirm("Are you sure you want to unlink your Slack account? You'll need to reconnect from Slack to use Background Agents again."))try{await m()}catch(e){}};return(0,r.jsxs)(g.w,{label:"Defaults",headerTrailingActions:l?(0,r.jsx)(I,{onClick:x,leadingIcon:(0,r.jsx)(M.default,{src:"/assets/images/slack.svg",alt:"Slack",width:12,height:12}),children:"Unlink Slack"}):void 0,children:[(0,r.jsx)(R,{defaultModel:s,defaultRepo:a,defaultBranch:n,modelOptions:p,isDisabled:!1,variant:"dashboard",onModelChange:u,onRepoChange:d,onBranchChange:c,className:"mb-4",isUserSettings:!0}),i&&(0,r.jsx)("p",{className:"text-xs text-red-500 mt-2",children:i})]})};var B=a(2207),D=a(27800),O=a(51797);let P=e=>{let{variant:t="dashboard"}=e,[a,n]=(0,s.useState)(!1),[o,i]=(0,s.useState)(!0),[l,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/background-composer/get-background-composer-user-settings",{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();n(t.slackNotificationsForWebEnabled||!1)}}catch(e){console.error("Failed to load notification settings",e)}finally{i(!1)}})()},[]);let c=async e=>{n(e),d(!0);try{if(!(await fetch("/api/background-composer/update-background-composer-user-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slackNotificationsForWebEnabled:e})})).ok)throw Error("Failed to update settings")}catch(t){console.error("Failed to update slack notifications",t),n(!e)}finally{d(!1)}};return(0,r.jsx)(g.w,{label:"Notifications",children:(0,r.jsx)(N.A,{children:(0,r.jsx)(j.J,{label:"Slack Notifications",description:"Get notified in Slack when a Background Agent completes a task",trailingItems:(0,r.jsx)(f.Switch,{checked:a,onCheckedChange:c,disabled:o||l})})})})},U=e=>{let{isTeamAdmin:t=!1,isPrivacyModeForced:a=!1,membershipType:n,subscriptionStatus:l,daysRemainingOnTrial:d,canUpdatePrivacyMode:c,onOpenPrivacyModal:u,showTeamSettings:m=!0,showUserSettings:h=!0}=e,{isEnabled:p}=(0,b.XJ)(),{createCheckoutUrl:g,team:x}=(0,i.M)(),{canSend:f,sendNotification:v,checkStatus:y}=(0,D.W)(null==x?void 0:x.id,"privacy-mode"),w=a&&(null==x?void 0:x.id)&&!t,j=w&&f,N=n===o.V.FREE||n===o.V.FREE_TRIAL&&"trialing"!==l,k=async()=>{try{let e=await g({tier:"pro"});window.location.href=e}catch(e){console.error("[Upgrade] Error creating checkout URL:",e)}},C=async()=>{try{await v(),setTimeout(()=>y(),100)}catch(e){console.error("Failed to send admin notification:",e)}};if(s.useEffect(()=>{w&&y()},[w,y]),!p)return(0,r.jsx)(r.Fragment,{});if(a){let e,a=!(null==x?void 0:x.id);return e=a?{label:"Learn more",onClick:()=>{window.open("/privacy-overview","_blank")}}:c?{label:"Edit Privacy Settings",onClick:u||(()=>{window.location.href="/dashboard?tab=settings&openPrivacy=true"})}:j?{label:"Request Access",onClick:C,disabled:!1}:w?{label:"Requested",onClick:void 0,disabled:!0}:void 0,(0,r.jsx)(O.X,{className:"mb-8",title:"Privacy Mode is On",description:"To use Background Agents,".concat(a?" you must change your privacy setting in the Cursor app (version 1.1+).":t?' switch your team\'s privacy setting from "Privacy Mode (Legacy)" to "Privacy Mode".':' ask an administrator to switch your team\'s privacy setting from "Privacy Mode (Legacy)" to "Privacy Mode".'),action:e})}return N?(0,r.jsx)(B.f,{membershipType:n,daysRemainingOnTrial:d,feature:"Background Agents",onUpgradeClick:k}):(0,r.jsxs)(r.Fragment,{children:[m&&(0,r.jsx)(L,{isTeamAdmin:t,variant:"dashboard"}),h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(F,{isTeamAdmin:t}),(0,r.jsx)(P,{variant:"dashboard"})]})]})};var _=a(30548),W=a(89888),z=a(23899),H=a(13715),J=a(37095),V=a(24349),q=a(61126);async function K(e){var t,a,r,n;let s=await fetch("/api/background-composer/list-background-composer-secrets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamScope:e})});if(!s.ok)throw Error(null!=(r=null==(a=await s.json())||null==(t=a.error)?void 0:t.message)?r:"HTTP ".concat(s.status));return null!=(n=(await s.json()).secrets)?n:[]}async function G(e,t,a){var r,n,s;let o=await fetch("/api/background-composer/create-background-composer-secret",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,value:t,teamScope:a})});if(!o.ok)throw Error(null!=(s=null==(n=await o.json())||null==(r=n.error)?void 0:r.message)?s:"HTTP ".concat(o.status))}async function Y(e,t){var a,r,n;let s=await fetch("/api/background-composer/revoke-background-composer-secret",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,teamScope:t})});if(!s.ok)throw Error(null!=(n=null==(r=await s.json())||null==(a=r.error)?void 0:a.message)?n:"HTTP ".concat(s.status))}function $(e){let{title:t,teamScope:a}=e,[n,o]=(0,s.useState)([]),[i,l]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(null),[h,p]=(0,s.useState)(""),[g,x]=(0,s.useState)(""),[f,b]=(0,s.useState)(null),v=async e=>{l(!0),e&&b(null);try{let e=await K(a);o(e)}catch(t){e&&b(t instanceof Error?t.message:String(t))}finally{l(!1)}};(0,s.useEffect)(()=>{v(!1)},[a]);let y=async()=>{if(!h||!g)return void b("Please provide both name and value");c(!0),b(null);try{await G(h,g,a),p(""),x(""),await v(!0)}catch(e){b(e instanceof Error?e.message:String(e))}finally{c(!1)}},w=async e=>{m(e),b(null);try{await Y(e,a),await v(!0)}catch(e){b(e instanceof Error?e.message:String(e))}finally{m(null)}},j=async e=>{var t;let r=null==(t=e.clipboardData)?void 0:t.getData("text");if(!r||!/^[A-Z_][A-Z0-9_]*=.*$/m.test(r))return;e.preventDefault();let n=[];for(let e of r.split("\n")){let t=e.trim();if(!t||t.startsWith("#"))continue;let a=t.indexOf("=");if(-1===a)continue;let r=t.substring(0,a).trim(),s=t.substring(a+1).trim();(s.startsWith('"')&&s.endsWith('"')||s.startsWith("'")&&s.endsWith("'"))&&(s=s.slice(1,-1)),r&&s&&n.push({name:r,value:s})}if(0!==n.length){p(""),x(""),c(!0),b(null);try{let e=await Promise.allSettled(n.map(e=>G(e.name,e.value,a))),t=e.filter(e=>"rejected"===e.status);t.length>0&&b("Created ".concat(e.length-t.length," secrets. ").concat(t.length," failed.")),await v(!0)}catch(e){b(e instanceof Error?e.message:String(e))}finally{c(!1)}}};return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(W.o5,{className:"text-base font-medium",children:t}),(0,r.jsx)(z.Button,{size:"sm",variant:"secondary",onClick:()=>v(!0),disabled:i,children:(0,r.jsxs)("span",{className:"flex items-center gap-1 text-xs",children:[(0,r.jsx)(V.A,{className:(0,J.cn)("h-3 w-3",i&&"animate-spin")})," ","Refresh"]})})]}),(0,r.jsx)(W.o5,{className:"text-xs text-brand-gray-400",children:"These secrets are injected as environment variables into the background agent's environment."}),f&&(0,r.jsx)("div",{className:"text-xs text-red-400",children:f}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(H.p,{placeholder:"Secret name (or paste .env)",value:h,onChange:e=>p(e.target.value),onPaste:j,className:"!h-8 flex-1"}),(0,r.jsx)(H.p,{placeholder:"Secret value",type:"password",value:g,onChange:e=>x(e.target.value),className:"!h-8 flex-[2]"}),(0,r.jsx)(z.Button,{size:"sm",onClick:y,disabled:d||!h||!g,children:"Create"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-1",children:n.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-md bg-brand-dashboard-card px-2 py-2",children:[(0,r.jsx)("span",{className:"text-xs font-mono",children:e.name}),(0,r.jsx)(z.Button,{size:"sm",variant:"secondary",onClick:()=>w(e.name),disabled:u===e.name,children:(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)(q.A,{className:(0,J.cn)("h-3 w-3",u===e.name&&"animate-pulse")}),"Delete"]})})]},"".concat(e.name)))})]})}function Z(){return(0,r.jsx)("div",{className:"bg-brand-dashboard-card px-6 py-6 rounded-xl w-full",children:(0,r.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,r.jsx)($,{title:"User Secrets",teamScope:!1}),(0,r.jsx)($,{title:"Team Secrets",teamScope:!0})]})})}var Q=a(51024);let X=e=>{let{onOpenPrivacyModal:t}=e,{hasAccess:a,isTeamAdmin:f}=(0,l.v9)(),{hasAccess:b}=(0,c._)(),{team:v,stripeStatus:y}=(0,i.M)(),[w,j]=(0,s.useState)(h.TEAM_SETTINGS),N=!(y.membershipType===o.V.ENTERPRISE&&!f),{isBackgroundAgentsRestricted:k}=(0,d.U)(v),{userPrivacyMode:C,isLoadingPrivacyMode:S}=(0,u.W)(),E=(null==v?void 0:v.id)?k:C===n.YTt.NO_STORAGE,A=!(null==v?void 0:v.id)&&S,T=!!(null==v?void 0:v.id);if(A)return(0,r.jsx)("div",{className:"px-6 py-6 rounded-lg",children:(0,r.jsx)("div",{className:"py-8 text-brand-gray-400",children:(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Loading..."})})});if(!a)return(0,r.jsxs)("div",{className:"dashboard-settings-chunk",children:[(0,r.jsx)(x.T,{title:"Background Agents",description:"Create Agents to edit and run code, asynchronously"}),(0,r.jsx)(Q._,{featureName:"Background Agents"})]});let R=()=>(0,r.jsxs)("div",{className:"dashboard-sections",children:[(0,r.jsx)(U,{isTeamAdmin:f,isPrivacyModeForced:E,membershipType:y.membershipType,subscriptionStatus:y.subscriptionStatus,daysRemainingOnTrial:y.daysRemainingOnTrial,canUpdatePrivacyMode:N,onOpenPrivacyModal:t,showTeamSettings:!1,showUserSettings:!0}),b&&(0,r.jsx)(m.Y,{})]});return(0,r.jsxs)("div",{className:"dashboard-settings-chunk",children:[(0,r.jsx)(x.T,{title:"Background Agents",description:"Create Agents to edit and run code, asynchronously"}),(0,r.jsxs)("div",{className:"dashboard-sections",children:[(0,r.jsx)(g.w,{label:"Integrations",children:(0,r.jsx)(_.Y,{team:v,source:"BACKGROUND_AGENT",onOpenPrivacyModal:t})}),T?(0,r.jsxs)("div",{className:"dashboard-tabbed-section",children:[(0,r.jsx)(p,{activeTab:w,onTabChange:j}),w===h.TEAM_SETTINGS?(0,r.jsx)("div",{className:"dashboard-sections",children:(0,r.jsx)(U,{isTeamAdmin:f,isPrivacyModeForced:E,membershipType:y.membershipType,subscriptionStatus:y.subscriptionStatus,daysRemainingOnTrial:y.daysRemainingOnTrial,canUpdatePrivacyMode:N,onOpenPrivacyModal:t,showTeamSettings:!0,showUserSettings:!1})}):R()]}):R(),(0,r.jsx)(Z,{})]})]})}},88640:(e,t,a)=>{a.d(t,{l:()=>s});var r=a(9381),n=a(10689);let s=e=>{let{children:t,className:a}=e,s=n.Children.count(t),o="";switch(s){case 2:o="grid-cols-1 sm:grid-cols-2";break;case 3:o="grid-cols-1 sm:grid-cols-3";break;case 4:o="grid-cols-1 sm:grid-cols-2 lg:grid-cols-4";break;case 5:o="grid-cols-1 sm:grid-cols-2 lg:grid-cols-5";break;default:o="grid-cols-1"}let i="mb-4 grid gap-2 ".concat(o," ").concat(a||"").trim();return(0,r.jsx)("div",{className:i,children:t})}},89858:(e,t,a)=>{a.d(t,{E:()=>i});var r=a(9381),n=a(97098);a(10689);var s=a(37095);let o=(0,n.F)("inline-flex items-center text-xs/[1rem] font-medium px-1 py-0.5 rounded-[0.25rem] transition-colors motion-reduce:transition-none",{variants:{variant:{default:"dark:brand bg-brand-neutrals-400 text-brand-white dark:bg-brand-neutrals-700 dark:text-brand-light-grey-wash",subtle:"bg-brand-neutrals-50 dark:bg-brand-neutrals-900",success:"bg-brand-green-400 text-brand-white dark:text-brand-light-grey-wash",epic:"bg-brand-black text-brand-yellow-200 dark:bg-brand-yellow-200 dark:text-brand-white",info:"bg-brand-yellow-400 text-brand-black dark:text-brand-white",primary:"border border-brand-gray-300 bg-brand-white dark:border-brand-neutrals-800 dark:bg-brand-neutrals-900",outline:"border border-brand-gray-200 bg-transparent dark:border-brand-neutrals-800",code:"border dark:border-brand-gray-200 bg-brand-white dark:bg-[#050505] dark:text-brand-light-grey-wash"}},defaultVariants:{variant:"default"}}),i=e=>{let{className:t,variant:a,as:n,...i}=e;return(0,r.jsx)(null!=n?n:"div",{className:(0,s.cn)(o({variant:a}),t),...i})}},91106:(e,t,a)=>{a.d(t,{_N:()=>v});var r=a(9381),n=a(90037),s=a(18068),o=a(89888),i=a(38742),l=a(44789),d=a(10689),c=a(11113),u=a(54392),m=a(12061),h=a(28790),p=a(34896),g=a(14066),x=a(52151);function f(e,t){switch(e){case s.Kt.USAGE_BASED:return"Usage-based";case s.Kt.USER_API_KEY:return"User API Key";case s.Kt.INCLUDED_IN_PRO:return"Included in Pro";case s.Kt.INCLUDED_IN_PRO_PLUS:return"Included in Pro Plus";case s.Kt.INCLUDED_IN_ULTRA:return"Included in Ultra";case s.Kt.INCLUDED_IN_BUSINESS:return"Included in Business";case s.Kt.ERRORED_NOT_CHARGED:return"Errored, Not Charged";case s.Kt.ABORTED_NOT_CHARGED:return"Aborted, Not Charged";case s.Kt.CUSTOM_SUBSCRIPTION:return null!=t?t:"Custom Subscription";case s.Kt.UNSPECIFIED:default:return"Unknown"}}function b(e){return"default"===e?"auto":e}let v=()=>{let{customRange:e,setCustomRange:t,team:a,users:v,selectedUserId:y,setSelectedUserId:w,viewerRole:j,filteredUsageEvents:N,isFilteredUsageEventsLoading:k,filteredUsageEventsError:C,fetchFilteredUsageEvents:S,totalUsageEventsCount:E,currentPage:A,setCurrentPage:T,pageSize:R,setPageSize:L,stripeStatus:M,usage:I}=(0,m.M)(),[F,B]=(0,d.useState)(!1),[D,O]=(0,d.useState)(null),[P,U]=(0,d.useState)(!1),[_,W]=(0,d.useState)(null),[z,H]=(0,d.useState)(!0),[J,V]=(0,d.useState)(!1),[q,K]=(0,d.useState)({show:!1}),[G,Y]=(0,d.useState)(!1),$=async()=>{if(null===a){U(!0),W(null);try{var e;let t=I.startOfMonth?new Date(I.startOfMonth).getTime():null,a=new Date().getTime(),r=await fetch("/api/dashboard/get-aggregated-usage-events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:-1,startDate:t,endDate:a})});if(!r.ok)throw Error("Failed to fetch aggregated stats: ".concat(r.statusText));let n=await r.json();n.aggregations=null==(e=n.aggregations)?void 0:e.map(e=>({...e,inputTokens:Number(e.inputTokens),outputTokens:Number(e.outputTokens),cacheWriteTokens:Number(e.cacheWriteTokens),cacheReadTokens:Number(e.cacheReadTokens),totalCents:Number(e.totalCents)})),n.totalInputTokens=Number(n.totalInputTokens),n.totalOutputTokens=Number(n.totalOutputTokens),n.totalCacheWriteTokens=Number(n.totalCacheWriteTokens),n.totalCacheReadTokens=Number(n.totalCacheReadTokens),O(n)}catch(e){console.error("Error fetching aggregated stats:",e),W(e instanceof Error?e.message:"Failed to load aggregated stats")}finally{U(!1)}}};(0,d.useEffect)(()=>{null===a&&I.startOfMonth&&$()},[a,I.startOfMonth]),(0,d.useEffect)(()=>{var t,a;K({show:!1}),Y(!1),S({startDate:null!=(t=null==e?void 0:e.from)?t:null,endDate:null!=(a=null==e?void 0:e.to)?a:null,userId:null!=y?y:null})},[S,e,y]);let Z=j===n.acM.OWNER||j===n.acM.FREE_OWNER,Q=Math.max(1,Math.ceil(E/R)),X=t=>{if(t>=1&&t<=Q){var a,r;T(t),S({startDate:null!=(a=null==e?void 0:e.from)?a:null,endDate:null!=(r=null==e?void 0:e.to)?r:null,userId:null!=y?y:null,page:t})}},ee=async()=>{if(!J){V(!0),K({show:!1}),Y(!1);try{let t=new URLSearchParams({...(null==a?void 0:a.id)&&{teamId:a.id.toString()},...(null==e?void 0:e.from)&&{startDate:e.from.getTime().toString()},...(null==e?void 0:e.to)&&{endDate:e.to.getTime().toString()},...y&&{userId:y},showTokenView:F.toString()}),r="/api/dashboard/export-usage-events-csv?".concat(t.toString()),n=window.location.origin+r;console.log("Export URL:",n);let s=window.open(r,"_blank");null==s?K({show:!0,url:n,success:!1}):K({show:!0,url:n,success:!0}),console.log("Starting CSV export download...")}catch(e){console.error("Error starting CSV export:",e),K({show:!0,url:void 0,success:!1})}finally{setTimeout(()=>V(!1),1e3)}}};return(0,r.jsxs)("div",{className:"col-span-1 flex flex-col gap-6 md:col-span-3 pb-6",children:[(()=>{var e,t,n,s;return null===a&&[u.V.PRO,u.V.PRO_PLUS,u.V.ULTRA].includes(null==M?void 0:M.membershipType)?(0,r.jsxs)("div",{className:"flex flex-col gap-4 border-0 bg-brand-dashboard-card p-6 dark:bg-brand-dashboard-card rounded-lg",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 cursor-pointer",onClick:()=>H(!z),children:[(0,r.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[(0,r.jsx)(o.o5,{className:"font-semibold text-lg",children:"Included Usage Summary"}),(0,r.jsx)("div",{className:"ml-auto",children:z?(0,r.jsx)(i.A,{className:"h-4 w-4 rotate-90 transition-transform"}):(0,r.jsx)(i.A,{className:"h-4 w-4 transition-transform"})})]}),I.startOfMonth&&(()=>{let e=new Date(I.startOfMonth),t=new Date(e);return t.setMonth(t.getMonth()+1),(0,r.jsxs)(o.o5,{className:"text-sm text-brand-gray-500",children:["Current billing period:"," ",e.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})," ","-"," ",t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]})})(),(0,r.jsx)(o.o5,{className:"text-sm text-brand-gray-500",children:(()=>{let e="",t="";switch(null==M?void 0:M.membershipType){case u.V.PRO:e=M.isOnStudentPlan?"Pro Student":"Pro",t="at least $20";break;case u.V.PRO_PLUS:e="Pro Plus",t="at least $60";break;case u.V.ULTRA:e="Ultra",t="at least $400";break;default:e="Your plan",t="included usage"}return"".concat(e," comes with ").concat(t," of included usage per month. We work closely with the model providers to make this monthly allotment as high as possible. You'll be notified in-app when you're nearing your monthly limit.")})()}),(0,r.jsx)(o.o5,{className:"text-sm text-brand-gray-500",children:"During the promotional release period, initial GPT-5 usage does not count towards usage limits."})]}),z&&(0,r.jsx)(r.Fragment,{children:P?(0,r.jsx)("div",{className:"flex justify-center p-8",children:(0,r.jsx)(p.K,{})}):_?(0,r.jsxs)(o.o5,{className:"text-center text-brand-red-400",children:["Error loading usage summary: ",_]}):D&&(null!=(t=null==(e=D.aggregations)?void 0:e.length)?t:0)>0?(0,r.jsx)("div",{className:"flex flex-col gap-6",children:(0,r.jsx)("div",{className:"flex flex-col gap-4",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full min-w-[800px] border-collapse text-left text-sm font-mono",children:[(0,r.jsx)("thead",{className:"text-xs uppercase text-brand-gray-600 dark:text-brand-gray-400",children:(0,r.jsxs)("tr",{className:"border-b border-brand-borders dark:border-brand-neutrals-800",children:[(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 font-semibold",children:"Model"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Input (w/ Cache Write)"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Input (w/o Cache Write)"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Cache Read"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Output"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Total Tokens"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"API Cost"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Cost to You"})]})}),(0,r.jsxs)("tbody",{className:"text-xs",children:[(null!=(n=null==D?void 0:D.aggregations)?n:[]).filter(e=>(e.inputTokens||0)>0||(e.outputTokens||0)>0||(e.cacheWriteTokens||0)>0||(e.cacheReadTokens||0)>0||(e.totalCents||0)>0).sort((e,t)=>{var a,r;return(null!=(a=t.totalCents)?a:0)-(null!=(r=e.totalCents)?r:0)}).map((e,t)=>{var a,n;let s=(e.inputTokens||0)+(e.outputTokens||0)+(e.cacheWriteTokens||0)+(e.cacheReadTokens||0);return(0,r.jsxs)("tr",{className:"bg-transparent hover:bg-brand-neutrals-50 dark:hover:bg-brand-neutrals-900",children:[(0,r.jsx)("td",{className:"px-3 py-2",children:(0,r.jsx)("div",{className:"flex items-center gap-1",children:b(null!=(a=e.modelIntent)?a:"default")})}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:(e.cacheWriteTokens||0).toLocaleString()}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:(e.inputTokens||0).toLocaleString()}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:(e.cacheReadTokens||0).toLocaleString()}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:(e.outputTokens||0).toLocaleString()}),(0,r.jsx)("td",{className:"px-3 py-2 text-right font-semibold",children:s.toLocaleString()}),(0,r.jsxs)("td",{className:"px-3 py-2 text-right font-semibold",children:["$",((null!=(n=e.totalCents)?n:0)/100).toFixed(2)]}),(0,r.jsx)("td",{className:"px-3 py-2 text-right font-semibold",children:"$0"})]},"".concat(e.modelIntent,"-").concat(t))}),(0,r.jsxs)("tr",{className:"border-t border-brand-borders dark:border-brand-neutrals-800 font-semibold",children:[(0,r.jsx)("td",{className:"px-3 py-2",children:"Total"}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:((null==D?void 0:D.totalCacheWriteTokens)||0).toLocaleString()}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:((null==D?void 0:D.totalInputTokens)||0).toLocaleString()}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:((null==D?void 0:D.totalCacheReadTokens)||0).toLocaleString()}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:((null==D?void 0:D.totalOutputTokens)||0).toLocaleString()}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:(((null==D?void 0:D.totalInputTokens)||0)+((null==D?void 0:D.totalOutputTokens)||0)+((null==D?void 0:D.totalCacheWriteTokens)||0)+((null==D?void 0:D.totalCacheReadTokens)||0)).toLocaleString()}),(0,r.jsxs)("td",{className:"px-3 py-2 text-right",children:["$",((null!=(s=null==D?void 0:D.totalCostCents)?s:0)/100).toFixed(2)]}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:"$0"})]})]})]})})})}):(0,r.jsx)(o.o5,{className:"text-center text-brand-gray-300",children:"No usage data found for the selected date range."})})]}):null})(),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col items-start justify-between gap-4 md:flex-row md:items-center",children:[(0,r.jsx)(g.U,{customRange:e,setCustomRange:t}),(0,r.jsxs)("div",{className:"flex flex-col items-start gap-2 sm:flex-row sm:items-end",children:[a&&Z&&(0,r.jsx)(x.T,{users:v,selectedUser:y,onUserSelect:w}),(0,r.jsx)(h.j,{onClick:ee,disabled:k||J||0===E,size:"medium",leadingIcon:J?(0,r.jsx)(p.K,{size:"sm"}):(0,r.jsx)(c.A,{className:"h-4 w-4"}),children:J?"Exporting...":"Export CSV"})]})]}),q.show&&(0,r.jsx)("div",{className:"p-4 rounded-lg border ".concat(q.success?"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800":"bg-yellow-50 border-yellow-200 dark:bg-yellow-900/20 dark:border-yellow-800"),children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-5 h-5 rounded-full flex items-center justify-center mt-0.5 ".concat(q.success?"bg-green-100 dark:bg-green-800":"bg-yellow-100 dark:bg-yellow-800"),children:q.success?(0,r.jsx)("svg",{className:"w-3 h-3 text-green-600 dark:text-green-300",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,r.jsx)("svg",{className:"w-3 h-3 text-yellow-600 dark:text-yellow-300",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)(o.o5,{className:"text-sm font-medium ".concat(q.success?"text-green-800 dark:text-green-200":"text-yellow-800 dark:text-yellow-200"),children:q.success?"CSV export download started!":"Download could not start automatically"}),(0,r.jsx)(o.o5,{className:"text-sm mt-1 ".concat(q.success?"text-green-700 dark:text-green-300":"text-yellow-700 dark:text-yellow-300"),children:q.success?"Your CSV download should begin shortly. If it doesn't start, you can use the link below:":"Please copy and paste this URL into your browser to download the CSV:"}),q.url&&(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,r.jsx)("input",{type:"text",value:q.url,readOnly:!0,className:"flex-1 px-3 py-2 text-sm bg-white dark:bg-brand-medium-black border border-brand-borders dark:border-brand-neutrals-800 rounded-md font-mono text-brand-gray-600 dark:text-brand-gray-400",onClick:e=>e.currentTarget.select()}),(0,r.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(q.url),Y(!0),setTimeout(()=>Y(!1),2e3)},className:"px-3 py-2 text-sm bg-brand-dashboard-card hover:bg-brand-borders/30 rounded-md transition-colors border border-brand-borders dark:border-brand-neutrals-800",children:G?"Copied!":"Copy"}),(0,r.jsx)("button",{onClick:()=>window.open(q.url,"_blank"),className:"px-3 py-2 text-sm bg-brand-primary hover:bg-brand-primary/90 text-white rounded-md transition-colors",children:"Open"})]}),(0,r.jsx)("button",{onClick:()=>{K({show:!1}),Y(!1)},className:"mt-3 text-sm text-brand-gray-500 hover:text-brand-gray-700 dark:hover:text-brand-gray-300 underline",children:"Dismiss"})]})]})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 border-0 bg-brand-dashboard-card p-6 dark:bg-brand-dashboard-card rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)(o.o5,{className:"font-semibold",children:"All Raw Events"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-xs text-brand-gray-500",children:"View:"}),(0,r.jsx)("button",{onClick:()=>{B(!F),K({show:!1}),Y(!1)},className:"px-3 py-1 text-xs rounded-md transition-colors ".concat(F?"bg-brand-neutrals-200 dark:bg-brand-neutrals-700 text-brand-gray-600 dark:text-brand-gray-400":"bg-brand-gray-500 text-white"),children:"Details"}),(0,r.jsx)("button",{onClick:()=>{B(!F),K({show:!1}),Y(!1)},className:"px-3 py-1 text-xs rounded-md transition-colors ".concat(F?"bg-brand-gray-500 text-white":"bg-brand-neutrals-200 dark:bg-brand-neutrals-700 text-brand-gray-600 dark:text-brand-gray-400"),children:"Tokens"})]})]}),k?(0,r.jsx)("div",{className:"flex justify-center p-8",children:(0,r.jsx)(p.K,{})}):C?(0,r.jsxs)(o.o5,{className:"text-center text-brand-red-400",children:["Error loading usage events: ",C]}):0===N.length?(0,r.jsx)(o.o5,{className:"text-center text-brand-gray-300",children:"No usage events found for the selected filters."}):(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full ".concat(F?"min-w-[800px]":"min-w-[700px]"," border-collapse text-left text-sm font-mono"),children:[(0,r.jsx)("thead",{className:"text-xs uppercase text-brand-gray-600 dark:text-brand-gray-400",children:(0,r.jsx)("tr",{className:"border-b border-brand-borders dark:border-brand-neutrals-800",children:F?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 font-semibold",children:"Kind"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 font-semibold",children:"Model"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Input (w/ Cache Write)"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Input (w/o Cache Write)"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Cache Read"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 text-right font-semibold",children:"Output"}),(0,r.jsx)("th",{scope:"col",className:"w-[100px] px-3 py-2 text-right font-semibold",children:"Cost"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("th",{scope:"col",className:"w-[130px] px-3 py-2 font-semibold",children:"Date"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 font-semibold",children:"User"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 font-semibold",children:"Kind"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 font-semibold",children:"Max Mode"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 font-semibold",children:"Model"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 font-semibold",children:"Tokens"}),(0,r.jsx)("th",{scope:"col",className:"w-[100px] px-3 py-2 text-right font-semibold",children:null===a?"Cost":"Cost (Requests)"})]})})}),(0,r.jsx)("tbody",{className:"text-xs",children:N.map((e,t)=>{var n,o,i,l;let d=a?null!=(i=null==(n=v.find(t=>t.id===String(e.owningUser)))?void 0:n.email)?i:String(null!=(o=e.owningUser)?o:"N/A"):"You",c=new Date(Number(e.timestamp)).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),u=new Date(Number(e.timestamp)).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0});if("Unknown"===e.model)return null;e.model=b(null!=(l=e.model)?l:"default");let m=e.tokenUsage||{inputTokens:0,outputTokens:0,cacheWriteTokens:0,cacheReadTokens:0,totalCents:0};return(0,r.jsx)("tr",{className:"bg-transparent hover:bg-brand-neutrals-50 dark:hover:bg-brand-neutrals-900",children:F?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("td",{className:"max-w-[150px] truncate px-3 py-2 text-left",title:f(e.kind,e.customSubscriptionName),children:f(e.kind,e.customSubscriptionName)}),(0,r.jsx)("td",{className:"max-w-[120px] truncate px-3 py-2 text-left",title:e.model,children:e.model}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:e.isTokenBasedCall?(m.cacheWriteTokens||0).toLocaleString():"-"}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:e.isTokenBasedCall?(m.inputTokens||0).toLocaleString():"-"}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:e.isTokenBasedCall?(m.cacheReadTokens||0).toLocaleString():"-"}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:e.isTokenBasedCall?(m.outputTokens||0).toLocaleString():"-"}),(0,r.jsx)("td",{className:"w-[100px] px-3 py-2 text-right",children:null===a?e.kind!==s.Kt.USAGE_BASED?(0,r.jsx)("span",{className:"cursor-help",title:"$".concat(((m.totalCents||0)/100).toFixed(2)," value"),children:"Included"}):(0,r.jsx)("span",{children:e.isTokenBasedCall?"$".concat(((m.totalCents||0)/100).toFixed(2)):e.usageBasedCosts}):(0,r.jsx)("span",{children:Math.round(10*e.requestsCosts)/10})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("td",{className:"w-[130px] truncate px-3 py-2 text-left",title:u,children:c}),(0,r.jsx)("td",{className:"max-w-[180px] truncate px-3 py-2 text-left",title:d,children:d}),(0,r.jsx)("td",{className:"max-w-[150px] truncate px-3 py-2 text-left",title:f(e.kind,e.customSubscriptionName),children:f(e.kind,e.customSubscriptionName)}),(0,r.jsx)("td",{className:"px-3 py-2 text-left",children:e.maxMode?"Yes":"No"}),(0,r.jsx)("td",{className:"max-w-[120px] truncate px-3 py-2 text-left",title:e.model,children:e.model}),(0,r.jsx)("td",{className:"px-3 py-2",children:e.isTokenBasedCall?(0,r.jsx)("span",{children:((m.inputTokens||0)+(m.outputTokens||0)+(m.cacheWriteTokens||0)+(m.cacheReadTokens||0)).toLocaleString()}):(0,r.jsx)("span",{className:"text-brand-gray-400",children:"-"})}),(0,r.jsx)("td",{className:"w-[100px] px-3 py-2 text-right",children:null===a?e.kind!==s.Kt.USAGE_BASED?(0,r.jsx)("span",{className:"cursor-help",title:"$".concat(((m.totalCents||0)/100).toFixed(2)," value"),children:"Included"}):(0,r.jsx)("span",{children:e.isTokenBasedCall?"$".concat(((m.totalCents||0)/100).toFixed(2)):e.usageBasedCosts}):(0,r.jsx)("span",{children:Math.round(10*e.requestsCosts)/10})})]})},"".concat(e.timestamp,"-").concat(t))})})]})}),Q>1&&(0,r.jsxs)("div",{className:"flex items-center justify-between border-t border-brand-borders dark:border-brand-neutrals-800 pt-4",children:[(0,r.jsxs)("div",{className:"flex items-center text-xs text-brand-gray-500",children:["Showing"," ",Math.min((A-1)*R+1,E)," ","- ",Math.min(A*R,E)," of"," ",E," events"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mr-4",children:[(0,r.jsx)("span",{className:"text-xs text-brand-gray-500",children:"Rows per page:"}),(0,r.jsxs)("select",{className:"bg-transparent border border-brand-borders dark:border-brand-neutrals-800 rounded text-xs px-2 py-1",value:R,onChange:t=>(t=>{var a,r;L(t),T(1),S({startDate:null!=(a=null==e?void 0:e.from)?a:null,endDate:null!=(r=null==e?void 0:e.to)?r:null,userId:null!=y?y:null,pageSize:t,page:1})})(Number(t.target.value)),children:[(0,r.jsx)("option",{value:100,children:"100"}),(0,r.jsx)("option",{value:250,children:"250"}),(0,r.jsx)("option",{value:500,children:"500"})]})]}),(0,r.jsx)("button",{onClick:()=>X(1),disabled:1===A,className:"p-1 rounded hover:bg-brand-neutrals-50 dark:hover:bg-brand-neutrals-900 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Jump to first page",children:(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("polyline",{points:"11 17 6 12 11 7"}),(0,r.jsx)("polyline",{points:"18 17 13 12 18 7"})]})}),(0,r.jsx)("button",{onClick:()=>X(A-1),disabled:1===A,className:"p-1 rounded hover:bg-brand-neutrals-50 dark:hover:bg-brand-neutrals-900 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:(0,r.jsx)(l.A,{className:"h-4 w-4"})}),(0,r.jsxs)("span",{className:"text-xs",children:["Page ",A," of ",Q]}),(0,r.jsx)("button",{onClick:()=>X(A+1),disabled:A===Q,className:"p-1 rounded hover:bg-brand-neutrals-50 dark:hover:bg-brand-neutrals-900 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:(0,r.jsx)(i.A,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>X(Q),disabled:A===Q,className:"p-1 rounded hover:bg-brand-neutrals-50 dark:hover:bg-brand-neutrals-900 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Jump to last page",children:(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("polyline",{points:"6 17 11 12 6 7"}),(0,r.jsx)("polyline",{points:"13 17 18 12 13 7"})]})})]})]})]})]})]})}},91302:(e,t,a)=>{a.d(t,{m:()=>o});var r=a(9381),n=a(10689),s=a(20503);let o=e=>{let{items:t,trigger:a,isLoading:o=!1,disabled:i=!1,className:l="",buttonClassName:d="",menuClassName:c="",menuAlign:u="right",size:m="base",onOpenChange:h}=e,[p,g]=(0,n.useState)(!1),[x,f]=(0,n.useState)("bottom"),b=(0,n.useRef)(null),v=(0,n.useRef)(null),y=(0,n.useRef)(null);return(0,n.useEffect)(()=>{null==h||h(p)},[p,h]),(0,n.useEffect)(()=>{if(p&&v.current){let e=v.current.getBoundingClientRect(),t=window.innerHeight-e.bottom-20,a=e.top-20;t<400&&a>t&&a>=400?f("top"):f("bottom")}},[p]),(0,n.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&g(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.jsxs)("div",{className:"relative ".concat(l),ref:b,children:[(0,r.jsxs)("button",{ref:v,onClick:()=>g(!p),className:"flex items-center rounded-md border border-brand-borders ".concat({base:"px-1.5 py-[3px] dashboard-sm gap-1",medium:"px-2 py-[3px] dashboard-base gap-1"}[m]," text-white transition duration-150 ease hover:bg-white/[0.04] whitespace-nowrap ").concat(d),disabled:i||o,children:[o?"Loading...":a,"string"==typeof a&&(0,r.jsx)(s.A,{className:"".concat({base:"h-3 w-3",medium:"h-4 w-4"}[m]," transition-transform ").concat(p?"rotate-180":"")})]}),p&&(0,r.jsx)("div",{ref:y,className:"absolute ".concat("left"===u?"left-0":"right-0"," ").concat("top"===x?"bottom-full mb-1":"top-full mt-1"," rounded-lg shadow-lg z-10 min-w-[160px] overflow-hidden ").concat(c),style:{backgroundColor:"#1b1d21",border:"2px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 0 8px 2px color-mix(in srgb, var(--vscode-widget-shadow, rgba(0, 0, 0, 0.36)) 30%, transparent)",maxHeight:"400px",overflowY:"auto"},children:t.map((e,a)=>(0,r.jsxs)(n.Fragment,{children:[e.href?(0,r.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",onClick:()=>g(!1),className:"block w-full px-3 py-2 text-sm text-left transition-colors hover:bg-white/5 ".concat(e.disabled?"opacity-50 cursor-not-allowed pointer-events-none":"cursor-pointer"," ").concat(e.className||"text-gray-300"),children:e.label}):(0,r.jsx)("button",{onClick:()=>(e=>{!e.disabled&&e.onClick&&(g(!1),e.onClick())})(e),className:"w-full px-3 py-2 text-sm text-left transition-colors hover:bg-white/5 ".concat(e.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer"," ").concat(e.className||"text-gray-300"),disabled:e.disabled,children:e.label}),a<t.length-1&&(0,r.jsx)("div",{className:"h-px bg-white/10"})]},a))})]})}},92079:(e,t,a)=>{a.d(t,{f:()=>d});var r=a(9381),n=a(37095),s=a(42768),o=a(41396),i=a(10689);let l={type:"spring",stiffness:250,damping:25},d=(0,i.forwardRef)((e,t)=>{let{onMouseEnter:a,onMouseLeave:d,className:c,size:u=28,...m}=e,h=(0,s.s)(),p=(0,i.useRef)(!1);(0,i.useImperativeHandle)(t,()=>(p.current=!0,{startAnimation:()=>h.start("animate"),stopAnimation:()=>h.start("normal")}));let g=(0,i.useCallback)(e=>{p.current?null==a||a(e):h.start("animate")},[h,a]),x=(0,i.useCallback)(e=>{p.current?null==d||d(e):h.start("normal")},[h,d]);return(0,r.jsx)("div",{className:(0,n.cn)(c),onMouseEnter:g,onMouseLeave:x,...m,children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:u,height:u,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)(o.P.path,{variants:{normal:{y:0},animate:{y:-2}},transition:l,animate:h,initial:"normal",d:"m7 20 5-5 5 5"}),(0,r.jsx)(o.P.path,{variants:{normal:{y:0},animate:{y:2}},transition:l,animate:h,initial:"normal",d:"m7 4 5 5 5-5"})]})})});d.displayName="ChevronsDownUpIcon"}}]);